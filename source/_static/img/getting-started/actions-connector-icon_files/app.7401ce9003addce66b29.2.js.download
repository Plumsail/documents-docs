webpackJsonp([0],[function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={modules:{ngResource:"ngResource",ngRoute:"ngRoute",ngFileUpload:"ngFileUpload",ngAria:"ngAria",processSimple:"processSimple",processSimpleComponents:"processSimple.components",processSimpleData:"processSimple.data",processSimpleDirectives:"processSimple.directives",processSimpleInterceptors:"processSimple.interceptors",processSimpleResources:"processSimple.resources",processSimpleServices:"processSimple.services",powerAppsDirectives:"PowerApps.Directives",powerUx:"powerux"},providers:{$httpProvider:"$httpProvider",$locationProvider:"$locationProvider",authenticationProvider:"authenticationProvider",route:"route",routeProvider:"routeProvider"},components:{activityFeed:"activityFeed",alert:"alert",apiIconColumn:"apiIconColumn",apiOperationCard:"apiOperationCard",apiOperationCardList:"apiOperationCardList",apis:"apis",approvalCenter:"approvalCenter",approvals:{approvalCard:"approvalCard",approvalCarousel:"approvalCarousel",receivedTab:"receivedTab",sentTab:"sentTab",historyTab:"historyTab",zeroApprovals:"zeroApprovals"},avatar:"avatar",backbutton:"backbutton",confirmDialog:"confirmDialog",connection:"connection",connectionDisambiguation:"connectionDisambiguation",connectionForm:"connectionForm",connections:"connections",connectionsWidget:"connectionsWidget",connectionWizard:"connectionWizard",contactSupport:"contactSupport",createConnection:"createConnection",customConnectorDialog:"customConnectorDialog",customApi:{customApiAction:"customApiAction",customApiDefinition:"customApiDefinition",customApiParameter:"customApiParameter",customApiResponse:"customApiResponse",customApiTestTab:"customApiTestTab",customApiTrigger:"customApiTrigger",definitionTab:"customApiDefinitionTab",detailsTab:"customApiDetailsTab",generalTab:"customApiGeneralTab",propertiesPane:"propertiesPane",securityTab:"customApiSecurityTab",shareTab:"customApiShareTab"},deleteFlowDialog:"deleteFlowDialog",developerEnvironmentBanner:"developerEnvironmentBanner",dialogButtons:"dialogButtons",editFlowDetails:"editFlowDetails",emailDisplay:"emailDisplay",exportFlow:"exportFlow",downloadMenu:"downloadMenu",environmentPicker:"environmentPicker",feedback:"feedback",filePicker:"filePicker",flow:"flow",flowNewGettingStarted:"flowNewGettingStarted",flowNewGettingStartedHeroSection:"flowNewGettingStartedHeroSection",flowOwners:"flowOwners",flowProperties:"flowProperties",flowTiles:{flowConnectionsTile:"flowConnectionsTile",flowDetailsTile:"flowDetailsTile",flowMobileBannerTile:"flowMobileBannerTile",flowOwnersTile:"flowOwnersTile",flowRunOnlyTile:"flowRunOnlyTile",flowRunsTile:"flowRunsTile"},flowPermissionsList:"flowPermissionsList",flowRun:"flowRun",flowRuns:"flowRuns",flows:"flows",submitTemplate:"submitTemplate",templateLandingLiteContent:"templateLandingLiteContent",flowSaveAsDialog:"flowSaveAsDialog",foldingList:"foldingList",fullPageError:"fullPageError",fullPageSingleAction:"fullPageSingleAction",gateways:"gateways",gearMenu:"gearMenu",headerAvatarImage:"headerAvatarImage",importFlow:"importFlow",infoCard:"infoCard",infoCardList:"infoCardList",infoPane:"infoPane",landing:"landing",learnMore:"learnMore",messageBar:"messageBar",modalDialog:"modalDialog",notificationList:"notificationList",options:"options",paneSection:"paneSection",parameterDropdownEditor:"parameterDropdownEditor",popularTriggers:"popularTriggers",propertyTile:"propertyTile",psList:"psList",recommendTemplates:"recommendTemplates",runFlow:"runFlow",runFlowContent:"runFlowContent",runFlowDialog:"runFlowDialog",runOperationSummary:"runOperationSummary",runtimeFlowWidget:"runtimeFlowWidget",schemaProperty:"schemaProperty",settingsPane:"settingsPane",spinner:"spinner",swaggerEditor:"swaggerEditor",heading:"heading",tokenBlock:"tokenBlock",templateTile:"templateTile",templateWidget:"templateWidget",trialDialog:"trialDialog",trialExpired:"trialExpired",userConsent:"userConsent",inlineUserConsent:"inlineUserConsent",validatedInput:"validatedInput",validationResults:"validationResults",validationResultTooltip:"validationResultTooltip",viewPermissionsDialog:"viewPermissionsDialog",widgetConsent:"widgetConsent",zeroActivities:"zeroActivities",zeroCustomApis:"zeroCustomApis",zeroFlowRuns:"zeroFlowRuns",zeroFlowRunsSlideInPane:"zeroFlowRunsSlideInPane",zeroFlows:"zeroFlows",autocomplete:"autocomplete",graphAutocomplete:"graphAutocomplete"},directives:{actvityFeedList:"activityFeedList",apiList:"apiList",cdnSrc:"cdnSrc",connectionForm:"connectionForm",connectionList:"connectionList",gatewayList:"gatewayList",customApiDetailsForm:"customApiDetailsForm",customApiList:"customApiList",flowDesigner:"flowDesigner",flowList:"flowList",flowMonitor:"flowMonitor",flowRunList:"flowRunList",listCommands:"listCommands",ngBindHtmlCompile:"ngBindHtmlCompile",npsHost:"npsHost",onInputFileChange:"onInputFileChange",purchaseButton:"purchaseButton",trialButton:"trialButton",trialDialogCtrl:"trialDialogCtrl"},interceptors:{consentInterceptor:"consentInterceptor",localeInterceptor:"localeInterceptor",loggingInterceptor:"loggingInterceptor",removeHeadersInterceptor:"removeHeadersInterceptor",widgetInterceptor:"widgetInterceptor"},services:{$compile:"$compile",$document:"$document",$element:"$element",$http:"$http",$injector:"$injector",$interval:"$interval",$location:"$location",$provide:"$provide",$q:"$q",$rootScope:"$rootScope",$route:"$route",$routeParams:"$routeParams",$scope:"$scope",$timeout:"$timeout",$window:"$window",$sce:"$sce",alertService:"alertService",algorithms:"algorithms",apiOperationsClient:"apiOperationsClient",apiOperationsService:"apiOperationsService",apisClient:"apisClient",apisClientLA:"apisClientLA",approvalRequestsClient:"approvalRequestsClient",approvalResponsesClient:"approvalResponsesClient",approvalsClient:"approvalsClient",authentication:"authentication",azureBlobUploaderService:"azureBlobUploaderService",backend:"backend",businessAppPlatformClient:"businessAppPlatformClient",connectionForm:"connectionForm",connectionHelper:"connectionHelper",connectionsClient:"connectionsClient",consentClient:"consentClient",designerConfig:"designerConfig",domHelper:"domHelper",flowRunCount:"flowRunCount",flowRun:"flowRun",gatewaysClient:"gatewaysClient",customApiHelper:"customApiHelper",dateTime:"dateTimeService",environment:"environment",environmentsClient:"environmentsClient",feedEventDefinitionsClient:"feedEventDefinitionsClient",fileReaderHelperService:"fileReaderHelperService",flowRolesClient:"flowRolesClient",flowRunsClient:"flowRunsClient",flowRunsHistoryCsvDownloadService:"flowRunsHistoryCsvDownloadService",flowsClient:"flowsClient",flowTriggerCallbackUrlClient:"flowTriggerCallbackUrlClient",flowTriggerHistoriesClient:"flowTriggerHistoriesClient",flowTriggersClient:"flowTriggersClient",userFlowAccountClient:"userFlowAccountClient",graph:"graph",geocode:"geocode",hostCommunication:"hostCommunication",installFlowService:"installFlowService",locationService:"locationService",logging:"logging",logicAppTemplateExport:"logicAppTemplateExport",navigation:"navigation",navigationHelper:"navigationHelper",npsHttpService:"npsHttpService",oAuth:"oAuth",policies:"policies",plan:"plan",templateCreationHelper:"templateCreationHelper",permissionsClient:"permissionsClient",plansClient:"plansClient",poll:"polling",promiseHelperService:"promiseHelperService",session:"session",flowConnectionsClient:"flowConnectionsClient",storageCacheFactory:"storageCacheFactory",swaggerEditorData:"swaggerEditorData",swaggerValidationService:"swaggerValidationService",rpc:"rpc",runInstanceService:"runInstanceService",storage:"storage",telemetry:"telemetry",optimizely:"optimizely",templatesClient:"templatesClient",templatePublish:"templatePublish",url:"url",userConsent:"userConsent",trialDialog:"trialDialog",appSettings:"AppSettings",clientResources:"clientResources",azureResourceClientFactory:"azureResourceClientFactory",resourceClientFactory:"resourceClientFactory",designerConnectionService:"designerConnectionService",designerAzureADService:"designerAzureADService",designerFlowManagementService:"designerFlowManagementService"}}},function(e,t,i){"use strict";function r(e){var t=e.toString();return t=t.substr("function ".length),t=t.substr(0,t.indexOf("("))}function n(e){var t=r(e),i=t[0].toLowerCase()+t.slice(1);return i=i.replace(new RegExp("(Directive|Service|Provider)$"),"")}function o(e,t){t.component(n(e),new e)}function s(e,t){var i=e.$inject||[],r=i.splice(0);r.push(function(t,i,r,n,o,s,a,l,c,u,p,d,g,m,f,h){return new e(t,i,r,n,o,s,a,l,c,u,p,d,g,m,f,h)}),t.directive(n(e),r)}function a(e,t){t.service(n(e),e)}function l(e,t){t.provider(n(e),e)}function c(){var e="",t=0;for(t=0;t<32;t+=1){var i=16*Math.random()|0;switch(t){case 8:case 12:case 16:case 20:e+="-"}e+=i.toString(16)}return e}function u(e,t){return e[t]}function p(e,t){return"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),"/"===t[0]&&(t=t.substring(1,t.length)),e+"/"+t}function d(e){return null===e||void 0===e}function g(e,t,i){return void 0===i&&(i=!0),i?!d(e)&&!d(t)&&e.toLowerCase()===t.toLowerCase():!d(e)&&!d(t)&&e===t}function m(e){return D(e)?"":""+e[0].toUpperCase()+e.slice(1)}function f(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var r,n=/\{[a-zA-Z$_\d]*\}/g,o=/\{(\d+)\}/g,s=!1;if(t&&1===t.length&&t[0]&&"object"==typeof t[0]){var a=t[0];r=e.replace(n,function(e){var t=e.substring(1,e.length-1);return a.hasOwnProperty(t)?(s=!0,a[t]):e})}return s||(r=e.replace(o,function(e,i){return void 0!==t[i]?t[i]:e})),r}function h(e,t,i){return void 0===i&&(i=0),String.prototype.indexOf.call(e,t,i)>=0}function v(e,t){var i=!1,r=""+e;return d(r)||d(t)||(i=g(r.substring(0,t.length),t)),i}function y(e,t){var i=!1,r=""+e;return d(r)||d(t)||(i=g(r.substr(r.length-t.length),t)),i}function w(e){return e?new Date(e):null}function C(e){return"string"==typeof e||e instanceof String}function S(e,t){return d(e)?"":(t?e:e.toLowerCase()).trim().replace(/[\?\~\!\@\#\$\%\^\&\*\<\>\{\}\[\]\(\)\|_\+\,\.\:\;\`\'\""\/\\]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").substring(0,200)}function b(e){return d(e)||D(e.trim())?"":-1===e.indexOf(" ")?e[0].toUpperCase()+e.substring(1):e.split(" ").map(function(e){return e[0].toUpperCase()+e.substring(1).toLowerCase()}).join("").replace(" ","")}function P(e){return d(e)?"":S(R(e))+"."+T(e)}function R(e){return d(e)?"":e.replace(/\.[^\/.]+$/,"")}function T(e){return d(e)?"":e.substr(e.lastIndexOf(".")+1)}function E(e){var t={};return Object.keys(e).forEach(function(i){t[i.toLowerCase()]=e[i]}),t}function A(e,t){if(e&&0!==e.size){var i=e;return i.lastModifiedDate=new Date,i.name=t,i}}function D(e){return d(e)||("object"==typeof e?0===Object.keys(e).length:""===e)}function F(e){return d(e)||!/\S/.test(e)}function N(e){return e.size/1024/1024}function I(e){var t=new Uint8Array(e),i="";return Object.keys(t).forEach(function(e){i+=String.fromCharCode(t[e])}),btoa(i)}function O(e,t){if(d(e)||D(t)||"object"!=typeof e)return!1;if(e.hasOwnProperty(t))return!0;for(var i in e)if(O(e[i],t))return!0;return!1}function k(e,t){return!d(e)&&!d(t)&&e.indexOf(t)>=0}function M(e){var t=[],i={};return e.forEach(function(e){i[e]||(i[e]=!0,t.push(e))}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.extractFuncName=r,t.extractAngularName=n,t.registerComponent=o,t.registerDirective=s,t.registerService=a,t.registerProvider=l,t.generateGuid=c,t.getEnumValue=u,t.joinUrl=p,t.isNullOrUndefined=d,t.equals=g,t.capitalize=m,t.format=f,t.stringIncludes=h,t.startsWith=v,t.endsWith=y,t.getDate=w,t.isString=C,t.getSlug=S,t.getTitleCaseString=b,t.getFileNameSlug=P,t.convertToLowerCaseIndex=E,t.convertBlobToFile=A,t.isEmpty=D,t.isNullOrWhitespace=F,t.getFileSizeInMb=N,t.arrayBufferToBase64=I,t.hasOwnNestedProperty=O,t.contains=k,t.getArrayWithNoDuplicates=M},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);angular.module(r.default.modules.processSimpleComponents,[r.default.modules.ngAria])},function(e,t,i){"use strict";function r(e){if(e&&e.data&&e.data.error&&e.data.error.code){var i=e.data.error.code;if(i===t.errorConstants.apiPolicyApiGroupCode||i===t.errorConstants.apiPolicyDataFlowCode)return!0;if(i===t.errorConstants.multipleErrorsCode&&Array.isArray(e.data.error.details)){return e.data.error.details.filter(function(e){return r({data:{error:e}})}).length>0}}return!1}function n(e,t){return e&&e.data&&e.data.error&&e.data.error.message?e.data.error.message:e&&e.data&&e.data&&e.data["odata.error"]&&e.data["odata.error"].message&&e.data["odata.error"].message.value?e.data["odata.error"].message.value:e&&e.message?e.message:p.isString(e)?e:e&&e.innerError&&e.innerError.error&&e.innerError.error.message?e.innerError.error.message:l(e)&&-1===e.status?"Client request aborted":t||"Something went wrong. Try again in a few minutes."}function o(e){return e.data&&e.data.error&&e.data.error.code}function s(e){return l(e)&&-1===e.status?t.Status.Abort:g.isAbortedClientError(e)?t.Status.Abort:t.Status.Failure}function a(e){return l(e)&&(e.config.headers&&e.config.headers.Authorization&&(e.config.headers.Authorization="----scrubbed----"),e.config.data&&(e.config.data="----scrubbed----")),e}function l(e){return e&&e.config&&e.config.method&&e.status}function c(e,t,i,r){e.error=t,e.time=new Date,e.isPageErrored=!0,i&&(e.friendlyErrorText=i),r&&(e.friendlyErrorSubtext=r)}function u(e){var t=d.getClientResources();if(e){var i=e.toLowerCase().indexOf('{"error":{"code":"');if(i>0)try{var r=e.substr(i);return JSON.parse(r).error.message}catch(t){return e}else{var n=e.indexOf("error_description="),o=e.indexOf("error=access_denied"),s=e.indexOf("Failed to login."),a=e.indexOf("Failed to save claims");if(n>-1){var l=n+"error_description=".length,c=e.substr(l).indexOf("\n");return c<0&&(c=e.substr(l).length),e.substring(l,c+l)}if(o>-1)return t.Error.Generic.AccessDenied;if(s>-1)return e.indexOf("A single sign on security validation check has failed.")>0?"Failed to login. A single sign on security validation check has failed.":t.Error.Generic.FailedToLogin;if(a>-1)return t.Error.Office.FailedToSaveClaims}}return e}Object.defineProperty(t,"__esModule",{value:!0});var p=i(1),d=i(69),g=i(15);t.errorConstants={apiPolicyApiGroupCode:"ApiPolicyApiGroupViolation",apiPolicyDataFlowCode:"ApiPolicyDataFlowViolation",multipleErrorsCode:"MultipleErrorsOccurred",softDeletedFlowCode:"FlowSoftDeleted",connectionAuthorizationFailed:"ConnectionAuthorizationFailed",outOfBoxTemplateInstanceNotUniqueCode:"OutOfBoxTemplateInstanceNotUnique"},t.dlpViolationLink={url:"https://go.microsoft.com/fwlink/?linkid=829852",text:d.getClientResources().Flow.Error.DLPViolation.LearnMore},t.Status={Success:"Success",Failure:"Failure",Abort:"Abort"},t.isDLPViolationError=r,t.parseErrorMessage=n,t.parseErrorCode=o,t.inferErrorStatus=s,t.scrubErrorObject=a,t.isAngularHttpErrorObject=l,t.showFullPageError=c,t.sanitizeError=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(40),n=i(66),o=i(3),s=i(29);t.ProfilingEventNames=s.ProfilingEventNames;var a=i(3);t.Status=a.Status;var l=function(){function e(e){this.analyticsService=e}return Object.defineProperty(e,"instance",{get:function(){return e.loggingService.value},enumerable:!0,configurable:!0}),e.prototype.logInfo=function(e,t,i,r,n,o){this.analyticsService.logInfo(e,t,i,r,n,o)},e.prototype.logWarning=function(e,t,i,r,n,o){this.analyticsService.logWarning(e,t,i,r,n,o)},e.prototype.logError=function(e,t,i,r,n,s){this.analyticsService.logError(e,o.scrubErrorObject(t),i,r,n,s)},e.prototype.logHttpRequestStart=function(e,t,i,r,n,o,s,a){this.analyticsService.logHttpRequestStart(e,t,i,r,n,o,s,a)},e.prototype.logHttpRequestEnd=function(e,t,i,r,n,o,s,a,l,c){this.analyticsService.logHttpRequestEnd(e,t,i,r,n,o,s,a,l,c)},e.prototype.performanceNow=function(){return this.analyticsService.performanceNow()},e.prototype.profileStart=function(e,t,i,r,n,o){return this.analyticsService.profileStart(i,e,t,r,n,o)},e.prototype.profileEnd=function(e,t,i,r,n,o){this.analyticsService.profileEnd(e,t,i,r,n,o)},e.prototype.profilePageStart=function(t,i,r,n,o,s){var a=this.analyticsService.profileStart(r,t,i,n,o,s,e.logPerformance);return e.logPerformance=!1,a},e.prototype.profilePageEnd=function(e,t,i,r,n,o){this.analyticsService.profileEnd(e,t,i,r,n,o)},e.prototype.profile=function(e,t,i,r,n,o){this.analyticsService.profile(e,t,i,r,n,o)},e.loggingService=new r.Lazy(function(){return new e(n.AnalyticsService.instance)}),e.logPerformance=!0,e}();t.LoggingService=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={activitiesZero:i(342),addPerson:i(343),alert:i(344),backArrow:i(345),clock:i(346),clockWhite:i(347),close:i(348),closeBlue:i(349),confirmationCheck:i(350),copyClipboard:i(351),consent:i(352),contentUpload:i(353),customApiZero:i(354),defaultConnection:i(355),defaultSwaggerIcon:i(356),description:i(357),fullPageErrorCreateEditFlow:i(358),fullPageErrorDebugFlow:i(359),fullPageErrorGeneric:i(360),fullPageErrorListFlows:i(361),iosAppStore:i(362),androidAppStore:i(363),flowNewGettingStarted:i(364),flowLight:i(365),flowLogoBlue:i(366),flowPlaceholder:i(367),flowsZero:i(368),flowsZeroRuns:i(369),flowsZeroFailures:i(370),onboarding:i(371),group:i(372),import:i(373),linkWhite:i(374),notificationError:i(375),notificationsZero:i(376),templateTileFailed:i(377),templateTileSucceed:i(378),templateTileSucceedMobile:i(379),smileyHappy:i(380),smileyHappyFill:i(381),smileySad:i(382),smileySadFill:i(383),statusError:i(384),statusInfo:i(385),statusProgress:i(386),statusSuccess:i(387),statusWarning:i(388),submitAsTemplate:i(389),supportIcon:i(390),templateNew:i(391),timerWhite:i(392),userPlaceholder:i(393),zeroApprovals:i(394),glyph:{arrow:"&#xE76C;",create:"&#xE710;",edit:"&#xE70F;",info:"&#xE946;",pause:"&#xE769;",play:"&#xE768;",trash:"&#xE74D;"}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(9),n=i(105),o=i(40),s=i(66),a=i(108),l=i(1),c=i(37);t.TelemetryEventNames=c.TelemetryEventNames,t.TelemetryScreenNames=c.TelemetryScreenNames,t.TelemetryEventStatus=c.TelemetryEventStatus,t.TelemetryAttributes=c.TelemetryAttributes;var u={authenticated:"Authenticated",unAuthenticated:"UnAuthenticated"},p=function(){function e(e,t,i){this.analyticsService=e,this.localyticsService=t,this.optimizelyService=i,this.trackExperimentViewedRetryMax=5,this.trackExperimentViewedRetryCount=0,this.localyticsService.setCustomDimension(n.CustomDimensions.sessionId,sessionInfo.sessionId),this.localyticsService.setCustomDimension(n.CustomDimensions.host,r.getAppSettings().siteOrigin),this.localyticsService.setCustomDimension(n.CustomDimensions.location,window.location.href),sessionInfo.isAuthenticated?(this.localyticsService.setCustomDimension(n.CustomDimensions.tenantId,sessionInfo.userInfo.tenantId),this.localyticsService.setCustomDimension(n.CustomDimensions.authenticationStatus,u.authenticated)):(this.localyticsService.setCustomDimension(n.CustomDimensions.tenantId,null),this.localyticsService.setCustomDimension(n.CustomDimensions.authenticationStatus,u.unAuthenticated)),this.trackExperimentViewed()}return e.prototype.trackExperimentViewed=function(){var e=this;if(this.optimizelyService.enabled)if(this.optimizelyService.ready){var t=this.optimizelyService.getExperimentViewedDetails();t.forEach(function(t){e.localyticsService.tagEvent("OptimizelyExperimentViewed",t)})}else this.trackExperimentViewedRetryCount<this.trackExperimentViewedRetryMax&&(this.trackExperimentViewedRetryCount++,setTimeout(function(){e.trackExperimentViewed()},1e3))},Object.defineProperty(e,"instance",{get:function(){return e.telemetryService.value},enumerable:!0,configurable:!0}),e.prototype.tagEvent=function(e,t,i){var r=l.getEnumValue(c.TelemetryEventNames,e);this.localyticsService.tagEvent(r,t),this.analyticsService.trackEvent(r,{attributes:t,data:i}),this.optimizelyService.track(r,$.extend({},i,t))},e.prototype.tagScreen=function(e){this.localyticsService.tagScreen(l.getEnumValue(c.TelemetryScreenNames,e)),this.analyticsService.trackEvent(l.getEnumValue(c.TelemetryEventNames,c.TelemetryEventNames.ScreenView),l.getEnumValue(c.TelemetryScreenNames,e))},e.prototype.flush=function(){this.analyticsService.flush()},e.telemetryService=new o.Lazy(function(){return new e(s.AnalyticsService.instance,n.LocalyticsService.instance,a.OptimizelyService.instance)}),e}();t.TelemetryService=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(t.SpinnerSize||(t.SpinnerSize={}));!function(e){e[e.NotSpecified=0]="NotSpecified",e[e.Global=1]="Global",e[e.Local=2]="Local",e[e.LocalHorizontal=3]="LocalHorizontal",e[e.LocalStatic=4]="LocalStatic"}(t.SpinnerPosition||(t.SpinnerPosition={})),t.SpinnerSizeCssClasses={small:"f-indeterminate-local f-progress-small",medium:"f-indeterminate-regional",large:"f-indeterminate-local f-progress-large"},t.SpinnerScopeCssClasses={global:"spinner-global",local:"spinner",localHorizontal:"spinner-local-horizontal",localStatic:""}},function(e,t,i){"use strict";function r(e,t){return e=(""+e).toUpperCase(),t=(""+t).toUpperCase(),e===t}Object.defineProperty(t,"__esModule",{value:!0}),t.equalsIgnoreCase=r},function(e,t,i){"use strict";function r(e){var t=window.appSettings=$.extend(!0,{},{activityFeedPath:"/providers/Microsoft.ProcessSimple/events",authClientId:"5e26e33b-bc1f-4838-b3a6-48a3492df6e8",authLoginBaseUrl:"https://login.microsoftonline.com/",authResource:"https://management.core.windows.net/",environmentCookieName:"environment",eulaConfirmCookieName:"eulaconfirmed",microsoftGraphResource:"https://graph.microsoft.com",azureResourceManagementUri:"https://management.azure.com",environment:"local",flowsConnectorPath:"/providers/Microsoft.PowerApps/apis/shared_logicflows",flowsPath:"/providers/Microsoft.ProcessSimple/flows",gatewaysPath:"/providers/Microsoft.PowerApps/gateways",logicFlowsRuntimeApiVersion:"2015-02-01-preview",microsoftGraphUrl:"https://graph.microsoft.com/v1.0",powerAppsButtonCategory:"PowerAppsButton",powerAppsConnectionProvidersPath:"/providers/Microsoft.PowerApps/apis",powerAppsConnectionsPath:"/providers/Microsoft.PowerApps/connections",powerAppsManagementUri:"https://management.azure.com/providers/Microsoft.PowerApps",powerAppsTemplateId:"05ed784f63df4ac7b8cbb465005d6068",processSimpleProviderName:"Microsoft.ProcessSimple",processSimpleResourceProviderApiVersionWithEnvironments:"2016-11-01-beta",siteOrigin:window.location.origin,setCategoryQueryString:"category",setEnvironmentQueryString:"environment",signUpEmailQueryString:"auth_upn",startPublishingTelemetry:!0,supportPageUrl:"https://go.microsoft.com/fwlink/?LinkID=787479",telemetryVersion:"2015-09-30-preview",tokenRefreshSkew:-600,userConsentPath:"/providers/Microsoft.ProcessSimple/consentUser",designer:{officeFabricModules:["Breadcrumb","Button","Calendar","Callout","Check","Checkbox","ChoiceGroup","Color","ColorPicker","ComboBox","CommandBar","common/BaseStore","common/connect","common/ConnectedHost","common/DirectionalHint","common/IAccessiblePopupProps","common/ISubscribable","common/StoreHost","common/storeKey","common/StoreSet","common/TestImages","common/tests","common/VisualTest","ContextualMenu","DatePicker","DetailsList","Dialog","DocumentCard","Dropdown","Fabric","Facepile","FocusTrapZone","FocusZone","Grid","GroupedList","HoverCard","Icon","Image","index","Label","Layer","Link","List","MarqueeSelection","MessageBar","Modal","Nav","OverflowSet","Overlay","Panel","Persona","Pickers","Pivot","Popup","ProgressIndicator","Rating","ResizeGroup","SearchBox","SelectableOption","Selection","Slider","SpinButton","Spinner","Styling","SwatchColorPicker","TeachingBubble","TextField","Toggle","Tooltip","Utilities","VisualTestRoot","VisualTestState"],versions:{default:"1.20821.1.10",next:"0.1.1.964",previous:"1.20807.1.13",diet:"1.20306.2.20",dev:"",latip1:""}}},window.appSettings,e);t.featureFlags.currentDesignerVersion=t.designer.versions[t.featureFlags.designer]}function n(){return window.appSettings}Object.defineProperty(t,"__esModule",{value:!0}),t.createAppSettings=r,t.getAppSettings=n;r(),function(){var e=n();if(e.isWidgetPage){var t=null!==window.location.href.match(".*/environments/([^/]*)/.*");e.featureFlags.enableEnvironments=t}}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.None=0]="None",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Progress=4]="Progress",e[e.Success=5]="Success"}(t.AlertType||(t.AlertType={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(16),n=i(69),o=i(1),s=i(5),a=i(10),l=function(){function e(){}return e.Description=".description",e.Item=".item",e.Schema=".schema",e.Summary=".summary",e.Name=".name",e.Type=".type",e.Path=".path",e.Title=".title",e.Default=".default",e.Required=".required",e.Actions=".actions",e.Triggers=".triggers",e.Parameters=".parameters",e.Definitions=".definitions",e.Responses=".responses",e.XMsSummary="["+r.Swagger.Summary+"]",e.XMsVisibility="["+r.Swagger.Visibility+"]",e.Operation=".operation",e.OperationId=e.Operation+".operationId",e.OperationDescription=""+e.Operation+e.Description,e.OperationParameters=""+e.Operation+e.Parameters,e.OperationResponses=""+e.Operation+e.Responses,e.OperationSummary=""+e.Operation+e.Summary,e}();t.Paths=l;var c=function(){function e(){}return e.clientResources=n.getClientResources(),e.Body=e.clientResources.Validate.CustomApi.DisplayNames.Body,e.OperationID=e.clientResources.Validate.CustomApi.DisplayNames.OperationId,e.Description=e.clientResources.Validate.CustomApi.DisplayNames.Description,e.URL=e.clientResources.Validate.CustomApi.DisplayNames.URL,e.Summary=e.clientResources.Validate.CustomApi.DisplayNames.Summary,e.Title=e.clientResources.Validate.CustomApi.DisplayNames.Title,e.Parameter=e.clientResources.Validate.CustomApi.DisplayNames.Parameter,e.Response=e.clientResources.Validate.CustomApi.DisplayNames.Response,e.BodyParameter=e.clientResources.Validate.CustomApi.DisplayNames.BodyParameter,e.Name=e.clientResources.Validate.CustomApi.DisplayNames.Name,e.Type=e.clientResources.Validate.CustomApi.DisplayNames.Type,e.Path=e.clientResources.Validate.CustomApi.DisplayNames.Path,e.Visibility=e.clientResources.Validate.CustomApi.DisplayNames.Visibility,e.Default=e.clientResources.Validate.CustomApi.DisplayNames.Default,e.Required=e.clientResources.Validate.CustomApi.DisplayNames.Required,e.Definition=e.clientResources.Validate.CustomApi.DisplayNames.Definition,e.ResponseDefinition=e.clientResources.Validate.CustomApi.DisplayNames.ResponseDefinition,e.ParameterDefinition=e.clientResources.Validate.CustomApi.DisplayNames.ParameterDefinition,e}();t.PathDisplayNames=c;var u;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Success=3]="Success",e[e.None=4]="None"}(u=t.ResultType||(t.ResultType={}));var p=function(){function e(e,t){this.swaggerItem=e,this.schemaPropertyItem=t}return Object.defineProperty(e.prototype,"fullSwaggerPath",{get:function(){return this.swaggerItem?""+this.swaggerItem.itemPath+(this.swaggerItem.propertyPath?this.swaggerItem.propertyPath:""):""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schemaProperty",{get:function(){return this.schemaPropertyItem?this.schemaPropertyItem.schemaProperty:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schemaPropertyKey",{get:function(){return this.schemaProperty?this.schemaProperty.key:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schemaPropertySubPath",{get:function(){return this.schemaPropertyItem&&this.schemaPropertyItem.subPath?this.schemaPropertyItem.subPath:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actionIndex",{get:function(){return this.getPathIndex(l.Actions)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"triggerIndex",{get:function(){return this.getPathIndex(l.Triggers)},enumerable:!0,configurable:!0}),e.prototype.getPathIndex=function(e){var t=this.fullSwaggerPath.indexOf(e);if(t<0)return-1;var i=this.fullSwaggerPath.substr(t+e.length).indexOf("[")+t+e.length;if(i<0)return-1;var r=this.fullSwaggerPath.substr(i).indexOf("]")+i;return r<0?-1:Number(this.fullSwaggerPath.substr(i+1,r-i-1))},e.prototype.getSwaggerPathDisplayName=function(e){return this.fullSwaggerPath===e.fullSwaggerPath?"":this.swaggerItem.propertyPath&&o.contains(e.fullSwaggerPath,this.swaggerItem.itemPath)?this.swaggerItem.propertyDisplayName||this.generateDisplayNameFromPath(this.swaggerItem.propertyPath):this.swaggerItem.itemDisplayName||this.generateDisplayNameFromPath(this.swaggerItem.itemPath)},e.prototype.getSchemaPropertyKeyDisplayName=function(e){return this.schemaProperty&&e.schemaPropertyKey!==this.schemaPropertyKey?this.schemaProperty.title||this.schemaProperty.name:""},Object.defineProperty(e.prototype,"schemaPropertySubPathDisplayName",{get:function(){return this.schemaPropertyItem&&this.schemaPropertyItem.subPathDisplayName?this.schemaPropertyItem.subPathDisplayName:this.generateDisplayNameFromPath(this.schemaPropertySubPath)},enumerable:!0,configurable:!0}),e.prototype.generateDisplayNameFromPath=function(e){return e.split(".").map(function(e){return o.capitalize(e)}).join(" ").trim()},e}();t.Violator=p;var d=(h={},h[u.Error]=s.default.statusError,h[u.Warning]=s.default.statusWarning,h[u.Info]=s.default.statusInfo,h[u.Success]=s.default.statusSuccess,h),g=function(){function e(e,t,i,r){this.ruleId=e,this.type=t,this.message=i,this.violator=r}return Object.defineProperty(e.prototype,"resultTypeImage",{get:function(){return d[this.type]},enumerable:!0,configurable:!0}),e}();t.ValidationResult=g;var m=function(){function e(e){this.ResultTypeToAlertType=(t={},t[u.Error]=a.AlertType.Error,t[u.Warning]=a.AlertType.Warning,t[u.Info]=a.AlertType.Info,t[u.Success]=a.AlertType.Success,t[u.None]=a.AlertType.Success,t.null=a.AlertType.None,t.undefined=a.AlertType.None,t),this.results=[],this.results=Array.isArray(e)?e:[];var t}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.results.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mostSevereResultType",{get:function(){var e=u.None;return this.results.forEach(function(t){t.type<e&&(e=t.type),u.Error}),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mostSevereResultTypeImage",{get:function(){return d[this.mostSevereResultType]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mostSevereAlertType",{get:function(){return this.ResultTypeToAlertType[this.mostSevereResultType]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorCount",{get:function(){return this.results.filter(function(e){return e.type===u.Error}).length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.results=[]},e.prototype.add=function(e){e&&(Array.isArray(e)?Array.isArray(e[0])?this.results=[].concat.apply(this.results,e):this.results=this.results.concat(e):Array.isArray(e.results)?this.results=this.results.concat(e.results):this.results.push(e))},e.prototype.filter=function(t){return new e(this.results.filter(function(e){return t(e)}))},e.prototype.filterOnViolator=function(t){return t?new e(this.results.filter(function(e){return e.violator&&o.startsWith(e.violator.fullSwaggerPath,t.fullSwaggerPath)&&(o.isEmpty(t.schemaPropertyKey)||e.violator.schemaPropertyKey===t.schemaPropertyKey)&&(o.isEmpty(t.schemaPropertySubPath)||e.violator.schemaPropertySubPath===t.schemaPropertySubPath)})):this},e}();t.ValidationResultCollection=m;var f=function(){function e(e){this.filter=e,this.resultCollection=new m}return e.prototype.updateFilteredResults=function(e){this.resultCollection=e.filterOnViolator(this.filter)},e}();t.FilteredResults=f;var h},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(9);angular.module(r.default.modules.processSimpleServices,[r.default.modules.ngRoute]).constant(r.default.services.appSettings,n.getAppSettings())},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(9);t.MediaConstants={resolutionLarge:960},t.MimeTypes={applicationJson:"application/json"},t.HeaderKeys={contentType:"Content-Type"},t.FlowNameMaxLength=255,t.PushNotificationConnectionReferenceKeyWord="shared_flowpush",t.WidgetType={flows:"flows",templates:"templates",logicAppsCustomApi:"LogicAppsCustomApi"},t.ScopeEmittedEvents={fullPageErrorCreateFromBlankClicked:"fullPageErrorCreateFromBlankClicked",fullPageErrorCreateFromTemplateClicked:"fullPageErrorCreateFromTemplateClicked"},t.AntiForgeryHeader="X-Csrf-Token",t.LocationParameterKeys={city:"location.address.city",countryOrRegion:"location.address.countryOrRegion",fullAddress:"location.fullAddress",latitude:"location.coordinates.latitude",longitude:"location.coordinates.longitude",postalCode:"location.address.postalCode",state:"location.address.state",street:"location.address.street"},t.ProcessSimpleResourceProviderManagementEndpoint=""+r.getAppSettings().processSimpleResourceProviderManagementEndpoint},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(106),n=i(107);t.ClientError=n.ClientError,t.isAbortedClientError=n.isAbortedClientError,t.ErrorCodes=r.default},function(e,t,i){"use strict";function r(e,t){return e&&e.length>0?e.map(function(e){return{name:e.name,source:t}}):[]}Object.defineProperty(t,"__esModule",{value:!0}),t.Swagger={DynamicSchema:"x-ms-dynamic-schema",DynamicValues:"x-ms-dynamic-values",NotificationContent:"x-ms-notification-content",NotificationUrl:"x-ms-notification-url",Permission:"x-ms-permission",Summary:"x-ms-summary",TestValue:"x-ms-test-value",Trigger:"x-ms-trigger",TriggerHint:"x-ms-trigger-hint",TriggerMetadata:"x-ms-trigger-metadata",TriggerValue:"x-ms-trigger-value",Visibility:"x-ms-visibility",NoGenericTest:"x-ms-no-generic-test"},t.TriggerMetadata={ValueCollection:"value-collection",ValuePath:"value-path"},t.Trigger={Single:"single",Batch:"batch"},t.Visibility={none:"none",advanced:"advanced",internal:"internal",important:"important"},t.DynamicValueFields={valueCollection:"value-collection",valuePath:"value-path",valueTitle:"value-title"},t.Permission={readOnly:"read-only"},t.OcpApimHeaderNames={Trace:"ocp-apim-trace",TraceLocation:"ocp-apim-trace-location",SubscriptionKey:"apihub-subscription-key"},t.DefaultName="default",t.ReferenceSources=["definitions","parameters","responses"],t.ReferenceSource={definitions:t.ReferenceSources[0],parameters:t.ReferenceSources[1],responses:t.ReferenceSources[2]},t.convertToReferences=r},function(e,t,i){"use strict";function r(e,t,i){return s(e,m.ResultType.Error,t,i)}function n(e,t,i){return s(e,m.ResultType.Warning,t,i)}function o(e,t,i){return s(e,m.ResultType.Info,t,i)}function s(e,t,i,r){return new m.ValidationResult(e.ruleId,t,i,r)}function a(e){return e&&e.operation?e.operation.operationId:""}function l(e,t){if(!e)return"";var i=e;if(v.isReference(e)&&(i=v.resolveParameter(e,t)),i.in===h.ParameterLocations.body)return m.PathDisplayNames.BodyParameter;var r=i[y.Swagger.Summary]||i.name;return f.format(m.PathDisplayNames.Parameter,i.in,r)}function c(e){return f.format(m.PathDisplayNames.Response,e.name)}function u(e,t,i){var r=new m.ValidationResultCollection,n=[];return e.operation&&Array.isArray(e.operation.parameters)&&e.operation.parameters.forEach(function(e){v.isReference(e)&&n.push(p(t,e.$ref))}),n.forEach(function(e){e&&r.add(i.filterOnViolator(e))}),r}function p(e,t){if(f.isNullOrUndefined(t))return null;var i=t.split("/");if(i&&i.length>2&&"#"===i[0]){var r=i[2];if("parameters"===i[1]){var n=e.parameters.map(function(e){return e.name}).indexOf(r);return n<0?null:new m.Violator({itemPath:m.Paths.Parameters+"["+n+"]"+m.Paths.Item})}if("definitions"===i[1]){var o=e.definitions.map(function(e){return e.name}).indexOf(r);return o<0?null:new m.Violator({itemPath:m.Paths.Definitions+"["+o+"]"+m.Paths.Item})}}return null}function d(e,t,i,r){var n=v.getParameterIndex(e,t.parameters,r.swagger),o=t.parameters[n];if(v.isReference(o)){var s=v.resolveParameter(o,r.swagger),a=v.getReferenceParameterIndex(r,{name:s.name,source:y.ReferenceSource.parameters},s);return m.Paths.Parameters+"["+a+"]"}return""+i.fullSwaggerPath+m.Paths.OperationParameters+"["+n+"]"}function g(e,t,i,r){var n=t.responses.map(function(e){return e.name}).indexOf(e.name),o=t.responses[n];if(v.isReference(o.item)){var s=v.getJsonReference(r.swagger,o.item.$ref),a=v.getReferenceResponseIndex(r,{name:name,source:y.ReferenceSource.responses},s);return m.Paths.Responses+"["+a+"]"}return""+i.fullSwaggerPath+m.Paths.OperationResponses+"["+n+"]"}Object.defineProperty(t,"__esModule",{value:!0});var m=i(11),f=i(1),h=i(27),v=i(24),y=i(16);t.constructError=r,t.constructWarning=n,t.constructInfo=o,t.getOperationDisplayName=a,t.getParameterDisplayName=l,t.getResponseDisplayName=c,t.getOperationReferencedResults=u,t.getReferencedViolator=p,t.getPathToParameter=d,t.getPathToResponse=g},function(e,t,i){"use strict";function r(e){var t=[];p.getAppSettings().widgetInfo&&p.getAppSettings().widgetInfo.flowsSettings&&p.getAppSettings().widgetInfo.flowsSettings.flowsFilter&&t.push(""+p.getAppSettings().widgetInfo.flowsSettings.flowsFilter);var i=p.getAppSettings().isWidgetPage,r=p.getAppSettings().featureFlags.enableWidgetTeamFlows;return e.isPersonal&&(!i||i&&r)&&t.push("search('personal')"),e.isShared&&(!i||i&&r)&&t.push("search('team')"),{$filter:t.join(" and "),$top:"50"}}function n(){return p.getAppSettings().featureFlags.enableEnvironments?p.getAppSettings().processSimpleResourceProviderPath+"/environments/"+d.getCurrentEnvironmentName()+"/flows":p.getAppSettings().processSimpleResourceProviderPath+"/flows"}function o(e){return p.getAppSettings().featureFlags.enableEnvironments?t.FlowsConstant.urlPathWithEnvironments+"/"+e:t.FlowsConstant.urlPath+"/"+e}function s(e){var t=e.id.toLowerCase().split("/"),i={};return i[t[1]]=t[2],i[t[3]]=t[4],i}function a(e){return!!(e&&201===e.status&&e.data&&e.data.name)}function l(e){return u.default.flowPlaceholder}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var c=i(0),u=i(5),p=i(9),d=i(20),g=i(14);t.getFlowsQueryParams=r,t.FlowsConstant={urlPath:p.getAppSettings().processSimpleResourceProviderPath+"/flows",urlPathWithEnvironments:p.getAppSettings().processSimpleResourceProviderPath+"/environments/"+d.getCurrentEnvironmentName()+"/flows",resourceType:p.getAppSettings().processSimpleResourceProviderPath+"/flows",expandParams:"swagger,properties.connectionreferences.apidefinition"},t.FlowPollFrequency={listFlows:42e4,getFlow:48e4,evictionDelay:3e5},t.getNewFlowId=n,t.getFlowId=o,t.parseFlowId=s,t.isFlowCreationSuccess=a,t.getFlowIcon=l,angular.module(c.default.modules.processSimpleData).factory(c.default.services.flowsClient,[c.default.services.appSettings,c.default.services.azureResourceClientFactory,c.default.services.environment,function(e,i,r){var n=e.featureFlags.enableEnvironments?t.FlowsConstant.urlPathWithEnvironments:t.FlowsConstant.urlPath;return i({urlBase:g.ProcessSimpleResourceProviderManagementEndpoint,urlPath:n,apiVersion:e.featureFlags.enableEnvironments?e.processSimpleResourceProviderApiVersionWithEnvironments:e.processSimpleResourceProviderApiVersion,resourceType:t.FlowsConstant.resourceType,rest:{query:{lazyPaging:!0},get:{params:{id:"@id",$expand:t.FlowsConstant.expandParams}},post:{params:{id:"@id"}},patch:{params:{id:"@id",$expand:t.FlowsConstant.expandParams}},delete:{params:{id:"@id",$expand:t.FlowsConstant.expandParams}}},actions:["start","stop","exportToARMTemplate"],options:{atomize:!1,queryPollInterval:t.FlowPollFrequency.listFlows,getPollInterval:t.FlowPollFrequency.getFlow,evictionDelay:t.FlowPollFrequency.evictionDelay}})}])},function(e,t,i){"use strict";function r(e){return e.properties&&ue.equalsIgnoreCase(e.properties.status,ce.Status.succeeded)}function n(e){return e.properties&&ue.equalsIgnoreCase(e.properties.status,ce.Status.skipped)}function o(e){return e.properties&&ue.equalsIgnoreCase(e.properties.status,ce.Status.failed)}function s(e){return e.properties&&ue.equalsIgnoreCase(e.properties.status,ce.Status.running)}function a(e){return"object"==typeof e&&e.hasOwnProperty("type")&&ue.equalsIgnoreCase(e.type,"Microsoft.ProcessSimple/flows/runs")}function l(e){return"object"==typeof e&&e.hasOwnProperty("type")&&ue.equalsIgnoreCase(e.type,"Microsoft.ProcessSimple/flows/triggers/histories")}function c(e,t){return u(e)?t.Flow.Commands.TurnOff:t.Flow.Commands.TurnOn}function u(e){return e.properties&&e.properties.state&&ue.equalsIgnoreCase(e.properties.state,ce.FlowState.started)}function p(e){return e.properties&&e.properties.state&&ue.equalsIgnoreCase(e.properties.state,ce.FlowState.suspended)}function d(e){return!!(e&&e.type&&e.kind&&ue.equalsIgnoreCase(e.type,ce.FlowTriggerType.request)&&ue.equalsIgnoreCase(e.kind,ce.FlowTriggerKind.APICONNECTION))}function g(e){return!!(e&&e.type&&ue.equalsIgnoreCase(e.kind,ce.FlowTriggerKind.BUTTON))}function m(e){return!!(e&&e.type&&ue.equalsIgnoreCase(e.type,ce.FlowTriggerType.recurrence))}function f(e){return!(!(e&&e.type&&e.kind&&ue.equalsIgnoreCase(e.type,ce.FlowTriggerType.request))||ue.equalsIgnoreCase(e.kind,ce.FlowTriggerKind.HTTP))}function h(e){return!(!m(e)&&!f(e))}function v(e){return!(!N(e)||!h(e.properties.definitionSummary.triggers[0]))}function y(e){return N(e)?e.properties.definitionSummary.triggers[0]:null}function w(e){return e&&e.properties&&e.properties.definition&&e.properties.definition.triggers?Object.keys(e.properties.definition.triggers)[0]:null}function C(e){return e?e.split("_").join(" "):null}function S(e){return e&&e.properties&&e.properties.userType||""}function b(e){return e&&e.properties&&e.properties.displayName||""}function P(e){return e&&e.name||""}function R(e){return T(e)?e.properties.connectionReferences:{}}function T(e){return!!(e&&e.properties&&e.properties.connectionReferences&&Object.keys(e.properties.connectionReferences).length>0)}function E(e){return!!(e&&e.source&&pe.equalsIgnoreCase(e.source,fe.ConnectionSource.Invoker))}function A(e){if(T(e)){var t=R(e);return Object.keys(t).some(function(e){return E(t[e])})}return!1}function D(e){var t={};if(A(e)){var i=R(e);Object.keys(i).forEach(function(e){E(i[e])&&(t[e]={api:i[e].apiDefinition})})}return t}function F(e){return!!e&&e.properties&&e.properties.installationStatus&&pe.equalsIgnoreCase(e.properties.installationStatus,ve.FlowInstallationStatus.installed)}function N(e){return!!(e&&e.properties&&e.properties.definitionSummary&&e.properties.definitionSummary.triggers&&1===e.properties.definitionSummary.triggers.length)}function I(e){return k(e)&&Object.keys(e.properties.triggerSchema.properties).filter(function(e){return K(e)}).length>0}function O(e){return k(e)&&Object.keys(e.properties.triggerSchema.properties).filter(function(e){return!K(e)}).length>0||j(e)}function k(e){return!!(N(e)&&f(e.properties.definitionSummary.triggers[0])&&e.properties.triggerSchema&&e.properties.triggerSchema.properties&&e.properties.triggerSchema.required&&e.properties.triggerSchema.required.length>0)}function M(e){return k(e)||j(e)}function x(e){return _(e)&&e.properties.triggerSchema.properties&&e.properties.triggerSchema.properties.rows&&e.properties.triggerSchema.properties.rows.items?e.properties.triggerSchema.properties.rows.items:e.properties.triggerSchema}function _(e){return N(e)&&d(e.properties.definitionSummary.triggers[0])}function U(e){return N(e)&&g(e.properties.definitionSummary.triggers[0])}function L(e){return U(e)||_(e)}function j(e){return!!(_(e)&&e.properties.triggerSchema&&e.properties.triggerSchema.properties&&e.properties.triggerSchema.properties.rows&&e.properties.triggerSchema.properties.rows.items&&e.properties.triggerSchema.properties.rows.items.required&&e.properties.triggerSchema.properties.rows.items.required.length>0)}function q(e){var t=e.properties&&e.properties.definition&&e.properties.definition.triggers&&e.properties.definition.triggers[w(e)];return!!(t&&t.recurrence&&t.recurrence.interval)}function B(e){return!!e&&!!e.properties&&!!e.properties.connectionReferences&&Object.keys(e.properties.connectionReferences).length>0}function V(e){return e&&Object.keys(e).filter(function(t){return e[t].api&&e[t].api.properties&&pe.equalsIgnoreCase(e[t].api.properties.tier,me.ApiTier.premium)}).length>0}function H(e){return e&&e.properties&&e.properties.connectionReferences&&W(e.properties.connectionReferences)}function W(e){return e&&Object.keys(e).filter(function(t){return e[t]&&e[t].apiDefinition&&e[t].apiDefinition.name&&pe.equalsIgnoreCase(ce.FlowConnectionKind.pushNotification,e[t].apiDefinition.name)}).length>0}function z(e){return e&&e.api&&pe.equalsIgnoreCase(e.api.tier,me.ApiTier.premium)}function G(e){return!!(e&&e.properties&&e.properties.sharingType)&&1===e.properties.sharingType.split(",").filter(function(e){return pe.equalsIgnoreCase(e.trim(),ve.FlowSharingTypes.coauthor)}).length}function K(e){return pe.equalsIgnoreCase(e,he.LocationParameterKeys.city)||pe.equalsIgnoreCase(e,he.LocationParameterKeys.countryOrRegion)||pe.equalsIgnoreCase(e,he.LocationParameterKeys.fullAddress)||pe.equalsIgnoreCase(e,he.LocationParameterKeys.latitude)||pe.equalsIgnoreCase(e,he.LocationParameterKeys.longitude)||pe.equalsIgnoreCase(e,he.LocationParameterKeys.postalCode)||pe.equalsIgnoreCase(e,he.LocationParameterKeys.state)||pe.equalsIgnoreCase(e,he.LocationParameterKeys.street)}function Q(e){return!!(e&&e.properties&&e.properties.userType&&pe.equalsIgnoreCase(e.properties.userType.trim(),ve.FlowUserTypes.user))}function J(e,t,i){if(void 0===i&&(i=!1),!(i||e&&0!==e.trim().length))throw new Error(t.Flow.Error.FlowNameRequired);if(e.trim().length>he.FlowNameMaxLength)throw new Error(de.format(t.Flow.Error.FlowNameMaxLength,he.FlowNameMaxLength))}function Y(e,t){var i=$.extend(!0,{},e);return Object.keys(i).forEach(function(e){var r=i[e],n="connection."+e,o=t[n];o&&(r.id=r.api.id,r.connectionName=o)}),i}function Z(e){return!!(e&&e.type&&pe.equalsIgnoreCase(e.type,ce.FlowTriggerExecutionType.check))}function X(e){return e&&e.status||null}function ee(e,t){var i=e.objectId;return{id:i,title:e.displayName,subTitle:e.mail,iconUrl:t.hasOwnProperty(i)?t[i]:""}}function te(e){var t=[];return e.map(function(e){var i={name:e.id,properties:{principal:{id:e.id,type:e.type}}};t.push(i)}),t}function ie(e){return e&&e.mobileRegistrationTime}function re(e,t){var i=R(e);return Object.keys(i).some(function(e){return ne(i[e],t)})}function ne(e,t){var i={};(t||[]).forEach(function(e){e.name&&e.properties&&e.properties.apiId&&(i[e.name.toLowerCase()]=e.properties.apiId)});var r=oe(e);if(r&&e.connectionName){var n=e.connectionName.toLowerCase();return!i[n]||!ue.equalsIgnoreCase(i[n],r)}return!0}function oe(e){return e&&(e.id||e.apiDefinition&&e.apiDefinition.id)||null}function se(e,t){var i={},r=R(e);return Object.keys(r).forEach(function(e){ne(r[e],t)&&(i[e]={api:r[e].apiDefinition})}),i}function ae(e,t){var i=ge.getConnectionReferencesOfFlowFormat(R(t));return e=ge.getConnectionReferencesOfFlowFormat(e),Object.keys(e).forEach(function(t){i[t]=e[t]}),i}function le(e,t){t=t||"";var i=t.split("/"),r=e.powerAppsResourceProviderPath.split("/")[2];return 7===i.length&&""===i[0]&&pe.equalsIgnoreCase(i[1],"providers")&&pe.equalsIgnoreCase(i[2],r)&&pe.equalsIgnoreCase(i[3],"apis")&&pe.equalsIgnoreCase(i[5],"apiOperations")?{resourceProvider:i[2],type:i[5],apiId:"/providers/"+r+"/apis/"+i[4],apiName:i[4],operationId:t,operationName:i[6]}:null}Object.defineProperty(t,"__esModule",{value:!0});var ce=i(23),ue=i(8),pe=i(8),de=i(1),ge=i(71),me=i(115),fe=i(177),he=i(14),ve=i(502);t.isSuccessful=r,t.isSkipped=n,t.hasFailed=o,t.isRunning=s,t.isFlowRun=a,t.isFlowTriggerHistory=l,t.getFlowStateCommandText=c,t.isStarted=u,t.isDisabled=p,t.isApiConnectionTrigger=d,t.isButtonTrigger=g,t.isRecurrenceTrigger=m,t.isManualTrigger=f,t.isRunnableTrigger=h,t.isRunnableFlow=v,t.getTrigger=y,t.getTrigggerName=w,t.getTrigggerDisplayName=C,t.getFlowUserType=S,t.getFlowDisplayName=b,t.getFlowName=P,t.getFlowConnectionReferences=R,t.containsConnectionReferences=T,t.hasInvokerConnection=E,t.containsInvokerConnectionReferences=A,t.getInvokerConnectionReferences=D,t.isFlowInstalled=F,t.containsTrigger=N,t.containsLocationParametersInSchema=I,t.containsTriggerWithAdditionalInputsThatAreNotLocationParameters=O,t.containsManualTriggerWithAdditionalInputs=k,t.containsTriggerWithAdditionalInputs=M,t.getUserInputParameterSchema=x,t.containsRequestApiConnectionTrigger=_,t.containsManualTriggerWithButtonKind=U,t.isRunOnlyManagementSupported=L,t.containsRequestApiConnectionTriggerWithAdditionalInputs=j,t.containsTriggerWithRecurrence=q,t.requiresConnections=B,t.hasPremiumConnection=V,t.containsConnectionWithNotification=H,t.hasNotificationConnection=W,t.isPremiumConnection=z,t.isCoauthoredFlow=G,t.isLocationParameterKey=K,t.isUserTypeFlow=Q,t.validateFlowDisplayName=J,t.getMergedConnectionReferencesFromRouteParams=Y,t.isFlowCheck=Z,t.getRunStatus=X,t.convertGraphModelToCardModel=ee,t.convertCardsToAddFlowRolesModel=te,t.userInstalledMobileApp=ie,t.isAnyFlowConnectionNotInGivenConnections=re,t.isFlowConnectionNotInGivenConnections=ne,t.getApiIdFromConnectionReference=oe,t.getFlowConnectionReferencesNotUsingGivenConnections=se,t.getUpdatedFlowConnectionReferences=ae,t.parseOperationId=le},function(e,t,i){"use strict";function r(e,t,i){return t&&(e.$filter?e.$filter="environment eq '"+i+"' and "+e.$filter:e=$.extend(e,{$filter:"environment eq '"+i+"'"})),e}function n(e,t,i){if(t){e=e||{properties:{}},e.properties=e.properties||{};var r={environment:{name:i}};e.properties=$.extend(e.properties,r)}return e}function o(){var e="";if(s.getAppSettings().isWidgetPage){var t=window.location.href.match(".*/environments/([^/]*)/.*");Array.isArray(t)&&(e=t[1])}else{var i=window.sessionInfo.environment;i&&i.name&&(e=i.name)}return e}Object.defineProperty(t,"__esModule",{value:!0}),i(12);var s=i(9),a=i(54),l=i(4),c=i(143),u=i(32),p=i(41),d=i(8),g=i(3),m=i(0);t.EnvironmentSku={NotSpecified:"NotSpecified",Standard:"Standard",Premium:"Premium",Developer:"Developer"},t.extendQueryParamsWithEnvironment=r,t.extendPropsWithEnvironment=n,t.getCurrentEnvironmentName=o;var f=function(){function e(e,t,i,r,n,o,s,c){var u=this;this.$interval=e,this.$window=t,this.appSettings=i,this.environmentsClient=r,this.loggingService=n,this.sessionService=o,this.storageService=s,this.urlService=c,this.environments={data:[]},this.environmentsStorageKey="environments",this.fetchEnvironments=function(){u.environmentsClient.getEnvironments().then(function(e){if(e&&e.data&&e.data.value){var t=u.getCurrentEnvironmentName(),i=e.data.value,r={data:i,lastUpdated:(new Date).getTime(),userId:u.sessionService.getUserSession().userInfo.uniqueId};u.environments.data=i,u.storageService.saveItem(u.environmentsStorageKey,JSON.stringify(r),a.StorageType.LocalStorage),t&&i.length>0&&!i.some(function(e){return d.equalsIgnoreCase(e.name,t)})&&u.loggingService.logWarning("EnvironmentService.fetchEnvironments","environment list and set environment differ. redirecting to ~/",{environments:i,environmentName:u.getCurrentEnvironmentName()})}}).catch(function(e){g.inferErrorStatus(e)===g.Status.Abort?u.loggingService.logWarning(l.ProfilingEventNames.environmentsFetchFailed,g.parseErrorMessage(e),e):u.loggingService.logError(l.ProfilingEventNames.environmentsFetchFailed,e)})}}return e.prototype.getCurrentEnvironmentName=function(){return o()},e.prototype.getCurrentEnvironmentDisplayName=function(){return this.getCurrentEnvironment().displayName},Object.defineProperty(e.prototype,"isDefaultOrLegacyEnvironment",{get:function(){return this.isDefaultEnvironment||this.isLegacyEnvironment},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDefaultEnvironment",{get:function(){return this.getCurrentEnvironment().isDefault},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLegacyEnvironment",{get:function(){var e=this.getCurrentEnvironmentName();return p.startsWithIgnoreCase(e,"legacy")},enumerable:!0,configurable:!0}),e.prototype.getUserEnvironments=function(){return this.environments},e.prototype.isDevEnvironment=function(){return this.getEnvironmentSku()===t.EnvironmentSku.Developer},e.prototype.getEnvironmentSku=function(){var e=this.getCurrentEnvironment();return e&&e.sku?e.sku:t.EnvironmentSku.NotSpecified},e.prototype.getCurrentEnvironment=function(){return this.sessionService.getUserSession().environment},e.prototype.setCurrentEnvironment=function(e){this.sessionService.getUserSession().environment={name:e.name,displayName:e.properties.displayName,isDefault:e.properties.isDefault,sku:e.properties.environmentSku}},e.prototype.syncEnvironments=function(){var e,t=this.storageService.getItem("environments",a.StorageType.LocalStorage);if(t)try{e=JSON.parse(t)}catch(e){this.loggingService.logError(l.ProfilingEventNames.environmentsStorageInvalid,e)}if(e&&e.data&&e.data.length&&e.userId===this.sessionService.getUserSession().userInfo.uniqueId){this.environments.data=e.data;var i=(new Date).getTime();e.lastUpdated&&i-e.lastUpdated<3e5?this.$interval(this.fetchEnvironments,3e5,1):this.fetchEnvironments()}else this.fetchEnvironments()},e.prototype.setEnvironment=function(e){var t,i=this.$window.location.href,r=i.match(/(.+)\/environments\/([^\/]*)\/([^\/]*)/);if([this.urlService.customApisRoute()].filter(function(e){return Array.isArray(i.match(e))}).length>0&&Array.isArray(r)){var n=r[2];return void(this.$window.location.href=i.replace(n,e.name))}if(Array.isArray(r)){var o=r[1],s=r[3];t=o+"/environments/"+e.name+"/"+s}else{var a=u.parseUri(i);a.parameters[this.appSettings.setEnvironmentQueryString]=e.name,t=c.composeUri(a.protocol,a.host,a.path,u.createQueryString(a.parameters))}this.$window.location.href=t},e.$inject=[m.default.services.$interval,m.default.services.$window,m.default.services.appSettings,m.default.services.environmentsClient,m.default.services.logging,m.default.services.session,m.default.services.storage,m.default.services.url],e}();t.EnvironmentService=f,angular.module(m.default.modules.processSimpleServices).service(m.default.services.environment,f)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);angular.module(r.default.modules.processSimpleData,[r.default.modules.ngResource,r.default.modules.powerUx])},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Status={failed:"Failed",running:"Running",skipped:"Skipped",succeeded:"Succeeded"},t.FlowState={started:"started",stopped:"stopped",suspended:"suspended"},t.FlowTriggerType={recurrence:"recurrence",request:"request",manual:"manual",apiconnection:"apiconnection"},t.FlowTriggerName={httpRequestTrigger:"request",manual:"manual",recurrence:"recurrence"},t.FlowTriggerKind={BUTTON:"Button",HTTP:"Http",POWERAPP:"PowerApp",APICONNECTION:"ApiConnection"},t.FlowConnectionKind={pushNotification:"shared_flowpush"},t.SCHEMA={GA_PREVIEW_20150801:{URL:"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2015-08-01-preview/workflowdefinition.json#",VERSION:"2015-08-01-preview"},GA_PREVIEW_20160401:{URL:"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-04-01-preview/workflowdefinition.json#",VERSION:"2016-04-01-preview"},GA_20160601:{URL:"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",VERSION:"2016-06-01"}},t.FlowTransformData={Flow:{isPartialProperty:"x-ms-powerflows-param-ispartial"},Designer:{isPartialProperty:"isPartial"}},t.FlowTriggerExecutionType={run:"Microsoft.ProcessSimple/environments/flows/runs",check:"Microsoft.ProcessSimple/environments/flows/triggers/histories"},t.isShared="isShared",t.populateRunOnlyUser="populateRunOnlyUser",t.FlowType={personal:"personal",shared:"shared"},t.WidgetHostAction={GETACCESSTOKEN:"GET_ACCESS_TOKEN",ONADDCONNECTIONCLICKED:"ON_ADD_CONNECTION_CLICKED",ONDELETECUSTOMAPICLICKED:"ON_DELETE_CUSTOMAPI_CLICKED",RUNFLOWCANCELBUTTONCLICKED:"RUN_FLOW_CANCEL_BUTTON_CLICKED",RUNFLOWDONEBUTTONCLICKED:"RUN_FLOW_DONE_BUTTON_CLICKED",RUNFLOWSTARTED:"RUN_FLOW_STARTED",RUNFLOWCOMPLETED:"RUN_FLOW_COMPLETED",WIDGETREADY:"WIDGET_READY",WIDGETRENDERED:"WIDGET_RENDERED"},t.WidgetNotifyActions={TriggerFlow:"triggerflow",TriggerFlowByTemplate:"triggerflowbytemplate",GetTriggerSchema:"gettriggerschema",RefereshConnections:"refreshconnections",RefreshApis:"refreshapis"}},function(e,t,i){"use strict";function r(e){if(e.securityDefinitions)for(var t in e.securityDefinitions)if(e.securityDefinitions.hasOwnProperty(t)&&e.securityDefinitions[t].type)return e.securityDefinitions[t].type;return"none"}function n(e,t){return Array.isArray(e)?e.map(function(e){return l(e,t)}):[]}function o(e,t){var i=n(e,t);return i.forEach(function(e){e.schema&&(e.schema=k.resolveSchema(t,e.schema).schema)}),i}function s(e){if(U.isNullOrUndefined(e)||x.hasOwnNestedProperty(e,"$ref"))return[];var t={excludeAdvanced:!1,excludeInternal:!1},i=new j.BodyParameterProcessor(e,t).getParameters(),r=i.filter(function(e){return e.type===O.Types.array});return r.length>0&&(r.forEach(function(e){var t=a(e);i=i.concat(t)}),i=i.filter(function(e){return e.type!==O.Types.array})),i}function a(e){if(U.isNullOrUndefined(e)||e.type!==O.Types.array)return[];var t={in:O.ParameterLocations.body,schema:e.itemSchema},i={excludeAdvanced:!1,excludeInternal:!1},r=new j.BodyParameterProcessor(t,i).getParameters(),n=r.map(function(e){return e});return n.forEach(function(t){t.isInsideArray=!0,t.parentArray=e.key}),n}function l(e,t){if(u(e)){var i=e.$ref,r=c(t,i);return r?r.item:null}return e}function c(e,t){if(U.isNullOrUndefined(t))return null;var i=e,r=t.split("/");return!r||r.length<=1||"#"!==r[0]?null:(r.slice(1).forEach(function(e){i=Array.isArray(i)?i.filter(function(t){return t.name===e})[0]:i[e]}),i||null)}function u(e){return e&&!U.isNullOrUndefined(e.$ref)}function p(e,t,i){return n(t,i).map(function(e){return e.name+e.in}).indexOf(e.name+e.in)}function d(e,t,i){var r=e.swagger.responses.map(function(e){return e.name}).indexOf(i.name);return h(t.source,r,e)?r:-1}function g(e,t,i){var r=e.swagger.parameters.map(function(e){return e.item}).indexOf(i);return h(t.source,r,e)?r:-1}function m(e,t){return w(t)&&!U.isNullOrUndefined(e)&&e>=0&&e<t.swagger.actions.length}function f(e,t){return C(t)&&!U.isNullOrUndefined(e)&&e>=0&&e<t.swagger.triggers.length}function h(e,t,i){return i&&i.swagger&&i.swagger[e]&&i.swagger[e].length>0&&t>=0&&t<i.swagger[e].length}function v(e,t){return t.operation.parameters&&t.operation.parameters.length>0&&e>=0&&e<t.operation.parameters.length}function y(e,t){return t.operation.responses&&t.operation.responses.length>0&&e>=0&&e<t.operation.responses.length}function w(e){return e&&e.swagger&&e.swagger.actions&&e.swagger.actions.length>0}function C(e){return e&&e.swagger&&e.swagger.triggers&&e.swagger.triggers.length>0}function S(e,t,i,r,n,o,s){if(U.isEmpty(e)||U.isNullOrUndefined(t))return o.validatationError=new $.ClientError($.ErrorCodes.customApiImportFromSampleError,s.Manage.CustomApi.RightPane.Definition.ImportFromSampleRequest.Error,null),!1;n.method=t.method;var a=decodeURI(L.parseUri(e).path),l=o.swagger.basePath;return U.isEmpty(l)||0!==a.indexOf(l)||(a=a.substr(l.length)),0!==a.indexOf("/")&&(a="/"+a),n.path=a,n.operation.parameters=M.getParameters(e,a,i,r),!0}function b(e,t,i,r,n){var o=k.generateSchemaFromJson(t);if(U.isNullOrUndefined(o))return r.validatationError=new $.ClientError($.ErrorCodes.customApiImportFromSampleError,n.Manage.CustomApi.RightPane.Definition.ImportFromSampleResponse.Error,null),!1;var s=M.getHeadersForResponse(e);return i.operation[I.Swagger.NotificationContent].schema=o,U.isEmpty(s)||(i.operation[I.Swagger.NotificationContent].headers=s),!0}function P(e,t,i,r,n){var o=k.generateSchemaFromJson(t);if(U.isNullOrUndefined(o))return r.validatationError=new $.ClientError($.ErrorCodes.customApiImportFromSampleError,n.Manage.CustomApi.RightPane.Definition.ImportFromSampleResponse.Error,null),!1;var s={description:I.DefaultName,schema:o},a=M.getHeadersForResponse(e);U.isEmpty(a)||(s.headers=a);var l=i.operation.responses.filter(function(e){return e.name===I.DefaultName})[0];return U.isNullOrUndefined(l)?i.operation.responses.push({name:I.DefaultName,item:s}):l.item=s,!0}function R(){return{method:"get",operation:{responses:[{name:I.DefaultName,item:{description:I.DefaultName,schema:{type:O.Types.string}}}]},path:""}}function T(){return{method:"get",operation:{responses:[]},path:""}}function E(e,t){return e.actions.concat(e.triggers).filter(function(e){return!!Array.isArray(e.operation.parameters)&&e.operation.parameters.some(function(e){return e.$ref==="#/parameters/"+t})})}function A(e,t){var i=null;return e&&e.paths&&Object.keys(e.paths).forEach(function(r){var n=e.paths[r];Object.keys(n||{}).forEach(function(e){var r=n[e];r&&B.equalsIgnoreCase(r.operationId,t)&&(i=r)})}),i}function D(e,t){for(var i=N(e,t),r=[];i.definitionNames.length>0;)!function(){var t={referencingItems:[],definitionNames:[]};i.definitionNames.forEach(function(i){t=F(t,N(e,i)),r.push(i)}),i=F(i,t),r.forEach(function(e){var t=i.definitionNames.indexOf(e);t>=0&&i.definitionNames.splice(t,1)})}();return i.referencingItems}function F(e,t){var i=e.referencingItems.concat(t.referencingItems),r=e.definitionNames.concat(t.definitionNames),n={};return i.forEach(function(e){var t=""+e.operationItem.method+e.operationItem.path;n[t]||(n[t]=e)}),{referencingItems:Object.keys(n).map(function(e){return n[e]}),definitionNames:x.getArrayWithNoDuplicates(r)}}function N(e,i){var r={referencingItems:[],definitionNames:[]},n="#/definitions/"+i;return e.actions.concat(e.triggers).forEach(function(e){return Array.isArray(e.operation.parameters)&&e.operation.parameters.some(function(e){return Object.keys(_.getAllReferences(e)).indexOf(n)>=0})?void r.referencingItems.push({operationItem:e,referenceType:t.parameterType}):Array.isArray(e.operation.responses)&&e.operation.responses.some(function(e){return Object.keys(_.getAllReferences(e.item)).indexOf(n)>=0})?void r.referencingItems.push({operationItem:e,referenceType:t.responseType}):void 0}),Array.isArray(e.definitions)&&(r.definitionNames=e.definitions.filter(function(e){return Object.keys(_.getAllReferences(e)).indexOf(n)>=0}).map(function(e){return e.name})),r}Object.defineProperty(t,"__esModule",{value:!0});var I=i(16),O=i(27),k=i(34),M=i(61),x=i(1),_=i(94),U=i(1),$=i(15),L=i(32),j=i(560),q=i(62),B=i(8);t.BaseSwagger={swagger:"2.0",info:{title:"Default title",description:"",version:"1.0"},host:"",basePath:"/",schemes:[],consumes:[],produces:[],paths:{},definitions:{},parameters:{},responses:{},securityDefinitions:{},security:[],tags:[]},t.DeserializedBaseSwagger=q.deserialize(t.BaseSwagger),t.ApiAuthenticationType={Basic:"basic",Oauth2:"oauth2",ApiKey:"apiKey",None:"none"},t.getAuthenticationTypeFromSwagger=r,t.getParametersWithResolvedReferences=n,t.getParametersWithFullyResolvedReferences=o,t.convertBodyParameterToInputParameters=s,t.getSchemaPropertiesFromArrayParameter=a,t.resolveParameter=l,t.getJsonReference=c,t.isReference=u,t.getParameterIndex=p,t.getReferenceResponseIndex=d,t.getReferenceParameterIndex=g,t.isActionIndexValid=m,t.isTriggerIndexValid=f,t.isReferenceIndexValid=h,t.isInlineParameterIndexValid=v,t.isInlineResponseIndexValid=y,t.updateActionRequest=S,t.updateWebhookResponse=b,t.updateActionResponse=P,t.getNewAction=R,t.getNewTrigger=T,t.getOperationsWithParameterReference=E,t.getOperationFromSwagger=A,t.parameterType="parameter",t.responseType="response",t.getReferencingItemsOfDefinition=D,t.combineReferencingEntities=F,t.getReferencingEntities=N},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);angular.module(r.default.modules.processSimpleDirectives,[r.default.modules.ngAria])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(69),n=i(1),o=function(){function e(){this.clientResources=r.getClientResources()}return Object.defineProperty(e.prototype,"ruleId",{get:function(){return n.extractFuncName(this.constructor.toString())},enumerable:!0,configurable:!0}),e.prototype.setSwaggerUsedForValidation=function(e){this.swagger=e},e.prototype.validateOperation=function(e,t){return[]},e.prototype.validateResolvedSchema=function(e,t){return[]},e.prototype.validateNonBodyParameter=function(e,t){return[]},e.prototype.validateJsonReference=function(e,t){return[]},e.prototype.validateUnresolvedSchema=function(e,t){return[]},e.prototype.validateSchemaProperty=function(e,t){return[]},e.prototype.validateDefinitionItem=function(e,t){return[]},e.prototype.validateResponseDefinitionItem=function(e,t){return[]},e.prototype.validateParameterDefinitionItem=function(e,t){return[]},e.prototype.validateInlineResponseDefinitionItem=function(e,t){return[]},e}();t.BaseRule=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Methods={get:"get",delete:"delete",post:"post",put:"put",head:"head",options:"options",patch:"patch"},t.Types={object:"object",any:"any",integer:"integer",number:"number",string:"string",array:"array",boolean:"boolean",null:"null",file:"file"},t.ParameterLocations={host:"host",path:"path",query:"query",header:"header",body:"body"}},function(e,t,i){"use strict";function r(e){return t.ApisConstant.urlPath+"/"+e}function n(e){var t=b.stripTrailingSlashes(S.stripLeadingSlashes(e||"")).split("/"),i=b.stripTrailingSlashes(S.stripLeadingSlashes(P.getAppSettings().powerAppsConnectionProvidersPath)).split("/");return 4===t.length&&w.equalsIgnoreCase(t[0],i[0])&&w.equalsIgnoreCase(t[1],i[1])&&w.equalsIgnoreCase(t[2],i[2])?t[3]:""}function o(e){return e&&e.properties&&e.properties.apiDefinitions&&e.properties.apiDefinitions.originalSwaggerUrl}function s(e){return!!e.properties.connectionParameters&&Object.keys(e.properties.connectionParameters).some(function(t){return w.equalsIgnoreCase(e.properties.connectionParameters[t].type,"oauthSetting")})}function a(e){return e.properties.capabilities&&e.properties.capabilities.indexOf("composite")>-1}function l(e){return e&&e.properties&&e.properties.metadata&&e.properties.metadata.source&&w.equalsIgnoreCase(e.properties.metadata.source,t.CustomApiType)}function c(e){return!s(e)&&!a(e)&&Object.keys(e.properties.connectionParameters).length>0}function u(e){return e.properties.displayName||e.name}function p(e){return e.properties.iconUri||C.default.defaultConnection}function d(e){return e.properties.iconBrandColor}function g(e,t){return e.properties.createdBy&&e.properties.createdBy.displayName?e.properties.createdBy.displayName:t.Manage.Connections.Publisher.Microsoft}function m(e){return e.properties.connectionParameters||{}}function f(e){return e&&e.properties&&e.properties.capabilities&&e.properties.capabilities.some(function(e){return w.equalsIgnoreCase(e,y.ApiCapabilities.gateway)})}function h(e){if(e&&e.properties&&e.properties.connectionParameters)for(var t=Object.keys(e.properties.connectionParameters),i=0;i<t.length;i++){var r=t[i],n=e.properties.connectionParameters[r].type;if(n&&w.equalsIgnoreCase(n,"gatewaySetting"))return r}return null}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var v=i(0),y=i(115),w=i(8),C=i(5),S=i(103),b=i(104),P=i(9);t.SettingGroups={connectors:"connectors"},t.CustomApiType="powerapps-user-defined",t.ApiPollFrequency={listApis:6e4,getApi:45e3,evictionDelay:3e5},t.ApisConstant={urlPath:P.getAppSettings().powerAppsResourceProviderPath+"/apis",resourceType:P.getAppSettings().powerAppsResourceProviderPath+"/apis"},t.getApiId=r,t.getApiNameFromId=n,t.getOriginalSwaggerUrl=o,t.isApiOauth=s,t.isApiComposite=a,t.isApiCustom=l,t.isApiConfigurable=c,t.getDisplayName=u,t.getIconUri=p,t.getIconBrandColor=d,t.getPublisher=g,t.getConnectionParameters=m,t.isApiGatewayCompatible=f,t.getGatewayParameterName=h,angular.module(v.default.modules.processSimpleData).factory(v.default.services.apisClient,[v.default.services.appSettings,v.default.services.azureResourceClientFactory,v.default.services.environment,function(e,i,r){var n=function(e){return-1===e.url.indexOf("environment eq")&&(e.url+="&$filter=environment eq '"+r.getCurrentEnvironmentName()+"'"),e};return i({urlBase:e.powerAppsResourceProviderEndpoint,urlPath:t.ApisConstant.urlPath,apiVersion:e.featureFlags.enableEnvironments?e.powerAppsResourceProviderApiVersionWithEnvironments:e.powerAppsResourceProviderApiVersion,resourceType:t.ApisConstant.resourceType,rest:{get:{params:{id:"@id",$expand:"swagger"},requestInterceptor:n},post:{params:{id:"@id"},requestInterceptor:n},put:{params:{id:"@id"},requestInterceptor:n},patch:{params:{id:"@id"},requestInterceptor:n},delete:{params:{id:"@id"},requestInterceptor:n},query:{responseInterceptor:function(e){return e.data&&e.data.filter(function(e){return!a(e)})},requestInterceptor:n}},actions:[{name:"validateApiSwaggerToWadl",urlPath:"/providers/Microsoft.PowerApps/objectIds/:objectId/validateApiSwaggerToWadl",method:"POST"},{name:"setUserSettings",urlPath:"/providers/Microsoft.PowerApps/objectIds/:objectId/userSettings/:settingGroup",method:"PUT"},{name:"getUserSettings",urlPath:"/providers/Microsoft.PowerApps/objectIds/:objectId/userSettings/:settingGroup",method:"GET"}],options:{atomize:!1,queryPollInterval:t.ApiPollFrequency.listApis,getPollInterval:t.ApiPollFrequency.getApi,evictionDelay:t.ApiPollFrequency.evictionDelay}})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfilingEventNames={NAVIGATION_PERFORMANCE:"NAVIGATION_PERFORMANCE",asyncPollStart:"AsyncPollStart",asyncPollEnd:"AsyncPollEnd",activityFeedLoadEnd:"ActivityFeedLoadEnd",activityFeedLoadMoreEnd:"ActivityFeedLoadMoreEnd",activityFeedLoadMoreStart:"ActivityFeedLoadMoreStart",activityFeedLoadStart:"ActivityFeedLoadStart",addFlowOwnerEnd:"AddFlowOwnerEnd",addFlowOwnerStart:"AddFlowOwnerStart",approvalsReceivedTabStart:"ApprovalsReceivedTabStart",approvalsReceivedTabEnd:"ApprovalsReceivedTabEnd",approvalsSentTabStart:"ApprovalsSentTabStart",approvalsSentTabEnd:"ApprovalsSentTabEnd",createTrialStart:"CreateTrialStart",createTrialEnd:"CreateTrialEnd",deleteConnectionEnd:"DeleteConnectionEnd",deleteConnectionStart:"DeleteConnectionStart",deleteFlowEnd:"DeleteFlowEnd",deleteFlowOwnerEnd:"DeleteFlowOwnerEnd",deleteFlowOwnerStart:"DeleteFlowOwnerStart",deleteFlowStart:"DeleteFlowStart",designerScriptLoadEnd:"DesignerScriptLoadEnd",designerScriptLoadStart:"DesignerScriptLoadStart",embedDefaultEnvironmentRetrievalFailed:"EmbedDefaultEnvironmentRetrievalFailed",embedSessionInfoRetrievalFailed:"EmbedSessionInfoRetrievalFailed",environmentCookieInvalid:"EnvironmentCookieInvalid",environmentsFetchFailed:"EnvironmentsFetchFailed",environmentsStorageInvalid:"EnvironmentStorageInvalid",expandConnectionWizardEnd:"ExpandConnectionWizardEnd",expandConnectionWizardStart:"ExpandConnectionWizardStart",exportFlowPageLoadStart:"ExportFlowPageLoadStart",exportFlowPageLoadEnd:"ExportFlowPageLoadEnd",extendTrialStart:"ExtendTrialStart",extendTrialEnd:"ExtendTrialEnd",flowLoadEnd:"FlowLoadEnd",flowLoadStart:"FlowLoadStart",flowConnectionsLoadEnd:"FlowConnectionsLoadEnd",flowConnectionsLoadStart:"FlowConnectionsLoadStart",flowConnectionsPageLoadStart:"FlowConnectionsPageLoadStart",flowConnectionsPageLoadEnd:"FlowConnectionsPageLoadEnd",flowOwnersLoadEnd:"FlowOwnersLoadEnd",flowOwnersLoadStart:"FlowOwnersLoadStart",flowRunLoadEnd:"FlowRunLoadEnd",flowRunLoadStart:"FlowRunLoadStart",flowRunOnlyLoadEnd:"FlowRunOnlyLoadEnd",flowRunOnlyLoadStart:"FlowRunOnlyLoadStart",flowRunsHistoryLoadEnd:"FlowRunsHistoryLoadEnd",flowRunsHistoryLoadStart:"FlowRunsHistoryLoadStart",flowPopularTriggersStart:"FlowPopularTriggersStart",flowPopularTriggersEnd:"FlowPopularTriggersEnd",getObjectsByObjectIdsEnd:"GetObjectsByObjectIdsEnd",getObjectsByObjectIdsStart:"GetObjectsByObjectIdsStart",getGraphDetailsStart:"getGraphDetailsStart",getGraphDetailsEnd:"getGraphDetailsEnd",graphServiceGetThumbnailsEnd:"GraphServiceGetThumbnailsEnd",graphServiceGetThumbnailsStart:"GraphServiceGetThumbnailsStart",importFlowPageLoadStart:"ImportFlowPageLoadStart",importFlowPageLoadEnd:"ImportFlowPageLoadEnd",myConnectionsLoadEnd:"MyConnectionsLoadEnd",myConnectionsLoadStart:"MyConnectionsLoadStart",myCustomApiCreateEnd:"MyCustomApiCreateEnd",myCustomApiCreateStart:"MyCustomApiCreateStart",myCustomApiDownloadEnd:"CustomApiDownloadEnd",myCustomApiDownloadStart:"CustomApiDownloadStart",myCustomApiGetIdentityProvidersEnd:"MyCustomApiGetIdentityProvidersEnd",myCustomApiGetIdentityProvidersStart:"MyCustomApiGetIdentityProvidersStart",myCustomApiGetCurrentUserPermissionStart:"MyCustomApiGetCurrentUserPermissionStart",myCustomApiGetCurrentUserPermissionEnd:"MyCustomApiGetCurrentUserPermissionEnd",myCustomApiGetPermissionsEnd:"MyCustomApiGetPermissionsEnd",myCustomApiGetPermissionsStart:"MyCustomApiGetPermissionsStart",myCustomApiGetTenantDetailsStart:"MyCustomApiGetTenantDetailsStart",myCustomApiGetTenantDetailsEnd:"MyCustomApiGetTenantDetailsEnd",myCustomApiModifyPermissionsStart:"MyCustomApiModifyPermissionsStart",myCustomApiModifyPermissionsEnd:"MyCustomApiModifyPermissionsEnd",myCustomApiLoadEnd:"MyCustomApiLoadEnd",myCustomApiLoadStart:"MyCustomApiLoadStart",LogicAppsCustomApiLoadEnd:"LogicApps.CustomApiLoadEnd",LogicAppsCustomApiLoadStart:"LogicApps.CustomApiLoadStart",LogicAppTemplateExportStart:"LogicAppTemplate.ExportStart",LogicAppTemplateExportEnd:"LogicAppTemplate.ExportEnd",myCustomApiPropertiesLoadEnd:"MyCustomApiPropertiesLoadEnd",myCustomApiPropertiesLoadStart:"MyCustomApiPropertiesLoadStart",myCustomApiPropertiesPaneLoadEnd:"MyCustomApiPropertiesPaneLoadEnd",myCustomApiPropertiesPaneLoadStart:"MyCustomApiPropertiesPaneLoadStart",myCustomApiSaveEditEnd:"MyCustomApiSaveEditEnd",myCustomApiSaveEditStart:"MyCustomApiSaveEditStart",LogicAppsCustomApiSaveEditEnd:"LogicApps.CustomApiSaveEditEnd",LogicAppsCustomApiSaveEditStart:"LogicApps.CustomApiSaveEditStart",myCustomApisLoadEnd:"MyCustomApisLoadEnd",myCustomApisLoadStart:"MyCustomApisLoadStart",myCustomApiTestCreateConnectionEnd:"myCustomApiTestCreateConnectionEnd",myCustomApiTestCreateConnectionStart:"myCustomApiTestCreateConnectionStart",myCustomApiTestOperationEnd:"myCustomApiTestOperationEnd",myCustomApiTestOperationStart:"myCustomApiTestOperationStart",myFlowsLoadEnd:"MyFlowsLoadEnd",myFlowsLoadStart:"MyFlowsLoadStart",myGatewaysLoadEnd:"MyGatewaysLoadEnd",myGatewaysLoadStart:"MyGatewaysLoadStart",mySharedFlowsLoadEnd:"MySharedFlowsLoadEnd",mySharedFlowsLoadStart:"MySharedFlowsLoadStart",hostReturnedNullAuthToken:"HostReturnedNullAuthToken",onBehalfOfTokenBundleRetrievalBypassedForNonFlowAuthToken:"OnBehalfOfTokenBundleRetrievalBypassedForNonFlowAuthToken",onBehalfOfTokenBundleRetrievalFailed:"OnBehalfOfTokenBundleRetrievalFailed",onBehalfOfTokenBundleLackingRequestedResource:"OnBehalfOfTokenBundleLackingRequestedResource",autoCreateFlowEnd:"AutoCreateFlowEnd",autoCreateFlowStart:"AutoCreateFlowStart",autoCreateFlowFailed:"AutoCreateFlowFailed",runFlowInputContentLoadStart:"RunFlowInputContentLoadStart",runFlowInputContentLoadEnd:"RunFlowInputContentLoadEnd",runFlowRequestStart:"RunFlowRequestStart",runFlowRequestEnd:"RunFlowRequestEnd",runFlowInputContentFileReadStart:"runFlowInputContentFileReadStart",runFlowInputContentFileReadEnd:"runFlowInputContentFileReadEnd",deleteFlowCurrentRunsLoadStart:"DeleteFlowCurrentRunsLoadStart",deleteFlowCurrentRunsLoadEnd:"DeleteFlowCurrentRunsLoadEnd",deleteFlowRequestStart:"DeleteFlowRequestStart",deleteFlowRequestEnd:"DeleteFlowRequestEnd",runFlowPageLoadStart:"RunFlowPageLoadStart",runFlowPageLoadEnd:"RunFlowPageLoadEnd",flowPropertyPageLoadStart:"FlowPropertyPageLoadStart",flowPropertyPageLoadEnd:"FlowPropertyPageLoadEnd",saveFlowEnd:"SaveFlowEnd",saveFlowStart:"SaveFlowStart",saveAsFlowStart:"SaveAsFlowStart",saveAsFlowEnd:"SaveAsFlowEnd",userConsentDetailsRetrievalFailed:"UserConsentDetailsRetrievalFailed",userConsentFailed:"userConsentFailed",userPlansRetrievalFailed:"UserPlansRetrievalFailed",currentUserDetailsLoadStart:"CurrentUserDetailsLoadStart",currentUserDetailsLoadEnd:"CurrentUserDetailsLoadEnd",runFlowWidgetTriggerFlowStart:"runFlowWidgetTriggerFlowStart",runFlowWidgetTriggerFlowEnd:"runFlowWidgetTriggerFlowEnd",runFlowWidgetTriggerFlowError:"runFlowWidgetTriggerFlowError",runFlowWidgetTriggerFlowCancelled:"runFlowWidgetTriggerFlowCancelled",runFlowWidgetGetTriggerSchemaStart:"runFlowWidgetGetTriggerSchemaStart",runFlowWidgetGetTriggerSchemaEnd:"runFlowWidgetGetTriggerSchemaEnd",runFlowWidgetGetTriggerSchemaError:"runFlowWidgetGetTriggerSchemaError",runFlowWidgeRunFlowDoneButtonClicked:"runFlowWidgeRunFlowDoneButtonClicked",requestRunOnlyAccessStart:"requestRunOnlyAccessStart",requestRunOnlyAccessEnd:"requestRunOnlyAccessEnd",hostCommunicationServiceHandleNotifyStart:"hostCommunicationServiceHandleNotifyStart",hostCommunicationServiceHandleNotifyEnd:"hostCommunicationServiceHandleNotifyEnd",geocodeGetStart:"GeocodeGetStart",geocodeGetEnd:"GeocodeGetEnd",geocodeReverseStart:"GeocodeReverseStart",geocodeReverseEnd:"GeocodeReverseEnd",locationInfoGetStart:"LocationInfoGetStart",locationInfoGetEnd:"LocationInfoGetEnd",debugViewSummaryPaneLoadEnd:"DebugViewSummaryPaneLoadEnd",debugViewSummaryPaneLoadStart:"DebugViewSummaryPaneLoadStart",zeroFlowRunsInfoPaneGetStart:"NoRunsInfoPaneStart",zeroFlowRunsInfoPaneGetEnd:"NoRunsInfoPaneEnd",flowRunOnlySaveStart:"FlowRunOnlySaveStart",flowRunOnlySaveEnd:"FlowRunOnlySaveEnd",flowRuntimeConnectionManagementStart:"FlowRuntimeConnectionManagementStart",flowRuntimeConnectionManagementEnd:"FlowRuntimeConnectionManagementEnd",renderConnectionWizardStart:"renderConnectionWizardStart",renderConnectionWizardEnd:"renderConnectionWizardEnd",installFlowStart:"installFlowStart",installFlowEnd:"installFlowEnd",loadConnectionDisambiguationStart:"loadConnectionDisambiguationStart",loadConnectionDisambiguationEnd:"loadConnectionDisambiguationEnd",userPreferencesUpdateFailed:"UserPreferencesUpdateFailed",swaggerValidationException:"SwaggerValidationException",editFlowDetailsSaveStart:"editFlowDetailsSaveStart",editFlowDetailsSaveEnd:"editFlowDetailsSaveEnd"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=r.module("powerux",["ngAria"]);t.default=n},function(e,t,i){"use strict";function r(){return"/flows/new"}function n(){return"/flows/new/getting-started"}function o(){return"/flows"}function s(){return"/approvals"}function a(){return"/approvals/received"}function l(){return"/approvals/sent"}function c(){return"/approvals/history"}function u(){return"/approvals/received/:approvalName/requests/:approvalRequestName"}function p(){return"/approvals/sent/:approvalName"}function d(){return"/flows/shared"}function g(){return"/flows/:flowName"}function m(){return"/flows/shared/:flowName"}function f(){return"/flows/:flowName/runs"}function h(){return"/flows/:flowName/runs/:flowRunName"}function v(){return"/flows/:flowName/checks/:flowRunName"}function y(){return"/flow/run"}function w(){return"/flows/:flowName/run"}function C(){return"/flows/shared/:flowName/run"}function S(){return"/flows/:flowName/addRunOnlyUser"}function b(){return"/flows/shared/:flowName/addRunOnlyUser"}function P(){return"/flows/:flowName/owners"}function R(){return"/flows/:flowName/export"}function T(){return"/flows/import"}function E(){return"/connections"}function A(){return"/connections/:apiName/:connectionName"}function D(){return"/gateways"}function F(){return"/gateways/:gatewayName"}function N(){return"/connections/available"}function I(){return"/connections/custom"}function O(){return"/connections/available/:apiName/new"}function k(){return"/connections/available/custom/create"}function M(e){return ae(e)+"/edit"}function x(){return"/flows/:flowName/details"}function _(){return"/flows/shared/:flowName/details"}function U(){return k()+"/general"}function $(){return k()+"/security"}function L(){return k()+"/definition"}function j(){return k()+"/definition/actions/:actionIndex"}function q(){return k()+"/definition/triggers/:triggerIndex"}function B(){return k()+"/definition/definitions/:definitionIndex"}function V(){return k()+"/definition/parameters/:parameterIndex"}function H(){return k()+"/definition/triggers/:triggerIndex/parameters/:parameterIndex"}function W(){return k()+"/definition/triggers/:triggerIndex/responses/:responseIndex"}function z(){return k()+"/definition/actions/:actionIndex/parameters/:parameterIndex"}function G(){return k()+"/definition/actions/:actionIndex/responses/:responseIndex"}function K(){return k()+"/definition/responses/:responseIndex"}function Q(e){return M(e)+"/general"}function J(e){return M(e)+"/security"}function Y(e){return M(e)+"/definition"}function Z(e){return M(e)+"/definition/actions/:actionIndex"}function X(e){return M(e)+"/definition/triggers/:triggerIndex"}function ee(e){return M(e)+"/definition/definitions/:definitionIndex"}function te(e){return M(e)+"/definition/actions/:actionIndex/parameters/:parameterIndex"}function ie(e){return M(e)+"/definition/actions/:actionIndex/responses/:responseIndex"}function re(e){return M(e)+"/definition/triggers/:triggerIndex/parameters/:parameterIndex"}function ne(e){return M(e)+"/definition/triggers/:triggerIndex/responses/:responseIndex"}function oe(e){return M(e)+"/definition/parameters/:parameterIndex"}function se(e){return M(e)+"/definition/responses/:responseIndex"}function ae(e){return e?"/connections/available/custom/"+e:"/connections/available/custom/:apiName"}function le(e){return ae(e)+"/details"}function ce(e){return ae(e)+"/share"}function ue(e){return M(e)+"/test"}function pe(e){return k()+"/test"}function de(e,t){return e?M(t):k()}function ge(e,t){return e?Y(t):L()}function me(){return"/activities"}Object.defineProperty(t,"__esModule",{value:!0}),t.getNewFlowUrl=r,t.getNewFlowGettingStartedUrl=n,t.getListFlowsUrl=o,t.getApprovalsBaseUrl=s,t.getApprovalsReceivedUrl=a,t.getApprovalsSentUrl=l,t.getApprovalsHistoryUrl=c,t.getApprovalRequestUrl=u,t.getApprovalUrl=p,t.getListSharedFlowsUrl=d,t.getViewFlowUrl=g,t.getViewSharedFlowUrl=m,t.getViewFlowRunsUrl=f,t.getViewFlowRunUrl=h,t.getViewFlowCheckUrl=v,t.getRuntimeWidgetRunFlowUrl=y,t.getRunFlowUrl=w,t.getRunTeamFlowUrl=C,t.getAddRunOnlyUserUrl=S,t.getSharedAddRunOnlyUserUrl=b,t.getFlowOwnersUrl=P,t.getExportFlowUrl=R,t.getImportFlowUrl=T,t.getListConnectionsUrl=E,t.getViewConnectionUrl=A,t.getListGatewaysUrl=D,t.getViewGatewayUrl=F,t.getAvailableConnectionsUrl=N,t.getCustomConnectionsUrl=I,t.getNewConnectionUrl=O,t.getNewCustomConnectorUrl=k,t.getEditCustomConnectorUrl=M,t.getViewFlowPropertiesUrl=x,t.getViewSharedFlowPropertiesUrl=_,t.getNewCustomConnectorGeneralUrl=U,t.getNewCustomConnectorSecurityUrl=$,t.getNewCustomConnectorDefinitionUrl=L,t.getNewCustomConnectorDefinitionActionUrl=j,t.getNewCustomConnectorDefinitionTriggerUrl=q,t.getNewCustomConnectorDefinitionDefinitionUrl=B,t.getNewCustomConnectorDefinitionParameterUrl=V,t.getNewCustomConnectorDefinitionInlineTriggerParameterUrl=H,t.getNewCustomConnectorDefinitionInlineTriggerResponseUrl=W,t.getNewCustomConnectorDefinitionInlineActionParameterUrl=z,t.getNewCustomConnectorDefinitionInlineActionResponseUrl=G,t.getNewCustomConnectorDefinitionResponseUrl=K,t.getEditCustomConnectorGeneralUrl=Q,t.getEditCustomConnectorSecurityUrl=J,t.getEditCustomConnectorDefinitionUrl=Y,t.getEditCustomConnectorDefinitionActionUrl=Z,t.getEditCustomConnectorDefinitionTriggerUrl=X,t.getEditCustomConnectorDefinitionDefinitionUrl=ee,t.getEditCustomConnectorDefinitionInlineActionParameterUrl=te,t.getEditCustomConnectorDefinitionInlineActionResponseUrl=ie,t.getEditCustomConnectorDefinitionInlineTriggerParameterUrl=re,t.getEditCustomConnectorDefinitionInlineTriggerResponseUrl=ne,t.getEditCustomConnectorDefinitionParameterUrl=oe,t.getEditCustomConnectorDefinitionResponseUrl=se,t.getCustomApiUrl=ae,t.getDetailsCustomApiUrl=le,t.getShareCustomApiUrl=ce,t.getEditCustomConnectorTestUrl=ue,t.getNewCustomConnectorTestUrl=pe,t.getCustomApiBaseUrl=de,t.getCustomApiDefinitionUrl=ge,t.getActivitiesUrl=me},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0}),r(i(49)),r(i(328)),r(i(67)),r(i(333)),r(i(68)),r(i(103)),r(i(104))},function(e,t,i){"use strict";function r(e,t){return"/providers/Microsoft.PowerApps/apis/"+e+"/connections/"+t}function n(e){return{properties:{connectionParameters:e}}}function o(e){return e.properties.displayName||e.name}function s(e){return e.properties.iconUri||A.default.statusWarning}function a(e){return e.properties.lastModifiedTime?new Date(e.properties.lastModifiedTime):void 0}function l(e){return F.getResourceType(e.properties.resource)}function c(e,t){var i=t.Connection.Status.Connected;return g(e)&&e.properties.statuses.forEach(function(e){e.error&&e.error.message?i=e.error.message:e.error&&!e.error.message&&(i=t.Connection.Status.SomethingWentWrong)}),i}function u(e){var t=e.properties.createdBy;return t&&t.email?t.email:""}function p(e){return new Date(e.properties.createdTime)}function d(e){var t=e.properties.createdBy;return t&&t.displayName?t.displayName:""}function g(e){var t=!1;return e.properties.statuses&&(t=e.properties.statuses.some(function(e){return N.equalsIgnoreCase(e.status,"error")})),t}function m(e){var t=!1;return e.properties.statuses&&(t=e.properties.statuses.some(function(e){return f(e)})),t}function f(e){return e.error&&e.error.code&&(N.equalsIgnoreCase(e.error.code,D.ConnectionStatusCode.Unauthenticated)||N.equalsIgnoreCase(e.error.code,D.ConnectionStatusCode.Unauthorized))}function h(e){return e&&e.properties&&e.properties.connectionParameters||{}}function v(e){return F.parseId(e).apis}function y(e){return F.parseIdFromString(e).apis}function w(e){return e.properties.apiId||""}function C(e){return N.equalsIgnoreCase(v(e),"shared_logicflows")}function S(e,t){var i=v(e);return!t.some(function(e){return N.equalsIgnoreCase(e,i)})}function b(e){return!!T(e)}function P(e){var t=e.properties;return t.statuses.length>0&&N.equalsIgnoreCase(t.statuses[0].status,"connected")}function R(e){return N.equalsIgnoreCase(e,"connected")}function T(e){var t=h(e);for(var i in t)if(I.isObject(t[i])&&t[i].gatewayObjectId)return t[i].gatewayObjectId;return null}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var E=i(0),A=i(5),D=i(464),F=i(87),N=i(8),I=i(42),O=i(9);t.ConnectionsConstant={storageCacheId:"connections",urlPath:O.getAppSettings().powerAppsResourceProviderPath+"/connections",resourceType:O.getAppSettings().powerAppsResourceProviderPath+"/connections"},t.PollFrequency={listConnections:42e4,getConnection:48e4,evictionDelay:3e5},t.getConnectionId=r,t.createConnectionPutObject=n,t.getDisplayName=o,t.getIcon=s,t.getDateModified=a,t.getUsageType=l,t.getStatusMessage=c,t.getOwnerEmail=u,t.getCreatedTime=p,t.getOwnerDisplayName=d,t.isConnectionInError=g,t.isConnectionInAuthError=m,t.getParameterValues=h,t.getConnectionApiName=v,t.getConnectionApiNameFromId=y,t.getConnectionApiId=w,t.isFlowConnection=C,t.shouldShowConnection=S,t.isConnectionUsingGateway=b,t.isConnected=P,t.isConnectedStatus=R,t.getConnectionGatewayName=T,angular.module(E.default.modules.processSimpleData).factory(E.default.services.connectionsClient,[E.default.services.appSettings,E.default.services.azureResourceClientFactory,E.default.services.environment,function(e,i,r){var n=function(e){return-1===e.url.indexOf("environment eq")&&(e.url+="&$filter=environment eq '"+r.getCurrentEnvironmentName()+"'"),e},o={name:"usages",method:"GET",isODataArray:!0,params:{$expand:"Resource"}},s={name:"getConsentLink",method:"POST",params:{id:"@id"},requestInterceptor:n},a={name:"confirmConsentCode",method:"POST",params:{id:"@id"},requestInterceptor:n};return i({urlBase:e.powerAppsResourceProviderEndpoint,urlPath:t.ConnectionsConstant.urlPath,resourceType:t.ConnectionsConstant.resourceType,apiVersion:e.featureFlags.enableEnvironments?e.powerAppsResourceProviderApiVersionWithEnvironments:e.powerAppsResourceProviderApiVersion,rest:{query:{responseInterceptor:function(t){return t.data&&t.data.filter(function(t){return S(t,e.filteredApis)})},requestInterceptor:n},get:{params:{id:"@id"},requestInterceptor:n},put:{params:{id:"@id"},requestInterceptor:n},delete:{params:{id:"@id"},requestInterceptor:n}},actions:[s,o,a],options:{queryPollInterval:t.PollFrequency.listConnections,getPollInterval:t.PollFrequency.getConnection,evictionDelay:t.PollFrequency.evictionDelay}})}])},function(e,t,i){"use strict";function r(e,t){void 0===t&&(t={});var i={type:C.Types.string};if(b.isNullOrUndefined(e))return t.allowNullType?{type:C.Types.null}:i;switch(typeof e){case C.Types.number:return e.toString().indexOf(".")>-1?{type:C.Types.number,format:"float"}:{type:C.Types.integer,format:"int32"};case C.Types.boolean:return{type:C.Types.boolean};case C.Types.string:return n(e,t);case C.Types.object:return o(e,t);default:return i}}function n(e,t){void 0===t&&(t={});var i={type:C.Types.string};try{var r=JSON.parse(e);return typeof r===C.Types.object?o(r,t):i}catch(t){var n=Date.parse(e);return isNaN(n)?i:{type:C.Types.string,format:"date-time"}}}function o(e,t){if(void 0===t&&(t={}),e instanceof Array){var i={type:C.Types.array},n=e[0];return e.forEach(function(e){angular.merge(n,e)}),i.items=r(n,t),i}return s(e,t)}function s(e,t){void 0===t&&(t={});var i={type:C.Types.string},n={type:C.Types.object,properties:{}};return b.isNullOrUndefined(e)?i:(0!==Object.keys(e).length&&Object.keys(e).forEach(function(t){var i={type:C.Types.string};null!==e[t]&&(i=r(e[t])),i.description=t,i[P.Swagger.Summary]=t,n.properties[t]=i}),t.assignDefaultValue&&(n.default=e),t.assignTestValue&&(n[S.Swagger.TestValue]=e),n)}function a(e,t,i){return void 0===i&&(i=""),b.isNullOrUndefined(e)?[]:b.isNullOrUndefined(t)?[{propertyPresent:!1,propertyName:i}]:t.type===C.Types.null||e.type===C.Types.number&&t.type===C.Types.integer||e.type===C.Types.string&&(t.type===C.Types.object||t.type===C.Types.array)?[]:e.type!==t.type?[{propertyPresent:!0,propertyName:i,expectedType:e.type.toString(),actualType:t.type.toString()}]:e.format!==t.format?[{propertyPresent:!0,propertyName:i,expectedType:e.type+" "+e.format,actualType:t.type+" "+t.format}]:e.type===C.Types.array?l(e,t,i):e.type===C.Types.object?c(e,t,i):[]}function l(e,t,i){return b.isNullOrUndefined(e.items)||b.isNullOrUndefined(t.items)?[]:a(e.items,t.items,b.isEmpty(i)?"Item":i+".Item")}function c(e,t,i){var r=[];return b.isNullOrUndefined(e.properties)?r:(Object.keys(e.properties).forEach(function(n){var o=t.properties?t.properties[n]:null;if(b.isNullOrUndefined(o)){if(!b.isNullOrUndefined(e.required)&&e.required.indexOf(n)>-1){var s={propertyPresent:!1,propertyName:n};r.push(s)}}else r=r.concat(a(e.properties[n],o,i+"."+n))}),r)}function u(e){var t={};return e.forEach(function(e){var i=b.isNullOrUndefined(e.default)?"":e.default,r=p(e.key),n="body.$"===r&&e.type===C.Types.string;if("body.$"===e.parentArray)t=b.isEmpty(t)?[{}]:t,n?t=[i]:E.set(t[0],r,i);else if(e.parentArray){var o=p(e.parentArray),s=E.get(t,o);n?s=[i]:(s=b.isNullOrUndefined(s)?[{}]:s,E.set(s[0],r,i)),E.set(t,o,s)}else n?t=i:E.set(t,r,i)}),Array.isArray(t)||"object"!=typeof t||(t=T.getObjectWithStringInKeysReplaced(t,"~1",".")),t}function p(e){return"$"===e[0]?e.substr(1):e}function d(e){return!b.isNullOrUndefined(e)&&!!e[P.Swagger.DynamicSchema]}function g(e,t,i){if(void 0===i&&(i=!1),b.isNullOrUndefined(e))return[];if(b.isNullOrUndefined(t))return e;var r=t;Array.isArray(r)||"object"!=typeof r||(r=T.getObjectWithStringInKeysReplaced(t,".","~1"));return e.forEach(function(e){var t=p(e.key),n="body.$"===t&&e.type===C.Types.string,o=void 0;if("body.$"===e.parentArray)o=n?r[0]:E.get(r[0],t);else if(e.parentArray){var s=p(e.parentArray),a=E.get(r,s);if(b.isNullOrUndefined(a)||b.isNullOrUndefined(a[0]))return;o=n?a[0]:E.get(a[0],t)}else o=n?r:E.get(r,t);e.default=i||b.isNullOrUndefined(e.default)?o:e.default}),e}function m(e,t){var i=angular.copy(e),r=angular.copy(t),n={};i.definitions&&Array.isArray(i.definitions)&&i.definitions.forEach(function(e){n["#/definitions/"+e.name]=e.item});var o={};return{schema:f(i,angular.copy(r),n,o),referencesUsed:Object.keys(o).filter(function(e){return!!o[e]}).filter(function(e,t,i){return i.indexOf(e)===t}).map(function(e){return e.split("/")[2]})}}function f(e,t,i,r,n){if(void 0===n&&(n=null),b.isNullOrUndefined(t))return null;if(null===n&&(n={}),!b.isNullOrUndefined(t.$ref)){var o=i[t.$ref];return n[t.$ref]?t:(n[t.$ref]=!0,r[t.$ref]=!0,f(e,o,i,r,n))}return t.type===C.Types.object?(b.isNullOrUndefined(t.properties)||(t.properties=h(e,t.properties,i,r,n)),b.isNullOrUndefined(t.additionalProperties)||"boolean"==typeof t.additionalProperties||(t.additionalProperties=f(e,t.additionalProperties,i,r,n))):t.type===C.Types.array&&(b.isNullOrUndefined(t.items)||(t.items=f(e,t.items,i,r,n))),t}function h(e,t,i,r,n){var o={};return Object.keys(t).forEach(function(s){var a=t[s],l=f(e,a,i,r,angular.copy(n));o[s]=l}),o}function v(e){return e.filter(function(e){return-1===["object","array"].indexOf(e.type)})}function y(e,t,i){var r={},n={};return i&&Array.isArray(i.definitions)&&i.definitions.forEach(function(e){n["#/definitions/"+e.name]=e.item}),e.forEach(function(e){var i=e.key.replace(/^(\$)/g,"").split(".").filter(function(e){return!b.isNullOrWhitespace(e)}).map(function(e){return e.replace("~1",".")}),o=t,s="",a="";i.forEach(function(e){if(o.$ref&&(s=o.$ref,a="",o=n[o.$ref]),"array"===o.type)o=o.items,a=(""===a?"":a+".")+"items";else if("object"===o.type){var t=Object.keys(o.properties).filter(function(t){return t===e.replace("~1",".")})[0];if(!t)throw new Error("Schema not found");o=o.properties[t],a=(""===a?"":a+".")+"properties."+t.replace(".","~1")}}),r[e.key]={path:a,reference:s.split("/")[2]}}),r}function w(e){var t=v(new R.SchemaProcessor({excludeInternal:!1,excludeAdvanced:!1,required:!0}).getSchemaProperties(e)),i=y(t,e,null),r=T.getObjectWithStringInKeysReplaced(e,".","~1");return t.forEach(function(t){var n=E.get(r,i[t.key].path)||e;t.leafTitle=n?n.title||n["x-ms-summary"]||"":""}),t.sort(function(e,t){return e.key<t.key?-1:1})}Object.defineProperty(t,"__esModule",{value:!0});var C=i(27),S=i(16),b=i(1),P=i(16),R=i(192),T=i(94),E=i(64);t.generateSchemaFromJson=r,t.getSchemaComparisonResults=a,t.convertBodyParametersToSingleObject=u,t.isDynamicSchema=d,t.setBodyParameterDefaultsFromJson=g,t.resolveSchema=m,t.filterSchemaProperties=v,t.resolveSchemaProperties=y,t.getLeafSchemaProperties=w},function(e,t,i){"use strict";function r(e){var t=document.createElement("a");t.href=e;var i=t.pathname||"";return u.startsWith(i,"/")||(i="/"+i),{raw:e,protocol:t.protocol?t.protocol.replace(/:/g,""):"",host:t.host||"",hostname:t.hostname||"",port:t.port?Number(t.port):void 0,path:i,parameters:n(t.search||""),hash:decodeURIComponent(t.hash||"")}}function n(e){var t={};return e?(u.startsWith(e,"?")&&(e=e.substring(1)),e.split("&").forEach(function(e){var i=e.split("="),r=i[0],n=i[1];t[decodeURIComponent(r||"")]=decodeURIComponent(n||"")}),t):t}function o(e){return Object.keys(e||{}).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}function s(e,t){var i=r(e),n=i.protocol+"://"+i.host+i.path,s=a(n,t),l=o(i.parameters);return l&&(s=s+"?"+l),s}function a(e,t){return u.endsWith(e,"/")&&u.startsWith(t,"/")?e.substring(0,e.length-1)+t:u.endsWith(e,"/")||u.startsWith(t,"/")?e+t:e+"/"+t}function l(e){return e.replace(/^\/+/,"")}function c(e){return e.replace(/\/+$/,"")}Object.defineProperty(t,"__esModule",{value:!0});var u=i(1);t.parseUri=r,t.parseQueryString=n,t.createQueryString=o,t.appendToUriPath=s,t.concatParts=a,t.stripLeadingSlashes=l,t.stripTrailingSlashes=c},function(e,t,i){"use strict";function r(e){return new e.designercore.Designer(s(e),e.designerElement)}function n(e){return new e.designercore.Monitor(s(e),e.designerElement)}function o(e,t){return new e.designercore.ConnectionWizard(s(e),e.designerElement,t)}function s(e){var t=e.designercore,i=e.appSettings,r=i.processSimpleResourceProviderPath+"/apiOperations",n=e.environment?i.processSimpleResourceProviderPath+"/environments/"+e.environment.name+"/apiOperations":r,o={config:{apiOperationsPath:n,connectionsPath:i.powerAppsConnectionsPath,connectionProvidersPath:i.powerAppsConnectionProvidersPath,flowsConnectorPath:i.flowsConnectorPath,flowsPath:i.flowsPath,gatewaysPath:i.gatewaysPath},visibleHideKeys:e.visibleHideKeys};e.allowCoauthoring&&(o.allowCoauthoring=e.allowCoauthoring,o.getUriForDynamicCalls=function(t){var r=t.connectionProvider,n=t.connection,o=P.SessionService.instance.getUserInfo();return r&&r.properties&&r.properties.primaryRuntimeUrl&&o&&o.uniqueId&&o.tenantId&&n&&n.properties&&n.properties.createdBy&&m.equalsIgnoreCase(n.properties.createdBy.id,o.uniqueId)&&m.equalsIgnoreCase(n.properties.createdBy.tenantId,o.tenantId)?g.concatParts(r.properties.primaryRuntimeUrl,n.name):g.concatParts(i.processSimpleManagementUri,"/environments/"+e.environment.name+"/flows/"+e.flowName+"/apis/"+r.name+"/connections/"+n.name+"/proxy")});var s=new t.PowerAppsUrlService(o),l=function(r){var n={getAccessToken:e.getArmAccessToken,getConsentServerAccessToken:e.getConsentServerAccessToken,baseUrl:E.stripTrailingSlashes(i.powerAppsResourceProviderEndpoint),apiVersion:e.environment?i.powerAppsResourceProviderApiVersionWithEnvironments:i.powerAppsResourceProviderApiVersion,analytics:r,oauthService:e.oAuthService,urlService:s,environment:e.environment,showViewPermissionsDialog:e.showViewPermissionsDialog};return e.allowCoauthoring&&(n.allowCoauthoring=!0,n.getFlowConnectionsPath=function(){return g.concatParts(f.FlowsConstant.urlPathWithEnvironments,e.flowName+"/connections")},n.flowConnectionsApiVersion=i.processSimpleResourceProviderApiVersionWithEnvironments),new t.PowerAppsConnectionService(n)},c=function(r){return new t.PowerAppsConnectionOperationsService({getAccessToken:e.getArmAccessToken,baseUrl:i.processSimpleResourceProviderManagementEndpoint,apiVersion:e.environment?i.processSimpleResourceProviderApiVersionWithEnvironments:i.processSimpleResourceProviderApiVersion,analytics:r,urlService:s,environment:e.environment,canAddOperation:e.canAddOperation})},u=A.uuid(),y=a(t,i,e),w={getArmAccessToken:e.getArmAccessToken,getRuntimeAccessToken:e.getRuntimeAccessToken,getConsentServerAccessToken:e.getConsentServerAccessToken,oauthService:e.oAuthService,urlService:s,baseUrl:i.azureResourceManagementUri,apiVersion:i.processSimpleResourceProviderApiVersion,logicFlowsRuntimeApiVersion:i.logicFlowsRuntimeApiVersion,host:window.location.host,hostEnvironment:t.Host.ProcessSimple,hostVersion:i.buildVersion,sessionId:P.SessionService.instance.getUserSession().sessionId,designerSessionId:u,telemetryBaseUrl:i.azureResourceManagementUri,telemetryVersion:i.telemetryVersion,startTelemetryPublish:i.designer.startPublishingTelemetry,settings:{"ui.recommendation.tiers_to_display":["Premium"],"core.defaultRecurrence":h.getPlanDefaultRecurrence(v.getUserPlan()),promotedServicesForActions:i.designer.promotedServicesForActions.slice(),promotedServicesForTriggers:i.designer.promotedServicesForTriggers.slice()},features:y,prefetchedData:e.prefetchedData,connectionServiceFactory:l,connectionOperationsServiceFactory:c,runInstanceServiceFactory:e.runInstanceServiceFactory,dietViewServiceFactory:e.dietViewServiceFactory,analyticsServiceFactory:function(e){var t=d.AnalyticsService.instance;return t.setContextData({designerSessionId:u,designerVersion:e}),y.DIET_VIEW&&t.setContextData({isDietView:!0}),t},onLog:function(e){"Telemetry"===e.eventType&&C.LocalyticsService.instance.tagEvent(e.eventName,e.eventData.data)},azureADServiceFactory:e.azureADServiceFactory,flowManagementServiceFactory:e.flowManagementServiceFactory,suggestionInfo:N,connectionWizardUIConfig:e.connectionWizardUIConfig};if(e.allowCoauthoring){w.dynamicCallApiVersion=i.processSimpleResourceProviderApiVersionWithEnvironments;var S={};w.connectorServiceFactory=function(r){var n=new t.ConnectorService({urlService:s,analytics:r,apiVersion:i.processSimpleResourceProviderApiVersionWithEnvironments,baseUrl:i.processSimpleManagementUri,getAccessToken:e.getArmAccessToken,locale:i.designer.locale});return{execute:function(e,t,r){if(p(t,i)){r.headers=r.headers||{},r.queries=r.queries||{};var o="";if(m.equalsIgnoreCase(e,"GET")){var s=R.stableStringify({httpMethod:e,runtimeUrl:t,inputs:r});S[s]?o=S[s]:(o=A.uuid(),S[s]=o)}var a=(r.path||"").split("?"),l=T.stripLeadingSlashes(a[0])||"",c=b.parseQueryString(a[1]||"");Object.keys(r.queries).forEach(function(e){c[e]=r.queries[e]}),Object.keys(c).length>0&&(l+="?"+b.createQueryString(c)),r.headers["x-ms-flow-proxy-wildcard"]=l,r.queries={},o&&(r.queries._=o),r.path=""}return n.execute(e,t,r)}}}}return w}function a(e,t,i){var r=e.features,n={};return r.ALLOW_EMPTY_DEFINITION&&(n[r.ALLOW_EMPTY_DEFINITION]=!1),r.FILTER_RECOMMENDATION&&(n[r.FILTER_RECOMMENDATION]=!1),r.SHOW_TRIGGER_RECURRENCE&&(n[r.SHOW_TRIGGER_RECURRENCE]=!1),r.RAW_MODE&&(n[r.RAW_MODE]=!1),r.USE_CONNECTION_CONFIGURATION_SERVICE&&(n[r.USE_CONNECTION_CONFIGURATION_SERVICE]=!1),r.BOOLEAN_DROPDOWN_FOR_CONDITION&&(n[r.BOOLEAN_DROPDOWN_FOR_CONDITION]=t.featureFlags.designerBooleanDropdownForCondition),r.CREATE_CONNECTION_TERMS_OF_USE&&(n[r.CREATE_CONNECTION_TERMS_OF_USE]=t.designer.termsInCreateConnection),!r.GATEWAY_FOR_CONNECTION||t.featureFlags.enableMSA&&P.SessionService.instance.isConsumerDomain||(n[r.GATEWAY_FOR_CONNECTION]=t.featureFlags.gatewaySupport),r.SHOW_API_RECOMMENDATIONS_FIRST&&(n[r.SHOW_API_RECOMMENDATIONS_FIRST]=!0),r.AUTO_CREATE_FIRST_PARTY_CONNECTION&&(n[r.AUTO_CREATE_FIRST_PARTY_CONNECTION]=!0),r.SHOW_INSERT_ACTION_BUTTON&&(n[r.SHOW_INSERT_ACTION_BUTTON]=!0),r.USE_DICTIONARY_EDITOR&&(n[r.USE_DICTIONARY_EDITOR]=!0),r.TOKEN_COPY_PASTE&&(n[r.TOKEN_COPY_PASTE]=!0),r.SUPPORT_EXPLICIT_BUTTON_INPUT_SELECTION&&(n[r.SUPPORT_EXPLICIT_BUTTON_INPUT_SELECTION]=t.featureFlags.designerButtonEnumParameter),r.SUPPORT_EXPLICIT_BUTTON_EMAIL_PARMATER&&(n[r.SUPPORT_EXPLICIT_BUTTON_EMAIL_PARMATER]=t.featureFlags.designerButtonEmailParameter),r.SUPPORT_EXPLICIT_BUTTON_FILE_PARAMETER&&(n[r.SUPPORT_EXPLICIT_BUTTON_FILE_PARAMETER]=t.featureFlags.designerButtonFileParameter),r.SHOW_DESCRIPTION&&(n[r.SHOW_DESCRIPTION]=t.featureFlags.designerShowDescription),r.SHOW_CONNECTIONS_IN_CARD_MENU&&(n[r.SHOW_CONNECTIONS_IN_CARD_MENU]=t.featureFlags.showConnectionsInMenu),!r.INTELLISENSE_COMBOBOX||t.featureFlags.enableMSA&&P.SessionService.instance.isConsumerDomain||(n[r.INTELLISENSE_COMBOBOX]=t.featureFlags.enablePeoplePicker),r.INITIALIZE_DYNAMIC_CONTENT_ASYNC&&(n[r.INITIALIZE_DYNAMIC_CONTENT_ASYNC]=t.featureFlags.designerInitializeDynamicContentAsync),r.USE_BUTTON_TRIGGER&&(n[r.USE_BUTTON_TRIGGER]=t.featureFlags.enableButtonTrigger),r.NEW_RECOMMENDATION_CARD&&(n[r.NEW_RECOMMENDATION_CARD]=t.featureFlags.designerNewRecommendationCard),r.NEW_TOKEN_PICKER&&(n[r.NEW_TOKEN_PICKER]=t.featureFlags.designerNewTokenPicker),r.ALLOW_COAUTHORING&&(n[r.ALLOW_COAUTHORING]=i.allowCoauthoring),r.OPERATION_CREATION_ENFORCEMENT&&(n[r.OPERATION_CREATION_ENFORCEMENT]=!0),r.USE_EDITOR_INPUT&&(n[r.USE_EDITOR_INPUT]=!F&&t.featureFlags.designerUseEditorInput),r.VIEW_CONNECTION_PERMISSIONS_DIALOG&&(n[r.VIEW_CONNECTION_PERMISSIONS_DIALOG]=t.featureFlags.designerViewConnectionPermissionsDialog),r.SUPPORT_EXPLICIT_BUTTON_PARAMETERS&&(n[r.SUPPORT_EXPLICIT_BUTTON_PARAMETERS]=t.featureFlags.enableButtonParameters),r.CONNECTION_WIZARD_FIRST_PARTY_CONNECTION_AUTO_CREATION&&(n[r.CONNECTION_WIZARD_FIRST_PARTY_CONNECTION_AUTO_CREATION]=t.featureFlags.enableImprovedFlowCreationFromTemplate&&!P.SessionService.instance.isConsumerDomain),r.CONNECTION_WIZARD_SIMPLE_CONNECTION_AUTO_CREATION&&(n[r.CONNECTION_WIZARD_SIMPLE_CONNECTION_AUTO_CREATION]=t.featureFlags.enableImprovedFlowCreationFromTemplate),t.featureFlags.enableDietDesigner&&r.DIET_VIEW&&i.enableDietDesigner&&(n[r.DIET_VIEW]=!0),r.USE_REQUEST_APICONNECTION_TRIGGER&&(n[r.USE_REQUEST_APICONNECTION_TRIGGER]=t.featureFlags.enableRequestApiConnectionTrigger),r.SHOW_CALLOUT_HINTS&&i.showCalloutHints&&t.featureFlags.designerShowCalloutHints&&(n[r.SHOW_CALLOUT_HINTS]=!0),r.REQUEST_APICONNECTION_TRIGGER_SUPPORT_EXPLICIT_BUTTON_PARAMETERS&&(n[r.REQUEST_APICONNECTION_TRIGGER_SUPPORT_EXPLICIT_BUTTON_PARAMETERS]=t.featureFlags.enableButtonParametersOnRequestApiConnectionTrigger),r.SHOW_VARIABLE_ACTIONS&&(n[r.SHOW_VARIABLE_ACTIONS]=!0),r.DISABLE_AUTO_FOCUS_PARAMETERS&&(n[r.DISABLE_AUTO_FOCUS_PARAMETERS]=!0),r.SUPPORT_PAN_AND_ZOOM&&(n[r.SUPPORT_PAN_AND_ZOOM]=t.featureFlags.designerSupportPanAndZoom),r.FX_TOKEN&&(n[r.FX_TOKEN]=t.featureFlags.designerShowExpressionBuilder),r.FX_TOKEN_FOR_CONDITION&&(n[r.FX_TOKEN_FOR_CONDITION]=t.featureFlags.designerShowExpressionBuilderForCondition),r.SHOW_SOFT_LANDING_TIPS&&(n[r.SHOW_SOFT_LANDING_TIPS]=t.featureFlags.designerShowSoftLandingTips),r.SHOW_PARENT_OBJECT_FOR_OUTPUTS&&(n[r.SHOW_PARENT_OBJECT_FOR_OUTPUTS]=t.featureFlags.designerParentObjectForOutputs),r.COLORIZE_MONITORING_INPUTS_OUTPUTS&&(n[r.COLORIZE_MONITORING_INPUTS_OUTPUTS]=!1),r.NEW_SCHEMA_EDITOR&&(n[r.NEW_SCHEMA_EDITOR]=!1),r.SUPPORT_NESTED_FOREACH_UI&&(n[r.SUPPORT_NESTED_FOREACH_UI]=!1),n}function l(e){var t=window.require;return window.require=function(e,i,r,n){return Array.isArray(e)&&Array.from(e).length&&"vs/editor/editor.main"===Array.from(e)[0]?(i&&i(),!0):t(e,i,r,n)},e}function c(e,t){var i=t.profileStart(w.ProfilingEventNames.designerScriptLoadStart),r=D.requireJsConfig(e),n=["react","react-dom","SwaggerParser","Immutable","fuse","resources","vs/loader","vs/editor/editor.main"];return e.featureFlags.designerUseEditorInput?new Promise(function(o,s){r(n,function(n,a,l,c,u,p){window.React=n,window.ReactDOM=a,window.Immutable=c,r(F?["office-ui-fabric-react"]:["office-ui-fabric-react","Draft"],function(){r(["core/main"],function(r){return e.featureFlags.currentDesignerVersion=r.version,t.profileEnd(i,w.ProfilingEventNames.designerScriptLoadEnd,{status:S.Status.Success}),o({designercore:r,resources:p})},function(e){t.profileEnd(i,w.ProfilingEventNames.designerScriptLoadEnd,{status:S.inferErrorStatus(e),error:S.parseErrorMessage(e)}),t.logError("DesignerHelper.DesignerScriptLoad",e),s(e)})},function(e){t.profileEnd(i,w.ProfilingEventNames.designerScriptLoadEnd,{status:S.inferErrorStatus(e),error:S.parseErrorMessage(e)}),t.logError("DesignerHelper.DesignerScriptLoad",e),s(e)})})}).then(l):new Promise(function(e,n){r(["core/main","resources","react","SwaggerParser","fuse"],function(r,n){e({designercore:r,resources:n}),t.profileEnd(i,w.ProfilingEventNames.designerScriptLoadEnd,{status:S.Status.Success})},function(e){t.profileEnd(i,w.ProfilingEventNames.designerScriptLoadEnd,{status:S.inferErrorStatus(e),error:S.parseErrorMessage(e)}),t.logError("DesignerHelper.DesignerScriptLoad",e),n(e)})})}function u(e){return window.Promise?new Promise(function(t,i){e.then(function(e){return t(e)}).catch(function(e){return i(e)})}):e}function p(e,t){var i=y.isAzureManagementUrl(e)||y.isProcesssimpleResourceProviderUrl(e);if(e&&i&&e.indexOf("proxy")>-1){var r=e.split("/");if(r.length>13&&m.equalsIgnoreCase(r[5],"environments")&&m.equalsIgnoreCase(r[7],"flows")&&m.equalsIgnoreCase(r[9],"apis")&&m.equalsIgnoreCase(r[11],"connections")&&m.equalsIgnoreCase(r[13],"proxy"))return!0}return!1}Object.defineProperty(t,"__esModule",{value:!0});var d=i(66),g=i(49),m=i(8),f=i(18),h=i(39),v=i(203),y=i(77),w=i(4),C=i(105),S=i(3),b=i(68),P=i(43),R=i(110),T=i(103),E=i(104),A=i(38),D=i(581),F=-1!==window.navigator.userAgent.indexOf("MSIE")||!String.prototype.startsWith||window.navigator.appVersion.indexOf("Trident/")>0,N={text:"Please vote for or make a new suggestion on the ",link:"https://powerusers.microsoft.com/t5/Flow-Ideas/idb-p/FlowIdeas",linkDisplayText:"Flow Ideas forum"};t.createDesigner=r,t.createDesignerMonitor=n,t.createDesignerConnectionWizard=o,t.loadDesignerScripts=c,t.toDesignerPromise=u,t.isProxyUrl=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.CreateFlowStarted=0]="CreateFlowStarted",e[e.CreateFlowFromTemplateStarted=1]="CreateFlowFromTemplateStarted",e[e.CreateFlowCompleted=2]="CreateFlowCompleted",e[e.ImportFromPackageClicked=3]="ImportFromPackageClicked",e[e.DietDesignerConnectionSelectionComplete=4]="DietDesignerConnectionSelectionComplete",e[e.DietDesignerEditInAdvancedModeClicked=5]="DietDesignerEditInAdvancedModeClicked",e[e.DeleteFlow=6]="DeleteFlow",e[e.DesignerLoad=7]="DesignerLoad",e[e.EditFlowClicked=8]="EditFlowClicked",e[e.FlowDesignerCloseClicked=9]="FlowDesignerCloseClicked",e[e.ListFlowRuns=10]="ListFlowRuns",e[e.ListFlowOwners=11]="ListFlowOwners",e[e.SaveFlowClicked=12]="SaveFlowClicked",e[e.StartFlowClicked=13]="StartFlowClicked",e[e.StopFlowClicked=14]="StopFlowClicked",e[e.SwitchFlowsListClicked=15]="SwitchFlowsListClicked",e[e.TestFlowWaitForRun=16]="TestFlowWaitForRun",e[e.UpdateFlowCompleted=17]="UpdateFlowCompleted",e[e.UpdateFlowStarted=18]="UpdateFlowStarted",e[e.ViewFlow=19]="ViewFlow",e[e.FlowListExportLogicAppTemplateClicked=20]="FlowListExportLogicAppTemplateClicked",e[e.FlowListExportBapPackagedClicked=21]="FlowListExportBapPackagedClicked",e[e.FlowDetailsExportLogicAppTemplateClicked=22]="FlowDetailsExportLogicAppTemplateClicked",e[e.FlowDetailsExportBapPackagedClicked=23]="FlowDetailsExportBapPackagedClicked",e[e.LearnMoreClicked=24]="LearnMoreClicked",e[e.UserVoiceClicked=25]="UserVoiceClicked",e[e.FlowGettingStartedSearchAllTriggersAndServices=26]="FlowGettingStartedSearchAllTriggersAndServices",e[e.ApprovalsReceivedTabClicked=27]="ApprovalsReceivedTabClicked",e[e.ApprovalsSentTabClicked=28]="ApprovalsSentTabClicked",e[e.ApprovalsHistoryTabClicked=29]="ApprovalsHistoryTabClicked",e[e.ApprovalCardApproveClicked=30]="ApprovalCardApproveClicked",e[e.ApprovalCardRejectClicked=31]="ApprovalCardRejectClicked",e[e.ApprovalCardClicked=32]="ApprovalCardClicked",e[e.ApprovalCardEmailRequesterClicked=33]="ApprovalCardEmailRequesterClicked",e[e.ApprovalCarouselNextFlipperClicked=34]="ApprovalCarouselNextFlipperClicked",e[e.ApprovalCarouselPreviousFlipperClicked=35]="ApprovalCarouselPreviousFlipperClicked",e[e.AddConnectionButtonClicked=36]="AddConnectionButtonClicked",e[e.CreateSimpleConnectionComplete=37]="CreateSimpleConnectionComplete",e[e.CreateFirstPartyConnectionComplete=38]="CreateFirstPartyConnectionComplete",e[e.ConsentFirstPartyConnectionComplete=39]="ConsentFirstPartyConnectionComplete",e[e.CreateConnectionByPopupCompleted=40]="CreateConnectionByPopupCompleted",e[e.CreateConfigurableConnection=41]="CreateConfigurableConnection",e[e.CreateConnectionStarted=42]="CreateConnectionStarted",e[e.CreateCustomApiButtonClicked=43]="CreateCustomApiButtonClicked",e[e.EditCustomApi=44]="EditCustomApi",e[e.DeleteConnectionFromList=45]="DeleteConnectionFromList",e[e.DeleteCustomApi=46]="DeleteCustomApi",e[e.DeleteConnectionFromDetails=47]="DeleteConnectionFromDetails",e[e.DeleteFirstPartyConnectionComplete=48]="DeleteFirstPartyConnectionComplete",e[e.DownloadCustomApi=49]="DownloadCustomApi",e[e.GetFirstPartyConnectionConsentUriComplete=50]="GetFirstPartyConnectionConsentUriComplete",e[e.UpdateConnectionPasswordClicked=51]="UpdateConnectionPasswordClicked",e[e.ShowConnectionInfo=52]="ShowConnectionInfo",e[e.TestTabVisited=53]="TestTabVisited",e[e.TestCurrentOperationClicked=54]="TestCurrentOperationClicked",e[e.ToggleRawBodyClicked=55]="ToggleRawBodyClicked",e[e.AttemptingToGetApimTrace=56]="AttemptingToGetApimTrace",e[e.CreateConnectionFromTestPage=57]="CreateConnectionFromTestPage",e[e.TestingOperationUsingRawBody=58]="TestingOperationUsingRawBody",e[e.TestingOperationUsingParsedBody=59]="TestingOperationUsingParsedBody",e[e.CustomApiDetailsTabVisited=60]="CustomApiDetailsTabVisited",e[e.CustomApiShareTabVisited=61]="CustomApiShareTabVisited",e[e.CustomApiShareTabSaveChangesClicked=62]="CustomApiShareTabSaveChangesClicked",e[e.CustomApiShareTabDiscardChangesClicked=63]="CustomApiShareTabDiscardChangesClicked",e[e.CustomApiSecurityTabVisited=64]="CustomApiSecurityTabVisited",e[e.CustomApiGeneralTabVisited=65]="CustomApiGeneralTabVisited",e[e.PostmanCollectionUploaded=66]="PostmanCollectionUploaded",e[e.SwaggerFileUploaded=67]="SwaggerFileUploaded",e[e.SwaggerUrlUploaded=68]="SwaggerUrlUploaded",e[e.CustomApiIconUploaded=69]="CustomApiIconUploaded",e[e.CustomApiActionVisited=70]="CustomApiActionVisited",e[e.CustomApiTriggerVisited=71]="CustomApiTriggerVisited",e[e.CustomApiSaveActionClicked=72]="CustomApiSaveActionClicked",e[e.CustomApiDiscardActionClicked=73]="CustomApiDiscardActionClicked",e[e.CustomApiSaveTriggerClicked=74]="CustomApiSaveTriggerClicked",e[e.CustomApiDiscardTriggerClicked=75]="CustomApiDiscardTriggerClicked",e[e.CustomApiImportFromSampleResponseClicked=76]="CustomApiImportFromSampleResponseClicked",e[e.CustomApiImportFromSampleRequestClicked=77]="CustomApiImportFromSampleRequestClicked",e[e.CustomApiDeleteParameterClicked=78]="CustomApiDeleteParameterClicked",e[e.CustomApiEditParameterClicked=79]="CustomApiEditParameterClicked",e[e.CustomApiDefinitionVisited=80]="CustomApiDefinitionVisited",e[e.CustomApiSaveDefinitionClicked=81]="CustomApiSaveDefinitionClicked",e[e.CustomApiDiscardDefinitionClicked=82]="CustomApiDiscardDefinitionClicked",e[e.CustomApiParameterVisited=83]="CustomApiParameterVisited",e[e.CustomApiSaveParameterClicked=84]="CustomApiSaveParameterClicked",e[e.CustomApiDiscardParameterClicked=85]="CustomApiDiscardParameterClicked",e[e.CustomApiResponseVisited=86]="CustomApiResponseVisited",e[e.CustomApiSaveResponseClicked=87]="CustomApiSaveResponseClicked",e[e.CustomApiDiscardResponseClicked=88]="CustomApiDiscardResponseClicked",e[e.AddGatewayButtonClicked=89]="AddGatewayButtonClicked",e[e.ShowGatewayInfo=90]="ShowGatewayInfo",e[e.IntallGatewayFromCreateConnectionClicked=91]="IntallGatewayFromCreateConnectionClicked",e[e.GatewayLearnClicked=92]="GatewayLearnClicked",e[e.HeaderAdminPortalClicked=93]="HeaderAdminPortalClicked",e[e.HeaderApprovalsClicked=94]="HeaderApprovalsClicked",e[e.HeaderDownloadClicked=95]="HeaderDownloadClicked",e[e.HeaderFeedbackClicked=96]="HeaderFeedbackClicked",e[e.HeaderHomeClicked=97]="HeaderHomeClicked",e[e.HeaderLearnClicked=98]="HeaderLearnClicked",e[e.HeaderMyConnectionsClicked=99]="HeaderMyConnectionsClicked",e[e.HeaderMyCustomApisClicked=100]="HeaderMyCustomApisClicked",e[e.HeaderMyGatewaysClicked=101]="HeaderMyGatewaysClicked",e[e.HeaderMyFlowsClicked=102]="HeaderMyFlowsClicked",e[e.HeaderNotificationClicked=103]="HeaderNotificationClicked",e[e.HeaderServicesClicked=104]="HeaderServicesClicked",e[e.HeaderSettingsClicked=105]="HeaderSettingsClicked",e[e.HeaderSignInClicked=106]="HeaderSignInClicked",e[e.HeaderSignOutClicked=107]="HeaderSignOutClicked",e[e.HeaderTemplatesClicked=108]="HeaderTemplatesClicked",e[e.HeaderLearnMenuBlogClicked=109]="HeaderLearnMenuBlogClicked",e[e.HeaderLearnMenuCommunityClicked=110]="HeaderLearnMenuCommunityClicked",e[e.HeaderLearnMenuGuidedLearningClicked=111]="HeaderLearnMenuGuidedLearningClicked",e[e.HeaderLearnMenuDocumentationClicked=112]="HeaderLearnMenuDocumentationClicked",e[e.HeaderLearnMenuFeedbackClicked=113]="HeaderLearnMenuFeedbackClicked",e[e.HeaderLearnMenuSupportClicked=114]="HeaderLearnMenuSupportClicked",e[e.HeaderLearnMenuPricingClicked=115]="HeaderLearnMenuPricingClicked",e[e.BannerLearnClicked=116]="BannerLearnClicked",e[e.SearchEvent=117]="SearchEvent",e[e.HydrateFlowRun=118]="HydrateFlowRun",e[e.FooterBlogClicked=119]="FooterBlogClicked",e[e.FooterBusinessPlatformClicked=120]="FooterBusinessPlatformClicked",e[e.FooterCommunityClicked=121]="FooterCommunityClicked",e[e.FooterContactUsClicked=122]="FooterContactUsClicked",e[e.FooterLegalLinkClicked=123]="FooterLegalLinkClicked",e[e.FooterCopyrightClicked=124]="FooterCopyrightClicked",e[e.FooterDocumentationClicked=125]="FooterDocumentationClicked",e[e.FooterDownloadGatewayClicked=126]="FooterDownloadGatewayClicked",e[e.FooterDownloadMobileClicked=127]="FooterDownloadMobileClicked",e[e.FooterFeedbackClicked=128]="FooterFeedbackClicked",e[e.FooterGuidedLearningClicked=129]="FooterGuidedLearningClicked",e[e.FooterHomeClicked=130]="FooterHomeClicked",e[e.FooterPowerAppsClicked=131]="FooterPowerAppsClicked",e[e.FooterPowerBIClicked=132]="FooterPowerBIClicked",e[e.FooterPricingClicked=133]="FooterPricingClicked",e[e.FooterPrivacyAndCookiesClicked=134]="FooterPrivacyAndCookiesClicked",e[e.FooterRssClicked=135]="FooterRssClicked",e[e.FooterServicesClicked=136]="FooterServicesClicked",e[e.FooterSigninClicked=137]="FooterSigninClicked",e[e.FooterSignupClicked=138]="FooterSignupClicked",e[e.FooterSupportClicked=139]="FooterSupportClicked",e[e.FooterPartnersClicked=140]="FooterPartnersClicked",e[e.FooterTemplatesClicked=141]="FooterTemplatesClicked",e[e.FooterTermsAndConditionsClicked=142]="FooterTermsAndConditionsClicked",e[e.FooterTermsOfUseClicked=143]="FooterTermsOfUseClicked",e[e.FooterTrademarksClicked=144]="FooterTrademarksClicked",e[e.FooterTwitterClicked=145]="FooterTwitterClicked",e[e.FooterYoutubeClicked=146]="FooterYoutubeClicked",e[e.BrowseApprovalsTemplatesClicked=147]="BrowseApprovalsTemplatesClicked",e[e.BrowseCollectDataTemplatesClicked=148]="BrowseCollectDataTemplatesClicked",e[e.BrowseNotificationTemplatesClicked=149]="BrowseNotificationTemplatesClicked",e[e.BrowseSyncFilesTemplatesClicked=150]="BrowseSyncFilesTemplatesClicked",e[e.ApiBrowsed=151]="ApiBrowsed",e[e.ApiOperationCardClicked=152]="ApiOperationCardClicked",e[e.BrowseTemplatesClicked=153]="BrowseTemplatesClicked",e[e.HowItWorksVideoPlayed=154]="HowItWorksVideoPlayed",e[e.TemplateBrowsed=155]="TemplateBrowsed",e[e.TemplatesNextPageClicked=156]="TemplatesNextPageClicked",e[e.TemplatesSeeMoreClicked=157]="TemplatesSeeMoreClicked",e[e.ShowAllServicesClicked=158]="ShowAllServicesClicked",e[e.ScreenView=159]="ScreenView",e[e.FlowCoauthorsLearnMoreClicked=160]="FlowCoauthorsLearnMoreClicked",e[e.FlowConnectionsLearnMoreClicked=161]="FlowConnectionsLearnMoreClicked",e[e.CtrlAltAPressed=162]="CtrlAltAPressed",e[e.PublishFlowStarted=163]="PublishFlowStarted",e[e.PublishFlowCompleted=164]="PublishFlowCompleted",e[e.PublishFlowRecommendedTemplateSeeMoreClicked=165]="PublishFlowRecommendedTemplateSeeMoreClicked",e[e.FeedbackFormClosed=166]="FeedbackFormClosed",e[e.UserFeedbackReceived=167]="UserFeedbackReceived",e[e.NotificationListClosed=168]="NotificationListClosed",e[e.NotificationBillingWarningClicked=169]="NotificationBillingWarningClicked",e[e.ActivityFeedShowMoreClicked=170]="ActivityFeedShowMoreClicked",e[e.BAPInfoBusinessPlatformClicked=171]="BAPInfoBusinessPlatformClicked",e[e.DummyTestEvent=172]="DummyTestEvent",e[e.SignUpClicked=173]="SignUpClicked",e[e.SignUpEmailProvided=174]="SignUpEmailProvided",e[e.SignInFromSignUpClicked=175]="SignInFromSignUpClicked",e[e.UserConsentDialogueShown=176]="UserConsentDialogueShown",e[e.UserConsentAcceptClicked=177]="UserConsentAcceptClicked",e[e.UserConsentCompleted=178]="UserConsentCompleted",e[e.UserConsentPrivacyAndCookiesClicked=179]="UserConsentPrivacyAndCookiesClicked",e[e.UserConsentTermsAndConditionsClicked=180]="UserConsentTermsAndConditionsClicked",e[e.InlineUserConsentDialogueShown=181]="InlineUserConsentDialogueShown",e[e.NotificationListAggregatedFailClicked=182]="NotificationListAggregatedFailClicked",e[e.NotificationListBrokenConnectionClicked=183]="NotificationListBrokenConnectionClicked",e[e.PageLoad=184]="PageLoad",e[e.FacebookShareClicked=185]="FacebookShareClicked",e[e.TwitterShareClicked=186]="TwitterShareClicked",e[e.EmailShareClicked=187]="EmailShareClicked",e[e.SupportGuidedLearningClicked=188]="SupportGuidedLearningClicked",e[e.SupportSamplesClicked=189]="SupportSamplesClicked",e[e.SupportDocumentationClicked=190]="SupportDocumentationClicked",e[e.SupportCommunityClicked=191]="SupportCommunityClicked",e[e.SupportSubmitIdeaClicked=192]="SupportSubmitIdeaClicked",e[e.SupportContactSupportClicked=193]="SupportContactSupportClicked",e[e.ContactSupportCommunityClicked=194]="ContactSupportCommunityClicked",e[e.ContactSupportAssistedClicked=195]="ContactSupportAssistedClicked",e[e.ContactSupportAdminClicked=196]="ContactSupportAdminClicked",e[e.BillingDialogShown=197]="BillingDialogShown",e[e.BillingAdminDialogForMyTeamClicked=198]="BillingAdminDialogForMyTeamClicked",e[e.BillingAdminDialogJustMeClicked=199]="BillingAdminDialogJustMeClicked";e[e.BillingDialogLearnMoreClicked=200]="BillingDialogLearnMoreClicked",e[e.BillingDialogRedirectToSignupClicked=201]="BillingDialogRedirectToSignupClicked",e[e.BillingDialogSignInWithOrgClicked=202]="BillingDialogSignInWithOrgClicked",e[e.BillingDialogTermAndConditionsClicked=203]="BillingDialogTermAndConditionsClicked",e[e.BillingDialogTrialExtensionRequestClicked=204]="BillingDialogTrialExtensionRequestClicked",e[e.FreePlanChoosePlanClicked=205]="FreePlanChoosePlanClicked",e[e.FreeTrialExpiredDialogDowngradeClicked=206]="FreeTrialExpiredDialogDowngradeClicked",e[e.FreeTrialExpiredDialogExtendTrialClicked=207]="FreeTrialExpiredDialogExtendTrialClicked",e[e.FreeTrialExpiredDialogPurchaseProClicked=208]="FreeTrialExpiredDialogPurchaseProClicked",e[e.IndividualPurchaseNotSupportedStartTrialClicked=209]="IndividualPurchaseNotSupportedStartTrialClicked",e[e.P1PlanPurchaseClicked=210]="P1PlanPurchaseClicked",e[e.P2PlanPurchaseClicked=211]="P2PlanPurchaseClicked",e[e.P1PlanStartTrialClicked=212]="P1PlanStartTrialClicked",e[e.P2PlanStartTrialClicked=213]="P2PlanStartTrialClicked",e[e.P1PlanExtendTrialClicked=214]="P1PlanExtendTrialClicked",e[e.P2PlanExtendTrialClicked=215]="P2PlanExtendTrialClicked",e[e.PremiumRequiredDialogOkClicked=216]="PremiumRequiredDialogOkClicked",e[e.StartFreeTrialDialogCancelClicked=217]="StartFreeTrialDialogCancelClicked",e[e.StartFreeTrialDialogStartTrialClicked=218]="StartFreeTrialDialogStartTrialClicked",e[e.TrialDialogOfficePortalSignupClicked=219]="TrialDialogOfficePortalSignupClicked",e[e.TrialDialogOfficePortalSignupDismissed=220]="TrialDialogOfficePortalSignupDismissed",e[e.TrialDialogOfficePortalSignupCompleted=221]="TrialDialogOfficePortalSignupCompleted",e[e.UpgradeToProDialogForMyTeamClicked=222]="UpgradeToProDialogForMyTeamClicked",e[e.UpgradeToProDialogJustMeClicked=223]="UpgradeToProDialogJustMeClicked",e[e.FeatureBlockedOnDeveloperEnvironmentOKClicked=224]="FeatureBlockedOnDeveloperEnvironmentOKClicked",e[e.PricingPageComparePlansClicked=225]="PricingPageComparePlansClicked",e[e.CommunityPlanInformationClicked=226]="CommunityPlanInformationClicked",e[e.EnvironmentPickerEnvironmentClicked=227]="EnvironmentPickerEnvironmentClicked",e[e.ApiCarouselNextFlipperClicked=228]="ApiCarouselNextFlipperClicked",e[e.ApiCarouselPreviousFlipperClicked=229]="ApiCarouselPreviousFlipperClicked",e[e.TestimonialCarouselNextFlipperClicked=230]="TestimonialCarouselNextFlipperClicked",e[e.TestimonialCarouselPreviousFlipperClicked=231]="TestimonialCarouselPreviousFlipperClicked",e[e.OneClickTemplateCreate=232]="OneClickTemplateCreate",e[e.HowFlowWorksVideoPlayed=233]="HowFlowWorksVideoPlayed",e[e.RunFlowContentCancelButtonClicked=234]="RunFlowContentCancelButtonClicked",e[e.RunFlowContentRunFlowButtonClicked=235]="RunFlowContentRunFlowButtonClicked",e[e.RunFlowContentDoneButtonClicked=236]="RunFlowContentDoneButtonClicked",e[e.DeleteFlowDialogCancelButtonClicked=237]="DeleteFlowDialogCancelButtonClicked",e[e.DeleteFlowDialogDeleteButtonClicked=238]="DeleteFlowDialogDeleteButtonClicked",e[e.FlowSaveAsDialogSaveButtonClicked=239]="FlowSaveAsDialogSaveButtonClicked",e[e.FlowSaveAsDialogCancelButtonClicked=240]="FlowSaveAsDialogCancelButtonClicked",e[e.TrialExpiredPageShown=241]="TrialExpiredPageShown",e[e.TrialExpiredBuyButtonClicked=242]="TrialExpiredBuyButtonClicked",e[e.TrialExpiredLearnMoreClicked=243]="TrialExpiredLearnMoreClicked",e[e.TrialExpiredExtendClicked=244]="TrialExpiredExtendClicked",e[e.TrialExpiredExtendCancelled=245]="TrialExpiredExtendCancelled",e[e.TrialExpiredExtendSubmitted=246]="TrialExpiredExtendSubmitted",e[e.LandingSectinHowItWorksVideoPlayed=247]="LandingSectinHowItWorksVideoPlayed",e[e.TemplateTileTemplateShown=248]="TemplateTileTemplateShown",e[e.TemplateTileInitFailed=249]="TemplateTileInitFailed",e[e.TemplateTileAddButtonClicked=250]="TemplateTileAddButtonClicked",e[e.TemplateTileLearnMoreLinkClicked=251]="TemplateTileLearnMoreLinkClicked",e[e.TemplateTileEmailLinkButtonClicked=252]="TemplateTileEmailLinkButtonClicked",e[e.TemplateTileManageButtonClicked=253]="TemplateTileManageButtonClicked",e[e.TemplateTileRetryButtonClicked=254]="TemplateTileRetryButtonClicked",e[e.TemplateTileBrowseButtonClicked=255]="TemplateTileBrowseButtonClicked",e[e.TemplateLandingLiteCreateButtonClicked=256]="TemplateLandingLiteCreateButtonClicked",e[e.DebugViewSummaryPaneOpened=257]="DebugViewSummaryPaneOpened",e[e.DebugViewSummaryPaneDataLoadCompleted=258]="DebugViewSummaryPaneDataLoadCompleted",e[e.DebugViewSummaryPaneClientSupportLinkClicked=259]="DebugViewSummaryPaneClientSupportLinkClicked",e[e.DebugViewSummaryPaneCommunityLinkClicked=260]="DebugViewSummaryPaneCommunityLinkClicked",e[e.DebugViewSummaryPaneServerSupportLinkClicked=261]="DebugViewSummaryPaneServerSupportLinkClicked",e[e.MobileDownloadGoToAppleStore=262]="MobileDownloadGoToAppleStore",e[e.MobileDownloadGoToGoogleStore=263]="MobileDownloadGoToGoogleStore",e[e.MobileDownloadEmailMeClicked=264]="MobileDownloadEmailMeClicked",e[e.MobileBannerInRunsTileShown=265]="MobileBannerInRunsTileShown",e[e.MobileBannerTileShown=266]="MobileBannerTileShown",e[e.MobileBannerTileCloseClicked=267]="MobileBannerTileCloseClicked",e[e.MobileBannerTileEmailMeLinkClicked=268]="MobileBannerTileEmailMeLinkClicked",e[e.RunOnlyTileSeeAllClicked=269]="RunOnlyTileSeeAllClicked",e[e.RunOnlyTileAddPersonClicked=270]="RunOnlyTileAddPersonClicked",e[e.RunOnlyPaneSaveClicked=271]="RunOnlyPaneSaveClicked",e[e.RunOnlyPaneCancelClicked=272]="RunOnlyPaneCancelClicked",e[e.RunOnlyPaneCloseClicked=273]="RunOnlyPaneCloseClicked",e[e.RunOnlyPaneDeleteAddedUserClicked=274]="RunOnlyPaneDeleteAddedUserClicked",e[e.RunOnlyPaneAddAddedUserClicked=275]="RunOnlyPaneAddAddedUserClicked",e[e.RunOnlyPaneDeletePendingToAddUserClicked=276]="RunOnlyPaneDeletePendingToAddUserClicked",e[e.RunOnlyPaneModifyConnectionSelectClicked=277]="RunOnlyPaneModifyConnectionSelectClicked",e[e.RunOnlyPaneModifyConnectionModalCancelClicked=278]="RunOnlyPaneModifyConnectionModalCancelClicked",e[e.SettingsPaneUpdateSettingsClicked=279]="SettingsPaneUpdateSettingsClicked",e[e.HomePageMarketingCollectionClicked=280]="HomePageMarketingCollectionClicked",e[e.HomePageHRCollectionClicked=281]="HomePageHRCollectionClicked",e[e.HomePageSoftwareCollectionClicked=282]="HomePageSoftwareCollectionClicked",e[e.HomePageEducationCollectionClicked=283]="HomePageEducationCollectionClicked",e[e.TemplateCollectionViewPreviousCollectionClicked=284]="TemplateCollectionViewPreviousCollectionClicked",e[e.TemplateCollectionViewNextCollectionClicked=285]="TemplateCollectionViewNextCollectionClicked",e[e.TemplateCollectionHeroBreadcrumbClickedClicked=286]="TemplateCollectionHeroBreadcrumbClickedClicked",e[e.TemplateCollectionsCarouselPreviousFlipperClicked=287]="TemplateCollectionsCarouselPreviousFlipperClicked",e[e.TemplateCollectionsCarouselNextFlipperClicked=288]="TemplateCollectionsCarouselNextFlipperClicked",e[e.TemplateCollectionSeeMoreClicked=289]="TemplateCollectionSeeMoreClicked",e[e.TemplateCollectionLetUsKnowClicked=290]="TemplateCollectionLetUsKnowClicked",e[e.EditFlowDetailsSave=291]="EditFlowDetailsSave"}(t.TelemetryEventNames||(t.TelemetryEventNames={}));!function(e){e[e.Connections=0]="Connections",e[e.Flows=1]="Flows"}(t.TelemetryScreenNames||(t.TelemetryScreenNames={})),t.TelemetryEventStatus={succeeded:"Succeded",failed:"Failed",canceled:"Canceled",timedout:"Timedout"},t.TelemetryAttributes={CreateNew:"CreateNew"},t.WedcsTelemetryNames={SignUpAADEmail:"flow-sign-up-aad-email",SignUpBlockedEmail:"flow-blocked-email",SignUpClick:"flow-signup-free",SignUpConsumerEmail:"flow-consumer-email",SignUpEmptyEmail:"flow-empty-email",SignUpInvalidEmail:"flow-signup-invalid-email",SignUpNavigateExternal:"flow-sign-up-navigate-external",SignUpNavigateInternal:"flow-sign-up-navigate-internal"}},function(e,t,i){"use strict";function r(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return n[255&e]+n[e>>8&255]+n[e>>16&255]+n[e>>24&255]+"-"+(n[255&t]+n[t>>8&255])+"-"+n[t>>16&15|64]+n[t>>24&255]+"-"+(n[63&i|128]+n[i>>8&255])+"-"+n[i>>16&255]+n[i>>24&255]+"-"+(n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255])}Object.defineProperty(t,"__esModule",{value:!0});for(var n=[],o=0;o<256;o++)n[o]=(o<16?"0":"")+o.toString(16);t.uuid=r},function(e,t,i){"use strict";function r(e){return e&&e.properties&&e.properties.policies&&e.properties.policies.calendarMonthFlowRunLimit?e.properties.policies.calendarMonthFlowRunLimit:k}function n(e){return e&&e.properties&&e.properties.policies&&e.properties.policies.maximumRecurrenceFrequency?e.properties.policies.maximumRecurrenceFrequency:O}function o(e,t){if(!e||!e.properties||!e.properties.assignedTime){return A.toISOString(new Date((new Date).getTime()-2592e6)).split("T")[0]+"T00:00:00Z"}var i,r,n,o=/(\d+)-(\d+)-(\d+)T.+/,s=e.properties.assignedTime.match(o),a=t.match(o),l=Number(s[3]),c=Number(a[1]),u=Number(a[2]),p=Number(a[3]);return p>=l?(n=l,r=u,i=c):(r=u-1,0===r&&(r=12),n=Math.min(l,I[r]),i=r>u?c-1:c),i+"-"+(r<10?0:"")+r+"-"+(n<10?0:"")+n+"T00:00:00Z"}function s(e){var i=e&&e.properties&&e.properties.definition&&e.properties.definition.triggers,r=i?Object.keys(e.properties.definition.triggers)[0]:void 0,n=i?e.properties.definition.triggers[r].recurrence:void 0;return n||t.NonRecurringFlowFrequency}function a(e,i){var r=s(i),o=n(e);return E.equalsIgnoreCase(r.frequency,t.RecurrenceFrequency.second)?r.interval>=o:!E.equalsIgnoreCase(r.frequency,t.RecurrenceFrequency.minute)||r.interval>=g(o)}function l(e){return p(e)||u(e)}function c(e){return e&&e.properties&&e.properties.isTrial&&e.properties.licenseSku!==t.planLicenseSku.free}function u(e){return e&&e.properties&&(E.equalsIgnoreCase(e.properties.licenseSku,t.planLicenseSku.o365)||E.equalsIgnoreCase(e.properties.licenseSku,t.planLicenseSku.d365))}function p(e){return!e||!e.properties||E.equalsIgnoreCase(e.properties.licenseSku,t.planLicenseSku.free)}function d(e){return(Date.parse(e.properties.expirationTime)<Date.now()||E.equalsIgnoreCase(e.properties.capabilityStatus,t.planCapabilityStatus.expired))&&c(e)}function g(e){return e/60}function m(e){return e/60/60}function f(e){return e/60/60/24}function h(e){return new Promise(function(t,i){v(e).then(function(e){if(e){var i=y(e);t(i)}else t(null)}).catch(function(e){i(e)})})}function v(e){var t=R.getAppSettings(),i=T.format("{0}/servicePlans?api-version={1}",t.processSimpleManagementUri,t.processSimpleResourceProviderApiVersionWithEnvironments);return new Promise(function(t,r){P.default({method:"GET",url:i,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}).then(function(e){t(e)},function(e,t,i){N.LoggingService.instance.logError(F.ProfilingEventNames.userPlansRetrievalFailed,i),r(i)})})}function y(e){if(D.isNullOrUndefined(e))return new Array;e.forEach(function(e){e.isCurrent=!1});var i=w(e),r=C(i),n=S(i),o=!D.isNullOrUndefined(n)&&(D.isNullOrUndefined(r)||n.properties.licenseSku>r.properties.licenseSku),s=D.isNullOrUndefined(r)||r.properties.licenseSku===t.planLicenseSku.free,a=o&&s?n:r;return D.isNullOrUndefined(a)||(a.isCurrent=!0),e}function w(e){return D.isNullOrUndefined(e)?null:e.filter(function(e){return e.properties&&e.properties.serviceType===R.getAppSettings().plansFlowServiceType&&e.properties&&e.properties.licenseSku!==t.planLicenseSku.dev})}function C(e){var i=w(e);if(D.isNullOrUndefined(i))return null;var r=i.filter(function(e){return e.properties&&E.equalsIgnoreCase(e.properties.capabilityStatus,t.planCapabilityStatus.enabled)}).sort(function(e,i){return(t.LicenseSkuValues[e.properties.licenseSku.toLowerCase()]||0)>(t.LicenseSkuValues[i.properties.licenseSku.toLowerCase()]||0)?-1:1});return r.length>0?r[0]:null}function S(e){var i=w(e);if(D.isNullOrUndefined(i))return null;var r=i.filter(function(e){return d(e)&&c(e)}).sort(function(e,i){return(t.LicenseSkuValues[e.properties.licenseSku.toLowerCase()]||0)>(t.LicenseSkuValues[i.properties.licenseSku.toLowerCase()]||0)?-1:1});return r.length>0?r[0]:null}function b(e){return{interval:g(n(e)),frequency:t.RecurrenceFrequency.minute}}Object.defineProperty(t,"__esModule",{value:!0});var P=i(109),R=i(9),T=i(1),E=i(8),A=i(78),D=i(1),F=i(29),N=i(4);t.planCapabilityStatus={enabled:"enabled",disabled:"disabled",expired:"expired"},t.planLicenseSku={free:"Free",o365:"SeededO365",d365:"SeededD365",p1:"P1",p2:"P2",dev:"Dev"},t.LicenseSkuValues={notspecified:0,free:1,seededo365:2,seededd365:3,p1:4,p2:5},t.RecurrenceFrequency={second:"Second",minute:"Minute",hour:"Hour",day:"Day"};var I=[null,31,28,31,30,31,30,31,31,30,31,30,31];t.DESIGNER_INVALID_SKU_ERROR_CODE="DefinitionInvalidForSKU";var O=-1;t.NonRecurringFlowFrequency={frequency:t.RecurrenceFrequency.second,interval:1/0};var k=750;t.monthlyFlowRunAllotment=r,t.getMaxFlowFrequencyInSeconds=n,t.getStartOfBillingPeriod=o,t.getFlowRecurrence=s,t.isValidRecurrence=a,t.isFreePlan=l,t.isTrial=c,t.isSeeded365=u,t.isFreeNotSeededPlan=p,t.isExpired=d,t.recurrenceToMinutes=g,t.recurrenceToHours=m,t.recurrenceToDays=f,t.getFilteredAndSelectedPlans=h,t.getPlansFromRP=v,t.filterAndSetCurrentPlan=y,t.getCurrentEnabledPlan=C,t.getPlanDefaultRecurrence=b},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.initialized=!1,this.func=e}return Object.defineProperty(e.prototype,"value",{get:function(){if(this.initialized){if(this.cachedError)throw this.cachedError;return this.cachedValue}try{return this.cachedValue=this.func(),this.cachedValue}catch(e){throw this.cachedError=e,e}finally{this.initialized=!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValueCreated",{get:function(){return this.initialized},enumerable:!0,configurable:!0}),e}();t.Lazy=r},function(e,t,i){"use strict";function r(e,t){var i,r=""+e;return r&&t&&(i=n.equalsIgnoreCase(r.substring(0,t.length),t)),i}Object.defineProperty(t,"__esModule",{value:!0});var n=i(8);t.startsWithIgnoreCase=r},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0}),r(i(139)),r(i(329)),r(i(330)),r(i(331)),r(i(332))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(109),n=i(1),o=i(9),s=i(4),a=i(66),l=i(144),c=i(23),u=i(50),p=i(8),d=i(29),g=i(1),m=i(397),f=i(39),h=i(14),v=i(20),y=i(398),w=i(15);t.UserType={MicrosoftAccount:"MicrosoftAccount",ActiveDirectory:"ActiveDirectory"};var C=function(){function e(e,t,i,r){var n=this;this.appSettings=e,this.jwtTokenHelper=t,this.loggingService=i,this.hostCommunicationService=r,this.cachedTokens={};var o=this.getUserSession();o.userInfo&&(this.cachedTokens[this.appSettings.authResource]=o.userInfo.accessToken),this.getTokenGivenAuthToken=this.getTokenGivenAuthToken.bind(this),this.validateOnBehalfOfTokenBundle=this.validateOnBehalfOfTokenBundle.bind(this),this.cacheOnBehalfOfTokenBundle=this.cacheOnBehalfOfTokenBundle.bind(this);var s=this;this.sessionInfoRetrievalPromise=new Promise(function(t,i){e.isWidgetPage&&e.widgetInfo&&e.widgetInfo.widgetType!==h.WidgetType.logicAppsCustomApi&&(e.featureFlags.enableWidgetEdit||e.featureFlags.enableWidgetCreateFromTemplate)?n.getToken(e.authResource).then(function(e){return n.populateSessionInfoUsingAccessToken(e)}).then(function(){var e=n.getUserSession();if(e&&e.userInfo){a.AnalyticsService.instance.setContextData({objectId:e.userInfo.uniqueId,tenantId:e.userInfo.tenantId,puid:e.userInfo.puid})}t()}).catch(function(e){s.loggingService.logError(d.ProfilingEventNames.embedSessionInfoRetrievalFailed,e),i(e),n.sessionInfoRetrievalPromise.catch(function(){})}):t()}),this.sessionInfoRetrievalPromise.then(function(){e.isWidgetPage&&e.widgetInfo&&e.widgetInfo.widgetType!==h.WidgetType.logicAppsCustomApi&&g.isNullOrWhitespace(v.getCurrentEnvironmentName())&&n.getDefaultEnvironmentName().then(function(e){var t=y.addEnvironmentToUrl(n.getCurrentUrl(),e);t!==n.getCurrentUrl()&&n.navigateToUrl(t)}).catch(function(e){s.loggingService.logError(d.ProfilingEventNames.embedDefaultEnvironmentRetrievalFailed,e)})})}return Object.defineProperty(e,"instance",{get:function(){return e.sessionService},enumerable:!0,configurable:!0}),e.prototype.getCurrentUrl=function(){return window.location.href},e.prototype.navigateToUrl=function(e){window.location.replace(e)},e.prototype.getDefaultEnvironmentName=function(){var e=this;return new Promise(function(t,i){r.default({method:"GET",url:e.appSettings.processSimpleResourceProviderManagementEndpoint+(e.appSettings.processSimpleResourceProviderPath+"/environments?api-version=")+e.appSettings.processSimpleResourceProviderApiVersionWithEnvironments,headers:{Authorization:"Bearer "+e.getUserInfo().accessToken,"Content-Type":"application/json"}}).then(function(e){var r=e.value,n=r.filter(function(e){return e.properties.isDefault}),o=n.length>0?n[0]:r[0];g.isNullOrUndefined(o)||g.isNullOrWhitespace(o.name)?i(new w.ClientError(w.ErrorCodes.widgetUnableToGetEnvironment,"Unable to get environment",void 0)):t(o.name)},function(e,t,r){i(r)})})},e.prototype.getToken=function(e){return this.appSettings.isWidgetPage?this.getTokenForWidget(e):this.getTokenForPortal(e)},e.prototype.cacheToken=function(e){var t=this;return function(i){return t.cachedTokens[e]=i,i}},e.prototype.validateTokenFromHost=function(e){return function(t){return t?Promise.resolve(t):(s.LoggingService.instance.logInfo(d.ProfilingEventNames.hostReturnedNullAuthToken,"Received success status but null token from host for resource "+e),Promise.reject(new Error("Received success status but null token from host for resource "+e)))}},e.prototype.validateTokenFromOnBehalfOfTokenBundle=function(e){return function(t){return t?Promise.resolve(t):(s.LoggingService.instance.logWarning(d.ProfilingEventNames.onBehalfOfTokenBundleLackingRequestedResource,"Failed to find token for resource "+e+" in cached bundle"),Promise.reject(new Error("Failed to find token for resource "+e+" in cached bundle")))}},e.prototype.getTokenForWidget=function(e){this.getTokenFromCache(this.appSettings.authResource);if(e===this.appSettings.authResource||!this.appSettings.featureFlags.enableOnBehalfOfTokens||!this.appSettings.widgetInfo.enableOnBehalfOfTokens)return this.getTokenFromHost(e);var t=this.getTokenFromCache(e),i=!!t&&this.jwtTokenHelper.isTokenExpired(t,this.appSettings.tokenRefreshSkew);return t&&!i?Promise.resolve(t):this.onBehalfOfTokenBundleFetched&&!t?this.validateTokenFromOnBehalfOfTokenBundle(e)(t):this.getTokenFromHost(this.appSettings.authResource).then(this.getTokenGivenAuthToken(e))},e.prototype.cacheOnBehalfOfTokenBundle=function(e){var t=this;Object.keys(e.audienceToToken).forEach(function(i){return t.cacheToken(i)(e.audienceToToken[i])})},e.prototype.getTokenGivenAuthToken=function(e){var t=this,i=this;return function(r){var n=i.isFlowAudienceToken(r);return n||s.LoggingService.instance.logWarning(d.ProfilingEventNames.onBehalfOfTokenBundleRetrievalBypassedForNonFlowAuthToken,"Bypassing fetch of on-behalf-of token bundle because auth token audience is not flow"),n?t.getOnBehalfOfTokenBundleFromRpPromise(r).then(i.validateOnBehalfOfTokenBundle).then(i.cacheOnBehalfOfTokenBundle).then(function(){return i.getTokenFromCache(e)}).then(i.validateTokenFromOnBehalfOfTokenBundle(e)):t.getTokenFromHost(e)}},e.prototype.isFlowAudienceToken=function(e){var t=this.jwtTokenHelper.extractJwtTokenPayload(e).aud;return!!t&&"https://service.flow.microsoft.com"===this.trimResource(t)},e.prototype.trimResource=function(e){return e&&"string"==typeof e&&e.length>0&&e.lastIndexOf("/")===e.length-1?e.slice(0,-1):e},e.prototype.getTokenFromCache=function(e){var t=this.trimResource(e);return this.cachedTokens[t]||this.cachedTokens[t+"/"]},e.prototype.getTokenFromHost=function(e){var t=this,i={resource:e};return new Promise(function(r,n){t.hostCommunicationService.getDataFromHostEvent(c.WidgetHostAction.GETACCESSTOKEN,i).then(function(e){return e.token}).then(t.validateTokenFromHost(e)).then(function(e){return r(e)}).catch(function(e){n(e)})})},e.prototype.getTokenForPortal=function(e){var t=this;return new Promise(function(i,r){t.refreshSessionIfExpired().then(function(){t.cachedTokens[e]&&!t.jwtTokenHelper.isTokenExpired(t.cachedTokens[e],t.appSettings.tokenRefreshSkew)?i(t.cachedTokens[e]):t.refreshAudienceToken(e).then(function(r){t.cachedTokens[e]=r,i(r)}).catch(function(e){t.loggingService.logError("SessionService.GetToken.RefreshToken",e),r(e)})}).catch(function(e){t.loggingService.logError("SessionService.GetToken",e),r(e)})})},e.prototype.getOnBehalfOfTokenBundleFromRpPromise=function(e){var t=this,i=g.format("{0}/users/me/onBehalfOfTokenBundle?api-version={1}",this.appSettings.processSimpleManagementUri,this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments);return new Promise(function(n,o){r.default({method:"POST",url:i,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}).then(function(e){t.onBehalfOfTokenBundleFetched=!0,n(e)},function(e,t,i){s.LoggingService.instance.logError(d.ProfilingEventNames.onBehalfOfTokenBundleRetrievalFailed,i),o(i)})})},e.prototype.validateOnBehalfOfTokenBundle=function(e){return e?Promise.resolve(e):Promise.reject(new Error("Received success status but null onBehalfOfTokenBundle from RP"))},e.prototype.getUserInfo=function(){return this.getUserSession().userInfo||null},Object.defineProperty(e.prototype,"isConsumerDomain",{get:function(){return this.isAuthenticated&&p.equalsIgnoreCase(this.getUserSession().userInfo.userType,t.UserType.MicrosoftAccount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOrgId",{get:function(){return this.isAuthenticated&&!this.isConsumerDomain},enumerable:!0,configurable:!0}),e.prototype.getUserSessionAsync=function(){var e=this;return this.sessionInfoRetrievalPromise.then(function(){return e.getUserSession()})},e.prototype.getUserSession=function(){return window.sessionInfo||null},e.prototype.populateSessionInfoUsingAccessToken=function(e){if(!this.appSettings.isWidgetPage)throw new Error("Populating SessionInfo from AccessToken is only supported in embed widget scenarios");var t=this;return new Promise(function(i,r){if(g.isNullOrUndefined(window.sessionInfo)||g.isNullOrUndefined(window.sessionInfo.userConsented)){var o=t.getUserInfoFromAccessToken(e),s=m.getUserConsentedStatus(e),a=f.getFilteredAndSelectedPlans(e);Promise.all([s,a]).then(function(e){var t=e[0],r=e[1],s={sessionId:n.generateGuid(),userInfo:o,isAuthenticated:!0,userConsented:t,environment:null,userPreferences:null,userServicePlans:r};window.sessionInfo=s,i()}).catch(function(e){r(e)})}else i()})},e.prototype.getUserInfoFromAccessToken=function(e){var i=this.jwtTokenHelper.extractJwtTokenPayload(e);return{accessToken:e,accessTokenType:"Bearer",tenantId:i.tid,displayName:i.upn||i.email,familyName:i.family_name,givenName:i.given_name,identityProvider:i.idp||i.iss,uniqueId:i.oid||i.sub,userType:i.tid===this.appSettings.msaCommonTenantId?t.UserType.MicrosoftAccount:t.UserType.ActiveDirectory,puid:null}},Object.defineProperty(e.prototype,"isAuthenticated",{get:function(){return!!this.getUserSession().isAuthenticated},enumerable:!0,configurable:!0}),e.prototype.signIn=function(){window.location.replace("/signin/")},e.prototype.signOut=function(){window.location.replace("/signout/")},e.prototype.hasUserConsented=function(){return this.getUserSession().userConsented},e.prototype.setUserConsent=function(){this.getUserSession().userConsented=!0},e.prototype.refreshSessionIfExpired=function(){var e=this;return new Promise(function(t,i){e.jwtTokenHelper.isTokenExpired(e.getUserSession().userInfo.accessToken,e.appSettings.tokenRefreshSkew)?e.refreshSession().then(function(i){sessionInfo=i,e.cachedTokens[e.appSettings.authResource]=sessionInfo.userInfo.accessToken,t(!0)}).catch(function(t){e.loggingService.logError("SessionService.GetToken",t),i(),e.signIn()}):t(!0)})},e.prototype.refreshAudienceToken=function(e){var t=this,i=n.format("/refreshtoken/?audience={0}",encodeURIComponent(e));return new Promise(function(e,n){r.default({method:"POST",url:i,headers:{Authorization:"Bearer "+t.getUserSession().userInfo.accessToken,"Content-Type":"application/json"}}).then(function(t){e(t)},function(e,t,i){n(i)})})},e.prototype.refreshSession=function(){var e=this;return new Promise(function(t,i){r.default({method:"POST",url:"/refresh/",headers:{Authorization:"Bearer "+e.getUserSession().userInfo.accessToken,"Content-Type":"application/json"}}).then(function(e){t(e)},function(e,t,r){i(r)})})},e.sessionService=new e(o.getAppSettings(),new l.JwtTokenService,s.LoggingService.instance,u.HostCommunicationService.instance),e}();t.SessionService=C},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(142),o=i(18),s=i(23),a=i(10),l=i(7),c=i(1),u=i(15),p=i(3),d=i(8),g=i(4),m=i(5);t.FilterNames={allRuns:"allRuns",successfulRuns:"succeeded",pausedRuns:"paused",runningRuns:"running",waitingRuns:"waiting",skippedRuns:"skipped",suspendedRuns:"suspended",cancelledRuns:"cancelled",failedRuns:"failed",failedTriggers:"failedTriggers",faultedRuns:"faulted",timedOutRuns:"timedOut",abortedRuns:"aborted",ignoredRuns:"ignored",invalid:"invalid"};var f=function(){function e(e,i,r,n,s,m,f,h,v,y,w,C){var S=this;this.$q=e,this.$routeParams=i,this.$scope=r,this.appSettings=n,this.clientResources=s,this.flowTriggerHistoriesClient=m,this.flowRunsClient=f,this.flowRunsHistoryCsvDownloadService=h,this.flowsClient=v,this.loggingService=y,this.navigationService=w,this.urlService=C,this.errorAlert={type:a.AlertType.None,message:"",options:{}},this.backButton={url:this.urlService.flowsRoute()},this.headingLinks=[];var b=this.loggingService.profilePageStart(g.ProfilingEventNames.flowRunsHistoryLoadStart);if(this.flowName=i.flowName||null,this.filter=i.filter||null,this.backUrl=i.backUrl||null,this.backUrl&&(this.backButton.url=this.backUrl),this.appSettings.featureFlags.enableDownloadFlowRunsHistoryCsv&&this.setupDownloadFlowRunsHistoryCsvLink(),this.allowableFilters=[t.FilterNames.successfulRuns,t.FilterNames.runningRuns,t.FilterNames.failedRuns,t.FilterNames.skippedRuns,t.FilterNames.faultedRuns,t.FilterNames.ignoredRuns,t.FilterNames.pausedRuns,t.FilterNames.cancelledRuns,t.FilterNames.abortedRuns,t.FilterNames.failedTriggers,t.FilterNames.allRuns].map(function(e){return e.toLowerCase()}),!this.filter||this.allowableFilters&&$.inArray(this.filter.toLowerCase(),this.allowableFilters)<0)return void this.navigationService.navigate(this.urlService.flowRunsRoute({flowName:this.flowName}),{filter:t.FilterNames.allRuns,backUrl:this.backUrl});this.flowRunList={id:"flowRuns",filter:this.filter,flowName:this.flowName,flowTriggerHistoriesWithRun:void 0,flowRuns:void 0,flowTriggerHistoryFilter:function(e){return S.filterFlowTriggerHistoryWithRun(e)},flowRunFilter:function(e){return S.filterFlowRun(e)},spinner:{size:l.SpinnerSize.Large,show:!0,local:l.SpinnerPosition.Local},loadingMoreSpinner:{size:l.SpinnerSize.Small,local:l.SpinnerPosition.LocalHorizontal},hasMore:function(){return S.flowRunList.flowTriggerHistoriesWithRun&&S.flowRunList.flowTriggerHistoriesWithRun.$hasNextPage()||S.flowRunList.flowRuns&&S.flowRunList.flowRuns.$hasNextPage()},isLoadingMore:!1,loadNextPage:function(){S.flowRunList.flowTriggerHistoriesWithRun&&S.flowRunList.flowTriggerHistoriesWithRun.$hasNextPage()?(S.flowRunList.isLoadingMore=!0,S.flowRunList.loadingMoreSpinner.show=!0,S.flowRunList.flowTriggerHistoriesWithRun.$getNextPage().finally(function(){S.flowRunList.isLoadingMore=!1,S.flowRunList.loadingMoreSpinner.show=!1})):S.flowRunList.flowRuns&&S.flowRunList.flowRuns.$hasNextPage()&&(S.flowRunList.isLoadingMore=!0,S.flowRunList.loadingMoreSpinner.show=!0,S.flowRunList.flowRuns.$getNextPage().finally(function(){S.flowRunList.isLoadingMore=!1,S.flowRunList.loadingMoreSpinner.show=!1}))}},this.fullPageErrorModel={isPageErrored:!1,pageTitle:this.clientResources.FlowRuns.GenericTitle};var P=o.getFlowId(this.flowName),R=this.flowsClient.get(this.$scope,{id:P});R.$promise.then(function(){if(d.equalsIgnoreCase(S.filter,t.FilterNames.skippedRuns)||d.equalsIgnoreCase(S.filter,t.FilterNames.failedTriggers)){if(R&&R.properties&&R.properties.definition&&R.properties.definition.triggers){var e=Object.keys(R.properties.definition.triggers||{})[0],i=S.getFilterString();if(e)return S.flowRunList.flowTriggerHistoriesWithRun=S.flowTriggerHistoriesClient.query(S.$scope,null===i?{flowName:S.flowName,flowTriggerName:e}:{flowName:S.flowName,flowTriggerName:e,$filter:i}),S.flowRunList.flowTriggerHistoriesWithRun.$promise}}else if(S.flowName){var i=S.getFilterString();return S.flowRunList.flowRuns=S.flowRunsClient.query(S.$scope,null===i?{flowName:S.flowName}:{flowName:S.flowName,$filter:i}),S.flowRunList.flowRuns.$promise}throw new u.ClientError(u.ErrorCodes.invalidFlowDefinition,S.clientResources.FlowRuns.Errors.InvalidFlowDefinition,null)}).then(function(){S.loggingService.profilePageEnd(b,g.ProfilingEventNames.flowRunsHistoryLoadEnd,{status:p.Status.Success})}).catch(function(e){S.loggingService.profilePageEnd(b,g.ProfilingEventNames.flowRunsHistoryLoadEnd,{status:p.inferErrorStatus(e),error:p.parseErrorMessage(e)}),S.loggingService.logError("FlowRunsCtrl.Constructor",e),p.showFullPageError(S.fullPageErrorModel,e)}).finally(function(){S.flowRunList.spinner.show=!1}),this.availableFilters=[{value:t.FilterNames.allRuns,displayName:s.FlowRuns.RunsFilter.AllRuns},{value:t.FilterNames.invalid,displayName:"----"},{value:t.FilterNames.successfulRuns,displayName:s.FlowRuns.RunsFilter.SuccessfulFlows},{value:t.FilterNames.failedRuns,displayName:s.FlowRuns.RunsFilter.FailedFlows},{value:t.FilterNames.runningRuns,displayName:s.FlowRuns.RunsFilter.RunningFlows},{value:t.FilterNames.cancelledRuns,displayName:s.FlowRuns.RunsFilter.CancelledFlows},{value:t.FilterNames.invalid,displayName:"----"},{value:t.FilterNames.skippedRuns,displayName:s.FlowRuns.RunsFilter.SkippedTriggers},{value:t.FilterNames.failedTriggers,displayName:s.FlowRuns.RunsFilter.FailedTriggers}],R.$watch(this.$scope,function(){S.title=c.format(S.clientResources.FlowRuns.Title,R&&R.properties&&R.properties.displayName||"")}),this.filterModel={filterSelected:this.filter,availableFilters:this.availableFilters,action:function(){return S.onFilterChange()}}}return e.prototype.refreshFlowRuns=function(){d.equalsIgnoreCase(this.filter,t.FilterNames.skippedRuns)||d.equalsIgnoreCase(this.filter,t.FilterNames.failedTriggers)?this.flowRunList&&this.flowRunList.flowTriggerHistoriesWithRun&&this.flowRunList.flowTriggerHistoriesWithRun.$refresh():this.flowRunList&&this.flowRunList.flowRuns&&this.flowRunList.flowRuns.$refresh()},e.prototype.onFilterChange=function(){this.filter=this.filterModel.filterSelected,this.flowRunList.filter=this.filter,this.navigationService.navigate(this.urlService.flowRunsRoute({flowName:this.flowName}),{filter:this.filter})},e.prototype.getFilterString=function(){if(this.filter){if(d.equalsIgnoreCase(this.filter,t.FilterNames.allRuns))return null;if(d.equalsIgnoreCase(this.filter,t.FilterNames.failedTriggers))return"Status eq 'failed'";var e=this.filter.toLowerCase();if(this.allowableFilters&&$.inArray(e,this.allowableFilters)>-1)return"Status eq '"+e+"'"}return null},e.prototype.filterFlowRun=function(e){var t=e&&e.properties&&e.properties.status;return this.filterByStatus(t)},e.prototype.filterFlowTriggerHistoryWithRun=function(e){var t=e&&e.properties&&e.properties.status,i=e&&e.properties&&e.properties.run&&e.properties.run.properties&&e.properties.run.properties.status;return this.filterByStatus(i||t)},e.prototype.filterByStatus=function(e){switch(this.filter){case t.FilterNames.failedRuns:return d.equalsIgnoreCase(e,s.Status.failed);case t.FilterNames.successfulRuns:return d.equalsIgnoreCase(e,s.Status.succeeded);case t.FilterNames.runningRuns:return d.equalsIgnoreCase(e,s.Status.running);default:return!0}},e.prototype.setupDownloadFlowRunsHistoryCsvLink=function(){this.flowRunsHistoryCsvDownloadLinkAsyncPollState=this.getDownloadLinkAsyncPollState(!1);var e=this;this.headingLinks.push({get label(){var t=e.flowRunsHistoryCsvDownloadLinkAsyncPollState.status;switch(t){case n.AsyncCachedPollStatus.NotStarted:case n.AsyncCachedPollStatus.Faulted:case n.AsyncCachedPollStatus.Cancelled:return e.clientResources.FlowRuns.GenerateCsv.Text;case n.AsyncCachedPollStatus.Running:return e.clientResources.FlowRuns.GeneratingCsv.Text;case n.AsyncCachedPollStatus.RanToCompletion:return e.clientResources.FlowRuns.DownloadCsv.Text;default:throw new Error("unknown AsyncCachedPollStatus: "+t)}},get image(){return m.default.import},get disabled(){return e.flowRunsHistoryCsvDownloadLinkAsyncPollState.status===n.AsyncCachedPollStatus.Running||!e.canDownloadCsv()},get hide(){return!e.canDownloadCsv()},get href(){return e.flowRunsHistoryCsvDownloadLinkAsyncPollState.status===n.AsyncCachedPollStatus.RanToCompletion?e.flowRunsHistoryCsvDownloadLinkAsyncPollState.result.downloadLink||e.flowRunsHistoryCsvDownloadLinkAsyncPollState.result.DownloadLink:"#"},get download(){return e.flowRunsHistoryCsvDownloadLinkAsyncPollState.status===n.AsyncCachedPollStatus.RanToCompletion},action:function(){return e.handleDownloadFlowRunsHistoryCsv()},button:!1})},e.prototype.getDownloadLinkAsyncPollState=function(e){return this.flowRunsHistoryCsvDownloadService.getDownloadLinkAsyncPollState({flowName:this.flowName,filter:this.filter,reset:e})},e.prototype.canDownloadCsv=function(){switch(this.filter){case t.FilterNames.successfulRuns:case t.FilterNames.failedRuns:case t.FilterNames.runningRuns:case t.FilterNames.cancelledRuns:case t.FilterNames.allRuns:return!0;default:return!1}},e.prototype.handleDownloadFlowRunsHistoryCsv=function(){var e=this;this.canDownloadCsv()&&this.flowRunsHistoryCsvDownloadLinkAsyncPollState.status!==n.AsyncCachedPollStatus.Running&&(this.errorAlert.message="",this.errorAlert.type=a.AlertType.None,this.flowRunsHistoryCsvDownloadLinkAsyncPollState.wait().catch(function(t){e.loggingService.logError("FlowRunsCtrl.handleDownloadFlowRunsHistoryCsv",t,{flowName:e.flowName,filter:e.filter}),e.errorAlert.message=p.parseErrorMessage(t),e.errorAlert.type=a.AlertType.Error,e.flowRunsHistoryCsvDownloadLinkAsyncPollState=e.getDownloadLinkAsyncPollState(!0)}))},e.$inject=[r.default.services.$q,r.default.services.$routeParams,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.flowTriggerHistoriesClient,r.default.services.flowRunsClient,r.default.services.flowRunsHistoryCsvDownloadService,r.default.services.flowsClient,r.default.services.logging,r.default.services.navigation,r.default.services.url],e}();t.FlowRunsCtrl=f},function(e,t){function i(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=i},function(e,t,i){"use strict";function r(e,r){var n=e.length>t.MaximiumIconsToRender?t.IconsToRenderWhenExcess:e.length;return v(i(463))({iconInfos:e.slice(0,n),className:"icon-set-"+Math.min(t.MaximiumIconsToRender,e.length),excessCount:e.length-n,shouldShowError:r,errorIcon:u.default.notificationError})}function n(e){var i=[];switch(e.properties.type){case h.FeedEventDefinitionType.AggregatedFail:case h.FeedEventDefinitionType.AggregatedSuccess:case h.FeedEventDefinitionType.PushNotification:case h.FeedEventDefinitionType.FlowSuspended:i=s(e.properties.object.flowDefinitionSummary,null);break;case h.FeedEventDefinitionType.BrokenConnection:i=[{iconUri:e.properties.object.iconUri,brandColor:t.ConnectionPlaceHolderBrandColor}]}return i}function o(e){return s(e.properties.definitionSummary,e.properties.connectionReferences)}function s(e,i){var r=[];if(e){var n=[a(e.triggers[0],f.DefaultIcon.Trigger,i)],o=e.actions?e.actions.filter(function(e){return p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.ApiApp)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.ApiConnection)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.ApiConnectionWebhook)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.Http)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.HttpWebhook)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.Manual)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.Recurrence)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.Request)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.Response)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.Wait)}).map(function(e){return a(e,f.DefaultIcon.Action,i)}):void 0,s=o?c(o):o;r=n.concat(s)}else r=[{iconUri:u.default.flowPlaceholder,brandColor:t.FlowPlaceHolderBrandColor}];return r}function a(e,i,r){if(e){if(p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.ApiConnection)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.ApiConnectionWebhook)||p.equalsIgnoreCase(e.type,m.FlowTemplateOperationType.Request)&&p.equalsIgnoreCase(e.kind,g.FlowTemplateOperationKind.ApiConnection)){if(e.api&&e.api.properties&&e.api.properties.iconUri&&e.api.properties.metadata&&e.api.properties.metadata&&e.api.properties.metadata.brandColor)return{brandColor:e.api.properties.metadata.brandColor,iconUri:e.api.properties.iconUri,onErrorImagePath:i};if(r){var n=d.getConnectionReference(e,r);return n&&n.api&&n.api.properties?{brandColor:n.api.properties.metadata.brandColor||t.DefaultBrandColor,iconUri:n.api.properties.iconUri,onErrorImagePath:i,displayName:n.api.properties.displayName}:{brandColor:n?n.brandColor:void 0,iconUri:n?n.iconUri:void 0,onErrorImagePath:i}}}var o=l(e.type,e.kind);return o.onErrorImagePath=i,o}return{brandColor:"#FFFFFF",iconUri:void 0,onErrorImagePath:i}}function l(e,t){switch(e){case m.FlowTemplateOperationType.Compose:return{brandColor:"#4D4F4F",iconUri:"/Content/Images/NativeTypes/compose.svg"};case m.FlowTemplateOperationType.Foreach:return{brandColor:"#4D4F4F",iconUri:"/Content/Images/NativeTypes/foreach.svg"};case m.FlowTemplateOperationType.Function:return{brandColor:"#3999C6",iconUri:"/Content/Images/NativeTypes/function.svg"};case m.FlowTemplateOperationType.Http:return{brandColor:"#FF8C00",iconUri:"/Content/Images/NativeTypes/http.svg"};case m.FlowTemplateOperationType.HttpWebhook:return{brandColor:"#7FBA00",iconUri:"/Content/Images/NativeTypes/webhook.svg"};case m.FlowTemplateOperationType.If:return{brandColor:"#4D4F4F",iconUri:"/Content/Images/NativeTypes/condition.svg"};case m.FlowTemplateOperationType.Join:return{brandColor:"#FFB900",iconUri:"/Content/Images/NativeTypes/join.svg"};case m.FlowTemplateOperationType.Manual:return{brandColor:"#742774",iconUri:"/Content/Images/NativeTypes/manual.svg"};case m.FlowTemplateOperationType.ParseJson:return{brandColor:"#6A69D6",iconUri:"/Content/Images/NativeTypes/parsejson.svg"};case m.FlowTemplateOperationType.Query:return{brandColor:"#F7894A",iconUri:"/Content/Images/NativeTypes/query.svg"};case m.FlowTemplateOperationType.Recurrence:return{brandColor:"#1F85FF",iconUri:"/Content/Images/NativeTypes/recurrence.svg"};case m.FlowTemplateOperationType.Request:if(t===g.FlowTemplateOperationKind.PowerApp)return{brandColor:"#742774",iconUri:"/Content/Images/NativeTypes/manual.svg"};if(t===g.FlowTemplateOperationKind.Http)return{brandColor:"#DD0735",iconUri:"/Content/Images/NativeTypes/request.svg"};if(t===g.FlowTemplateOperationKind.Button)return{brandColor:"#0077FF",iconUri:"/Content/Images/NativeTypes/button.svg"};break;case m.FlowTemplateOperationType.Response:return{brandColor:"#DD0735",iconUri:"/Content/Images/NativeTypes/response.svg"};case m.FlowTemplateOperationType.Scope:return{brandColor:"#4D4F4F",iconUri:"/Content/Images/NativeTypes/scope.svg"};case m.FlowTemplateOperationType.Select:return{brandColor:"#4D4F4F",iconUri:"/Content/Images/NativeTypes/select.svg"};case m.FlowTemplateOperationType.Switch:return{brandColor:"#63707E",iconUri:"/Content/Images/NativeTypes/switch.svg"};case m.FlowTemplateOperationType.Table:return{brandColor:"#00AE56",iconUri:"/Content/Images/NativeTypes/table.svg"};case m.FlowTemplateOperationType.Terminate:return{brandColor:"#E81124",iconUri:"/Content/Images/NativeTypes/terminate.svg"};case m.FlowTemplateOperationType.Until:return{brandColor:"#4D4F4F",iconUri:"/Content/Images/NativeTypes/until.svg"};case m.FlowTemplateOperationType.Wait:return{brandColor:"#4D4F4F",iconUri:"/Content/Images/NativeTypes/wait.svg"};case m.FlowTemplateOperationType.Workflow:return{brandColor:"#3C026B",iconUri:"/Content/Images/NativeTypes/workflow.svg"};case m.FlowTemplateOperationType.XmlValidation:return{brandColor:"#0078D7",iconUri:"/Content/Images/NativeTypes/xmlvalidation.svg"};case m.FlowTemplateOperationType.NotSpecified:default:return{brandColor:"#FFFFFF",iconUri:void 0}}return{brandColor:"#FFFFFF",iconUri:void 0}}function c(e){var t={};return e.filter(function(e){return!t[e.iconUri]&&(t[e.iconUri]=!0,!0)})}Object.defineProperty(t,"__esModule",{value:!0});var u=i(5),p=i(8),d=i(435),g=i(154),m=i(70),f=i(155),h=i(55),v=i(436);i(462),t.MaximiumIconsToRender=4,t.IconsToRenderWhenExcess=3,t.FlowPlaceHolderBrandColor="#E3E3E3",t.ConnectionPlaceHolderBrandColor="#E3E3E3",t.DefaultBrandColor="#FFFFFF",t.getIconsTemplate=r,t.getIconInfoForFeedEvent=n,t.getIconInfoForFlow=o,t.getIconInfoForFlowDefinitionSummary=s,t.getIconInfoForOperation=a,t.removeDuplicateIcons=c},function(e,t,i){"use strict";function r(e){return u.getAppSettings().processSimpleResourceProviderPath+"/galleries/"+e+"/templates"}function n(e,t){return u.getAppSettings().featureFlags.enableEnvironments?u.getAppSettings().processSimpleResourceProviderPath+"/environments/"+p.getCurrentEnvironmentName()+"/galleries/"+e+"/templates/"+t:u.getAppSettings().processSimpleResourceProviderPath+"/galleries/"+e+"/templates/"+t}function o(e,t){if(!t||""===t)return e;var i=t.toLowerCase().split(/\b\s+/);return e.filter(function(e){return i.some(function(t){var i=new RegExp(t);return!(!e.properties.displayName||!i.test(e.properties.displayName.toLowerCase()))||(!(!e.properties.description||!i.test(e.properties.description.toLowerCase()))||Object.keys(e.properties.connectionReferences).some(function(t){var r=e.properties.connectionReferences[t];return r&&r.api.properties.displayName&&i.test(r.api.properties.displayName.toLowerCase())}))})})}function s(e,t,i){if(u.getAppSettings().isWidgetPage){var r=t?"?"+t:"";return $.get("/"+u.getAppSettings().locale+"/widgets/templates/"+e+"/"+r,i)}return $.get("/"+u.getAppSettings().locale+"/views/templates/recommended/publish/"+e+"/",i)}function a(e){return $.get("/"+u.getAppSettings().locale+"/views/templates/oneclickhero/",e)}function l(e){return $.get("/"+u.getAppSettings().locale+"/views/templates/oneclickapprovalflow/",e)}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var c=i(0),u=i(9),p=i(20);t.TemplatesConstant={urlPath:u.getAppSettings().processSimpleResourceProviderPath+"/galleries/:galleryName/templates",resourceType:u.getAppSettings().processSimpleResourceProviderPath+"/galleries/templates"},t.getGalleryTemplatesId=r,t.getTemplateId=n,t.getMatchingTemplates=o,t.getRecommendedTemplatesViewForPublishFlow=s,t.getOneClickHeroTemplatesView=a,t.getOneClickApprovalFlowTemplatesView=l,angular.module(c.default.modules.processSimpleData).factory(c.default.services.templatesClient,[c.default.services.$rootScope,c.default.services.azureResourceClientFactory,c.default.services.appSettings,function(e,i,r){var o=i({resourceType:t.TemplatesConstant.resourceType,urlPath:t.TemplatesConstant.urlPath,apiVersion:r.featureFlags.enableEnvironments?r.processSimpleResourceProviderApiVersionWithEnvironments:r.processSimpleResourceProviderApiVersion,rest:{get:{params:{id:"@id",$expand:"definition,connectionReferences.api.properties,connectionReferences.api.properties.swagger"}},post:{params:{id:"@id"}},query:{params:{$expand:"definition,connectionReferences.api.properties"}}},options:{atomize:!1}}),s=r.cache.template;return s&&s.properties&&s.properties.definition&&o.updateCache(e,{id:n(s.properties.galleryName,s.name)},s),o}])},function(e,t,i){"use strict";function r(e){return u.getCustomApiBaseUrl(e.editMode,e.apiName)}function n(e){return this.getBaseUrl(e)+"/definition/actions/new"}function o(e,t){return this.getBaseUrl(e)+"/definition/actions/"+t}function s(e,t){return this.getBaseUrl(e)+"/definition/triggers/"+t}function a(e,t,i){switch(t.source){case p.ReferenceSource.parameters:return this.getBaseUrl(e)+"/definition/parameters/"+i;case p.ReferenceSource.responses:return this.getBaseUrl(e)+"/definition/responses/"+i;default:return this.getBaseUrl(e)+"/definition/definitions/"+i}}function l(e,t,i,r){return d.equalsIgnoreCase(i,"action")?this.getActionUrl(e,t)+"/parameters/"+r:this.getTriggerUrl(e,t)+"/parameters/"+r}function c(e,t,i,r){return d.equalsIgnoreCase(i,"action")?this.getActionUrl(e,t)+"/responses/"+r:this.getTriggerUrl(e,t)+"/responses/"+r}Object.defineProperty(t,"__esModule",{value:!0});var u=i(31),p=i(16),d=i(8);t.getBaseUrl=r,t.getNewActionUrl=n,t.getActionUrl=o,t.getTriggerUrl=s,t.getReferenceUrl=a,t.getInlineParameterUrl=l,t.getInlineResponseUrl=c},function(e,t,i){"use strict";function r(e,t){return o.endsWithIgnoreCase(e,"/")&&n.startsWithIgnoreCase(t,"/")?e.substring(0,e.length-1)+t:o.endsWithIgnoreCase(e,"/")||n.startsWithIgnoreCase(t,"/")?e+t:e+"/"+t}Object.defineProperty(t,"__esModule",{value:!0});var n=i(41),o=i(138);t.concatParts=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(40),n=i(1),o=i(4),s=i(8),a=i(15),l=i(1),c=i(395),u=i(9),p=i(23),d=function(){function e(e,t,i){var r=this;this.appSettings=e,this.loggingService=t,this.rpcService=i,this.onTriggerFlowByTemplate=function(e){r.triggerFlowByTemplateCallback=e},this.onTriggerFlow=function(e){r.triggerFlowCallback=e},this.onGetTriggerSchema=function(e){r.getTriggerSchemaCallback=e},this.onCustomApiRefreshConnections=function(e){r.customApiRefreshConnectionsCallback=e},this.onCustomApiRefreshApis=function(e){r.customApiRefreshApisCallback=e},this.handleNotify=function(e,t){var i="Handle notify was invoked with action name: "+e;return r.loggingService.logInfo(o.ProfilingEventNames.hostCommunicationServiceHandleNotifyStart,i,{actionName:e}),new Promise(function(c,u){if(n.isNullOrWhitespace(e)){var d="Handle notify invocation failed. Notify action name cannot be null or empty.";r.loggingService.logError(a.ErrorCodes.hostCommunicationServiceEmptyActionName,new Error(d)),u({code:a.ErrorCodes.runFlowWidgetNullOrEmptyActionName,message:d})}else{var g=e.toLowerCase();if(s.equalsIgnoreCase(g,p.WidgetNotifyActions.TriggerFlow)&&r.triggerFlowCallback)i="Handle notify invocation succeeded for trigger flow action",r.loggingService.logInfo(o.ProfilingEventNames.hostCommunicationServiceHandleNotifyEnd,i),c(r.triggerFlowCallback(t));else if(s.equalsIgnoreCase(g,p.WidgetNotifyActions.TriggerFlowByTemplate)&&r.triggerFlowByTemplateCallback)i="Handle notify invocation succeeded for trigger flow by template action",r.loggingService.logInfo(o.ProfilingEventNames.hostCommunicationServiceHandleNotifyEnd,i),c(r.triggerFlowByTemplateCallback(t));else if(s.equalsIgnoreCase(g,p.WidgetNotifyActions.GetTriggerSchema)&&r.getTriggerSchemaCallback)i="Handle notify invocation succeeded for get trigger schema action",r.loggingService.logInfo(o.ProfilingEventNames.hostCommunicationServiceHandleNotifyEnd,i),c(r.getTriggerSchemaCallback(t));else if(s.equalsIgnoreCase(g,p.WidgetNotifyActions.RefereshConnections)&&r.onCustomApiRefreshConnections)i="Handle notify invocation succeeded for refresh connections action",r.loggingService.logInfo(o.ProfilingEventNames.hostCommunicationServiceHandleNotifyEnd,i),c(r.customApiRefreshConnectionsCallback());else if(s.equalsIgnoreCase(g,p.WidgetNotifyActions.RefreshApis)&&r.onCustomApiRefreshApis)i="Handle notify invocation succeeded for refresh apis action",r.loggingService.logInfo(o.ProfilingEventNames.hostCommunicationServiceHandleNotifyEnd,i),c(r.customApiRefreshApisCallback());else{var d=l.format("Handle notify invocation failed. Invalid action name:{0} was passed in.",e);r.loggingService.logError(a.ErrorCodes.hostCommunicationServiceInvalidActionName,new Error(d),{actionName:e}),u({code:a.ErrorCodes.runFlowWidgetInvalidActionName,message:d})}}})},this.appSettings.isWidgetPage&&(i.onNotify=this.handleNotify)}return Object.defineProperty(e,"instance",{get:function(){return e.hostCommunicationService.value},enumerable:!0,configurable:!0}),e.prototype.triggerHostEvent=function(e,t){return this.rpcService.triggerHostEvent(e,t)},e.prototype.getDataFromHostEvent=function(e,t){return this.rpcService.getDataFromHostEvent(e,t)},e.hostCommunicationService=new r.Lazy(function(){return new e(u.getAppSettings(),o.LoggingService.instance,c.RpcService.instance)}),e}();t.HostCommunicationService=d},function(e,t){function i(e){return!!e&&"object"==typeof e}e.exports=i},function(e,t){var i=Array.isArray;e.exports=i},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(0),o=i(1);!function(e){e[e.SessionStorage=0]="SessionStorage",e[e.LocalStorage=1]="LocalStorage",e[e.Cookie=2]="Cookie"}(r=t.StorageType||(t.StorageType={}));var s=function(){function e(){this.isSessionStorageAvailable=this.isStorageAvailable("sessionStorage"),this.isLocalStorageAvailable=this.isStorageAvailable("localStorage"),this.defaultStorageType=this.isSessionStorageAvailable?r.SessionStorage:r.Cookie}return e.prototype.saveItem=function(e,t,i){switch(i=i||this.defaultStorageType){case r.SessionStorage:return void sessionStorage.setItem(e,t);case r.LocalStorage:return void localStorage.setItem(e,t);case r.Cookie:return void this.saveCookie(e,t);default:throw new Error("Unknown storage type")}},e.prototype.getItem=function(e,t){switch(t=t||this.defaultStorageType){case r.SessionStorage:return sessionStorage.getItem(e);case r.LocalStorage:return localStorage.getItem(e);case r.Cookie:return this.getCookie(e);default:throw new Error("Unknown storage type")}},e.prototype.appendItem=function(e,t,i){var r=this.getItem(e,i)||"",n=r+t;this.saveItem(e,n,i)},e.prototype.saveObject=function(e,t,i){try{var r=JSON.stringify(t);this.saveItem(e,r,i)}catch(e){}},e.prototype.getObject=function(e,t){var i;try{var r=this.getItem(e,t);r&&(i=JSON.parse(r))}catch(e){}return i},e.prototype.clearItem=function(e,t){switch(t=t||this.defaultStorageType){case r.SessionStorage:return void sessionStorage.removeItem(e);case r.LocalStorage:return void localStorage.removeItem(e);case r.Cookie:return void this.deleteCookie(e);default:throw new Error("Unknown storage type")}},e.prototype.clearAllItems=function(e){switch(e=e||this.defaultStorageType){case r.SessionStorage:sessionStorage.clear();break;case r.LocalStorage:localStorage.clear();break;case r.Cookie:throw new Error("Cannot clear all cookies");default:throw new Error("Unknown storage type")}},e.prototype.saveCookie=function(e,t,i){i=i||1;var r=new Date;r.setTime(r.getTime()+24*i*60*60*1e3);var n="expires="+r.toUTCString();e=encodeURIComponent(e),t=encodeURIComponent(t),document.cookie=e+"="+t+"; "+n+"; path=/;"},e.prototype.getCookie=function(e){for(var t=encodeURIComponent(e)+"=",i=document.cookie.split(";"),r=0;r<i.length;r++){for(var n=i[r];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}return""},e.prototype.deleteCookie=function(e){document.cookie=o.format("{0}=; Path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC",e)},e.prototype.isStorageAvailable=function(e){try{var t=e in window&&window[e];try{t&&(t.setItem("test","test"),t.removeItem("test"))}catch(e){var i=e.name.toLowerCase().replace(/_/g,"");if(o.stringIncludes(i,"quotaexceedederr",0))return!1}return!!t}catch(e){return!1}},e}();t.StorageService=s,angular.module(n.default.modules.processSimpleServices).service(n.default.services.storage,s)},function(e,t,i){"use strict";function r(e){return e&&e.properties&&(e.properties.type===t.FeedEventDefinitionType.AggregatedFail||e.properties.type===t.FeedEventDefinitionType.BrokenConnection)}function n(e,i){switch(e&&e.properties&&e.properties.type){case t.FeedEventDefinitionType.AggregatedFail:return i;case t.FeedEventDefinitionType.BrokenConnection:case t.FeedEventDefinitionType.PushNotification:case t.FeedEventDefinitionType.AggregatedSuccess:case t.FeedEventDefinitionType.FlowSuspended:return e.properties.title;default:return""}}function o(e){switch(e&&e.properties&&e.properties.type){case t.FeedEventDefinitionType.AggregatedFail:case t.FeedEventDefinitionType.AggregatedSuccess:case t.FeedEventDefinitionType.PushNotification:case t.FeedEventDefinitionType.FlowSuspended:return e.properties.object.displayName;case t.FeedEventDefinitionType.BrokenConnection:return e.properties.object.description;default:return""}}Object.defineProperty(t,"__esModule",{value:!0}),t.FeedEventDefinitionType={AggregatedFail:"AggregatedFail",AggregatedSuccess:"AggregatedSuccess",PushNotification:"PushNotification",BrokenConnection:"BrokenConnection",FlowSuspended:"FlowSuspended"},t.isFailure=r,t.getTitle=n,t.getDescription=o},function(e,t,i){(function(e,r){var n=i(447),o={function:!0,object:!0},s=o[typeof t]&&t&&!t.nodeType?t:null,a=o[typeof e]&&e&&!e.nodeType?e:null,l=n(s&&a&&"object"==typeof r&&r),c=n(o[typeof self]&&self),u=n(o[typeof window]&&window),p=n(o[typeof this]&&this),d=l||u!==(p&&p.window)&&u||c||p||Function("return this")();e.exports=d}).call(t,i(134)(e),i(75))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(1),o=i(1),s=i(83);t.DefaultDateTimeOptions={UseShortFormat:!1,UseShortUnit:!1};var a=function(){function e(e){this.clientResources=e}return e.prototype.getFriendlyTimeSinceString=function(e,t,i){return s.getFriendlyTimeSinceString(this.clientResources,e,t,i)},e.prototype.getSimpleDateTimeString=function(e){return n.format("{0} {1}",e.toLocaleDateString(),e.toLocaleTimeString())},e.prototype.getTimeAtDateTimeString=function(e){return s.getTimeAtDateTimeString(this.clientResources,e)},e.prototype.compareDates=function(e,t){var i=o.getDate(e),r=o.getDate(t);return i&&r?i.getTime()-r.getTime():i?i.getTime():r?-1*r.getTime():0},e.prototype.getIntervalDate=function(e,t){return s.getIntervalDate(e,t)},e.$inject=[r.default.services.clientResources],e}();t.DateTimeService=a,angular.module(r.default.modules.processSimpleServices).service(r.default.services.dateTime,a)},function(e,t,i){"use strict";function r(e,t){return t.getUserSessionAsync().then(function(t){return e.getUserSettings({objectId:t.userInfo.uniqueId,settingGroup:o.SettingGroups.connectors})}).then(function(e){return e.data&&e.data.properties&&e.data.properties.settings&&Array.isArray(e.data.properties.settings.visibleHideKeys)?e.data.properties.settings.visibleHideKeys:[]}).catch(function(e){return a.LoggingService.instance.logWarning("getVisibleHideKeys",e),[]})}function n(e,t,i,n){s.isNullOrWhitespace(i)||r(e,t).then(function(r){return n===c.Add&&-1===r.indexOf(i)?r.push(i):n===c.Remove&&r.indexOf(i)>-1?r.splice(r.indexOf(i),1):n=c.DoNothing,n===c.DoNothing?null:e.setUserSettings({objectId:t.getUserInfo().uniqueId,settingGroup:o.SettingGroups.connectors},{visibleHideKeys:r})})}Object.defineProperty(t,"__esModule",{value:!0});var o=i(28),s=i(1),a=i(4),l=function(){function e(){}return e.AddConnectorHideKey="addConnectorHideKey",e.RemoveConnectorHideKey="removeConnectorHideKey",e}();t.QueryParameters=l;var c;!function(e){e[e.Add=0]="Add",e[e.Remove=1]="Remove",e[e.DoNothing=2]="DoNothing"}(c=t.UpdateConnectorHideKeyAction||(t.UpdateConnectorHideKeyAction={})),t.getVisibleHideKeys=r,t.updateConnectorHideKey=n},function(e,t,i){var r=i(92),n=i(56),o=r(n,"Map");e.exports=o},function(e,t){function i(e){var t=typeof e;return"number"==t||"boolean"==t||"string"==t&&"__proto__"!==e||null==e}e.exports=i},function(e,t,i){"use strict";function r(e,t,i,r){var s=v.parseUri(e),c=n(t).concat(o(s.parameters)).concat(a(i)),u=l(r);return h.isEmpty(u)||c.push(u),c}function n(e){return h.isEmpty(e)||"/"===e?[]:u(e).map(function(e){return{name:e,in:"path",required:!0,type:"string"}})}function o(e){return h.isEmpty(e)?[]:Object.keys(e).map(function(t){return{name:t,in:"query",required:!1,type:p(e[t])}})}function s(e){var t=e.replace(new RegExp("/\n/\r","g"),"\n").split("\n"),i={};return t.forEach(function(e){if(!h.isEmpty(e.trim())){var t=e.trim().split(" "),r=t[0],n="";t.length>=2&&(n=t.splice(1).join(" ")),i[r]=p(n)}}),i}function a(e){if(h.isEmpty(e))return[];var t=s(e);return Object.keys(t).map(function(e){return{name:e,in:"header",required:!1,type:t[e]}})}function l(e){return h.isEmpty(e)?{}:{name:m.ParameterLocations.body,in:"body",required:!1,schema:f.generateSchemaFromJson(e)}}function c(e){var t={};if(h.isEmpty(e))return t;var i=s(e);return Object.keys(i).map(function(e){t[e]={description:e,type:i[e]}}),t}function u(e){for(var t=[],i=/\{(.*?)\}/g,r=i.exec(e);null!==r;)h.isEmpty(r[1])||t.push(r[1]),r=i.exec(e);return t}function p(e){var t="string";if(h.isEmpty(e))return t;if(e=e.trim(),isNaN(Number(e)))"true"===e||"false"===e?t="boolean":e.length>=1&&"["===e[0]&&"]"===e[e.length-1]&&(t="array");else{t=Number(e)%1==0?"integer":"number"}return t}function d(e,t){return h.isEmpty(e)||h.isEmpty(e.trim())?e:(e=e.trim(),"boolean"===t?"true"===e.toLowerCase():"number"===t||"integer"===t?Number(e):"array"===t&&e.length>1?e.substr(1,e.length-2).split(","):e)}function g(e){return""+e.name+e.in}Object.defineProperty(t,"__esModule",{value:!0});var m=i(27),f=i(34),h=i(1),v=i(32);t.getParameters=r,t.getPathParameters=n,t.getQueryParameters=o,t.getHeaderNamesWithType=s,t.getHeaderParameters=a,t.getBodyParameter=l,t.getHeadersForResponse=c,t.getPathParametersInsideBrackets=u,t.getTypeFromStringValue=p,t.getTypedValueFromStringValue=d,t.getUniqueParameterName=g},function(e,t,i){"use strict";function r(e){var t=angular.copy(e),i=t;return t.definitions&&(t.definitions=Object.keys(t.definitions).map(function(e){return{name:e,item:t.definitions[e]}})),t.parameters&&(t.parameters=Object.keys(t.parameters).map(function(e){return{name:e,item:t.parameters[e]}})),t.responses&&(t.responses=Object.keys(t.responses).map(function(e){return{name:e,item:t.responses[e]}})),i.actions=[],i.triggers=[],s.isEmpty(i.paths)?i:(n(i.paths,i.triggers,i.actions),i)}function n(e,t,i){Object.keys(e).forEach(function(r){var n=e[r];n&&Object.keys(o.Methods).map(function(e){return o.Methods[e]}).forEach(function(o){var l=n[o];if(!s.isEmpty(l)&&l.responses&&(l.responses=Object.keys(l.responses).map(function(e){return{name:e,item:l.responses[e]}})),!s.isEmpty(l))if(l.hasOwnProperty(a.Swagger.Trigger)){var c={path:r,method:o,operation:n[o]};n[a.Swagger.NotificationContent]&&(c.operation[a.Swagger.NotificationContent]=n[a.Swagger.NotificationContent]),t.push(c)}else i.push({path:r,method:o,operation:n[o]});delete e[r][o]})})}Object.defineProperty(t,"__esModule",{value:!0});var o=i(27),s=i(1),a=i(16);t.deserialize=r},function(e,t){var i=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},,function(e,t,i){"use strict";function r(e,t){for(var i=t;null!==i;){if(i===e)return!0;i=i.parentElement}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.isParentOrElement=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(9),o=i(1),s=i(1),a=i(322),l=i(323),c=i(40),u=i(105),p=i(29),d=i(37),g=function(e){function t(i){var r=e.call(this,{postEventsToServer:function(e,r){return $.ajax({type:"POST",url:s.joinUrl(i.siteOrigin,t.telemetryServiceRelativeUrl),beforeSend:function(e){e.setRequestHeader("content-type","application/json"),e.setRequestHeader("x-ms-client-request-id",s.generateGuid())},data:JSON.stringify({events:r})}).then(function(e,t,i){return{ok:!0}},function(e,t,i){return console.error(i),{ok:!1}})},resolvePromise:function(e){return $.Deferred().resolve(e)},onLog:function(e){if("Telemetry"===e.eventType){var t=e.eventName&&e.eventName[0].toLowerCase()+e.eventName.substring(1);p.ProfilingEventNames[e.eventName]||p.ProfilingEventNames[t]||o.getEnumValue(d.TelemetryEventNames,e.eventName)||u.LocalyticsService.instance.tagEvent(e.eventName,e.eventData.data)}},localStorageCapacity:500,localStorageKeyPrefix:"ps",useLocalStorage:!0})||this;return r.setContextData({correlationId:i.correlationId,host:i.siteOrigin,hostVersion:i.buildVersion,isWidgetPage:n.getAppSettings().isWidgetPage,objectId:sessionInfo.isAuthenticated?sessionInfo.userInfo.uniqueId:null,puid:sessionInfo.isAuthenticated?sessionInfo.userInfo.puid:null,referrerUrl:document.referrer?document.referrer:null,sessionId:sessionInfo.sessionId,tenantId:sessionInfo.isAuthenticated?sessionInfo.userInfo.tenantId:null}),n.getAppSettings().isWidgetPage&&r.setContextData({widgetSdkVersion:n.getAppSettings().widgetInfo?n.getAppSettings().widgetInfo.sdkVersion:null,widgetType:n.getAppSettings().widgetInfo?n.getAppSettings().widgetInfo.widgetType.toLowerCase():null}),sessionInfo.isAuthenticated&&!sessionInfo.userConsented&&r.setContextData({isUserConsented:!1}),r.logNavigationPerformance(p.ProfilingEventNames.NAVIGATION_PERFORMANCE),i.startPublishingTelemetry&&(setTimeout(function(){r.flush()},a.getRandomNumberInclusive(3e3,6e3)),r.startPublish()),r}return r.__extends(t,e),Object.defineProperty(t,"instance",{get:function(){return t.analyticsService.value},enumerable:!0,configurable:!0}),t.telemetryServiceRelativeUrl="providers/Internal.Telemetry/collect",t.analyticsService=new c.Lazy(function(){var e=n.getAppSettings();return new t({siteOrigin:e.siteOrigin,buildVersion:e.buildVersion,startPublishingTelemetry:e.startPublishingTelemetry,correlationId:e.correlationId})}),t}(l.Analytics);t.AnalyticsService=g},function(e,t,i){"use strict";function r(e){return s.startsWithIgnoreCase(e,"http://")}function n(e){return s.startsWithIgnoreCase(e,"https://")}function o(e){return n(e)||r(e)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(41);t.isHttpUrl=r,t.isHttpsUrl=n,t.isAbsoluteUrl=o},function(e,t,i){"use strict";function r(e){var t={};return e?(o.startsWithIgnoreCase(e,"?")&&(e=e.substring(1)),e.split("&").forEach(function(e){var i=e.split("="),r=i[0],n=i[1];t[decodeURIComponent(r||"")]=decodeURIComponent(n||"")}),t):t}function n(e){return Object.keys(e||{}).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}Object.defineProperty(t,"__esModule",{value:!0});var o=i(41);t.parseQueryString=r,t.createQueryString=n},function(e,t,i){"use strict";function r(){return o.getScriptsResources()}Object.defineProperty(t,"__esModule",{value:!0}),i(334);var n=i(0),o=i(140);t.getClientResources=r,angular.module(n.default.modules.processSimpleResources).constant(n.default.services.clientResources,r())},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowTemplateOperationType={ApiApp:"ApiApp",ApiConnection:"ApiConnection",ApiConnectionWebhook:"ApiConnectionWebhook",Compose:"Compose",DecrementVariable:"DecrementVariable",Flow:"Flow",Foreach:"Foreach",Function:"Function",Http:"Http",HttpWebhook:"HttpWebhook",If:"If",IncrementVariable:"IncrementVariable",InitializeVariable:"InitializeVariable",Join:"Join",Manual:"Manual",NotSpecified:"NotSpecified",ParseJson:"ParseJson",Query:"Query",Recurrence:"Recurrence",Request:"Request",Response:"Response",Scope:"Scope",Select:"Select",SetVariable:"SetVariable",Switch:"Switch",Table:"Table",Terminate:"Terminate",Until:"Until",Wait:"Wait",Workflow:"Workflow",XmlValidation:"XmlValidation"}},function(e,t,i){"use strict";function r(e){var t={};return Object.keys(e||{}).forEach(function(i){var r=n(e[i]);r&&(t[i]=r)}),t}function n(e){if(e){var t={};if(t.id=e.id||e.api&&e.api.id,!t.id)return;if(t.connectionName=e.connectionName||e.connection&&o(e.connection.id),!t.connectionName)return;return e.source&&(t.source=e.source),t}}function o(e){if(e){var t=a.stripLeadingSlashes(a.stripTrailingSlashes(e)).split("/");if(6===t.length&&s.equalsIgnoreCase(t[0],"providers")&&s.equalsIgnoreCase(t[2],"apis")&&s.equalsIgnoreCase(t[4],"connections"))return t[5]}}Object.defineProperty(t,"__esModule",{value:!0});var s=i(8),a=i(35);t.getConnectionReferencesOfFlowFormat=r,t.extractConnectionNameFromId=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PostmanCollectionV2Schema="https://schema.getpostman.com/json/collection/v2.0.0/collection.json",t.AuthorizationHeaderName="Authorization",t.BasicAuthSecurityDefinitionName="BasicAuth",t.OAuthSecurityDefinitionName="OAuth",t.BasicAuthTokenType="basic",t.OAuthTokenType="bearer"},function(e,t){var i=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=i)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},,function(e,t,i){"use strict";function r(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e=e||{},t.forEach(function(t){n(t)||Object.keys(t).map(function(i){e[i]=t[i]})}),e}function n(e){return null===e||void 0===e}function o(e,t){if(n(e))throw new TypeError("array cannot be null or undefined");if("function"!=typeof t)throw new TypeError("predicate is not a function");for(var i=Object(e),r=e.length>>>0,o=e,s=0;s<r;s++){var a=i[s];if(t.call(o,a,s,i))return s}return-1}function s(e,t){var i=l.parseUri(e),n=i.port?":"+i.port:"",o=i.protocol+"://"+i.host+n+i.path,s=l.createQueryString(r({},i.parameters,t));return s&&(o=o+"?"+s),o}function a(e){return/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)}Object.defineProperty(t,"__esModule",{value:!0});var l=i(32);t.assign=r,t.isNullOrUndefined=n,t.findIndex=o,t.appendQueryString=s,t.validateUrl=a},function(e,t,i){"use strict";function r(e){return d.startsWithIgnoreCase(e,m.getAppSettings().azureResourceManagementUri)}function n(e){return d.startsWithIgnoreCase(e,m.getAppSettings().powerAppsResourceProviderEndpoint)}function o(e){return d.startsWithIgnoreCase(e,m.getAppSettings().processSimpleResourceProviderManagementEndpoint)}function s(e){return r(e)||n(e)||o(e)}Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),l=i(49),c=i(32),u=i(8),p=i(1),d=i(41),g=i(44),m=i(9),f=i(67),h=i(1),v={approvalsHistoryRoute:"/approvals/history",approvalsSentRoute:"/approvals/sent",approvalsReceivedRoute:"/approvals/received",connectionsRoute:"/connections",portalConsentRoute:"/consent/",rpConsentRoute:"/consentUser",customApisRoute:"/custom",availableConnectionsRoute:"/available",flowsRoute:"/flows",exportFlowRouteFormatting:"/flows/{0}/export",importFlowRoute:"/flows/import",sharedFlowsRoute:"/flows/shared",newFlowsRoute:"/new",flowChecksRoute:"/checks",flowRunsRoute:"/runs",gatewaysRoute:"/gateways",termsRoute:"termsofservice/",manageRoute:"/manage",mobileDownloadRoute:"/mobile/download",templateRoute:"/galleries/{0}/templates/{1}/",templatesRoute:"/templates",widgetsRoute:"/widgets",servicePlansRoute:"/servicePlans/",servicesRoute:"/services",refreshServicePlansRoute:"/refreshPlans/",signinRoute:"/signin",signoutRoute:"/signout/",environmentRoute:"/environments",ownersRoute:"/owners",pricingRoute:"/pricing",startTrialRoute:"/startTrial",userPreferencesRoute:"/preferences/"};t.isAzureManagementUrl=r,t.isPowerAppsResourceProviderUrl=n,t.isProcesssimpleResourceProviderUrl=o,t.needLocaleHeader=s;var y=function(){function e(e,t,i,r){this.$routeParams=e,this.$rootScope=t,this.appSettings=i,this.loggingService=r,t.$on("$routeChangeSuccess",this.onRouteChangeSuccess.bind(this))}return e.prototype.onRouteChangeSuccess=function(e,t,i){i&&i.$$route?!i.$$route.originalPath||t.$$route&&t.$$route.originalPath===i.$$route.redirectTo||(this.previousUrl=l.concatParts(this.appSettings.siteOrigin,"manage")+i.$$route.originalPath):this.previousUrl=document.referrer},e.prototype.isAzureManagementUrl=function(e){return r(e)},e.prototype.isPowerAppsResourceProviderUrl=function(e){return n(e)},e.prototype.isProcesssimpleResourceProviderUrl=function(e){return o(e)},e.prototype.localeRoute=function(){return this.appSettings.locale},e.prototype.approvalsServiceRoute=function(){return"/"+this.localeRoute()+v.servicesRoute+"/shared_approvals/approvals"},e.prototype.approvalsHistoryRoute=function(){return v.approvalsHistoryRoute},e.prototype.approvalsSentRoute=function(){return v.approvalsSentRoute},e.prototype.approvalsReceivedRoute=function(){return v.approvalsReceivedRoute},e.prototype.selectedApprovalRoute=function(e){return this.approvalsSentRoute()+"/"+e},e.prototype.selectedApprovalRequestRoute=function(e,t){return this.approvalsReceivedRoute()+"/"+e+"/requests/"+t},e.prototype.portalConsentRoute=function(){return v.portalConsentRoute},e.prototype.rpConsentRoute=function(){return v.rpConsentRoute},e.prototype.connectionsRoute=function(){return v.connectionsRoute},e.prototype.customApisRoute=function(){return""+this.connectionsRoute()+v.customApisRoute},e.prototype.availableConnectionsRoute=function(){return""+this.connectionsRoute()+v.availableConnectionsRoute},e.prototype.exportFlowsRoute=function(e){return p.format(v.exportFlowRouteFormatting,e)},e.prototype.importFlowRoute=function(){return v.importFlowRoute},e.prototype.flowsRoute=function(){return v.flowsRoute},e.prototype.flowsFullPath=function(){return""+window.location.origin+this.manageRoute()+this.flowsRoute()},e.prototype.sharedFlowsRoute=function(){return v.sharedFlowsRoute},e.prototype.newFlowsRoute=function(){return""+this.flowsRoute()+v.newFlowsRoute},e.prototype.newFlowsGettingStartedRoute=function(){return this.newFlowsRoute()+"/getting-started"},e.prototype.newFlowFullPath=function(){return""+window.location.origin+this.manageRoute()+this.newFlowsRoute()},e.prototype.mobileDownloadRoute=function(){return v.mobileDownloadRoute},e.prototype.manageRoute=function(e){return e?""+v.manageRoute+e:v.manageRoute},e.prototype.manageRouteWithEnvironment=function(e){var t=window.location.origin;return this.appSettings.isWidgetPage&&this.appSettings.featureFlags.enableWidgetTeamFlows&&(t=t+"/"+this.localeRoute()+v.widgetsRoute),e?""+t+this.manageRoute()+v.environmentRoute+"/"+e:""+t+this.manageRoute()},e.prototype.manageApprovalRouteWithEnvironment=function(e,t){var i,r=window.location.origin,n=this.manageRoute();return e?(this.appSettings.isWidgetPage&&(i=this.getWidgetQueryStringParameters(e),n=v.widgetsRoute+n),""+r+n+v.environmentRoute+"/"+e+t+"?"+c.createQueryString(i)):""+r+this.manageRoute()},e.prototype.templatesRoute=function(){return this.appSettings.isWidgetPage&&this.appSettings.featureFlags.enableWidgetCreateFromTemplate?v.widgetsRoute+v.templatesRoute:v.templatesRoute},e.prototype.templatesFullPath=function(){return""+window.location.origin+v.templatesRoute},e.prototype.templateFullPath=function(e,t){return""+window.location.origin+p.format(v.templateRoute,e,t)},e.prototype.newBlankFlowRoute=function(e){var t=e?""+this.manageRoute()+v.environmentRoute+"/"+e+this.newFlowsRoute():""+this.manageRoute()+this.newFlowsRoute();return this.appSettings.isWidgetPage&&this.appSettings.widgetInfo.flowsSettings&&!h.isNullOrWhitespace(this.appSettings.widgetInfo.flowsSettings.createFromBlankTemplateId)?t+"?"+c.createQueryString(this.getCreateFromBlankTemplateArgs()):t},e.prototype.newTemplateFlowRoute=function(e){var t="/"+this.localeRoute()+this.templatesRoute(),i={};return this.appSettings.isWidgetPage?i=this.getWidgetQueryStringParameters(e):i.environment=e,t+"?"+c.createQueryString(i)},e.prototype.getWidgetQueryStringParameters=function(e){var t={environment:e};if(this.appSettings.widgetInfo.sdkVersion&&(t.sdkVersion=this.appSettings.widgetInfo.sdkVersion),this.appSettings.widgetInfo.widgetId&&(t.widgetId=this.appSettings.widgetInfo.widgetId),this.appSettings.widgetInfo.widgetType&&(t.widgetType=this.appSettings.widgetInfo.widgetType),this.appSettings.widgetInfo.enableOnBehalfOfTokens&&(t.enableOnBehalfOfTokens=this.appSettings.widgetInfo.enableOnBehalfOfTokens.toString()),this.appSettings.widgetInfo.widgetStyleSettings&&this.appSettings.widgetInfo.widgetStyleSettings.backgroundColor&&(t.backgoundColor=this.appSettings.widgetInfo.widgetStyleSettings.backgroundColor),this.appSettings.widgetInfo.flowsSettings&&(this.appSettings.widgetInfo.flowsSettings.flowsFilter&&(t.flowsFilter=this.appSettings.widgetInfo.flowsSettings.flowsFilter),this.appSettings.widgetInfo.flowsSettings.createFromBlankTemplateId&&(t.defaultTemplate=this.appSettings.widgetInfo.flowsSettings.createFromBlankTemplateId)),this.appSettings.widgetInfo.templatesSettings){if(this.appSettings.widgetInfo.templatesSettings.destination&&(t.destination=this.appSettings.widgetInfo.templatesSettings.destination),this.appSettings.widgetInfo.templatesSettings.pageSize&&(t.pageSize=this.appSettings.widgetInfo.templatesSettings.pageSize.toString()),this.appSettings.widgetInfo.templatesSettings.searchTerm&&(t.q=this.appSettings.widgetInfo.templatesSettings.searchTerm),this.appSettings.widgetInfo.templatesSettings.defaultParams){var i=JSON.parse(this.appSettings.widgetInfo.templatesSettings.defaultParams);$.extend(t,this.parseDynamicParameters(i))}this.appSettings.widgetInfo.templatesSettings.category&&(t.category=this.appSettings.widgetInfo.templatesSettings.category)}return t},e.prototype.editFlowRoute=function(e){return this.flowsRoute()+"/"+e.flowName},e.prototype.editSharedFlowRoute=function(e){return this.flowsRoute()+"/shared/"+e.flowName},e.prototype.flowDetailsRoute=function(e){return e.shared?this.sharedFlowsRoute()+"/"+e.flowName+"/details":this.flowsRoute()+"/"+e.flowName+"/details"},e.prototype.flowChecksRoute=function(e){return""+this.editFlowRoute(e)+v.flowChecksRoute},e.prototype.flowCheckRoute=function(e){return this.flowChecksRoute({flowName:e.flowName})+"/"+e.runName},e.prototype.flowRunsRoute=function(e){return""+this.editFlowRoute(e)+v.flowRunsRoute},e.prototype.flowRunRoute=function(e){return this.flowRunsRoute({flowName:e.flowName})+"/"+e.runName},e.prototype.flowOwnersRoute=function(e){return""+this.editFlowRoute(e)+v.ownersRoute},e.prototype.gatewaysRoute=function(){return v.gatewaysRoute},e.prototype.isFlowCheckPage=function(e){if(void 0===e&&(e=window.location.href),this.isManagementPage(e)){var t=e.split("/");if(t.length>9&&u.equalsIgnoreCase(t[4],"environments")&&u.equalsIgnoreCase(t[6],"flows")&&u.equalsIgnoreCase(t[8],"checks"))return!0}return!1},e.prototype.isConnectionsPage=function(e){return void 0===e&&(e=window.location.href),this.assertAbsoluteUrl(e),d.startsWithIgnoreCase(e,l.concatParts(this.appSettings.siteOrigin,"manage/connections"))},e.prototype.isTemplateDetailsPage=function(e){return void 0===e&&(e=window.location.href),this.assertAbsoluteUrl(e),d.startsWithIgnoreCase(e,this.appSettings.siteOrigin)&&-1!==e.indexOf("galleries")&&-1!==e.indexOf("templates")},e.prototype.isManagementPage=function(e){return void 0===e&&(e=window.location.href),this.assertAbsoluteUrl(e),d.startsWithIgnoreCase(e,l.concatParts(this.appSettings.siteOrigin,"manage"))},Object.defineProperty(e.prototype,"cameFromTemplateDetailsPage",{get:function(){try{return this.previousUrl&&this.isTemplateDetailsPage(this.previousUrl)}catch(e){this.loggingService.logError("UrlService.cameFromTemplateDetailsPage",e)}return!1},enumerable:!0,configurable:!0}),e.prototype.servicePlansRoute=function(){return v.servicePlansRoute},e.prototype.refreshServicePlansRoute=function(){return v.refreshServicePlansRoute},e.prototype.signinRoute=function(){return v.signinRoute},e.prototype.signoutRoute=function(){return v.signoutRoute},e.prototype.supportUrl=function(){return this.appSettings.supportPageUrl},e.prototype.termsRoute=function(e){return"/"+e.locale+"/"+v.termsRoute},e.prototype.pricingRoute=function(){return v.pricingRoute},e.prototype.startTrialRoute=function(e,t){var i=v.startTrialRoute+"?licenseId="+e;return t?i+"&currency="+t:i},e.prototype.widgetsRoute=function(){return v.widgetsRoute},e.prototype.widgetTemplatesRoute=function(){return""+this.widgetsRoute()+this.templatesRoute()+"/?"+this.widgetQuery()},e.prototype.userPreferencesRoute=function(){return v.userPreferencesRoute},e.prototype.widgetQuery=function(){return"widgetId="+this.appSettings.widgetInfo.widgetId},e.prototype.flowRunsFullPath=function(e){var t=window.location.origin;return(e.environmentName?""+t+this.manageRoute()+v.environmentRoute+"/"+e.environmentName+this.editFlowRoute(e)+v.flowRunsRoute:""+t+this.manageRoute()+this.editFlowRoute(e)+v.flowRunsRoute)+"?filter="+g.FilterNames.allRuns},e.prototype.editFlowFullPath=function(e){var t=window.location.origin;return e.environmentName?""+t+this.manageRoute()+v.environmentRoute+"/"+e.environmentName+this.editFlowRoute(e):""+t+this.manageRoute()+this.editFlowRoute(e)},e.prototype.getFlowsFullPath=function(e){var t=window.location.origin;return e?""+t+this.manageRoute()+v.environmentRoute+"/"+e+this.flowsRoute():""+t+this.manageRoute()+this.flowsRoute()},e.prototype.getSharedFlowsFullPath=function(e){var t=window.location.origin;return e?""+t+this.manageRoute()+v.environmentRoute+"/"+e+this.sharedFlowsRoute():""+t+this.manageRoute()+this.sharedFlowsRoute()},e.prototype.getCreateFromBlankTemplateArgs=function(){if(this.appSettings.isWidgetPage&&this.appSettings.widgetInfo.flowsSettings&&!h.isNullOrWhitespace(this.appSettings.widgetInfo.flowsSettings.createFromBlankTemplateId)){var e={gallery:"public",template:this.appSettings.widgetInfo.flowsSettings.createFromBlankTemplateId};if(this.appSettings.widgetInfo.templatesSettings&&this.appSettings.widgetInfo.templatesSettings.defaultParams){var t=JSON.parse(this.appSettings.widgetInfo.templatesSettings.defaultParams);$.extend(e,this.parseDynamicParameters(t))}return e}return null},e.prototype.assertAbsoluteUrl=function(e){if(void 0===e&&(e=null),!f.isAbsoluteUrl(e))throw new Error("absoluteUrl should start with https:// or http://")},e.prototype.isRefreshSessionUrl=function(e){return d.startsWithIgnoreCase(e,l.concatParts(this.appSettings.siteOrigin,"/refresh/"))},e.prototype.isRefreshAudienceTokenUrl=function(e){return d.startsWithIgnoreCase(e,l.concatParts(this.appSettings.siteOrigin,"/refreshtoken/?audience="))},e.prototype.isTelemetryServiceUrl=function(e){return d.startsWithIgnoreCase(e,l.concatParts(this.appSettings.siteOrigin,"providers/internal.telemetry/collect"))},e.prototype.isConsentUserUrl=function(e){return d.startsWithIgnoreCase(e,l.concatParts(this.appSettings.siteOrigin,this.portalConsentRoute()))||d.startsWithIgnoreCase(e,l.concatParts(this.appSettings.processSimpleManagementUri,this.rpConsentRoute()))||d.startsWithIgnoreCase(e,this.portalConsentRoute())},e.prototype.isListUserDetailsUrl=function(e){return d.startsWithIgnoreCase(e,l.concatParts(this.appSettings.processSimpleManagementUri,"/listUserDetails"))},e.prototype.isNpsOriginUrl=function(e){return d.startsWithIgnoreCase(e,this.appSettings.npsOriginUrl)},e.prototype.isEmailTypeCheckUrl=function(e){return d.startsWithIgnoreCase(e,l.concatParts(this.appSettings.siteOrigin,"providers/internal.User/users"))&&e.indexOf("getType")>-1},e.prototype.redirectRouteAfterSavingFlow=function(e){if(this.appSettings.featureFlags.enableFlowProperty){var t=this.flowDetailsRoute({flowName:e.flowName,shared:e.isSharedFlow}),i=window.location.origin;return e.isConnectionWizardPage?""+i+this.manageRoute()+t:t}return this.flowsRoute()},e.prototype.parseDynamicParameters=function(e){var t={};return Object.keys(e).map(function(i){d.startsWithIgnoreCase(i,"parameters.")&&(t[i]=e[i])}),t},e.$inject=[a.default.services.$routeParams,a.default.services.$rootScope,a.default.services.appSettings,a.default.services.logging],e}();t.UrlService=y,angular.module(a.default.modules.processSimpleServices).service(a.default.services.url,y)},function(e,t,i){"use strict";function r(e){var t="";if(e.hasOwnProperty("toISOString"))t=e.toISOString();else{t=e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1,2)+"-"+n(e.getUTCDate(),2)+"T"+n(e.getUTCHours(),2)+":"+n(e.getUTCMinutes(),2)+":"+n(e.getUTCSeconds(),2)+"."+n(e.getUTCMilliseconds(),3)+"Z"}return t}function n(e,t){for(var i=""+e,r=i.length,n=r;n<t;n++)i="0"+i;return i}Object.defineProperty(t,"__esModule",{value:!0}),t.toISOString=r},function(e,t,i){function r(e,t,i){function r(){w&&clearTimeout(w),f&&clearTimeout(f),S=0,m=f=y=w=C=void 0}function c(t,i){i&&clearTimeout(i),f=w=C=void 0,t&&(S=o(),h=e.apply(y,m),w||f||(m=y=void 0))}function u(){var e=t-(o()-v);e<=0||e>t?c(C,f):w=setTimeout(u,e)}function p(){return(w&&C||f&&R)&&(h=e.apply(y,m)),r(),h}function d(){c(R,w)}function g(){if(m=arguments,v=o(),y=this,C=R&&(w||!b),!1===P)var i=b&&!w;else{S||f||b||(S=v);var r=P-(v-S),n=r<=0||r>P;n?(f&&(f=clearTimeout(f)),S=v,h=e.apply(y,m)):f||(f=setTimeout(d,r))}return n&&w?w=clearTimeout(w):w||t===P||(w=setTimeout(u,t)),i&&(n=!0,h=e.apply(y,m)),!n||w||f||(m=y=void 0),h}var m,f,h,v,y,w,C,S=0,b=!1,P=!1,R=!0;if("function"!=typeof e)throw new TypeError(a);return t=s(t)||0,n(i)&&(b=!!i.leading,P="maxWait"in i&&l(s(i.maxWait)||0,t),R="trailing"in i?!!i.trailing:R),g.cancel=r,g.flush=p,g}var n=i(45),o=i(411),s=i(145),a="Expected a function",l=Math.max;e.exports=r},function(e,t,i){function r(e){var t=n(e)?l.call(e):"";return t==o||t==s}var n=i(45),o="[object Function]",s="[object GeneratorFunction]",a=Object.prototype,l=a.toString;e.exports=r},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});var n=i(416);t.date=n;var o=i(148);t.json=o;var s=i(42);t.object=s;var a=i(149);t.string=a;var l=i(32);t.url=l,r(i(421)),r(i(38))},function(e,t,i){"use strict";function r(e){return e?new Date(e):null}Object.defineProperty(t,"__esModule",{value:!0}),t.getDate=r},function(e,t,i){"use strict";function r(e,t,i,r){if(c.isNullOrUndefined(i))return"";var n=e.DateTime,o=r?t&&t.UseShortFormat?n.formats.timeShort:n.formats.time:n.formats.timeAgo;r=r||new Date;var s=(r.getTime()-i.getTime())/1e3;if(s<0)return"";var l,h,v=a(e,t&&t.UseShortUnit);return s>=f?(l=Math.floor(s/f),h=1===l?v.Year:v.Years):s>=m?(l=Math.floor(s/m),h=1===l?v.Month:v.Months):s>=g?(l=Math.floor(s/g),h=1===l?v.Week:v.Weeks):s>=d?(l=Math.floor(s/d),h=1===l?v.Day:v.Days):s>=p?(l=Math.floor(s/p),h=1===l?v.Hour:v.Hours):s>=u?(l=Math.floor(s/u),h=1===l?v.Minute:v.Minutes):(l=Math.floor(s),h=1===l?v.Second:v.Seconds),c.format(o,l,h)}function n(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,0,0,0,0)}function o(e,t){var i=t.getHours(),r=t.getMinutes();return c.format(e.DateTime.formats.timeAt,s(e)[t.getMonth()],t.getDate(),i>12?i%12:i,r<10?""+e.DateTime.units.zero+r:r,i>=12?e.DateTime.units.pm:e.DateTime.units.am)}function s(e){return[e.DateTime.months.January,e.DateTime.months.February,e.DateTime.months.March,e.DateTime.months.April,e.DateTime.months.May,e.DateTime.months.June,e.DateTime.months.July,e.DateTime.months.August,e.DateTime.months.September,e.DateTime.months.October,e.DateTime.months.November,e.DateTime.months.December]}function a(e,t){return t?{Second:e.DateTime.units.sec,Seconds:e.DateTime.units.sec,Minute:e.DateTime.units.min,Minutes:e.DateTime.units.min,Hour:e.DateTime.units.h,Hours:e.DateTime.units.h,Day:e.DateTime.units.d,Days:e.DateTime.units.d,Week:e.DateTime.units.wk,Weeks:e.DateTime.units.wk,Month:e.DateTime.units.mo,Months:e.DateTime.units.mo,Year:e.DateTime.units.yr,Years:e.DateTime.units.yr}:{Second:e.DateTime.units.second,Seconds:e.DateTime.units.seconds,Minute:e.DateTime.units.minute,Minutes:e.DateTime.units.minutes,Hour:e.DateTime.units.hour,Hours:e.DateTime.units.hours,Day:e.DateTime.units.day,Days:e.DateTime.units.days,Week:e.DateTime.units.week,Weeks:e.DateTime.units.weeks,Month:e.DateTime.units.month,Months:e.DateTime.units.months,Year:e.DateTime.units.year,Years:e.DateTime.units.years}}function l(e,t,i){switch(t.toLowerCase()){case e.Second:t=1===i?e.Second:e.Seconds;break;case e.Minute:t=1===i?e.Minute:e.Minutes;break;case e.Hour:t=1===i?e.Hour:e.Hours;break;case e.Day:t=1===i?e.Day:e.Days;break;case e.Week:t=1===i?e.Week:e.Weeks;break;case e.Month:t=1===i?e.Month:e.Months;break;case e.Year:t=1===i?e.Year:e.Years}return t}Object.defineProperty(t,"__esModule",{value:!0});var c=i(1),u=60,p=60*u,d=24*p,g=7*d,m=30*d,f=365*d,h=function(){function e(){}return e}();t.DateTimeOptions=h,t.getFriendlyTimeSinceString=r,t.getIntervalDate=n,t.getTimeAtDateTimeString=o;var v=function(){function e(){}return e}();t.DateTimeUnits=v,t.getDateTimeUnits=a,t.getDateTimeUnitToDisplay=l},function(e,t){function i(e,t){return e===t||e!==e&&t!==t}e.exports=i},function(e,t){function i(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}var r=9007199254740991;e.exports=i},function(e,t){function i(e,t){return e="number"==typeof e||n.test(e)?+e:-1,t=null==t?r:t,e>-1&&e%1==0&&e<t}var r=9007199254740991,n=/^(?:0|[1-9]\d*)$/;e.exports=i},function(e,t,i){"use strict";function r(e){if(!e)return null;switch(e.type){case"Microsoft.ProcessSimple/flows":return s.Flow;case"Microsoft.ProcessSimple/apis/connections":return s.Connection;default:return null}}function n(e){return o(e.id)}function o(e){for(var t=e.split("/"),i={},r=1;r<t.length-1;r+=2)i[t[r]]=t[r+1];return i}Object.defineProperty(t,"__esModule",{value:!0});var s;!function(e){e[e.Flow=0]="Flow",e[e.Connection=1]="Connection"}(s=t.ResourceType||(t.ResourceType={})),t.getResourceType=r,t.parseId=n,t.parseIdFromString=o},function(e,t){!function(e){function t(r){if(i[r])return i[r].exports;var n=i[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};t.m=e,t.c=i,t.p="../out",t(0)}([function(e,t,i){"use strict";var r=i(1),n=i(37),o=i(38),s=i(4),a=function(){function e(e){if(this.sdkConfig=e,!this.sdkConfig)throw new s.PowerAppsError("SDK options are required");if(this.sdkConfig.hostName&&"string"!=typeof this.sdkConfig.hostName)throw new s.PowerAppsError("The host name can only be of type string");this.sdkConfig.hostName=this.sdkConfig.hostName||"https://web.powerapps.com",this.sdkConfig.locale=this.sdkConfig.locale||"en-us"}return e.prototype.renderWidget=function(e,t,i){switch(e){case o.ConnectionWidget.widgetType:return new o.ConnectionWidget(this.sdkConfig,t,i);case r.ExportWidget.widgetType:return new r.ExportWidget(this.sdkConfig,t,i);case n.ImportWidget.widgetType:return new n.ImportWidget(this.sdkConfig,t,i);default:throw new s.PowerAppsError("Please provide a valid supported widget type.")}},e}();t.PowerAppsSDK=a,window.PowerAppsSDK=a,window.PowerAppsSDKLoaded&&window.PowerAppsSDKLoaded()},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(2),o=function(){function e(){}return e}();t.IExportWidgetData=o;var s=function(e){function t(t,i,r){var n=e.call(this,t,i,r)||this;return n.sdkConfig=t,n.widgetConfig=i,n.widgetData=r,n}return r(t,e),t.prototype.constructPath=function(){return"/environments/"+this.widgetData.environmentName+"/flows/"+this.widgetData.flowName+"/export"},t}(n.Widget);s.widgetType="export",t.ExportWidget=s},function(e,t,i){"use strict";var r=i(3),n=i(4),o=i(5),s=i(18),a=i(36),l=function(){function e(e,t,i){if(this.sdkConfig=e,this.widgetConfig=t,this.widgetData=i,this.callbacks={},this.notifyCallback="NOTIFY",!this.widgetConfig)throw new n.PowerAppsError("Widget requires a widget option.");if(!this.sdkConfig)throw new n.PowerAppsError("Widget requires a sdk option.");if(!this.sdkConfig.hostName||this.sdkConfig.hostName.length<1)throw new n.PowerAppsError("hostName is required in sdk option.");if("string"==typeof this.sdkConfig.hostName&&"/"===this.sdkConfig.hostName.charAt(this.sdkConfig.hostName.length-1)&&(this.sdkConfig.hostName=this.sdkConfig.hostName.substring(0,this.sdkConfig.hostName.length-1)),s.isString(this.widgetConfig.container)&&(this.widgetConfig.container=document.getElementById(this.widgetConfig.container)),!this.widgetConfig.container)throw new n.PowerAppsError("Widget requires a container element.");s.isNullOrUndefined(this.widgetConfig.widgetId)&&(this.widgetConfig.widgetId=o.uuid()),this.url=this.constructUrl(),this.renderIframe(),this.rpcClient=new a.Rpc({signature:this.widgetConfig.widgetId,targetOrigin:"*",rpcMessageHandler:new a.WindowPostMessageRpcHandler({targetWindow:this.iframe.contentWindow})})}return e.prototype.notify=function(e,t){var i=this;return new Promise(function(r,n){var o=i.createRequestParam(),s={actionName:e,actionData:t};o.data=s,i.rpcClient.call(i.notifyCallback,[o]).then(function(e){r(e&&e.data?e.data:null)}).catch(function(e){e&&e.innerException&&(e=e.innerException.data?e.innerException.data:{code:"UnknownError",message:e.innerException.message}),n(e)})})},e.prototype.listen=function(e,t){this.callbacks[e]||(this.callbacks[e]=t)},e.prototype.dispose=function(){this.iframe&&(this.widgetConfig.container.removeChild(this.iframe),r.removeEventListener("message",this.onReceivedMessageHandler))},e.prototype.constructUrl=function(){return("string"==typeof this.sdkConfig.hostName?this.sdkConfig.hostName+"/widget":this.sdkConfig.hostName[0]+"/widget")+this.constructPath()+"?l="+this.sdkConfig.locale},e.prototype.createRequestParam=function(){return{callInfo:{widgetId:this.widgetConfig.widgetId}}},e.prototype.renderIframe=function(){var e=this;this.iframe=document.createElement("iframe"),this.iframe.setAttribute("src",this.url),this.iframe.setAttribute("id",this.widgetConfig.widgetId),this.iframe.setAttribute("name","widgetIFrame");var t=this.widgetConfig.container;this.iframe.scrolling=t.getAttribute("data-mswidget-scrolling")||"yes",t.appendChild(this.iframe),this.onReceivedMessageHandler=function(t){return e.onMessageReceived(t)},r.addEventListener("message",this.onReceivedMessageHandler,!0)},e.prototype.onMessageReceived=function(e){if(this.isValidRpcEvent(e)&&e.data.method)switch(e.data.method){case"__PING__":this.rpcAckHandler(e);break;default:this.invokeCallbackHandler(e.data.method,e)}},e.prototype.isValidRpcEvent=function(e){return"string"==typeof this.sdkConfig.hostName?s.equalsIgnoreCase(e.origin,this.sdkConfig.hostName):(s.equalsIgnoreCase(e.origin,this.sdkConfig.hostName[0])||s.equalsIgnoreCase(e.origin,this.sdkConfig.hostName[1]))&&s.equalsIgnoreCase(e.data.signature,this.widgetConfig.widgetId)},e.prototype.rpcAckHandler=function(e){var t={id:e.data.id,signature:e.data.signature,result:"__PONG__",error:null};e.source.postMessage(t,e.origin)},e.prototype.invokeCallbackHandler=function(e,t){var i;t&&t.data&&t.data.params&&t.data.params.length>0&&(i=t.data.params[0]);var r=this.callbacks[e];if(r){var n={id:t.data.id,signature:t.data.signature},o=function(e,i){n.result=i,n.error=e,t.source.postMessage(n,t.origin)};try{r(i,o)}catch(e){n.result=null,n.error=e,t.source.postMessage(n,t.origin)}}},e}();l.widgetPrefix="powerapps-sdk",t.Widget=l},function(e,t){"use strict";function i(e,t,i){window.addEventListener?window.addEventListener(e,t,i):window.attachEvent(e,t)}function r(e,t,i){window.removeEventListener?window.removeEventListener(e,t,i):window.detactEvent(e,t)}t.addEventListener=i,t.removeEventListener=r},function(e,t){"use strict";var i=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},r=function(e){function t(i){var r=e.call(this,t.errorName+": message")||this;return r.message=i,r.name=t.errorName,r}return i(t,e),t}(Error);r.errorName="MsFlowCustomApiSDK",t.PowerAppsError=r},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}var n=i(6);t.date=n;var o=i(9);t.json=o;var s=i(12);t.object=s;var a=i(18);t.string=a;var l=i(26);t.url=l,r(i(34)),r(i(35))},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}r(i(7)),r(i(8))},function(e,t){"use strict";function i(e){var t="";if(e.hasOwnProperty("toISOString"))t=e.toISOString();else{t=e.getUTCFullYear()+"-"+r(e.getUTCMonth()+1,2)+"-"+r(e.getUTCDate(),2)+"T"+r(e.getUTCHours(),2)+":"+r(e.getUTCMinutes(),2)+":"+r(e.getUTCSeconds(),2)+"."+r(e.getUTCMilliseconds(),3)+"Z"}return t}function r(e,t){for(var i=""+e,r=i.length,n=r;n<t;n++)i="0"+i;return i}t.toISOString=i},function(e,t){"use strict";function i(e){return e?new Date(e):null}t.getDate=i},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}r(i(10)),r(i(11))},function(e,t){"use strict";function i(e,t){var i=[],r=function(e,t){if(null!==t&&"object"==typeof t){if(i.indexOf(t)>=0)return;i.push(t)}return t};return e?JSON.stringify(e,r,t?"\t":4):""}t.prettyStringify=i},function(e,t,i){"use strict";function r(e){if(n.isObject(e)){"function"==typeof e.toJSON&&(e=e.toJSON());var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push({key:i,value:e[i]});t.sort(function(e,t){return e.key<t.key?-1:1});return"{"+t.map(function(e){return'"'+e.key+'":'+r(e.value)}).join(",")+"}"}if(Array.isArray(e)){"function"==typeof e.toJSON&&(e=e.toJSON());return"["+e.map(function(e){return r(e)}).join(",")+"]"}return JSON.stringify(e)}var n=i(12);t.stableStringify=r},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}r(i(13)),r(i(14)),r(i(15)),r(i(16)),r(i(17))},function(e,t){"use strict";function i(e,t,i){for(var r in e)e.hasOwnProperty(r)&&t.call(i,{key:r,value:e[r]})}t.forEach=i},function(e,t){"use strict";function i(e,t){return e[t]}t.getEnumValue=i},function(e,t){"use strict";function i(e){return!(!e||"object"!=typeof e||e instanceof Date||e instanceof RegExp||Array.isArray(e))}t.isObject=i},function(e,t){"use strict";function i(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}t.isObjectEmpty=i},function(e,t,i){"use strict";function r(e,t,i){var r=[];return n.forEach(e,function(e){var n=t.call(i,e);null!==n&&void 0!==n&&r.push(n)}),r}var n=i(13);t.map=r},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}r(i(19)),r(i(20)),r(i(21)),r(i(22)),r(i(23)),r(i(24)),r(i(25))},function(e,t){"use strict";function i(e,t){return e=(""+e).toUpperCase(),t=(""+t).toUpperCase(),e===t}t.equalsIgnoreCase=i},function(e,t){"use strict";function i(){var e,t=Array.prototype.slice.apply(arguments),i=t[0]||"",r=t.slice(1),n=/\{[a-zA-Z$_\d]*\}/g,o=/\{(\d+)\}/g,s=!1;if(r&&1===r.length&&r[0]&&"object"==typeof r[0]){var a=r[0];e=i.replace(n,function(e){var t=e.substring(1,e.length-1);return a.hasOwnProperty(t)?(s=!0,a[t]):e})}return s||(e=i.replace(o,function(e,i){return void 0!==t[i]?t[i]:e})),e}t.format=i},function(e,t){"use strict";function i(e){return null===e||void 0===e}t.isNullOrUndefined=i},function(e,t,i){"use strict";function r(e,t){var i,r=""+e;return r&&t&&(i=n.equalsIgnoreCase(r.substring(0,t.length),t)),i}var n=i(19);t.startsWithIgnoreCase=r},function(e,t,i){"use strict";function r(e,t){var i,r=""+e;return r&&t&&(i=n.equalsIgnoreCase(r.substr(r.length-t.length),t)),i}var n=i(19);t.endsWithIgnoreCase=r},function(e,t){"use strict";function i(e){return"string"==typeof e||e instanceof String}t.isString=i},function(e,t){"use strict";function i(e,t,i){return void 0===i&&(i=0),String.prototype.indexOf.call(e,t,i)>=0}t.stringIncludes=i},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}r(i(27)),r(i(28)),r(i(29)),r(i(30)),r(i(31)),r(i(32)),r(i(33))},function(e,t,i){"use strict";function r(e,t){return o.endsWithIgnoreCase(e,"/")&&n.startsWithIgnoreCase(t,"/")?e.substring(0,e.length-1)+t:o.endsWithIgnoreCase(e,"/")||n.startsWithIgnoreCase(t,"/")?e+t:e+"/"+t}var n=i(22),o=i(23);t.concatParts=r},function(e,t,i){"use strict";function r(e,t,i,r){return new o(e,t).format(i,r)}var n=i(12);t.formatDottedUrl=r;var o=function(){function e(e,t){this._dottedUrlTemplate=[e,t].join("/")}return e.prototype.format=function(e,t){var i=this;e=e||{},t=t||{};var r={},o=this._dottedUrlTemplate.replace(/:(\w+?)(\W|$)/g,function(n,o,s){if(!e[o])return""+s;var a=e[o];return"string"==typeof a&&"@"===a[0]&&(a=i._lookupDottedPath(t||{},a)),angular.isFunction(a)&&(a=a()),r[o]=a,a+s}),s={};n.forEach(e,function(e){r[e.key]||(s[e.key]=angular.isFunction(e.value)?e.value():e.value)}),o=o.split("://").map(function(e){return e.replace(/[\/]{2,}/g,"/")}).join("://"),o=this._encodeUri(o);var a=this._getQueryString(s);return a&&(o=o+(/\?/.test(o)?"&":"?")+a),o},e.prototype._lookupDottedPath=function(e,t){try{return""+(t||"").split(".").reduce(function(e,t){return e[t]},e)}catch(e){return""}},e.prototype._getQueryString=function(e){var t=this;return n.map(e,function(e){var i=t._camelCaseToHypens(e.key);return t._encodeQueryStringComponent(i)+"="+t._encodeQueryStringComponent(e.value)}).join("&")},e.prototype._camelCaseToHypens=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},e.prototype._encodeUri=function(e){return encodeURI(e).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+").replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")},e.prototype._encodeQueryStringComponent=function(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")},e}()},function(e,t,i){"use strict";function r(e){return s.startsWithIgnoreCase(e,"http://")}function n(e){return s.startsWithIgnoreCase(e,"https://")}function o(e){return n(e)||r(e)}var s=i(22);t.isHttpUrl=r,t.isHttpsUrl=n,t.isAbsoluteUrl=o},function(e,t,i){"use strict";function r(e){var t=document.createElement("a");t.href=e;var i=t.pathname||"";return o.startsWithIgnoreCase(i,"/")||(i="/"+i),{raw:e,protocol:t.protocol?t.protocol.replace(/:/g,""):"",host:t.host||"",hostname:t.hostname||"",port:t.port?Number(t.port):void 0,path:i,parameters:n.parseQueryString(t.search||""),hash:decodeURIComponent(t.hash||"")}}var n=i(31),o=i(22);t.parseUri=r},function(e,t,i){"use strict";function r(e){var t={};return e?(o.startsWithIgnoreCase(e,"?")&&(e=e.substring(1)),e.split("&").forEach(function(e){var i=e.split("="),r=i[0],n=i[1];t[decodeURIComponent(r||"")]=decodeURIComponent(n||"")}),t):t}function n(e){return Object.keys(e||{}).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}var o=i(22);t.parseQueryString=r,t.createQueryString=n},function(e,t){"use strict";function i(e){return e.replace(/^\/+/,"")}t.stripLeadingSlashes=i},function(e,t){"use strict";function i(e){return e.replace(/\/+$/,"")}t.stripTrailingSlashes=i},function(e,t){"use strict";var i=function(){function e(e){this.initialized=!1,this.func=e}return Object.defineProperty(e.prototype,"value",{get:function(){if(this.initialized){if(this.cachedError)throw this.cachedError;return this.cachedValue}try{return this.cachedValue=this.func(),this.cachedValue}catch(e){throw this.cachedError=e,e}finally{this.initialized=!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValueCreated",{get:function(){return this.initialized},enumerable:!0,configurable:!0}),e}();t.Lazy=i},function(e,t){"use strict";function i(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return r[255&e]+r[e>>8&255]+r[e>>16&255]+r[e>>24&255]+"-"+(r[255&t]+r[t>>8&255])+"-"+r[t>>16&15|64]+r[t>>24&255]+"-"+(r[63&i|128]+r[i>>8&255])+"-"+r[i>>16&255]+r[i>>24&255]+"-"+(r[255&n]+r[n>>8&255]+r[n>>16&255]+r[n>>24&255])}for(var r=[],n=0;n<256;n++)r[n]=(n<16?"0":"")+n.toString(16);t.uuid=i},function(e,t,i){var r;void 0!==(r=function(){return function(e){function t(r){if(i[r])return i[r].exports;var n=i[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){var r,n;r=[i,t,i(1),i(2)],void 0!==(n=function(e,t,i,r){"use strict";function n(){var e={};return e.promise=new Promise(function(t,i){e.resolve=t,e.reject=i}),e}var o="__PING__",s=function(){function e(e){var t=this;if(this._deferredResponses={},this._rpcMethods={},this._ready=!1,this._queuedRequestMessages=[],this._onRpcMessageRecieved=function(e){if(e&&e.signature===t._rpcOptions.signature){var i=e;i.method?t._onRpcRequestMessageReceived(i):t._onRpcResponseMessageReceived(e)}},this._onRpcRequestMessageReceived=function(e){var i=t._rpcMethods[e.method];if(i){var r={signature:e.signature,id:e.id,error:null};try{var n=i.apply(t,e.params);t._rpcOptions.Promise.resolve(n).then(function(e){r.result=e,t._rpcOptions.rpcMessageHandler.postMessage(r,t._rpcOptions.targetOrigin)}).catch(function(e){r.error=t._serializeError(e),t._rpcOptions.rpcMessageHandler.postMessage(r,t._rpcOptions.targetOrigin)})}catch(e){r.error=t._serializeError(e),t._rpcOptions.rpcMessageHandler.postMessage(r,t._rpcOptions.targetOrigin)}}},this._onRpcResponseMessageReceived=function(e){var i=t._deferredResponses[e.id];i&&(e.error?i.reject(t._deserializeError(e.error)):i.resolve(e.result),delete t._deferredResponses[e.id])},!e)throw new Error("rpcOptions required");e.Promise||(e.Promise={defer:n,resolve:function(e){return Promise.resolve(e)},reject:function(e){return Promise.reject(e)}}),this._rpcOptions=e,this._rpcOptions.rpcMessageHandler.addListener(this._onRpcMessageRecieved),this.register(o,this._onPing)}return e.prototype.ack=function(){var e=this;return this.unregister(o),this.call(o).then(function(t){if("__PONG__"!==t)return Promise.reject(new Error("Invalid PONG message"+t));e._ready=!0,e._processQueue()}).catch(function(t){return e.register(o,e._onPing),console.error("PING failed to receive PONG message",t),Promise.reject(t)})},e.prototype.call=function(e,t){var i=r.default(),n={signature:this._rpcOptions.signature,id:i,method:this._normalizeMethodName(e),params:t},s=this._rpcOptions.Promise.defer();return this._deferredResponses[i]=s,this._ready||e===o?this._call(n):this._queuedRequestMessages.push(n),s.promise},e.prototype.register=function(e,t){var i=this._normalizeMethodName(e);if(this._rpcMethods[i])throw new Error("Rpc method with name '"+e+"' already registered.");this._rpcMethods[i]=t},e.prototype.unregister=function(e){var t=this._normalizeMethodName(e);if(!this._rpcMethods[t])throw new Error("Rpc method with name "+e+" failed to unregister. Method not found");delete this._rpcMethods[t]},e.prototype.dispose=function(){var e=this;this._rpcMethods={},Object.keys(this._deferredResponses).forEach(function(t){return e._deferredResponses[t].reject(new Error("rpc disposed"))}),this._deferredResponses={},this._rpcOptions.rpcMessageHandler.removeListener(this._onRpcMessageRecieved)},e.prototype._call=function(e){try{this._rpcOptions.rpcMessageHandler.postMessage(e,this._rpcOptions.targetOrigin)}catch(t){this._deferredResponses[e.id].reject(t),delete this._deferredResponses[e.id]}},e.prototype._onPing=function(){return this.unregister(o),this._ready=!0,this._processQueue(),"__PONG__"},e.prototype._processQueue=function(){var e=this;this._queuedRequestMessages.forEach(function(t){return e._call(t)}),this._queuedRequestMessages=[]},e.prototype._normalizeMethodName=function(e){return e.toUpperCase()},e.prototype._serializeError=function(e){if(e instanceof Error){var t={name:e.name,message:e.message,_stack:e.stack};return Object.keys(e).forEach(function(i){t[i]=e[i]}),{value:t}}return{value:e}},e.prototype._deserializeError=function(e){return new i.RpcException("ReceiverFailed","Receiver failed",i.convertToException(e.value))},e}();t.Rpc=s;var a=function(){function e(e){if(this._listeners={},!e)throw new Error("options required");if(!e.targetWindow)throw new Error("targetWindow required");e.sourceWindow=e.sourceWindow||window,e.messageSerializer=e.messageSerializer||function(e){return e},e.messageDeserializer=e.messageDeserializer||function(e){return e},this._options=e}return e.prototype.postMessage=function(e,t){this._options.targetWindow.postMessage(this._options.messageSerializer(e),t)},e.prototype.addListener=function(e){var t=this;this._listeners[e]&&console.error("duplicate rpc listener added"),this._listeners[e]=function(i){var r=t._options.messageDeserializer(i.data);r&&e(r.method?{signature:r.signature,id:r.id,method:r.method,params:r.params}:{signature:r.signature,id:r.id,result:r.result,error:r.error})},this._options.sourceWindow.addEventListener("message",this._listeners[e])},e.prototype.removeListener=function(e){this._options.sourceWindow.removeEventListener("message",this._listeners[e]),delete this._listeners[e]},e}();t.WindowPostMessageRpcHandler=a}.apply(t,r))&&(e.exports=n)},function(e,t,i){var r,n,o=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};r=[i,t],void 0!==(n=function(e,t){"use strict";function i(e){return e instanceof Error||e.name&&e.message&&!e.hasOwnProperty("_stackTrace")?new r("ErrorException","Error",e.message,e):e.type&&e.code&&e.message&&e.hasOwnProperty("_stackTrace")?e:new n(e)}var r=function(){function e(e,t,i,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var o=r&&r instanceof Error?r:new Error(i);if(!e)throw new a("Type cannot be empty for exception");if(this._type=e,!t)throw new a("Code cannot be empty for exception");if(this._code=t,!i)throw new a("Message cannot be empty for exception");this._message=i,this._data=r,this._stackTrace=o.stack,this._innerException=n}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"code",{get:function(){return this._code},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stackTrace",{get:function(){return this._stackTrace},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"innerException",{get:function(){return this._innerException},enumerable:!0,configurable:!0}),e}();t.Exception=r;var n=function(e){function t(t){return e.call(this,"UnknownException","UnknownException","Unknown error.",t)||this}return o(t,e),t}(r);t.UnknownException=n;var s=function(e){function t(t,i,r){return void 0===r&&(r=null),e.call(this,"RpcException",t,i,null,r)||this}return o(t,e),t}(r);t.RpcException=s;var a=function(e){function t(t){return e.call(this,"ArgumentException","ArgumentException",t,null,null)||this}return o(t,e),t}(r);t.ArgumentException=a,t.convertToException=i}.apply(t,r))&&(e.exports=n)},function(e,t,i){var r,n;r=[i,t],void 0!==(n=function(e,t){"use strict";function i(){for(var e,t="",i=0;i<4;i++)e=4294967296*Math.random()|0,t+=r[15&e]+r[e>>4&15]+r[e>>8&15]+r[e>>12&15]+r[e>>16&15]+r[e>>20&15]+r[e>>24&15]+r[e>>28&15];var o=r[8+4*Math.random()|0];return t.substr(0,8)+n+t.substr(9,4)+n+"4"+t.substr(13,3)+n+o+t.substr(16,3)+n+t.substr(19,12)}var r=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],n="-";Object.defineProperty(t,"__esModule",{value:!0}),t.default=i}.apply(t,r))&&(e.exports=n)}])}.call(t,i,t,e))&&(e.exports=r)},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(2),o=function(){function e(){}return e}();t.IImportWidgetData=o;var s=function(e){function t(t,i,r){var n=e.call(this,t,i,r)||this;return n.sdkConfig=t,n.widgetConfig=i,n.widgetData=r,n}return r(t,e),t.prototype.constructPath=function(){return"/environments/"+this.widgetData.environmentName+"/flows/import"},t}(n.Widget);s.widgetType="import",t.ImportWidget=s},function(e,t,i){"use strict";var r=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},n=i(2),o=function(){function e(){}return e}();t.IConnectionWidgetData=o;var s=function(e){function t(t,i,r){var n=e.call(this,t,i,r)||this;return n.sdkConfig=t,n.widgetConfig=i,n.widgetData=r,n}return r(t,e),t.prototype.constructPath=function(){return"/environments/"+this.widgetData.environmentName+"/connections"},t}(n.Widget);s.widgetType="connections",t.ConnectionWidget=s}])},function(e,t,i){"use strict";function r(e){return"providers/Microsoft.PowerApps/gateways/"+e}function n(e){return e.properties.displayName||e.name}function o(e){return e.properties.machineName||""}function s(e){return e.properties.description||""}function a(e){return e.properties.contactInformation||[]}function l(e){return e.properties.status||""}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var c=i(0),u=i(9),p=i(20);t.GatewaysConstant={urlPath:u.getAppSettings().powerAppsResourceProviderPath+"/gateways",resourceType:u.getAppSettings().powerAppsResourceProviderPath+"/gateways"},t.apiFilter="apiName eq '{0}'",t.PollFrequency={listGateways:6e4,getGateway:45e3,evictionDelay:3e5},t.getGatewayId=r,t.getDisplayName=n,t.getMachineName=o,t.getDescription=s,t.getContactInfo=a,t.getStatusMessage=l,angular.module(c.default.modules.processSimpleData).factory(c.default.services.gatewaysClient,[c.default.services.appSettings,c.default.services.azureResourceClientFactory,c.default.services.environment,function(e,i,r){return i({urlBase:e.powerAppsResourceProviderEndpoint,urlPath:t.GatewaysConstant.urlPath,resourceType:t.GatewaysConstant.resourceType,apiVersion:e.featureFlags.enableEnvironments?e.powerAppsResourceProviderApiVersionWithEnvironments:e.powerAppsResourceProviderApiVersion,rest:{query:{params:p.extendQueryParamsWithEnvironment({},e.featureFlags.enableEnvironments,r.getCurrentEnvironmentName())},get:{params:p.extendQueryParamsWithEnvironment({id:"@id"},e.featureFlags.enableEnvironments,r.getCurrentEnvironmentName())}},actions:[],options:{queryPollInterval:t.PollFrequency.listGateways,getPollInterval:t.PollFrequency.getGateway,evictionDelay:t.PollFrequency.evictionDelay}})}])},function(e,t,i){function r(e,t){for(var i=e.length;i--;)if(n(e[i][0],t))return i;return-1}var n=i(84);e.exports=r},function(e,t,i){var r=i(92),n=r(Object,"create");e.exports=n},function(e,t,i){function r(e,t){var i=null==e?void 0:e[t];return n(i)?i:void 0}var n=i(514);e.exports=r},function(e,t,i){var r,n;r=[i,t],void 0!==(n=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultKeyPrefix="$";!function(e){e.BasePath="x-ms-base-path",e.DynamicSchema="x-ms-dynamic-schema",e.DynamicValues="x-ms-dynamic-values",e.Encode="x-ms-url-encoding",e.Headers="x-ms-headers",e.Method="x-ms-method",e.NotificationContent="x-ms-notification-content",e.NotificationUrl="x-ms-notification-url",e.Path="x-ms-path",e.Permission="x-ms-permission",e.SchedulerRecommendation="x-ms-scheduler-recommendation",e.SchedulerTrigger="x-ms-scheduler-trigger",e.Summary="x-ms-summary",e.Trigger="x-ms-trigger",e.Visibility="x-ms-visibility",e.Annotation="x-ms-api-annotation",e.TriggerHint="x-ms-trigger-hint",e.DynamicallyAdded="x-ms-dynamically-added",e.ContentHint="x-ms-content-hint"}(t.ExtensionProperties||(t.ExtensionProperties={}));!function(e){e.Body="body",e.FormData="formData",e.Header="header",e.Path="path",e.Query="query"}(t.ParameterLocations||(t.ParameterLocations={}));!function(e){e.$200="200",e.$201="201",e.$202="202",e.$203="203",e.$204="204",e.$205="205",e.$206="206",e.$207="207",e.$208="208",e.$226="226",e.$default="default"}(t.ResponseCodes||(t.ResponseCodes={}));!function(e){e.Advanced="advanced",e.Internal="internal",e.Important="important",e.ReadOnly="read-only"}(t.Visibility||(t.Visibility={}));!function(e){e.Single="single",e.Batch="batch"}(t.TriggerTypes||(t.TriggerTypes={}));!function(e){e.Array="array",e.Boolean="boolean",e.File="file",e.Integer="integer",e.Null="null",e.Number="number",e.Object="object",e.String="string",e.Any="any"}(t.Types||(t.Types={}));!function(e){e.StatusCode="statusCode",e.Queries="queries",e.Headers="headers",e.Body="body",e.Schema="schema",e.Outputs="outputs",e.Name="name",e.Properties="properties"}(t.OutputSource||(t.OutputSource={}));!function(e){e.Body="key-body-output",e.Headers="key-headers-output",e.Item="key-item-output",e.Outputs="key-outputs-output",e.Queries="key-queries-output",e.StatusCode="key-statuscode-output",e.Name="key-name-output",e.Properties="key-properties-output",e.PathParameters="key-pathparameters-output"}(t.OutputKeys||(t.OutputKeys={}));!function(e){e.ConnectionId="connectionId"}(t.ReservedParameterNames||(t.ReservedParameterNames={})),t.OutputMapKey="key"}.apply(t,r))&&(e.exports=n)},function(e,t,i){"use strict";function r(e,t,i){return n(l.copy(e),t,i)}function n(e,t,i){return u.isEmpty(e)||"object"!=typeof e?e:Array.isArray(e)?e.map(function(e){return r(e,t,i)}):(Object.keys(e).forEach(function(n){return e[n]=r(e[n],t,i)}),c.mapKeys(e,function(e,r){return r.replace(t,i)}))}function o(e){return s(e,[],"")}function s(e,t,i){var r={};return u.isEmpty(e)||"object"!=typeof e||t.some(function(t){return t===e})?{}:(t.push(e),e.$ref&&(r[e.$ref]=[i]),Array.isArray(e)?e.forEach(function(e,n){var o=s(e,t,i+"["+n+"]");r=a(r,o)}):Object.keys(e).map(function(r){return s(e[r],t,i+"."+r.split(".").join("~1"))}).forEach(function(e){r=a(r,e)}),r)}function a(e,t){var i=l.copy(e);return Object.keys(t).forEach(function(e){i[e]?i[e]=i[e].concat(t[e]):i[e]=t[e]}),i}Object.defineProperty(t,"__esModule",{value:!0});var l=i(22),c=i(64),u=i(1);t.getObjectWithStringInKeysReplaced=r,t.getAllReferences=o},function(e,t,i){"use strict";function r(e,t,i){return o.getAppSettings().processSimpleResourceProviderPath+"/environments/"+s.getCurrentEnvironmentName()+"/flows/"+e+"/"+t+"/"+i}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var n=i(0),o=i(9),s=i(20),a=i(14);t.FlowRoles={owners:"owners",users:"users"},t.FlowRolesConstant={urlPath:o.getAppSettings().processSimpleResourceProviderPath+"/environments/"+s.getCurrentEnvironmentName()+"/flows/:flowName/:roleName/:id",listUrlPath:o.getAppSettings().processSimpleResourceProviderPath+"/environments/"+s.getCurrentEnvironmentName()+"/flows/:flowName/:roleName",modifyUrlPath:o.getAppSettings().processSimpleResourceProviderPath+"/environments/"+s.getCurrentEnvironmentName()+"/flows/:flowName/modify:roleName",requestAccessUrlPath:o.getAppSettings().processSimpleResourceProviderPath+"/environments/"+s.getCurrentEnvironmentName()+"/flows/:flowName/requestUserAccess",resourceType:o.getAppSettings().processSimpleResourceProviderPath+"/environments/flows/:roleName"},t.getFlowRoleId=r,angular.module(n.default.modules.processSimpleData).factory(n.default.services.flowRolesClient,[n.default.services.azureResourceClientFactory,n.default.services.appSettings,n.default.services.environment,function(e,i){var r={urlPath:t.FlowRolesConstant.modifyUrlPath,name:"modify",method:"POST",params:{flowName:"@flowName",roleName:"@roleName"}},n={urlPath:t.FlowRolesConstant.requestAccessUrlPath,name:"requestAccess",method:"POST",params:{flowName:"@flowName"}};return e({apiVersion:i.processSimpleResourceProviderApiVersionWithEnvironments,urlBase:a.ProcessSimpleResourceProviderManagementEndpoint,urlPath:t.FlowRolesConstant.urlPath,resourceType:t.FlowRolesConstant.resourceType,rest:{delete:{params:{id:"@id"}},query:{urlPath:t.FlowRolesConstant.listUrlPath,params:{flowName:"@flowName",roleName:"@roleName"}}},actions:[r,n]})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RoleName={CanView:"CanView",CanViewWithShare:"CanViewWithShare",CanEdit:"CanEdit",Owner:"Owner"},t.PrincipalType={User:"User",Group:"Group",Tenant:"Tenant",NotSpecified:"NotSpecified"}},function(e,t,i){"use strict";function r(e,t){var i=e.filter(function(e){return b.equalsIgnoreCase(e.properties.principal.id,t)});return S.isEmpty(i)?null:i[0]}function n(e){return!(!e||!e.length)&&e.some(function(e){return b.equalsIgnoreCase(e.properties.principal.type,y.PrincipalType.Group)})}function o(e){return!(!e||!e.properties)&&b.equalsIgnoreCase(e.properties.roleName,y.RoleName.Owner)}function s(e){return!(!e||!e.properties)&&(b.equalsIgnoreCase(e.properties.roleName,y.RoleName.CanView)||b.equalsIgnoreCase(e.properties.roleName,y.RoleName.CanViewWithShare))}function a(e){return!(!e||!e.properties)&&b.equalsIgnoreCase(e.properties.roleName,y.RoleName.CanViewWithShare)}function l(e){return!(!e||!e.properties)&&!b.equalsIgnoreCase(e.properties.roleName,y.RoleName.CanView)}function c(e){return!(!e||!e.properties)&&u(e.properties.principal.type)}function u(e){return b.equalsIgnoreCase(e,y.PrincipalType.Tenant)}function p(e){return e.filter(function(e){return!!e.properties.principal.id&&!c(e)}).map(function(e){return e.properties.principal.id})}function d(e){return g(m(e))}function g(e){if(e&&e.length>0){var t=e[0];return e.forEach(function(e){e.priority<t.priority&&(t=e)}),t}return null}function m(e){return[y.RoleName.CanView,y.RoleName.CanViewWithShare,y.RoleName.CanEdit,y.RoleName.Owner].map(function(t){return f(t,e)})}function f(e,t){switch(e){case y.RoleName.CanView:return{name:y.RoleName.CanView,displayName:t.Manage.CustomApi.Share.RoleView,priority:1};case y.RoleName.CanViewWithShare:return{name:y.RoleName.CanViewWithShare,displayName:t.Manage.CustomApi.Share.RoleViewWithShare,priority:2};case y.RoleName.CanEdit:return{name:y.RoleName.CanEdit,displayName:t.Manage.CustomApi.Share.RoleEdit,priority:3};case y.RoleName.Owner:return{name:y.RoleName.Owner,displayName:t.Manage.CustomApi.Share.RoleOwner,priority:4};default:return null}}function h(e,t){return e&&e.length?e.reduce(function(e,i){return(e&&e.properties?f(e.properties.roleName,t).priority:Number.NEGATIVE_INFINITY)>=(i&&i.properties?f(i.properties.roleName,t).priority:Number.NEGATIVE_INFINITY)?e:i}):null}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var v=i(0),y=i(96),w=i(20),C=i(9),S=i(1),b=i(8);t.PermissionsConstant={urlPath:C.getAppSettings().powerAppsResourceProviderPath+"/permissions",resourceType:C.getAppSettings().powerAppsResourceProviderPath+"/permissions"},t.PermissionsPollFrequency={evictionDelay:3e5},t.getPermissionForObjectId=r,t.hasGroupPermission=n,t.isUserOwner=o,t.isUserReader=s,t.isUserViewWithShare=a,t.canUserShare=l,t.isPermissionForTenant=c,t.isTenantPermissionType=u,t.getOidsFromPermissions=p,t.getDefaultRoleForResource=d,t.getRoleWithMinimumPriority=g,t.getRoles=m,t.getRole=f,t.getHighestPermission=h,angular.module(v.default.modules.processSimpleData).factory(v.default.services.permissionsClient,[v.default.services.$routeParams,v.default.services.appSettings,v.default.services.azureResourceClientFactory,v.default.services.environment,function(e,i,r,n){var o=i.powerAppsResourceProviderPath+"/apis/:apiName/permissions",s=i.powerAppsResourceProviderPath+"/apis/:apiName/modifyPermissions";return r({urlBase:i.powerAppsResourceProviderEndpoint,urlPath:o,apiVersion:i.powerAppsResourceProviderApiVersionWithEnvironments,resourceType:t.PermissionsConstant.resourceType,rest:{post:{params:w.extendQueryParamsWithEnvironment({},!0,n.getCurrentEnvironmentName())},query:{responseInterceptor:function(e){return e.data},params:w.extendQueryParamsWithEnvironment({},!0,n.getCurrentEnvironmentName())}},actions:[{name:"modify",urlPath:s,method:"POST"}],options:{atomize:!1,evictionDelay:t.PermissionsPollFrequency.evictionDelay}})}])},function(e,t,i){"use strict";function r(e){return s(e,[S.SkipDesignerTemplate])}function n(e){return s(e,[S.OneClickTemplate])}function o(e){return s(e,[S.Diet])}function s(e,t,i){if(void 0===i&&(i=!1),e&&e.properties&&e.properties.categoryNames&&e.properties.categoryNames.length>0){var r=e.properties.categoryNames.map(function(e){return(e||"").toUpperCase()});return i?(t||[]).every(function(e){return-1!==r.indexOf(e.toUpperCase())}):(t||[]).some(function(e){return-1!==r.indexOf(e.toUpperCase())})}return!1}Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),l=i(15),c=i(39),u=i(70),p=i(1),d=i(33),g=i(18),m=i(47),f=i(4),h=i(123),v=i(3),y=i(38),w=i(71),C=i(118),S={Diet:"diet",OneClickTemplate:"featured-oneclick",SkipDesignerTemplate:"featured-skipdesigner"};t.isSkipDesignerTemplate=r,t.isOneClickTemplate=n,t.isDietTemplate=o,t.isTemplateTaggedWith=s;var b=function(){function e(e,t,i,r,n,o,s,a,l,c,u,p){this.$q=e,this.$window=t,this.apisClient=i,this.clientResources=r,this.connectionHelper=n,this.connectionsClient=o,this.environmentService=s,this.flowsClient=a,this.loggingService=l,this.policiesService=c,this.sessionService=u,this.templatesClient=p}return e.prototype.autoCreateFlow=function(e,t,i){var r=this,n=this.loggingService.profileStart(f.ProfilingEventNames.autoCreateFlowStart);return this.$scope=e,(i?this.createFlowWithConnectionReferences(e,t,i):this.createFlow(t)).then(function(e){var i=g.isFlowCreationSuccess(e)?e.data.name:void 0;if(i)return r.loggingService.profileEnd(n,f.ProfilingEventNames.autoCreateFlowEnd,{status:v.Status.Success,templateName:t,flowName:i}),r.flowsClient.refreshQuery(g.getFlowsQueryParams({isPersonal:!0})),i;throw new l.ClientError(l.ErrorCodes.oneClickFlowCreationNoFlowName,r.clientResources.OneClickTemplate.NoFlowName,null,{responseStatusCode:e&&e.status,responseData:e&&e.data})}).catch(function(e){throw r.loggingService.profileEnd(n,f.ProfilingEventNames.autoCreateFlowEnd,{status:v.inferErrorStatus(e),error:v.parseErrorMessage(e),templateName:t}),r.loggingService.logError("TemplateCreationHelperService.autoCreateFlow",e),e})},e.prototype.createFlow=function(e){var t=this,i=this.getFlowWithDefinitionFromTemplate(e),r=this.connectionsClient.refreshQuery().then(function(){return t.connectionsClient.query(t.$scope)}),n=this.apisClient.query(this.$scope).$promise;return this.$q.all([i,r,n]).then(function(e){var i=e[0],r=e[1],n=e[2],o=i,s=r.filter(function(e){return!d.isConnectionInAuthError(e)}),a=n;return t.createAndUpdateConnectionReferences(o,s,a)}).then(function(e){return t.flowsClient.post({id:g.getNewFlowId()},e)})},e.prototype.createFlowWithConnectionReferences=function(e,t,i,r,n){var o=this;return this.$scope=e,this.getFlowWithDefinitionFromTemplate(t,r,n).then(function(e){var t=e.properties.connectionReferences;return Object.keys(t||{}).forEach(function(i){t[i]&&o.updateRuntimeUrl(e,i,t[i])}),e.properties.connectionReferences=w.getConnectionReferencesOfFlowFormat(i),o.flowsClient.post({id:g.getNewFlowId()},e)})},e.prototype.getFlowWithDefinitionFromTemplate=function(e,t,i){var r=this,n=m.getTemplateId("public",e);return this.templatesClient.get(this.$scope,{id:n}).$promise.then(function(){var o=r.templatesClient.get(r.$scope,{id:n});if(o){var s=$.extend(!0,{},o),a={},c={environment:{name:r.environmentService.getCurrentEnvironmentName()}},u=i?C.replaceParameterValues(s.properties.definition,i):s.properties.definition;return a.properties={},a.properties.definition=u,a.properties.connectionReferences=s.properties.connectionReferences,a.properties=$.extend(a.properties,c),a.properties.templateName=e,t&&(a.properties.flowAuthorizationDelegate={delegationSource:t}),r.updateRecurrenceFrequencyPerUserPlan(a),a}throw new l.ClientError(l.ErrorCodes.templateNotFoundError,p.format(r.clientResources.Manage.Flows.Template.NotFound,e,"public"),null,{galleryName:"public",templateName:e})})},e.prototype.createAndUpdateConnectionReferences=function(e,t,i){var r=this,n=e.properties.connectionReferences,o={},s=[];return Object.keys(n).forEach(function(a){var l=n[a];if(l.api){var c=l.api.id,u=r.getMatchingApi(c,i),p=r.getFlowDefinitionConnectionReference(l,t,u).then(function(t){o[a]=t,r.updateRuntimeUrl(e,a,l)});s.push(p)}else r.loggingService.logWarning("TemplateCreationService.createAndUpdateConnectionReferences","Api in connection reference "+l+" is null")}),this.$q.all(s).then(function(){return e.properties.connectionReferences=o,e})},e.prototype.getFlowDefinitionConnectionReference=function(e,t,i){var r=this,n={},o=e.api.id,s=this.getMatchingConnectionReference(o,t);return n.id=o,this.$q(function(e,t){if(s)n.connectionName=s.name,e(n);else{var o=y.uuid(),a=d.getConnectionId(i.name,o);r.connectionHelper.addConnection(i,a,null,!1).then(function(){n.connectionName=o,e(n)}).catch(function(e){t(e)})}})},e.prototype.getMatchingConnectionReference=function(e,t){var i=new RegExp("^"+e+"/"),r=t.filter(function(e){return i.test(e.id)});return r.length>0?r[0]:void 0},e.prototype.getMatchingApi=function(e,t){var i=new RegExp("^"+e+"$"),r=t.filter(function(e){return i.test(e.id)});return r.length>0?r[0]:void 0},e.prototype.updateRuntimeUrl=function(e,t,i){var r=this;Object.keys(e.properties.definition.triggers).forEach(function(n){r.updateOperationRuntimeUrl(t,i,e.properties.definition.triggers[n])}),Object.keys(e.properties.definition.actions).forEach(function(n){r.updateOperationRuntimeUrl(t,i,e.properties.definition.actions[n])})},e.prototype.updateOperationRuntimeUrl=function(e,t,i){var r=this;if(i){if(i.type===u.FlowTemplateOperationType.If){var n=$.extend({},i.actions,(i.else||{}).actions);Object.keys(n).forEach(function(i){r.updateOperationRuntimeUrl(e,t,n[i])})}else if(i.type===u.FlowTemplateOperationType.Foreach){var o=$.extend({},i.actions);Object.keys(o).forEach(function(i){r.updateOperationRuntimeUrl(e,t,o[i])})}if(!h.isNativeOperation(i)&&i.inputs&&i.inputs.host&&i.inputs.host.api){var s=i.inputs.host.api.runtimeUrl,a="shared_"+s.substr(s.lastIndexOf("/")+1);e===a&&(i.inputs.host.api.runtimeUrl=t.api.properties.primaryRuntimeUrl)}}},e.prototype.updateRecurrenceFrequencyPerUserPlan=function(e){var t=c.getFlowRecurrence(e),i=this.policiesService.getDefaultRecurrence();if(t!==c.NonRecurringFlowFrequency&&(t.frequency===c.RecurrenceFrequency.second||t.interval<i.interval&&t.frequency===c.RecurrenceFrequency.minute)){var r=Object.keys(e.properties.definition.triggers)[0];e.properties.definition.triggers[r].recurrence=i}},e.$inject=[a.default.services.$q,a.default.services.$window,a.default.services.apisClient,a.default.services.clientResources,a.default.services.connectionHelper,a.default.services.connectionsClient,a.default.services.environment,a.default.services.flowsClient,a.default.services.logging,a.default.services.policies,a.default.services.session,a.default.services.templatesClient],e}();t.TemplateCreationHelperService=b,angular.module(a.default.modules.processSimpleServices).service(a.default.services.templateCreationHelper,b)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);angular.module(r.default.modules.processSimpleInterceptors,[r.default.modules.processSimpleServices])},function(e,t,i){"use strict";function r(e,t,i,r,n){var a=g.resolveSchemaProperties(t,i,e);t.forEach(function(t){var l=a[t.key],c=e.definitions.indexOf(e.definitions.filter(function(e){return e.name===l.reference})[0]),u=l.reference?e.definitions[c].item:i;if(o(t,u,l.path),n){var p=l.reference?"#/definitions/"+l.reference:r;s(e,u,l.path,t.required,p)}})}function n(e,t,i,n,o){r(e,[t],i,n,o)}function o(e,t,i){var r=m.getObjectWithStringInKeysReplaced(t,".","~1");f.set(r,i+".description",e.description),f.set(r,i+".title",e.leafTitle),f.set(r,i+".type",e.type),f.set(r,i+".format",e.format),e.visibility===p.Visibility.none?f.unset(r,i+".x-ms-visibility"):f.set(r,i+".x-ms-visibility",e.visibility),e.dynamicValues?f.set(r,i+".x-ms-dynamic-values",e.dynamicValues):f.unset(r,i+".x-ms-dynamic-values"),e.enum?f.set(r,i+".enum",e.enum.map(function(e){return e.value})):f.unset(r,i+".enum"),e.default?f.set(r,i+".default",e.default):f.unset(r,i+".default"),a(t,m.getObjectWithStringInKeysReplaced(r,"~1","."))}function s(e,t,i,r,n){void 0===n&&(n="");for(var o=m.getObjectWithStringInKeysReplaced(t,".","~1"),u=i;!d.isNullOrWhitespace(u);){var p=l(o,u);c(o,p,u,r),u=p}!d.isNullOrWhitespace(n)&&Array.isArray(e.definitions)&&e.definitions.forEach(function(i){var o=m.getAllReferences(i.item);Array.isArray(o[n])&&o[n].forEach(function(n){s(e,i.item,n,Array.isArray(t.required)||r,"#/definitions/"+i.name)})}),a(t,m.getObjectWithStringInKeysReplaced(o,"~1","."))}function a(e,t){Object.keys(e).forEach(function(t){return delete e[t]}),Object.keys(t).forEach(function(i){return e[i]=t[i]})}function l(e,t){var i=t.split(".");for(i.pop();i.length>0;){var r=i.join("."),n=f.get(e,r);if(n&&"object"===n.type)return r;i.pop()}return""}function c(e,t,i,r){var n=f.get(e,i+".required");r=r||Array.isArray(n)&&n.length>0;var o=f.get(e,t+".required");if(Array.isArray(o)||r){var s=u(t,i);Array.isArray(o)?r&&-1===o.indexOf(s)?o.push(s):!r&&o.indexOf(s)>-1&&o.splice(o.indexOf(s),1):o=[s],0===o.length?f.unset(e,t+".required"):f.set(e,t+".required",o)}}function u(e,t){var i=e.split(".").filter(function(e){return!d.isNullOrWhitespace(e)});return t.split(".").filter(function(e){return!d.isNullOrWhitespace(e)}).slice(0,i.length+2).pop().split("~1").join(".")}Object.defineProperty(t,"__esModule",{value:!0});var p=i(16),d=i(1),g=i(34),m=i(94),f=i(64);t.saveSchemaProperties=r,t.saveSchemaProperty=n,t.updateRequiredFields=s,t.getPathToFirstParentObject=l,t.updateRequiredArrayAtPath=c},function(e,t,i){var r=i(233),n=i(238);e.exports=i(102)?function(e,t,i){return r.f(e,t,n(1,i))}:function(e,t,i){return e[t]=i,e}},function(e,t,i){e.exports=!i(127)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,i){"use strict";function r(e){return e.replace(/^\/+/,"")}Object.defineProperty(t,"__esModule",{value:!0}),t.stripLeadingSlashes=r},function(e,t,i){"use strict";function r(e){return e.replace(/\/+$/,"")}Object.defineProperty(t,"__esModule",{value:!0}),t.stripTrailingSlashes=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(40),o={tagEvent:"tagEvent",tagScreen:"tagScreen",setCustomDimension:"setCustomDimension",setCustomerId:"setCustomerId"};!function(e){e[e.sessionId=0]="sessionId",e[e.tenantId=1]="tenantId",e[e.host=2]="host",e[e.authenticationStatus=3]="authenticationStatus",e[e.location=4]="location"}(r=t.CustomDimensions||(t.CustomDimensions={}));var s=function(){function e(){}return e.prototype.log=function(e,t,i){ll(e,t,i)},e.prototype.setCustomDimension=function(e,t){ll(o.setCustomDimension,r,t)},e.prototype.tagEvent=function(e,t){ll(o.tagEvent,e,t)},e.prototype.tagScreen=function(e){ll(o.tagScreen,e)},Object.defineProperty(e,"instance",{get:function(){return e.localyticsService.value},enumerable:!0,configurable:!0}),e.localyticsService=new n.Lazy(function(){return new e}),e}();t.LocalyticsService=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={aborted:"ClientErrorAborted",apiOperationNotFound:"apiOperationNotFound",blobUploadFailure:"blobUploadFailure",createAuthenticationFormError:"createAuthenticationFormError",customApiError:"customApiError",customApiExist:"customApiExist",customApiGetSwaggerFromUrl:"customApiGetSwaggerFromUrl",customApiGetSwaggerIcon:"customApiGetSwaggerIcon",customApiImportFromSampleError:"customApiImportFromSampleError",customApiInvalidBasePath:"customApiInvalidBasePath",customApiInvalidIconBrandColor:"customApiInvalidIconBrandColor",customApiInvalidHost:"customApiInvalidHost",customApiNameError:"customApiNameError",customApiValidationError:"customApiValidationError",customApiOriginalDataError:"customApiOriginalDataError",customApiRefreshApisClient:"customApiRefreshApisClient",flowNotFound:"flowNotFound",flowRunNotFound:"flowRunNotFound",flowRunRequestFailed:"flowRunRequestFailed",flowSaveAsFailed:"flowSaveAsFailed",flowsDesignerGetDefinitionError:"flowsDesignerGetDefinitionError",flowsDesignerLoadDefinitionError:"flowsDesignerLoadDefinitionError",flowsDesignerScriptLoadError:"flowsDesignerScriptLoadError",flowNotRunnable:"flowNotRunnable",invalidFlowDefinition:"invalidFlowDefinition",oneClickFlowCreationNoFlowName:"oneClickFlowCreationNoFlowName",storageCreationFailure:"storageCreationFailure",swaggerToWadlError:"swaggerToWadlError",swaggerUploadFailure:"swaggerUploadFailure",templateNotFoundError:"templateNotFoundError",widgetUnableToGetEnvironment:"widgetUnableToGetEnvironment",nullResponse:"nullResponse",operationCanceled:"operationCanceled",invalidOperation:"invalidOperation",runInstanceServiceInvalidId:"runInstanceServiceInvalidId",runInstanceServiceInvalidStatusCode:"runInstanceServiceInvalidStatusCode",runInstanceServiceInvalidTriggerHistoryResponse:"runInstanceServiceInvalidTriggerHistoryResponse",graphServiceInvalidMemberId:"graphServiceInvalidMemberId",graphServiceInvalidTenantId:"graphServiceInvalidTenantId",graphServiceQueryBadResponse:"graphServiceQueryBadResponse",runFlowWidgetNeverLoadedWithEnvironment:"runFlowWidgetNeverLoadedWithEnvironment",runFlowWidgetNullOrEmptyActionName:"runFlowWidgetNullOrEmptyActionName",runFlowWidgetInvalidActionName:"runFlowWidgetInvalidActionName",runFlowWidgetFlowNotFound:"runFlowWidgetFlowNotFound",runFlowWidgetError:"runFlowWidgetError",runFlowWidgetCancelled:"runFlowWidgetCancelled",runFlowWidgetInvalidTriggerFlowParams:"runFlowWidgetInvalidTriggerFlowParams",runFlowWidgetInvalidImplicitDataType:"runFlowWidgetInvalidImplicitDataType",runFlowWidgetInvalidTriggerSchemaParams:"runFlowWidgetInvalidTriggerSchemaParams",runFlowWidgetInvalidTriggerSchema:"runFlowWidgetInvalidTriggerSchema",runFlowWidgetNotReady:"runFlowWidgetNotReady",runFlowWidgetTemplateDefinitionEmpty:"runFlowWidgetTemplateDefinitionEmpty",runFlowWidgetTemplateNotFound:"runFlowWidgetTemplateNotFound",runFlowWidgetTemplateError:"runFlowWidgetTemplateError",hostCommunicationServiceInvalidActionName:"hostCommunicationServiceInvalidActionName",hostCommunicationServiceEmptyActionName:"hostCommunicationServiceEmptyActionName",locationServiceInvalidResult:"locationServiceInvalidResult",geocodeServiceGeolocationUnsupported:"geocodeServiceGeolocationUnsupported",geocodeServiceGeolocationDisabled:"geocodeServiceGeolocationDisabled",geocodeServiceInvalidResult:"geocodeServiceInvalidResult",installFlowFailed:"installFlowFailed"}},function(e,t,i){"use strict";function r(e,t){for(void 0===t&&(t=!0);;){if(e&&e.code&&e.message){if(e.code===o.default.aborted||e.code===o.default.operationCanceled)return!0;if(t){e=e.innerError;continue}}return!1}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(13),o=i(106),s=function(e){function t(t,i,r,n){var o=e.call(this)||this;return o.code=t,o.message=i,o.innerError=r,o.data=n,o.stack=new Error(i).stack,o}return n.__extends(t,e),t.prototype.toString=function(){return"ClientError ("+this.code+"): "+this.message},t.prototype.toJSON=function(){return{error:{code:this.code,message:this.message,data:this.data,innerError:this.innerError&&this.innerError.toJSON?this.innerError.toJSON():this.innerError,stack:this.stack}}},t}(Error);t.ClientError=s,t.isAbortedClientError=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(9),n=i(40),o={},s={CreateFlowCompleted:100},a="optimizely",l=function(){function e(e){this.appSettings=e,this.enabled&&(window[a]=window[a]||[],this.setEnvironment(e.environment))}return Object.defineProperty(e,"instance",{get:function(){return e.optimizelyService.value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizely",{get:function(){return window[a]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this.appSettings.featureFlags.enableOptimizely},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){return!!(this.enabled&&this.optimizely&&this.optimizely.allExperiments)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"experimentFlags",{get:function(){var e=this,t={};return this.enabled&&this.ready?(Object.keys(this.optimizely.allExperiments).forEach(function(i){var r=e.optimizely.allExperiments[i];r.enabled&&(t[_.camelCase(r.name)]=e.optimizely.variationMap[i])}),t):t},enumerable:!0,configurable:!0}),e.prototype.getExperimentViewedDetails=function(){var e=this,t=[];return this.enabled&&this.ready?(Object.keys(this.optimizely.allExperiments).forEach(function(i){var r=e.optimizely.allExperiments[i];r.enabled&&t.push({id:i,name:r.name,variationName:e.optimizely.variationNamesMap[i]})}),t):t},e.prototype.setEnvironment=function(e){this.setDimensionValue("environment",e)},e.prototype.setDimensionValue=function(e,t){this.enabled&&this.optimizely.push(["setDimensionValue",e,t])},e.prototype.track=function(e,t){if(void 0===t&&(t={}),this.enabled){for(var i=o[e]||[],r=i.map(function(i){return e+"["+i+"="+t[i]+"]"}),n=0,a=[e].concat(r);n<a.length;n++){var l=a[n];this.optimizely.push(["trackEvent",l])}var c=s[e];c&&this.optimizely.push(["trackEvent",e,{revenue:c}])}},e.optimizelyService=new n.Lazy(function(){return new e(r.getAppSettings())}),e}();t.OptimizelyService=l},function(e,t,i){"use strict";function r(e){var t=n.LoggingService.instance,i=o.uuid();e.headers=e.headers||{},null!==e.headers[l.clientRequestId]&&(e.headers[l.clientRequestId]=i),e&&a.needLocaleHeader(e.url)&&(e.headers["Accept-Language"]=s.getAppSettings().locale),t.logHttpRequestStart("OUTGOING_REQUEST_START",e.method,e.url,i,c);var r=t.performanceNow(),u=$.ajax(e);return u.then(function(i,n,o){t.logHttpRequestEnd("OUTGOING_REQUEST_END",e.method,e.url,{status:o.status,contentLength:o.responseText.length,serviceRequestId:o.getResponseHeader(l.serviceRequestId)},t.performanceNow()-r,e.headers[l.clientRequestId],c)},function(i,n,o){t.logHttpRequestEnd("OUTGOING_REQUEST_END",e.method,e.url,{status:i.status,contentLength:i&&i.responseText&&i.responseText.length||0,responseBodyOnError:i.responseText,serviceRequestId:e.headers[l.serviceRequestId]},t.performanceNow()-r,e.headers[l.clientRequestId],c)}),u}Object.defineProperty(t,"__esModule",{value:!0});var n=i(4),o=i(38),s=i(9),a=i(77),l={clientRequestId:"x-ms-client-request-id",serviceRequestId:"x-ms-request-id"},c={source:"AjaxHelper.JQuery"};t.default=r},function(e,t,i){"use strict";function r(e){if(n.isObject(e)){"function"==typeof e.toJSON&&(e=e.toJSON());var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push({key:i,value:e[i]});t.sort(function(e,t){return e.key<t.key?-1:1});return"{"+t.map(function(e){return'"'+e.key+'":'+r(e.value)}).join(",")+"}"}if(Array.isArray(e)){"function"==typeof e.toJSON&&(e=e.toJSON());return"["+e.map(function(e){return r(e)}).join(",")+"]"}return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(42);t.stableStringify=r},function(e,t,i){function r(e){return null!=e&&!("function"==typeof e&&o(e))&&s(n(e))}var n=i(442),o=i(80),s=i(85);e.exports=r},function(e,t,i){function r(e){var t=c(e);if(!t&&!a(e))return o(e);var i=s(e),r=!!i,u=i||[],p=u.length;for(var d in e)!n(e,d)||r&&("length"==d||l(d,p))||t&&"constructor"==d||u.push(d);return u}var n=i(165),o=i(455),s=i(160),a=i(111),l=i(86),c=i(163);e.exports=r},function(e,t,i){function r(e){if("string"==typeof e)return e;if(null==e)return"";if(o(e))return n?l.call(e):"";var t=e+"";return"0"==t&&1/e==-s?"-0":t}var n=i(167),o=i(459),s=1/0,a=n?n.prototype:void 0,l=n?a.toString:void 0;e.exports=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(0),o=i(28),s=i(6),a=i(33),l=i(38),c=i(31),u=i(28),p=i(1),d=i(29),g=i(3),m=i(50),f=i(23),h=i(169),v=i(10),y=i(28);!function(e){e[e.Default=0]="Default",e[e.Custom=1]="Custom"}(r=t.ApiType||(t.ApiType={}));var w=function(){function e(e,t,i,r,n,o,a,l,c,u){var p=this;this.$scope=e,this.appSettings=t,this.clientResources=i,this.connectionFormService=r,this.connectionHelper=n,this.customApiHelperService=o,this.loggingService=a,this.navigationService=l,this.telemetryService=c,this.trialDialog=u,this.hostCommunicationService=m.HostCommunicationService.instance,this.hideCommandsInDropDown=!1,this.showConfirmDelete=!1,this.onConfirmDelete=function(){var e=p.apiToDelete;p.apiToDelete=void 0,p.$scope.model.markedForDeletion.push(e),p.telemetryService.tagEvent(s.TelemetryEventNames.DeleteCustomApi,{type:"CustomApi"},{api:e.name}),p.customApiHelperService.deleteApi(e).then(function(){p.removeFromMarkedForDeletion(e)}).catch(function(){p.removeFromMarkedForDeletion(e),p.$scope.model.rows=p.$scope.model.apis.filter(function(e){return!p.$scope.model.markedForDeletion.some(function(t){return t.id===e.id})}).map(function(e){return p.convertApiToRow(e)})}),p.$scope.model.rows=p.$scope.model.rows.filter(function(t){return t.id!==e.id})},this.$scope.$watch("model.apis",function(e){p.$scope.model.rows=e.map(function(e){return p.convertApiToRow(e)})}),this.headerNameField=this.clientResources.Manage.Connection.Header.Name,this.hideCommandsInDropDown=this.$scope.model.hideCommandsInDropDown,this.appSettings.isWidgetPage&&this.hostCommunicationService.onCustomApiRefreshApis(function(){p.customApiHelperService.refreshApis()})}return e.prototype.showErrorAlert=function(e){this.$scope.model.statusAlert.type=v.AlertType.Error,this.$scope.model.statusAlert.message=e},e.prototype.hideErrorAlert=function(){this.$scope.model.statusAlert.type=v.AlertType.None,this.$scope.model.statusAlert.message=""},e.prototype.convertApiToRow=function(e){var t=this.$scope.model.apiType===r.Default?this.defaultCommands(e):this.customCommands(e),i=this.customCommandsInDropdown(e);return{name:y.getDisplayName(e),id:e.id,imageUrl:y.getIconUri(e),publisher:o.getPublisher(e,this.clientResources),api:e,commands:t,commandsInDropDown:i,allCommands:t.concat(i)}},e.prototype.defaultCommands=function(e){var t=this;return[{text:this.clientResources.Manage.Connections.CreateToolTip,iconUrl:"glyph-create",click:function(){return t.openAddConnection(e,c.getListConnectionsUrl())}}]},e.prototype.customCommandsInDropdown=function(e){var t=this,i=[],r=[{text:this.clientResources.Manage.Apis.DeleteToolTip,iconUrl:"glyph-delete",click:function(){return t.deleteApi(e)}},{text:this.clientResources.Manage.Apis.PropertiesConnectionToolTip,iconUrl:"glyph-info",click:function(){return t.navigationService.navigate(c.getDetailsCustomApiUrl(e.name))}},{text:this.clientResources.Manage.Apis.ShareConnectionToolTip,iconUrl:"glyph-owners",click:function(){return t.navigationService.navigate(c.getShareCustomApiUrl(e.name))}}];return this.appSettings.featureFlags.enableBlankConnector&&(i=[{text:this.clientResources.Manage.Apis.Update.OpenApiFile,iconUrl:"glyph-upload",click:function(){t.$scope.onClickUpdate({dialogMode:h.DialogMode.OpenApiFile,api:e})}},{text:this.clientResources.Manage.Apis.Update.OpenApiUrl,iconUrl:"glyph-upload",click:function(){t.$scope.onClickUpdate({dialogMode:h.DialogMode.OpenApiUrl,api:e})}},{text:this.clientResources.Manage.Apis.Update.Postman,iconUrl:"glyph-upload",click:function(){t.$scope.onClickUpdate({dialogMode:h.DialogMode.Postman,api:e})}}]),r.concat(i)},e.prototype.customCommands=function(e){var t=this,i=[];if(i.push({text:this.clientResources.Manage.Apis.CreateConnectionToolTip,iconUrl:"glyph-create",click:function(){return t.openAddConnection(e,c.getListConnectionsUrl())}}),this.$scope.model.apiType===r.Custom){var n=u.getOriginalSwaggerUrl(e);i.push({text:this.clientResources.Manage.Apis.DownloadToolTip,iconUrl:"glyph-download",disabled:!n,click:function(){return t.downloadCustomApi(e,n)}})}return this.appSettings.featureFlags.enableEditCustomApi&&i.push({text:this.clientResources.Manage.Apis.EditToolTip,iconUrl:"glyph-edit",click:function(){t.telemetryService.tagEvent(s.TelemetryEventNames.EditCustomApi,{type:"CustomApi"},{api:e.name}),t.navigationService.navigate(c.getEditCustomConnectorGeneralUrl(e.name))}}),i},e.prototype.onClickRow=function(e){this.$scope.model.apiType===r.Default?this.openAddConnection(e.api,c.getListConnectionsUrl()):this.appSettings.featureFlags.enablePropertiesPaneCustomApi&&this.$scope.model.apiType===r.Custom&&this.navigationService.navigate(c.getEditCustomConnectorGeneralUrl(e.api.name))},e.prototype.deleteApi=function(e){this.appSettings.isWidgetPage?this.hostCommunicationService.triggerHostEvent(f.WidgetHostAction.ONDELETECUSTOMAPICLICKED,{apiName:e.name}):(this.apiToDelete=e,this.showConfirmDelete=!0)},e.prototype.downloadCustomApi=function(e,t){var i=this,r=window.document.createElement("a");this.telemetryService.tagEvent(s.TelemetryEventNames.DownloadCustomApi,{type:"CustomApi"},{api:e.name});var n=this.loggingService.profileStart(d.ProfilingEventNames.myCustomApiDownloadStart);this.customApiHelperService.getSwaggerFromUrl(t).then(function(t){var o=new Blob([angular.toJson(t,!0)],{type:"application/json"}),s=p.getSlug(e.properties.displayName,!0)+".swagger.json";navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(o,s):(r.download=s,r.href=window.URL.createObjectURL(o),document.body.appendChild(r),r.click()),i.loggingService.profileEnd(n,d.ProfilingEventNames.myCustomApiDownloadEnd,{status:g.Status.Success})}).catch(function(e){alert(i.clientResources.Manage.CustomApi.OriginalSwagger.DownloadError),i.loggingService.profileEnd(n,d.ProfilingEventNames.myCustomApiDownloadEnd,{status:g.inferErrorStatus(e),error:g.parseErrorMessage(e)})}).finally(function(){document.body.removeChild(r)})},e.prototype.removeFromMarkedForDeletion=function(e){this.$scope.model.markedForDeletion=this.$scope.model.markedForDeletion.filter(function(t){return t.id!==e.id})},e.prototype.openAddConnection=function(e,t){var i=this;if(this.hideErrorAlert(),this.appSettings.isWidgetPage)return void this.hostCommunicationService.triggerHostEvent(f.WidgetHostAction.ONADDCONNECTIONCLICKED,{apiName:e.name});o.isApiOauth(e)||(this.$scope.model.onLoading=!0,this.$scope.onAddConnection()),this.telemetryService.tagEvent(s.TelemetryEventNames.CreateConnectionStarted,{type:this.$scope.model.apiType===r.Default?"DefaultApi":"CustomApi"},{api:e.name});var n=this.appSettings.featureFlags.showManageGateways&&u.isApiGatewayCompatible(e);if(o.isApiConfigurable(e)||n)this.navigationService.navigate("/connections/available/"+e.name+"/new");else{var c=l.uuid(),p=a.getConnectionId(e.name,c);this.connectionHelper.addConnection(e,p).then(function(e){return i.connectionHelper.testConnection(e)}).then(function(){return i.navigationService.navigate(t)}).catch(function(e){i.loggingService.logError("ApiListDirectiveCtrl.OpenAddConnection",e);var t=g.parseErrorMessage(e,i.clientResources.Common.SomethingWentWrong);i.showErrorAlert(t)}).finally(function(){i.$scope.model.onLoading=!1,i.$scope.onAddConnection()})}},e.prototype.getCommandText=function(e){return e.inProgress&&e.inProgressText?e.inProgressText:e.text},e.prototype.isCommandDisabled=function(e){return e.disabled||e.inProgress},e.prototype.clickCommand=function(e,t){if(e.stopPropagation(),!this.isCommandDisabled(t)){var i=t.click();i&&i.finally&&(t.inProgress=!0,i.finally(function(){return t.inProgress=!1}))}},e.prototype.getRowAriaLabel=function(e){return p.format(this.clientResources.CreateConnectionAriaLabel,e.name)},e.$inject=[n.default.services.$scope,n.default.services.appSettings,n.default.services.clientResources,n.default.services.connectionForm,n.default.services.connectionHelper,n.default.services.customApiHelper,n.default.services.logging,n.default.services.navigation,n.default.services.telemetry,n.default.services.trialDialog],e}();t.ApiListDirectiveCtrl=w},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApiTier={standard:"Standard",premium:"Premium"},t.ApiEnvironment={NotSpecified:"NotSpecified",Shared:"Shared",Dedicated:"Dedicated"},t.ApiAuthenticationType={Basic:"basic",Oauth2:"oauth2",ApiKey:"apiKey",None:"none"},t.ApiCapabilities={composite:"composite",tabular:"tabular",blob:"blob",gateway:"gateway",cloud:"cloud"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(88);var r=i(7),n=i(4),o={getAccessToken:"GET_ACCESS_TOKEN",widgetReady:"WIDGET_READY",documentClick:"DOCUMENT_CLICK"},s=function(){function e(e,t,i,s,a,l,c,u,p){var d=this;this.spinner={size:r.SpinnerSize.Large,show:!0,local:r.SpinnerPosition.Local},this.contentLoaded=!1;var g=i.profilePageStart(u),m=new PowerAppsSDK({hostName:t.powerAppsPortalUrl,locale:t.locale});this.widget=m.renderWidget(a,l,c),this.widget.listen(o.getAccessToken,function(e,t){var i=e.data;s.getToken(i.resource).then(function(e){t(null,{token:e})})}),this.widget.listen(o.widgetReady,function(){e.$apply(function(){i.profilePageEnd(g,p,{status:n.Status.Success}),d.spinner.show=!1,d.contentLoaded=!0})}),this.widget.listen(o.documentClick,function(){angular.element("body").click()})}return e}();t.PowerAppsWidgetCtrl=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r,n=i(0),o=i(28),s=i(8),a=i(1);!function(e){e[e.Create=0]="Create",e[e.Edit=1]="Edit"}(r=t.FormType||(t.FormType={})),t.InputType={string:"string",securestring:"securestring",bool:"bool",options:"options",int:"int",number:"number"},t.supportedTypes=[t.InputType.securestring,t.InputType.string,t.InputType.number,t.InputType.int,t.InputType.bool];var l=function(){function e(e){this.loggingService=e}return e.prototype.createFormItemsFromConnectionParameters=function(e,t,i){var n=this;void 0===i&&(i={});var o={},l=[],c=a.convertToLowerCaseIndex(i);return Object.keys(t||{}).forEach(function(a){var u=t[a];if(n.isSupportedType(u.type)){var p=u.uiDefinition&&u.uiDefinition.displayName||a,d=u.type,g=void 0,m=a.toLowerCase(),f=c[m];g=!(s.equalsIgnoreCase(u.type,"bool")||e!==r.Create&&s.equalsIgnoreCase(u.type,"securestring"))&&(u.uiDefinition&&u.uiDefinition.constraints&&u.uiDefinition.constraints.required===(!0).toString()),!s.equalsIgnoreCase(u.type,"bool")||null!==i[a]&&void 0!==i[a]||(f=!1),o[a]={type:d,displayName:p,value:f,required:g,isCreateFormItem:e===r.Create}}else l.push(u.type)}),l.length>0&&this.loggingService.logInfo("ConnectionUnsupportedTypes","Connection unsupported types detected.",{unsupportedConnectionTypes:l}),o},e.prototype.convertParameterTypeToFormType=function(e,i){var r=e.type,n=e.uiDefinition&&e.uiDefinition.constraints&&e.uiDefinition.constraints.clearText;return s.equalsIgnoreCase(t.InputType.securestring,r)&&n&&(r=t.InputType.string),i&&(r=t.InputType.options),r},e.prototype.createFormItemsFromProviderParameters=function(e,t,i){void 0===i&&(i={});var r={};return t.forEach(function(e){var t={type:e.Type,metadata:e.Metadata,uiDefinition:{displayName:e.DisplayName,description:e.Description,constraints:{required:(!e.Default).toString(),allowedValues:e.AllowedValues}}};r[e.Name]=t,!i[e.Name]&&e.Default&&(i[e.Name]=e.Default)}),this.createFormItemsFromConnectionParameters(e,r,i)},e.prototype.convertFormItemsToParameterValues=function(e){var i=this,r={};return Object.keys(e).forEach(function(n){var o,a=e[n];switch(a.type.toLowerCase()){case t.InputType.bool:o=s.equalsIgnoreCase(a.value,"true");break;case t.InputType.int:case t.InputType.number:try{o=JSON.parse(a.value)}catch(e){i.loggingService.logError("ConnectionFormService.ConvertFormItemsToParameterValues",e)}break;case t.InputType.options:var l=a.value;l&&l.value&&(o=l.value);break;default:o=a.value}r[n]=o}),r},e.prototype.addGatewayToParameterValues=function(e,t,i){if(t){e[o.getGatewayParameterName(i)]={gatewayObjectId:t.name}}return e},e.prototype.isSupportedType=function(e){return t.supportedTypes.some(function(t){return s.equalsIgnoreCase(t,e)})},e.$inject=[n.default.services.logging],e}();t.ConnectionFormService=l,angular.module(n.default.modules.processSimpleServices).service(n.default.services.connectionForm,l)},function(e,t,i){"use strict";function r(e,i){var r=JSON.stringify(e);return e.parameters&&i&&Object.keys(e.parameters).forEach(function(e){var o=t.ParametersPrefix+e;if(/^[a-zA-Z0-9\.]+$/.test(e)){var s=new RegExp("parameters\\('"+e.replace(/\,/g,"\\,")+"'\\)","g"),a=new RegExp("\\\"parameters\\('"+e.replace(/\,/g,"\\,")+"'\\)\\\"","g");i.hasOwnProperty(o)&&i[o]?(r=r.replace(a,'"'+i[o]+'"'),r=r.replace(s,"'"+i[o]+"'")):r=n(r,e)}}),JSON.parse(r)}function n(e,t){var i,r,n=["parameters({0})","string({0})","encodeURIComponent({0})","@{{0}}","'{0}'"],l=s(e);r=e.replace(new RegExp("parameters\\('"+t.replace(/\,/g,"\\,")+"'\\)","g"),l);do{i=r,n.forEach(function(e){r=r.replace(o(a.format(e,l)),l)})}while(i!==r);return r.replace(new RegExp(l,"g"),"")}function o(e){var t=e.replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\{/g,"\\{").replace(/\}/g,"\\}");return new RegExp(t,"g")}function s(e){var t;do{t=a.generateGuid()}while(-1!==e.indexOf(t));return t}Object.defineProperty(t,"__esModule",{value:!0});var a=i(1);t.ParametersPrefix="parameters.",t.replaceParameterValues=r,t.removeParameter=n},function(e,t,i){"use strict";function r(e){var t=e.triggers;return Object.keys(t).forEach(function(i){var r=t[i];o(e.$schema,r)&&s(r,c.FlowTransformData.Flow.isPartialProperty,c.FlowTransformData.Designer.isPartialProperty)}),e}function n(e){var t=e.triggers;return Object.keys(t).forEach(function(i){var r=t[i];o(e.$schema,r)&&s(r,c.FlowTransformData.Designer.isPartialProperty,c.FlowTransformData.Flow.isPartialProperty)}),e}function o(e,t){return e===c.SCHEMA.GA_PREVIEW_20150801.URL?l.equalsIgnoreCase(t.type,c.FlowTriggerType.manual):l.equalsIgnoreCase(t.type,c.FlowTriggerName.httpRequestTrigger)&&l.equalsIgnoreCase(t.kind,c.FlowTriggerKind.POWERAPP)}function s(e,t,i){var r=e.inputs&&e.inputs.schema;r&&r.properties&&Object.keys(r.properties).forEach(function(e){var n=r.properties[e];n&&n.hasOwnProperty(t)&&(n[i]=n[t],delete n[t])})}function a(e){var t={};return(e||[]).map(function(e){var i=u.getApiNameFromId(e.api.id);t[i]=e}),t}Object.defineProperty(t,"__esModule",{value:!0});var l=i(8),c=i(23),u=i(28);t.toDesignerFlowDefinition=r,t.toPortalFlowDefinition=n,t.designerConnectionReferencesDataListToConnectionReferences=a},function(e,t,i){function r(e,t){return"number"==typeof e||!n(e)&&(s.test(e)||!o.test(e)||null!=t&&e in Object(t))}var n=i(52),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(19);!function(e){e[e.None=0]="None",e[e.Cancel=1]="Cancel",e[e.Resubmit=2]="Resubmit"}(t.FlowRunAction||(t.FlowRunAction={}));var o=function(){function e(e,t,i,r,n,o,s,a,l,c,u){this.$q=e,this.$interval=t,this.appSettings=i,this.clientResources=r,this.flowRunsClient=n,this.flowTriggerHistoriesClient=o,this.algorithms=s,this.poll=a,this.navigation=l,this.urlService=c,this.loggingService=u}return e.prototype.waitForFlowRunToComplete=function(e,t,i,r){var o=this,s=this.$q.defer(),a=this.appSettings.flowTesting,l=a.pollingInterval,c=a.pollingTimeout,u=a.pollRetryCount,p=a.pollRetryDelay;return this.flowRunCompleted=r,n.isRunning(t)?(this.pollFlowRunStatus=this.poll({poll:function(){return o.algorithms.asyncRetry(u,p,function(){return o.flowRunsClient.get(e,{id:t.id}).$refresh().then(function(e){var t=e.data;i.refreshRun(),n.isRunning(t)||s.resolve(t)}).catch(function(e){o.loggingService.logError("FlowCtrl.WaitForFlowRunToComplete",e),s.reject(e)})})},interval:l}),this.timeoutPromise=this.$interval(function(){s.reject(new Error(o.clientResources.Flow.Error.TimeoutWaitingForRunComplete))},c,1),s.promise.finally(function(){r&&r(),o.$interval.cancel(o.timeoutPromise),o.pollFlowRunStatus.destroy()}),this.pollFlowRunStatus.start(e)):(r&&r(),s.resolve(t)),s.promise},e.prototype.stopFlowRunPolling=function(){this.flowRunCompleted&&this.flowRunCompleted(),this.timeoutPromise&&this.$interval.cancel(this.timeoutPromise),this.pollFlowRunStatus&&this.pollFlowRunStatus.destroy()},e.prototype.cancelFlowRun=function(e,t){var i=this;return this.flowRunsClient.cancel({flowName:e,flowRunName:t}).then(function(e){return i.stopFlowRunPolling()})},e.prototype.resubmitFlowRun=function(e,t,i,r,n){var o=this;return this.flowTriggerHistoriesClient.resubmit({flowName:t,flowTriggerName:i,flowTriggerHistoryId:r}).then(function(r){return o.flowTriggerHistoriesClient.query(e,{flowName:t,flowTriggerName:i})}).then(function(e){e.$refresh().then(function(){var i=e[0].properties.run;o.navigation.navigate(o.urlService.flowRunRoute({flowName:t,runName:i.name}),n?{backUrl:n}:{})})})},e.$inject=[r.default.services.$q,r.default.services.$interval,r.default.services.appSettings,r.default.services.clientResources,r.default.services.flowRunsClient,r.default.services.flowTriggerHistoriesClient,r.default.services.algorithms,r.default.services.poll,r.default.services.navigation,r.default.services.url,r.default.services.logging],e}();t.FlowRunService=o,angular.module(r.default.modules.processSimpleServices).service(r.default.services.flowRun,o)},function(e,t,i){var r,n;r=[i,t],void 0!==(n=function(e,t){"use strict";function i(e){return e=e||[],e.reduce(function(e,t){return e.concat(t)},[])}function r(e,t){return e&&t?e.length===t.length&&e.every(function(e,i){return e===t[i]}):e===t}function n(e,t){return e&&t?e.length===t.length&&e.every(function(e){return t.indexOf(e)>-1}):e===t}function o(e,t,i){return void 0===i&&(i=!0),i?!w(e)&&!w(t)&&e.toLowerCase()===t.toLowerCase():!w(e)&&!w(t)&&e===t}function s(e,t,i){return void 0===i&&(i=!0),i?!w(e)&&!w(t)&&e.toLowerCase().indexOf(t.toLowerCase())>-1:!w(e)&&!w(t)&&e.indexOf(t)>-1}function a(e,t){for(var i,r=0;r<t.length;r++)if(e(t[r])){i=t[r];break}return i}function l(e,t){return(t||[]).filter(function(t){return e.hasOwnProperty(t)}).map(function(t){return delete e[t]}).filter(function(e){return e}).length>0}function c(e,t){if(!w(e)){var i=e.indexOf(t);i>=0&&e.splice(i,1)}}function u(e,t){w(e)||w(t)||t.forEach(function(t){c(e,t)})}function p(e,t){e=e||{};for(var i=Object.keys(e),r=0;r<i.length;r++){var n=i[r];if(o(n,t))return e[n]}}function d(e,i){for(var r=e||{},n=0;n<i.length;n++)r=t.getProperty(r,i[n]);return r}function g(e,i,r){if(i.length&&e){for(var n=0;n<i.length-1;n++)e=t.getProperty(e,i[n]);var o=i[i.length-1];o&&(e[o]=r)}}function m(e,i){if(i.length&&e){for(var r=0;r<i.length-1;r++)if(!(e=t.getProperty(e,i[r])))return;var n=i[i.length-1];n&&delete e[n]}}function f(e,t){t.length&&e&&t.forEach(function(t){m(e,t)})}function h(e,t){return"object"==typeof e&&Object.keys(e).some(function(e){return o(e,t)})}function v(e){return"string"==typeof e}function y(e){return v(e)&&""===e}function w(e){return null===e||void 0===e}function C(e){return"object"==typeof e?!e||!Object.keys(e).length:!e}function S(e){return void 0===e||""===e}function b(e){return"[object Object]"===Object.prototype.toString.call(e)}function P(e){return e&&(/^https:\/\//i.test(e)||/^data:image\//i.test(e))}function R(e,t){if(!t)throw new Error("key required");e=e||[];var i={};return e.filter(function(e){return e.hasOwnProperty(t)}).forEach(function(e){var r=e[t];i[r]=e}),i}function T(e,t){return e=e||{},Object.keys(e).map(function(i){var r=e[i];return t&&(r[t]=i),r})}function E(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e=e||{},t.forEach(function(t){w(t)||Object.keys(t).map(function(i){e[i]=t[i]})}),e}function A(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t?(t.forEach(function(t){t&&Object.keys(t).map(function(i){e[i]=U(t[i])})}),e):e}function D(e){for(var t=[],i={},r=0,n=e.length;r<n;++r)i.hasOwnProperty(e[r])||(t.push(e[r]),i[e[r]]=1);return t}function F(e){return e?e.map(function(e){return U(e)}):null}function N(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var r,n=/\{[a-zA-Z$_\d]*\}/g,o=/\{(\d+)\}/g,s=!1;if(t&&1===t.length&&t[0]&&"object"==typeof t[0]){var a=t[0];r=e.replace(n,function(e){var t=e.substring(1,e.length-1);return a.hasOwnProperty(t)?(s=!0,a[t]):e})}return s||(r=e.replace(o,function(e,i){return void 0!==t[i]?t[i]:e})),r}function I(e,i,r){void 0===r&&(r=2);var n={},o=e;i.forEach(function(e){n[e]=!0});for(var s=r;;){if(!t.getProperty(n,o))return o;o=e+"_"+s++}}function O(e,t){var i,r=""+e;return r&&t&&(i=o(r.substring(0,t.length),t)),i}function k(e,t){var i,r=""+e;return r&&t&&(i=o(r.substr(r.length-t.length),t)),i}function M(e,t){var i=e;return i.length<t.length?e:(O(i,t)&&(i=i.length>1?i.substr(t.length):""),k(i,t)&&(i=i.length>1?i.substring(0,i.length-t.length):""),i)}function x(e,t){return e&&t&&!O(e,t)&&(e=""+t+e),e}function _(e){try{return JSON.parse(e)}catch(t){return e}}function U(e){return Array.isArray(e)?F(e):e instanceof Date?new Date(e.valueOf()):e&&"object"==typeof e?A({},e):e}function $(e,t){return Object.keys(t).reduce(function(e,i){return A({},e,(r={},r[i]=t[i],r));var r},A({},e))}function L(e){try{return JSON.parse(e),!0}catch(e){return!1}}function j(e){return e.reduce(function(e,t){return e+t},0)}function q(e,t){return j(e.map(t))}function B(e,t){if(w(e))throw new TypeError("array cannot be null or undefined");if("function"!=typeof t)throw new TypeError("predicate is not a function");for(var i=Object(e),r=e.length>>>0,n=e,o=0;o<r;o++){var s=i[o];if(t.call(n,s,o,i))return o}return-1}function V(e,t){for(var i=t;null!==i;){if(i===e)return!0;i=i.parentElement}return!1}function H(e){var t=document.createElement("a");t.href=e;var i=t.pathname,r=t.search;return{pathname:"/"+decodeURIComponent(i.replace(/(^\/+)/g,"")),queryKey:G(r)}}function W(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,i,r){return t+t+i+i+r+r});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!i)throw new Error("wrong hex color");return{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}}function z(e){return/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)}function G(e){var t={};if(!(e=e.slice("?"===e[0]?1:0)))return t;for(var i,r=/(?:^|&)([^&=]*)=?([^&]*)/g;null!==(i=r.exec(e));){var n=(i[0],i[1]),o=i[2];t[decodeURIComponent(n)]=decodeURIComponent(o)}return t}function K(e,t){if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e)){var i=e.substring(1).split("");3===i.length&&(i=[i[0],i[0],i[1],i[1],i[2],i[2]]);var r=parseInt("0x"+i.join(""),16);return t=t||1,"rgba("+[r>>16&255,r>>8&255,255&r].join(",")+", "+t+")"}throw new Error("Invalid Hex color value")}function Q(e){for(var t=[],i=0,r=[e];r.length;)!function(){var n=r.pop();switch(typeof n){case"boolean":i+=4;break;case"number":i+=8;break;case"string":i+=2*n.length;break;case"object":-1===t.indexOf(e)&&(t.push(e),Array.isArray(n)?n.forEach(function(e){return r.push(e)}):n&&Object.keys(n).forEach(function(e){return r.push(n[e])}))}}();return i}function J(e,t,i){if(void 0===i&&(i=" "),e=String(e),String.prototype.padStart)return e.padStart(t,i);if(t>>=0,e.length>t)return String(e);if(i=String(i),(t-=e.length)>i.length)for(var r=t/i.length,n=0;n<r;n++)i+=i;return i.slice(0,t)+e}Object.defineProperty(t,"__esModule",{value:!0}),t.aggregate=i,t.arrayEquals=r,t.arrayEqualsOrderInsensitive=n,t.equals=o,t.includes=s,t.first=a,t.removeKeys=l,t.remove=c,t.exclude=u,t.getPropertyValue=p,t.getProperty=p,t.getObjectPropertyValue=d,t.setObjectPropertyValue=g,t.deleteObjectProperty=m,t.deleteObjectProperties=f,t.hasProperty=h,t.isString=v,t.isEmptyString=y,t.isNullOrUndefined=w,t.isNullOrEmpty=C,t.isUndefinedOrEmptyString=S,t.isObject=b,t.isValidIcon=P,t.map=R,t.unmap=T,t.assign=E,t.extend=A,t.uniqueArray=D,t.copyArray=F,t.format=N,t.generateUniqueName=I,t.startsWith=O,t.endsWith=k,t.trim=M,t.addPrefix=x,t.getJSONValue=_,t.createCopy=U,t.combineObjects=$,t.isValidJSON=L,t.sum=j,t.mapsum=q,t.findIndex=B,t.isParentOrElement=V,t.parsePathnameAndQueryKeyFromUri=H,t.hexToRgb=W,t.validateUrl=z,t.hexToRgbA=K,t.approximateSize=Q,t.padStart=J}.apply(t,r))&&(e.exports=n)},function(e,t,i){"use strict";function r(e){switch(e.type){case n.FlowTemplateOperationType.Compose:case n.FlowTemplateOperationType.DecrementVariable:case n.FlowTemplateOperationType.Foreach:case n.FlowTemplateOperationType.Function:case n.FlowTemplateOperationType.Http:case n.FlowTemplateOperationType.HttpWebhook:case n.FlowTemplateOperationType.If:case n.FlowTemplateOperationType.IncrementVariable:case n.FlowTemplateOperationType.InitializeVariable:case n.FlowTemplateOperationType.Join:case n.FlowTemplateOperationType.Manual:case n.FlowTemplateOperationType.ParseJson:case n.FlowTemplateOperationType.Query:case n.FlowTemplateOperationType.Recurrence:case n.FlowTemplateOperationType.Request:case n.FlowTemplateOperationType.Response:case n.FlowTemplateOperationType.Scope:case n.FlowTemplateOperationType.Select:case n.FlowTemplateOperationType.SetVariable:case n.FlowTemplateOperationType.Switch:case n.FlowTemplateOperationType.Table:case n.FlowTemplateOperationType.Terminate:case n.FlowTemplateOperationType.Until:case n.FlowTemplateOperationType.Wait:return!0;case n.FlowTemplateOperationType.NotSpecified:default:return!1}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(70);t.isNativeOperation=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(577),o=i(23);i(578),t.callbackFunctionsNumber=4;var s=function(){function e(e){this.controller=n.FlowPropertiesCtrl,this.template=i(579),this.controllerAs="flowPropertiesCtrl",this.resolve=(t={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Flows}]},t[o.isShared]=[function(){return!(!e||!e.isSharedFlow)}],t[o.populateRunOnlyUser]=[function(){return!(!e||!e.populateRunOnlyUser)}],t);var t}return e}();t.FlowProperties=s,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowProperties,new s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(21);var r=i(0),n=i(9),o=i(20),s=i(14);t.approvalAssignedToFilterFormatting="properties/assignedTo/id eq '{0}'";var a={query:42e4,get:48e4,evictionDelay:3e5};t.ApprovalRequestsConstant={urlPath:n.getAppSettings().processSimpleResourceProviderPath+"/environments/"+o.getCurrentEnvironmentName()+"/approvalRequests",resourceType:n.getAppSettings().processSimpleResourceProviderPath+"/approvals/approvalRequests",expandParams:"properties/approval,properties.principals.thumbnailphoto"},angular.module(r.default.modules.processSimpleData).factory(r.default.services.approvalRequestsClient,[r.default.services.appSettings,r.default.services.azureResourceClientFactory,r.default.services.environment,function(e,i,r){var l=t.ApprovalRequestsConstant.urlPath,c={name:"postResponse",method:"POST",urlPath:n.getAppSettings().processSimpleResourceProviderPath+"/environments/"+o.getCurrentEnvironmentName()+"/approvals/:id/approvalResponses",params:{id:"@id"}};return i({urlBase:s.ProcessSimpleResourceProviderManagementEndpoint,urlPath:l,apiVersion:e.processSimpleResourceProviderApiVersionWithEnvironments,resourceType:t.ApprovalRequestsConstant.resourceType,rest:{query:{params:{$filter:"@filter",$expand:t.ApprovalRequestsConstant.expandParams}}},actions:[c],options:{atomize:!1,queryPollInterval:a.query,getPollInterval:a.get,evictionDelay:a.evictionDelay}})}])},function(e,t,i){var r=i(63),n=i(73),o=i(101),s=i(239),a=i(241),l=function(e,t,i){var c,u,p,d,g=e&l.F,m=e&l.G,f=e&l.S,h=e&l.P,v=e&l.B,y=m?r:f?r[t]||(r[t]={}):(r[t]||{}).prototype,w=m?n:n[t]||(n[t]={}),C=w.prototype||(w.prototype={});m&&(i=t);for(c in i)u=!g&&y&&void 0!==y[c],p=(u?y:i)[c],d=v&&u?a(p,r):h&&"function"==typeof p?a(Function.call,p):p,y&&s(y,c,p,e&l.U),w[c]!=p&&o(w,c,d),h&&C[c]!=p&&(C[c]=p)};r.core=n,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var i=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++i+r).toString(36))}},function(e,t){var i=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:i)(e)}},,,,,,,,function(e,t,i){"use strict";function r(e,t){var i=e/t;return i<.5?n.low:i<.9?n.medium:n.high}Object.defineProperty(t,"__esModule",{value:!0}),i(12);var n,o=i(0);!function(e){e[e.low=0]="low",e[e.medium=1]="medium",e[e.high=2]="high"}(n=t.FlowRunSeverity||(t.FlowRunSeverity={})),t.getFlowRunSeverity=r;var s=function(){function e(){}return e}();t.IFlowRunCountService=s;var a=function(){function e(e,t,i){this.$q=e,this.userFlowAccountClient=t,this.loggingService=i}return e.prototype.getFlowRunCount=function(){var e=this;if(this.flowRunCountPromise)return this.flowRunCountPromise;var t=this.$q.defer();return this.flowRunCountPromise=t.promise,this.userFlowAccountClient.getCurrentUserBillingUsageStatistics().then(function(i){i.data&&i.data.properties&&i.data.properties.billingUsageStatistics?t.resolve(i.data.properties.billingUsageStatistics.calendarMonthRunsToDate):(e.loggingService.logError("invalidFlowRunCount",new Error("Invalid billing usage statistics response received.")),t.resolve(0))}).catch(function(i){e.loggingService.logError("flowRunCountRequestFailed",i),t.reject(i)}),this.flowRunCountPromise},e.$inject=[o.default.services.$q,o.default.services.userFlowAccountClient,o.default.services.logging],e}();t.FlowRunCountService=a,angular.module(o.default.modules.processSimpleServices).service(o.default.services.flowRunCount,a)},function(e,t,i){"use strict";function r(e,t){var i,r=""+e;return r&&t&&(i=n.equalsIgnoreCase(r.substr(r.length-t.length),t)),i}Object.defineProperty(t,"__esModule",{value:!0});var n=i(8);t.endsWithIgnoreCase=r},function(e,t,i){"use strict";function r(e,t,i){for(var r in e)e.hasOwnProperty(r)&&t.call(i,{key:r,value:e[r]})}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=r},function(e,t,i){"use strict";function r(){return window.ClientResources}Object.defineProperty(t,"__esModule",{value:!0}),t.getScriptsResources=r},function(e,t,i){"use strict";function r(e,t){window.MscomCustomEvent&&window.MscomCustomEvent.apply(e,["wcs.cid="+t])}function n(){return window.MscomGetCookieKeyValue?window.MscomGetCookieKeyValue(o.mc1,o.guid):null}Object.defineProperty(t,"__esModule",{value:!0}),t.sendMscomCustomEvent=r;var o={mc1:"MC1",guid:"GUID"};t.getCookieGuid=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(4),o=i(8),s=i(110),a=i(3);t.PollResponseHeaders={Location:"location",RetryAfter:"retry-after"},t.PollHttpResponseStatus={Accepted:202,Completed:200,NoContent:204},t.DefaultPollingRetryIntervalInSeconds="5",t.DefaultPollingRetryIntervalInMilliseconds=5e3;var l;!function(e){e[e.CompleteSuccess=0]="CompleteSuccess",e[e.CompleteFailure=1]="CompleteFailure",e[e.NotComplete=2]="NotComplete"}(l=t.IPollStatus||(t.IPollStatus={}));var c;!function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.RanToCompletion=2]="RanToCompletion",e[e.Cancelled=3]="Cancelled",e[e.Faulted=4]="Faulted"}(c=t.AsyncCachedPollStatus||(t.AsyncCachedPollStatus={}));var u=function(){function e(e,t,i,r){this.$http=e,this.$q=t,this.$timeout=i,this.loggingService=r,this.cachedAsyncPollers={}}return e.prototype.getOrCreateCachedAsyncPoller=function(e){var t=this,i=s.stableStringify(e.cacheParams),r=new Date,o=this.cachedAsyncPollers[i];if(o&&o.expiration<r.getTime()&&(delete this.cachedAsyncPollers[i],o=null),!o){var u,p,d=c.NotStarted,g=null;this.cachedAsyncPollers[i]=o={expiration:r.getTime()+e.evictionDelay,data:{get status(){return d},get result(){if(d===c.RanToCompletion)return p;throw new Error("Async poll did not complete successfully")},get error(){return d===c.Faulted?g:null},wait:function(){if(!u){var i=t.loggingService.profilePageStart(n.ProfilingEventNames.asyncPollStart);u=t.waitOnPolling(e.action()).then(function(e){return e.status===l.CompleteSuccess?e.response:e.status===l.CompleteFailure?t.$q.reject(e.response):t.$q.reject("Polling failed. Invalid state")}).then(function(r){return d=c.RanToCompletion,p=r.data,t.loggingService.profileEnd(i,n.ProfilingEventNames.asyncPollEnd,{status:a.Status.Success,data:e.eventData}),p}).catch(function(r){throw d=c.Faulted,g=r,t.loggingService.profileEnd(i,n.ProfilingEventNames.asyncPollEnd,{status:a.inferErrorStatus(g),error:a.parseErrorMessage(g),data:e.eventData}),r}),d=c.Running}return u}}}}return o.data},e.prototype.waitOnPolling=function(e,i){var r=this,n=this.$q.defer();return e.then(function(e){var o=e&&e.headers&&e.headers();if(o&&o[t.PollResponseHeaders.Location]){var s=e.headers()[t.PollResponseHeaders.RetryAfter]?e.headers()[t.PollResponseHeaders.RetryAfter]:t.DefaultPollingRetryIntervalInSeconds;return r.backendPollingTracker(e.headers()[t.PollResponseHeaders.Location],s,i).then(function(e){n.resolve(e)}).catch(function(e){n.reject(e)})}return n.resolve(e)}).catch(function(e){return n.reject(e)}),n.promise},e.prototype.backendPollingTracker=function(e,i,r){var n=this,s=e,a=(i&&parseInt(i,10))>=0?1e3*parseInt(i,10):t.DefaultPollingRetryIntervalInMilliseconds;return this.setPolling(function(){return n.backendPoller(s,r)},function(e){return e.HttpStatusCode===t.PollHttpResponseStatus.Completed||e.HttpStatusCode===t.PollHttpResponseStatus.NoContent?o.equalsIgnoreCase(n.extractStatus(e),"Failed")?{status:l.CompleteFailure,response:e.Response}:{status:l.CompleteSuccess,response:e.Response}:(s=e.Location,{status:l.NotComplete,response:e.Response})},a)},e.prototype.extractStatus=function(e){if(e.Response&&e.Response.data){var t=e.Response.data;if(t.properties){return t.properties.status}return t.status}return""},e.prototype.setPolling=function(e,t,i){var r=this,n=this.$q.defer(),o=function(){e().then(function(e){var s=t(e);s.status===l.CompleteSuccess&&n.resolve(s),s.status===l.CompleteFailure?n.reject(s):s.status===l.NotComplete&&r.$timeout(o,i)}).catch(function(e){n.reject(e)})};return this.$timeout(o,i),n.promise},e.prototype.backendPoller=function(e,t){var i={method:"GET",url:e};return this.getRequest(i)},e.prototype.getRequest=function(e){return this.$http(e).then(function(e){return e.status===t.PollHttpResponseStatus.Accepted?{HttpStatusCode:e.status,Location:e.headers()[t.PollResponseHeaders.Location],RetryAfter:e.headers()[t.PollResponseHeaders.RetryAfter],Response:e,StatusText:e.statusText}:{HttpStatusCode:e.status,Location:"",RetryAfter:"",Response:e,StatusText:e.statusText}})},e.$inject=[r.default.services.$http,r.default.services.$q,r.default.services.$timeout,r.default.services.logging],e}();t.BackendService=u,angular.module(r.default.modules.processSimpleServices).service(r.default.services.backend,u)},function(e,t,i){"use strict";function r(e,t,i,r){var o=n.concatParts(e+"://",t);return i&&(o=n.concatParts(o,i)),r&&(o=n.concatParts(o,"?"+r)),o}Object.defineProperty(t,"__esModule",{value:!0});var n=i(32);t.composeUri=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants={JwtToken:{audience:"aud",name:"name",upn:"upn",email:"email",expiry:"exp",tenantId:"tid",objectId:"oid",puid:"puid"}};var r=function(){function e(){}return e.prototype.isTokenExpired=function(e,i){i=i||120;var r=parseInt(this.getTokenClaim(e,t.Constants.JwtToken.expiry),10);return!(r&&r>this._getNowSeconds()-i)},e.prototype.extractJwtTokenPayload=function(e){var t=this.decodeJwt(e);if(!t)return null;var i=t.jwsPayload,r=this.base64DecodeStringUrlSafe(i);return r?JSON.parse(r):null},e.prototype.getTokenClaim=function(e,t){return this.extractJwtTokenPayload(e)[t]},e.prototype.decodeJwt=function(e){var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/,i=t.exec(e);if(!i||i.length<4)throw new Error("The returned token is not parseable");return{header:i[1],jwsPayload:i[2],jwsSig:i[3]}},e.prototype.base64DecodeStringUrlSafe=function(e){return e=this.convertBase64UrlToBase64(e),window.atob?decodeURIComponent(window.escape(window.atob(e))):null},e.prototype.convertBase64UrlToBase64=function(e){return e.length%4==2?e+="==":e.length%4==3&&(e+="="),e=e.replace(/-/g,"+"),e=e.replace(/_/g,"/")},e.prototype._getNowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e}();t.JwtTokenService=r},function(e,t,i){function r(e){if(o(e)){var t=n(e.valueOf)?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var i=c.test(e);return i||u.test(e)?p(e.slice(2),i?2:8):l.test(e)?s:+e}var n=i(80),o=i(45),s=NaN,a=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,p=parseInt;e.exports=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(9),n=i(35),o=i(1),s=i(40),a=function(){function e(e){this.appSettings=e}return Object.defineProperty(e,"instance",{get:function(){return e.cdnUrlHelper.value},enumerable:!0,configurable:!0}),e.prototype.getCdnUrl=function(e){return!this.appSettings.featureFlags.enableCdn||!this.appSettings.cdnUrl||o.startsWith(e,"https://")||o.startsWith(e,"http://")?e:n.stripTrailingSlashes(this.appSettings.cdnUrl)+"/"+n.stripLeadingSlashes(e)+(this.appSettings.contentVersion?"?v="+this.appSettings.contentVersion:"")},e.cdnUrlHelper=new s.Lazy(function(){return new e(r.getAppSettings())}),e}();t.CdnUrlHelper=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(30);t.PollInterval={Never:31536e6};var o=function(){function e(e,t){var i=this;this._pollRefCount=0,this._$interval=e,this._options=t,this._getPollInterval=function(){var e=i._options.interval;return r.isFunction(e)?e():e}}return e.prototype.destroy=function(){this._pollRefCount=0,this._clearScheduledPoll(),this._isPolling=!1,this._isDestroyed=!0},e.prototype.start=function(e){var t=this;this._isDestroyed||(this._pollRefCount++,e.$on("$destroy",function(){--t._pollRefCount<=0&&(t._pollRefCount=0,t._clearScheduledPoll(),t._isPolling=!1)}),this._isPolling||(this._schedulePoll(),this._isPolling=!0))},e.prototype.reset=function(){this._isPolling&&(this._clearScheduledPoll(),this._schedulePoll())},e.prototype._schedulePoll=function(){var e=this;this._intervalPromise=this._$interval(function(){e._options.poll(),e._schedulePoll()},this._getPollInterval(),1)},e.prototype._clearScheduledPoll=function(){this._intervalPromise&&(this._$interval.cancel(this._intervalPromise),this._intervalPromise=null)},e}();n.default.factory("poll",["$interval",function(e){return function(t){return new o(e,t)}}])},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0}),r(i(417)),r(i(110))},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0}),r(i(8)),r(i(418)),r(i(419)),r(i(41)),r(i(138)),r(i(150)),r(i(420))},function(e,t,i){"use strict";function r(e){return"string"==typeof e||e instanceof String}Object.defineProperty(t,"__esModule",{value:!0}),t.isString=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(434);i(465);var o=function(){function e(){this.controller=n.ActivityFeedCtrl,this.template=i(466),this.controllerAs="activityFeedCtrl",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Activity}]}}return e}();t.ActivityFeed=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.activityFeed,new o)},function(e,t,i){"use strict";function r(e,t,i){var r=o.getIntervalDate(e,t),n=s.isNullOrUndefined(i)?e:o.getIntervalDate(e,i);return"Timestamp ge "+l.toISOString(r)+" "+(s.isNullOrUndefined(i)?"":"and Timestamp lt "+l.toISOString(n))}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var n=i(0),o=i(83),s=i(1),a=i(14),l=i(78);t.getFilterString=r,t.FeedEventDefinitionConstant={urlPath:"/providers/Microsoft.ProcessSimple/events",resourceType:"/providers/Microsoft.ProcessSimple/feeds/events"},t.FeedEventDefinitionPollFrequency={listFeedEventDefinitions:12e4,evictionDelay:3e5},angular.module(n.default.modules.processSimpleData).factory(n.default.services.feedEventDefinitionsClient,[n.default.services.azureResourceClientFactory,n.default.services.appSettings,n.default.services.environment,n.default.services.session,function(e,i,r,n){var o=i.processSimpleResourceProviderPath+"/environments/"+r.getCurrentEnvironmentName()+"/events";return e({urlBase:a.ProcessSimpleResourceProviderManagementEndpoint,urlPath:i.featureFlags.enableEnvironments?o:t.FeedEventDefinitionConstant.urlPath,apiVersion:i.featureFlags.enableEnvironments?i.processSimpleResourceProviderApiVersionWithEnvironments:i.processSimpleResourceProviderApiVersion,rest:{query:{params:{$aggregate:"Fail,Success",$expand:"Runs"}}},options:{atomize:!1,queryPollInterval:t.FeedEventDefinitionPollFrequency.listFeedEventDefinitions,evictionDelay:t.FeedEventDefinitionPollFrequency.evictionDelay}})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(8),o=i(55),s=i(7),a=i(46),l=i(57),c=i(168);!function(e){e[e.Today=0]="Today",e[e.Yesterday=1]="Yesterday",e[e.Older=2]="Older"}(t.EventTimeline||(t.EventTimeline={})),t.PagingConstants={TodayStartInterval:0,YesterdayEndInterval:0,YesterdayStartInterval:-1,PagingIntervals:[-1,-8,-15,-22,-29],MaximumPagesToLoad:4};var u=function(){function e(t,i,r,o,a,l,c){var u=this;this.$sce=t,this.$scope=i,this.$q=r,this.clientResources=o,this.feedEventDefinitionsClient=a,this.dateTimeService=l,this.navigationService=c,this.spinner={size:s.SpinnerSize.Large,local:s.SpinnerPosition.Local},this.$q.all(this.$scope.model.eventCollections.map(function(e){return e.events.$promise})).finally(function(){u.$scope.model.spinner.show=!1}),this.$scope.model.eventCollections.forEach(function(t,i){t.events.$watch(u.$scope,function(){var r=t.events.filter(function(t){return e.SupportedFeedEventTypes.some(function(e){return n.equalsIgnoreCase(e,t.properties.type)})}).map(function(e){return u.convertFeedEventDefinitionToRow(e,t.expandDateTime)});u.$scope.model.tables[i]={rows:t.shouldMerge&&u.$scope.model.tables[i]&&u.$scope.model.tables[i].rows?u.$scope.model.tables[i].rows.concat(r):r,heading:t.heading}})})}return e.prototype.convertFeedEventDefinitionToRow=function(e,t){var i=new Date(e.properties.timestamp);return{type:e.properties.type,title:o.getTitle(e,this.clientResources.Manage.Activity.Flow.Failed),description:o.getDescription(e),timeSince:t?this.dateTimeService.getTimeAtDateTimeString(i):this.dateTimeService.getFriendlyTimeSinceString(l.DefaultDateTimeOptions,i),imageRenderHtml:this.$sce.trustAsHtml(a.getIconsTemplate(a.getIconInfoForFeedEvent(e),o.isFailure(e))),navigationInfo:c.getNavigationInfo(e)}},e.prototype.activityFeedPresent=function(){return this.$scope.model.tables.some(function(e){return 0!==e.rows.length})&&!this.$scope.model.spinner.show},e.prototype.rowDefaultAction=function(e){this.navigationService.navigate(e.navigationInfo)},e.$inject=[r.default.services.$sce,r.default.services.$scope,r.default.services.$q,r.default.services.clientResources,r.default.services.feedEventDefinitionsClient,r.default.services.dateTime,r.default.services.navigation],e.SupportedFeedEventTypes=[o.FeedEventDefinitionType.AggregatedFail,o.FeedEventDefinitionType.AggregatedSuccess,o.FeedEventDefinitionType.PushNotification,o.FeedEventDefinitionType.FlowSuspended,o.FeedEventDefinitionType.BrokenConnection],e}();t.ActivityFeedListDirectiveCtrl=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowTemplateOperationKind={ApiConnection:"ApiConnection",Http:"Http",NotSpecified:"NotSpecified",PowerApp:"PowerApp",Button:"Button"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultIcon={Trigger:"/Content/Images/Common/trigger.svg",Action:"/Content/Images/Common/action.svg",Connection:"/Content/Images/Common/connection.svg"}},function(e,t,i){function r(e,t,i){if(!a(i))return!1;var r=typeof t;return!!("number"==r?o(i)&&s(t,i.length):"string"==r&&t in i)&&n(i[t],e)}var n=i(84),o=i(111),s=i(86),a=i(45);e.exports=r},function(e,t){function i(e){return function(t){return null==t?void 0:t[e]}}e.exports=i},function(e,t,i){function r(e,t){if("function"!=typeof e)throw new TypeError(s);return t=a(void 0===t?e.length-1:o(t),0),function(){for(var i=arguments,r=-1,o=a(i.length-t,0),s=Array(o);++r<o;)s[r]=i[t+r];switch(t){case 0:return e.call(this,s);case 1:return e.call(this,i[0],s);case 2:return e.call(this,i[0],i[1],s)}var l=Array(t+1);for(r=-1;++r<t;)l[r]=i[r];return l[t]=s,n(e,this,l)}}var n=i(159),o=i(443),s="Expected a function",a=Math.max;e.exports=r},function(e,t){function i(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}e.exports=i},function(e,t,i){function r(e){var t=e?e.length:void 0;return a(t)&&(s(e)||l(e)||o(e))?n(t,String):null}var n=i(449),o=i(161),s=i(52),a=i(85),l=i(162);e.exports=r},function(e,t,i){function r(e){return n(e)&&a.call(e,"callee")&&(!c.call(e,"callee")||l.call(e)==o)}var n=i(450),o="[object Arguments]",s=Object.prototype,a=s.hasOwnProperty,l=s.toString,c=s.propertyIsEnumerable;e.exports=r},function(e,t,i){function r(e){return"string"==typeof e||!n(e)&&o(e)&&l.call(e)==s}var n=i(52),o=i(51),s="[object String]",a=Object.prototype,l=a.toString;e.exports=r},function(e,t){function i(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}var r=Object.prototype;e.exports=i},function(e,t){function i(e,t){for(var i=-1,r=e.length,n=Array(r);++i<r;)n[i]=t(e[i],i,e);return n}e.exports=i},function(e,t){function i(e,t){return n.call(e,t)||"object"==typeof e&&t in e&&null===o(e)}var r=Object.prototype,n=r.hasOwnProperty,o=Object.getPrototypeOf;e.exports=i},function(e,t){var i=/<%=([\s\S]+?)%>/g;e.exports=i},function(e,t,i){var r=i(56),n=r.Symbol;e.exports=n},function(e,t,i){"use strict";function r(e){switch(e&&e.properties&&e.properties.type){case n.FeedEventDefinitionType.AggregatedFail:case n.FeedEventDefinitionType.AggregatedSuccess:return e.properties.object.isFlowDeleted?s:"flows/"+e.properties.actorId+"/runs/"+e.properties.object.runs[0].flowRunSequenceId;case n.FeedEventDefinitionType.PushNotification:return e.properties.object.isFlowDeleted?s:"flows/"+e.properties.actorId+"/runs/"+e.properties.object.flowRunSequenceId;case n.FeedEventDefinitionType.BrokenConnection:return"connections/"+o.getConnectionApiNameFromId(e.properties.object.connectionId)+"/"+e.properties.actorId;case n.FeedEventDefinitionType.FlowSuspended:return e.properties.object.isFlowDeleted?s:"flows/"+e.properties.actorId;default:return s}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(55),o=i(33),s="#";t.getNavigationInfo=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Blank=0]="Blank",e[e.OpenApiFile=1]="OpenApiFile",e[e.OpenApiUrl=2]="OpenApiUrl",e[e.Postman=3]="Postman"}(t.DialogMode||(t.DialogMode={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(471);i(472);var o=function(){function e(){this.template=i(473),this.controller=n.ApprovalCenterCtrl,this.controllerAs="approvalCenterCtrl"}return e}();t.ApprovalCenter=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.approvalCenter,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(478);i(479);var o=function(){function e(){this.controller=n.ConnectionCtrl,this.template=i(480),this.controllerAs="connectionCtrl",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Connections}]}}return e}();t.Connection=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.connection,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(481);i(482);var o=function(){function e(){this.controller=n.ConnectionsCtrl,this.template=i(483),this.controllerAs="connectionsCtrl",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Connections}]}}return e}();t.Connections=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.connections,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(488);i(489);var o=function(){function e(){this.controller=n.GatewaysCtrl,this.template=i(490),this.controllerAs="gatewaysCtrl",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Gateways}]}}return e}();t.Gateways=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.gateways,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(491);i(492);var o=function(){function e(){this.controller=n.GatewayCtrl,this.template=i(493),this.controllerAs="gatewayCtrl",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Gateways}]}}return e}();t.Gateway=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.connection,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(494);i(495);var o=function(){function e(){this.controller=n.CreateConnectionCtrl,this.template=i(496),this.controllerAs="controller",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Connections}]}}return e}();t.CreateConnection=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.createConnection,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(501),o=i(23);i(562);var s=function(){function e(e){this.controller=n.FlowCtrl,this.template=i(563),this.controllerAs="flowCtrl",e=e||{},this.resolve=(t={},t[o.isShared]=[function(){return!(!e||!e.isSharedFlow)}],t);var t}return e}();t.Flow=s,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flow,new s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionSource={Embedded:"Embedded",Invoker:"Invoker",NotSpecified:"NotSpecified"}},function(e,t,i){function r(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}var n=i(507),o=i(508),s=i(509),a=i(510),l=i(511);r.prototype.clear=n,r.prototype.delete=o,r.prototype.get=s,r.prototype.has=a,r.prototype.set=l,e.exports=r},function(e,t,i){function r(e,t){var i=n(e,t);return!(i<0)&&(i==e.length-1?e.pop():s.call(e,i,1),!0)}var n=i(90),o=Array.prototype,s=o.splice;e.exports=r},function(e,t,i){function r(e,t){var i=n(e,t);return i<0?void 0:e[i][1]}var n=i(90);e.exports=r},function(e,t,i){function r(e,t){return n(e,t)>-1}var n=i(90);e.exports=r},function(e,t,i){function r(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}var n=i(512),o=i(515),s=i(517),a=i(519),l=i(520);r.prototype.clear=n,r.prototype.delete=o,r.prototype.get=s,r.prototype.has=a,r.prototype.set=l,e.exports=r},function(e,t){function i(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}e.exports=i},function(e,t,i){function r(e,t){return n?void 0!==e[t]:s.call(e,t)}var n=i(91),o=Object.prototype,s=o.hasOwnProperty;e.exports=r},function(e,t,i){function r(e,t,i){var r=n(e,t);r<0?e.push([t,i]):e[r][1]=i}var n=i(90);e.exports=r},function(e,t,i){function r(e,t,i,a,l){return e===t||(null==e||null==t||!o(e)&&!s(t)?e!==e&&t!==t:n(e,t,r,i,a,l))}var n=i(522),o=i(45),s=i(51);e.exports=r},function(e,t){function i(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=e}),i}e.exports=i},function(e,t,i){var r=i(92),n=i(56),o=r(n,"Set");e.exports=o},function(e,t,i){function r(e,t,i){var r=null==e?void 0:n(e,t);return void 0===r?i:r}var n=i(190);e.exports=r},function(e,t,i){function r(e,t){t=o(t,e)?[t+""]:n(t);for(var i=0,r=t.length;null!=e&&i<r;)e=e[t[i++]];return i&&i==r?e:void 0}var n=i(191),o=i(120);e.exports=r},function(e,t,i){function r(e){return n(e)?e:o(e)}var n=i(52),o=i(537);e.exports=r},function(e,t,i){var r,n,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};r=[i,t,i(93),i(557),i(558),i(122),i(193)],void 0!==(n=function(e,t,i,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e){void 0===e&&(e={}),this.options=e,this.options=o({arrayOutputDepth:0,expandArrayOutputs:!0,required:!1,isInputSchema:!1,excludeAdvanced:!1,excludeInternal:!0},e)}return e.prototype.getSchemaProperties=function(e){var t=this;e=this._dereferenceRefSchema(e);var r;switch(e.type){case i.Types.Array:r=this._getArrayParameters(e);break;case i.Types.Boolean:case i.Types.Integer:case i.Types.Null:case i.Types.Number:case i.Types.String:case void 0:r=this._getScalarParameters(e);break;case i.Types.Object:r=this._getObjectParameters(e);break;default:r=[]}return r=r.filter(function(e){return!(t.options.excludeInternal&&s.equals(e.visibility,i.Visibility.Internal))}).filter(function(e){return!(t.options.excludeAdvanced&&s.equals(e.visibility,i.Visibility.Advanced))}),this._sortParameters(r)},e.prototype._getArrayParameters=function(e){var t=this._dereferenceRefSchema(e.items||{type:i.Types.Any}),r=t.type,n=this._getScalarParameters(e);if(this.options.expandArrayOutputs&&!this.options.isInputSchema){if(1===this.options.arrayOutputDepth&&!this.options.expandNestedArrayOutputs||this.options.arrayOutputDepth>1)return n;if(this.options.parentProperty?(this.options.parentProperty.arrayName=this.options.prefix,this.options.parentProperty.isArray=!0):this.options.parentProperty={arrayName:this.options.prefix,isArray:!0},this.options.prefix=void 0,this.options.summaryPrefix=void 0,this.options.titlePrefix=void 0,this.options.arrayOutputDepth++,n=n.concat(this._getParameterDetails(t,null,!0,!0)),r===i.Types.Object){if(t[i.ExtensionProperties.DynamicSchema])return this._getScalarParameters(t).concat(n);var o=this.options.keyPrefix?this.options.keyPrefix+"."+a.WildIndexSegment:"$."+a.WildIndexSegment,s=this._getObjectPropertyOutputs(t,o);if(s.length)return s.concat(n)}}return n},e.prototype._getObjectParameters=function(e,t){void 0===t&&(t=null);var r=[],n=this._getObjectPropertyOutputs(e,t);if(s.hasProperty(e,i.ExtensionProperties.DynamicSchema)){var o=this._getParameterDetails(e);return o&&r.push(o),r}return n.length?n:this._getScalarParameters(e)},e.prototype._getObjectPropertyOutputs=function(t,r){var n=this,l=t.properties||{},c=t.required||[],u=Object.keys(l),p=[];if(u.length){var d=u.map(function(u){var p=r||n.options.keyPrefix;p=p||"$";var d=a.encodePropertySegment(u),g=p?p+"."+d:d,m=n.options.prefix?n.options.prefix+"."+u:u,f=l[u],h=s.isNullOrUndefined(n.options.required)?-1!==c.indexOf(u):n.options.required&&-1!==c.indexOf(u),v=t[i.ExtensionProperties.Permission]||n.options.permission,y=n._getTitlePrefix(t.title,t[i.ExtensionProperties.Summary]),w=n._getSummaryPrefix(t[i.ExtensionProperties.Summary],""),C=o({},n.options.parentProperty,{visibility:n._getVisibility(t)});return new e({keyPrefix:g,arrayOutputDepth:n.options.arrayOutputDepth,currentKey:u,excludeAdvanced:n.options.excludeAdvanced,excludeInternal:n.options.excludeInternal,expandNestedArrayOutputs:n.options.expandNestedArrayOutputs,includeParentObject:n.options.includeParentObject,isInputSchema:n.options.isInputSchema,isNested:!0,metadata:n.options.metadata,parentProperty:C,permission:v,prefix:m,required:h,summaryPrefix:w,titlePrefix:y}).getSchemaProperties(f)});p=s.aggregate(d)}if(this.options.includeParentObject){var g=this._getName(),m=this._getTitle(t.title,t[i.ExtensionProperties.Summary]||this.options.currentKey),f=this._getSummary(t[i.ExtensionProperties.Summary],"");p.push({key:this.options.keyPrefix?this.options.keyPrefix:"$",type:i.Types.Object,format:t.format,required:this.options.required,description:t.description,visibility:this._getVisibility(t),isNested:this.options.isNested,dynamicValues:t[i.ExtensionProperties.DynamicValues],isInsideArray:this.options.parentProperty&&this.options.parentProperty.isArray,parentArray:this.options.parentProperty&&this.options.parentProperty.arrayName,readOnly:t.readOnly,recommended:t[i.ExtensionProperties.SchedulerRecommendation],isNotificationUrl:t[i.ExtensionProperties.NotificationUrl],default:t.default,permission:t[i.ExtensionProperties.Permission]||this.options.permission,name:g,title:m,summary:f})}return this._sortParameters(p)},e.prototype._getScalarParameters=function(e,t){var i=this._getParameterDetails(e,t);return i?[i]:[]},e.prototype._dereferenceRefSchema=function(e){if(s.isNullOrUndefined(e))return e;var t=e.$ref;if(t){var i=this.options.metadata;e=r.dereferenceRefSchema(t,i)}return e},e.prototype._getName=function(){return this.options.prefix||this.options.isInputSchema?this.options.prefix||this.options.currentKey:this.options.parentProperty&&this.options.parentProperty.isArray?this.options.parentProperty.arrayName?this.options.parentProperty.arrayName+"-"+i.OutputKeys.Item:i.OutputKeys.Item:i.OutputKeys.Body},e.prototype._getParameterDetails=function(e,t,r,o){void 0===r&&(r=!1),void 0===o&&(o=!1);var s=this.options,l=s.isInputSchema,c=s.parentProperty,u=s.permission,p=s.required,d=this.options.keyPrefix?this.options.keyPrefix:"$";d=o?d+"."+a.WildIndexSegment:d;var g=r?null:this.options.currentKey,m=this._getName(),f=t||e,h=f.default,v=f[i.ExtensionProperties.ContentHint],y=f.description,w=f[i.ExtensionProperties.DynamicallyAdded],C=f[i.ExtensionProperties.DynamicSchema],S=f[i.ExtensionProperties.DynamicValues],b=f[i.ExtensionProperties.Encode],P=n.getEnum(f,p),R=f.format,T=this._dereferenceRefSchema(f.items),E=c&&c.isArray,A=this.options.isNested,D=f[i.ExtensionProperties.NotificationUrl],F=c&&c.arrayName,N=f[i.ExtensionProperties.Permission]||u,I=f.readOnly,O=f[i.ExtensionProperties.SchedulerRecommendation],k=p,M=this._getTitle(f.title,f[i.ExtensionProperties.Summary]),x=this._getSummary(f[i.ExtensionProperties.Summary],""),_=f.type||i.Types.Any,U=this._getVisibility(f);return l&&I?null:(M=M||x||this._getTitle(g,""),!M&&l&&(M="Body"),{key:d,default:h,contentHint:v,description:y,dynamicallyAdded:w,dynamicSchema:C,dynamicValues:S,encode:b,enum:P,format:R,itemSchema:T,isInsideArray:E,isNested:A,isNotificationUrl:D,name:m||M,parentArray:F,permission:N,readOnly:I,recommended:O,required:k,summary:x,title:M,type:_,visibility:U})},e.prototype._getSummary=function(e,t){var i=e||t,r=this.options.summaryPrefix;return r&&i?r+" "+i:i},e.prototype._getTitle=function(e,t){var i=e||t,r=this.options.titlePrefix;return r&&i?r+" "+i:i},e.prototype._getTitlePrefix=function(e,t){var i=e||t,r=this.options.titlePrefix;return r&&i?r+" "+i:i||r},e.prototype._getSummaryPrefix=function(e,t){var i=e||t,r=this.options.summaryPrefix;return r&&i?r+" "+i:i||r},e.prototype._getVisibility=function(e){return e[i.ExtensionProperties.Visibility]||(this.options.parentProperty?this.options.parentProperty.visibility:"")},e.prototype._sortParameters=function(e){var t=[];return e.forEach(function(e){e.required&&t.push(e)}),e.forEach(function(e){!e.required&&s.equals(e.visibility,i.Visibility.Important)&&t.push(e)}),e.forEach(function(e){e.required||s.equals(e.visibility,i.Visibility.Important)||s.equals(e.visibility,i.Visibility.Advanced)||t.push(e)}),e.forEach(function(e){e.required||s.equals(e.visibility,i.Visibility.Important)||!s.equals(e.visibility,i.Visibility.Advanced)||t.push(e)}),t},e}();t.SchemaProcessor=l}.apply(t,r))&&(e.exports=n)},function(e,t,i){var r,n;r=[i,t],void 0!==(n=function(e,t){"use strict";function i(e){return e.map(n).join(l)}function r(e){return e.split(l).map(o)}function n(e){return e=e.replace(c,u),p.forEach(function(t){e=e.replace(t[0],t[1])}),e}function o(e){return p.forEach(function(t){e=e.replace(t[1],t[0])}),e.replace(u,c)}function s(e){return e.split(l).filter(a).length>0}function a(e){return e===t.WildIndexSegment}Object.defineProperty(t,"__esModule",{value:!0});var l=".",c="~",u="~0",p=[[".","~1"],["[","~2"],["*","~3"]];t.WildIndexSegment="[*]",t.create=i,t.parse=r,t.encodePropertySegment=n,t.decodePropertySegment=o,t.containsWildIndexSegment=s}.apply(t,r))&&(e.exports=n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(564);i(565);var o=function(){function e(){this.controller=n.FlowNewGettingStartedCtrl,this.template=i(566)}return e}();t.FlowNewGettingStarted=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowNewGettingStarted,new o)},function(e,t,i){"use strict";function r(e,t,i){return"providers/Microsoft.ProcessSimple/environments/"+o.getCurrentEnvironmentName()+"/flows/"+e+"/apis/"+t+"/connections/"+i}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var n=i(0),o=i(20),s=i(14);t.FlowConnectionsConstant={resourceType:"/providers/Microsoft.PowerApps/apis/connections"},t.getFlowConnectionsDeletionId=r,angular.module(n.default.modules.processSimpleData).factory(n.default.services.flowConnectionsClient,[n.default.services.appSettings,n.default.services.azureResourceClientFactory,n.default.services.environment,function(e,i,r){var n=e.processSimpleResourceProviderPath+"/environments/"+r.getCurrentEnvironmentName()+"/flows/:flowName/connections";return i({urlBase:s.ProcessSimpleResourceProviderManagementEndpoint,urlPath:n,resourceType:t.FlowConnectionsConstant.resourceType,apiVersion:e.processSimpleResourceProviderApiVersionWithEnvironments,rest:{query:{responseInterceptor:function(e){return e}}}})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(571);i(573);var o=function(){function e(){this.controller=n.FlowRunCtrl,this.controllerAs="flowRunCtrl",this.template=i(574),this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Flows}]}}return e}();t.FlowRun=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowRun,new o)},function(e,t,i){"use strict";function r(e){var t=m.OperationErrorType.Default,i=a(e);switch(e.statusCode){case 400:t=m.OperationErrorType.InvalidInput;break;case 401:t=m.OperationErrorType.NotAuthorized;break;case 404:t=m.OperationErrorType.ObjectNotFound,i&&h.isString(i)&&i.match(v.ConnectionNotFound)&&(t=m.OperationErrorType.ConnectionNotFound);break;case 409:t=m.OperationErrorType.Conflict;break;case 500:case 502:case 503:case 504:t=m.OperationErrorType.InternalServerError;break;default:t=m.OperationErrorType.Default}return t}function n(e,t){var i,r=t.properties.definition.triggers[e]||p(e,t.properties.definition.actions),n=!g.isNativeOperation(r)&&r&&r.inputs&&r.inputs.host&&r.inputs.host.api&&r.inputs.host.api.runtimeUrl||null;return n&&Object.keys(t.properties.connectionReferences).length>0?Object.keys(t.properties.connectionReferences).forEach(function(e){var r=t.properties.connectionReferences[e];r&&r.apiDefinition&&r.apiDefinition.properties&&r.apiDefinition.properties.primaryRuntimeUrl&&r.apiDefinition.properties.primaryRuntimeUrl===n&&(i=r)}):i=r,i}function o(e,t,i,r){var n,o=!0;switch(t){case m.OperationErrorType.Conflict:n=e.FlowRun.Operation.ErrorType.Conflict;break;case m.OperationErrorType.ConnectionNotFound:n=e.FlowRun.Operation.ErrorType.ConnectionNotFound;break;case m.OperationErrorType.InvalidInput:n=e.FlowRun.Operation.ErrorType.InputsInvalid;break;case m.OperationErrorType.InternalServerError:n=e.FlowRun.Operation.ErrorType.InternalServerError;break;case m.OperationErrorType.InvalidTemplate:o=!0,n=e.FlowRun.Operation.ErrorType.InvalidTemplate;break;case m.OperationErrorType.NotAuthorized:o=!0,n=e.FlowRun.Operation.ErrorType.NotAuthorized;break;case m.OperationErrorType.ObjectNotFound:n=e.FlowRun.Operation.ErrorType.ObjectNotFound;break;case m.OperationErrorType.RequestEntityTooLarge:n=e.FlowRun.Operation.ErrorType.RequestEntityTooLarge;break;default:n=e.FlowRun.Operation.ErrorType.Default}return o&&r.forEach(function(e){e.name===i&&(n=d.format(n,e.properties.displayName))}),n}function s(e,t,i){switch(t){case m.OperationErrorType.Conflict:return e.FlowRun.Operation.FixIt.Conflict;case m.OperationErrorType.ConnectionNotFound:return d.format(e.FlowRun.Operation.FixIt.ConnectionNotFound,i);case m.OperationErrorType.InternalServerError:return e.FlowRun.Operation.FixIt.InternalServerError;case m.OperationErrorType.InvalidInput:return e.FlowRun.Operation.FixIt.InputsInvalid;case m.OperationErrorType.InvalidTemplate:return e.FlowRun.Operation.FixIt.InvalidTemplate;case m.OperationErrorType.NotAuthorized:return d.format(e.FlowRun.Operation.FixIt.NotAuthorized,i);case m.OperationErrorType.ObjectNotFound:return e.FlowRun.Operation.FixIt.ObjectNotFound;case m.OperationErrorType.RequestEntityTooLarge:return e.FlowRun.Operation.FixIt.RequestEntityTooLarge;default:return e.FlowRun.Operation.FixIt.Default}}function a(e){if(e.body){if(e.body.$content)return"application/octet-stream"===e.body["$content-type"]?atob(e.body.$content):e.body.$content;if(e.body.message)return e.body.message;if(e.body.error&&e.body.error.message)return e.body.error.message}else if(e.error&&e.error.message)return e.error.message;return e.body}function l(e){return e===m.OperationErrorType.InternalServerError||e===m.OperationErrorType.Default}function c(e){var t={},i=e.filter(function(e){var i=e.title+e.errorDetails;return!t[i]&&(t[i]=!0,!0)});return i.forEach(function(e){return e.duplicateFailureCount=0}),e.forEach(function(e){var t=e.title+e.errorDetails;i.filter(function(e){return e.title+e.errorDetails===t})[0].duplicateFailureCount+=1}),i}function u(e,t,i){var r,n,o=d.format("https://flow.microsoft.com/{0}/documentation/fix-flow-failures/",t),s=d.format("https://flow.microsoft.com/{0}/support/",t),a='<a data-event-name="{0}" href="{1}" target="_blank">{2}</a>';return i?(r=d.format(a,f.TelemetryEventNames.DebugViewSummaryPaneClientSupportLinkClicked,o,e.FlowRun.Support.Here),n=d.format(a,f.TelemetryEventNames.DebugViewSummaryPaneCommunityLinkClicked,"https://go.microsoft.com/fwlink/?LinkID=787467",e.FlowRun.Support.Community),d.format(e.FlowRun.Support.ClientFailureMessage,r,n)):(r=d.format(a,f.TelemetryEventNames.DebugViewSummaryPaneServerSupportLinkClicked,s,e.FlowRun.Support.SupportPage),d.format(e.FlowRun.Support.ServerFailureMessage,r))}function p(e,t){var i;return t&&Object.keys(t).forEach(function(r){i||"runAfter"===r||(r===e?i=t[r]:"object"==typeof t[r]&&(i=p(e,t[r])))}),i}Object.defineProperty(t,"__esModule",{value:!0});var d=i(1),g=i(123),m=i(572),f=i(37),h=i(150),v={ConnectionNotFound:/connection .* not found/i};t.getErrorType=r,t.getConnectionReference=n,t.getErrorDescription=o,t.getFixDescription=s,t.getErrorDetails=a,t.isServerError=l,t.removeDuplicateFailedOperationSummary=c,t.getSupportMessage=u},function(e,t,i){"use strict";function r(e,t){return o.getAppSettings().featureFlags.enableEnvironments?"/providers/Microsoft.ProcessSimple/environments/"+s.getCurrentEnvironmentName()+"/flows/"+e+"/runs/"+t:"/providers/Microsoft.ProcessSimple/flows/"+e+"/runs/"+t}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var n=i(0),o=i(9),s=i(20),a=i(14);t.FlowRunsConstant={urlPath:o.getAppSettings().processSimpleResourceProviderPath+"/flows/:flowName/runs",resourceType:o.getAppSettings().processSimpleResourceProviderPath+"/flows/runs"},t.FlowRunsPollFrequency={listFlowRuns:6e4,getFlowRuns:45e3,evictionDelay:3e5},t.getFlowRunId=r,angular.module(n.default.modules.processSimpleData).factory(n.default.services.flowRunsClient,[n.default.services.azureResourceClientFactory,n.default.services.appSettings,n.default.services.environment,function(e,i,r){var n=i.processSimpleResourceProviderPath+"/environments/"+r.getCurrentEnvironmentName()+"/flows/:flowName/runs",o=i.featureFlags.enableEnvironments?n:t.FlowRunsConstant.urlPath,s={urlPath:n+"/:flowRunName/cancel",name:"cancel",method:"POST",params:{flowName:"@flowName",flowRunName:"@flowRunName"}};return e({apiVersion:i.featureFlags.enableEnvironments?i.processSimpleResourceProviderApiVersionWithEnvironments:i.processSimpleResourceProviderApiVersion,urlBase:a.ProcessSimpleResourceProviderManagementEndpoint,urlPath:o,resourceType:t.FlowRunsConstant.resourceType,rest:{get:{params:{flowName:"@flowName",id:"@id"}},query:{lazyPaging:!0,params:{flowName:"@flowName"}}},actions:[s],options:{atomize:!1,evictionDelay:t.FlowRunsPollFrequency.evictionDelay}})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(200);t.PaneAnimation={SlideIn:"SlideIn",NoAnimation:"NoAnimation"};var o=function(){function e(e,t,i,r,n){this.$document=e,this.$element=t,this.$scope=i,this.appSettings=r,this.Resources=n,this.registerCloseOnClickOutsidePane()}return e.prototype.close=function(){this.onClose(),this.expanded=!1},Object.defineProperty(e.prototype,"isSlideInAnimation",{get:function(){return this.paneAnimation!==t.PaneAnimation.NoAnimation},enumerable:!0,configurable:!0}),e.prototype.registerCloseOnClickOutsidePane=function(){var e=this,t=function(t){e.$scope.$apply(function(){n.isParentOrElement(e.$element[0],t.target)||e.toggleButtonId&&e.toggleButtonId===t.target.id||!e.closeOnClickOutsidePane&&void 0!==e.closeOnClickOutsidePane||e.close()})};this.$document.on("click",t),this.$scope.$on("$destroy",function(){e.$document.off("click",t)})},e.$inject=[r.default.services.$document,r.default.services.$element,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources],e}();t.InfoPaneCtrl=o},function(e,t,i){"use strict";function r(e,t){for(var i=t;null!==i;){if(i===e)return!0;i=i.parentElement}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.isParentOrElement=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(44);i(575);var o=function(){function e(){this.controller=n.FlowRunsCtrl,this.controllerAs="flowRunsCtrl",this.template=i(576),this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Flows}]}}return e}();t.FlowRuns=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowRuns,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(580),o=i(23);i(604);var s=function(){function e(e){this.controller=n.FlowsCtrl,this.template=i(605),this.controllerAs="flowsCtrl",this.resolve=(t={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Flows}]},t[o.isShared]=[function(){return!(!e||!e.isSharedFlows)}],t);var t}return e}();t.Flows=s,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flows,new s)},function(e,t,i){"use strict";function r(){var e=n.SessionService.instance.getUserSession();if(!e||!e.isAuthenticated||!e.userServicePlans||0===e.userServicePlans.length)return null;var t=e.userServicePlans.filter(function(e){return e.isCurrent});return t.length>0?t[0]:null}Object.defineProperty(t,"__esModule",{value:!0});var n=i(43),o=i(4),s=i(3),a=i(0),l=i(39);t.getUserPlan=r;var c=function(){function e(e,t,i){this.loggingService=e,this.plansClient=t,this.sessionService=i}return e.prototype.getUserPlan=function(){return r()},e.prototype.refreshUserPlans=function(){var e=this;return this.plansClient.refreshPlans().then(function(t){e.setUserPlans(t.data)})},e.prototype.isPlanExpired=function(){var e=this.getUserPlan();return Date.parse(e.properties.expirationTime)<Date.now()&&e.properties.licenseSku!==l.planLicenseSku.free&&!0===e.properties.isTrial},e.prototype.isPlanFree=function(){return l.isFreePlan(this.getUserPlan())},e.prototype.isPlanSeeded365=function(){return l.isSeeded365(this.getUserPlan())},e.prototype.isPlanFreeAndNotSeeded=function(){return l.isFreeNotSeededPlan(this.getUserPlan())},e.prototype.isPlanTrial=function(){return l.isTrial(this.getUserPlan())},e.prototype.getPlanLicenseSku=function(){return this.getUserPlan().properties.licenseSku},e.prototype.getPlanName=function(){return this.getUserPlan().name},e.prototype.startTrial=function(e){var t=this,i=this.loggingService.profileStart(o.ProfilingEventNames.createTrialStart);return this.plansClient.createPlan({},{properties:{licenseId:e}}).then(function(e){t.loggingService.profileEnd(i,o.ProfilingEventNames.createTrialEnd,{status:o.Status.Success}),t.setUserPlan(e.data)}).catch(function(e){throw t.loggingService.profileEnd(i,o.ProfilingEventNames.createTrialEnd,{status:s.inferErrorStatus(e),error:s.parseErrorMessage(e)}),e})},e.prototype.setUserPlan=function(e){var t=n.SessionService.instance.getUserSession();e&&this.sessionService.getUserSession()&&(t.userServicePlans.forEach(function(e){e.isCurrent=!1}),e.isCurrent=!0,t.userServicePlans=t.userServicePlans.concat(e))},e.prototype.setUserPlans=function(e){var t=n.SessionService.instance.getUserSession();e&&this.sessionService.getUserSession()&&(t.userServicePlans=e)},e.$inject=[a.default.services.logging,a.default.services.plansClient,a.default.services.session],e}();t.PlanService=c,angular.module(a.default.modules.processSimpleServices).service(a.default.services.plan,c)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(610);i(611);var o=function(){function e(){this.template=i(612),this.controller=n.RunFlowCtrl,this.controllerAs="runFlowCtrl"}return e}();t.RunFlow=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.runFlow,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(613);i(614);var o=function(){function e(){this.template=i(615),this.bindings={inputData:"<",createFromTemplateArgs:"<"},this.controller=n.RuntimeFlowWidgetCtrl,this.controllerAs="runtimeFlowWidgetCtrl"}return e}();t.RuntimeFlowWidget=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.runtimeFlowWidget,new o)},function(e,t,i){"use strict";function r(e){var t=angular.copy(e);if(t.definitions&&Array.isArray(t.definitions)){var i={};t.definitions.forEach(function(e){i[e.name]=e.item}),t.definitions=i}if(t.parameters&&Array.isArray(t.parameters)){var r={};t.parameters.forEach(function(e){r[e.name]=e.item}),t.parameters=r}if(t.responses&&Array.isArray(t.responses)){var o={};t.responses.forEach(function(e){o[e.name]=e.item}),t.responses=o}t.paths||(t.paths={});var s=[];return Array.isArray(t.actions)&&(s=s.concat(t.actions)),Array.isArray(t.triggers)&&(s=s.concat(t.triggers)),s.forEach(function(e){var i={};e.operation.responses&&Array.isArray(e.operation.responses)&&e.operation.responses.forEach(function(e){i[e.name]=e.item}),e.operation.responses=i,t.paths[e.path]||(t.paths[e.path]={}),e[n.Swagger.NotificationContent]&&(t.paths[e.path][n.Swagger.NotificationContent]=e.operation[n.Swagger.NotificationContent],delete e.operation[n.Swagger.NotificationContent]),t.paths[e.path][e.method]=e.operation}),delete t.actions,delete t.triggers,JSON.stringify(t)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(16);t.serialize=r},function(e,t,i){"use strict";function r(e){return e.widgetInfo&&e.widgetInfo.widgetType===n.WidgetType.logicAppsCustomApi}Object.defineProperty(t,"__esModule",{value:!0});var n=i(14);t.isLogicApps=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NotSpecified=0]="NotSpecified",e[e.Created=1]="Created",e[e.Pending=2]="Pending",e[e.Suspended=3]="Suspended",e[e.Completed=4]="Completed",e[e.Expired=5]="Expired",e[e.Canceled=6]="Canceled"}(t.ApprovalStatus||(t.ApprovalStatus={}));!function(e){e[e.NotSpecified=0]="NotSpecified",e[e.Reviewing=1]="Reviewing",e[e.Saved=2]="Saved",e[e.Commited=3]="Commited"}(t.ApprovalResponseStatus||(t.ApprovalResponseStatus={}))},function(e,t){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(734);i(735);var o=function(){function e(){this.template=i(736),this.controller=n.GraphAutocompleteCtrl,this.bindings={onSelect:"&",isDisabled:"<",limit:"<?"},this.controllerAs="graphAutocompleteCtrl"}return e}();t.GraphAutocomplete=o;var s=function(){function e(e,t){this.model=e,this.type=t}return e.prototype.isUser=function(){return"user"===this.type},e.prototype.isGroup=function(){return"group"===this.type},Object.defineProperty(e.prototype,"mail",{get:function(){return this.model.mail},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return this.model.displayName},enumerable:!0,configurable:!0}),e}();t.GraphAutocompleteModel=s,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.graphAutocomplete,new o)},function(e,t,i){"use strict";function r(e,t){var i=e.EmailLink.Content.Apple.Store+":%20"+t.mobileIosAppStoreUrlForEmail,r=e.EmailLink.Content.Google.Store+":%20"+t.mobileAndroidAppStoreUrlForEmail,n="%0A%0A"+i+"%0A%0A"+r,o=""+e.EmailLink.Content.Description+n;return"mailto:?subject="+e.EmailLink.Content.Subject+"&body="+o+"%0A%0A"}Object.defineProperty(t,"__esModule",{value:!0}),t.getEmailLink=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(65),o=i(1),s=function(){function e(e,t){var i=this;this.$scope=e,this.clientResources=t,this.dismissDropDown=function(){i.isDropdownOpen&&(i.isDropdownOpen=!1,document.removeEventListener("click",i.documentClickListener))},this.toggleDropDown=function(e){e&&(e.preventDefault(),i.currentElement=e.currentTarget.nextElementSibling,i.isDropdownOpen=!i.isDropdownOpen,i.documentClickListener=function(t){n.isParentOrElement(e.currentTarget,t.target)||i.$scope.$apply(function(){i.dismissDropDown()})},document.addEventListener("click",i.documentClickListener))},o.isEmpty(this.$scope.dropdownGlyph)&&(this.$scope.dropdownGlyph="glyph-ellipsis"),this.currentElement=null,this.isDropdownOpen=!1,this.$scope.$on("$destroy",function(){document.removeEventListener("click",i.documentClickListener)})}return e.prototype.getCommandText=function(e){return e.inProgress&&e.inProgressText?e.inProgressText:e.text},e.prototype.getButtonText=function(){return this.$scope.buttonText?this.$scope.buttonText:""},e.prototype.getButtonLabel=function(){return this.$scope.buttonText?this.$scope.buttonText:this.clientResources.ListCommands.More},e.prototype.isCommandDisabled=function(e){return e.disabled||e.inProgress},e.prototype.clickDropdownToggle=function(e){e.stopPropagation()},e.prototype.clickCommand=function(e,t){if(e.stopPropagation(),!this.isCommandDisabled(t)){var i=t.click();i&&i.finally&&(t.inProgress=!0,i.finally(function(){return t.inProgress=!1})),t.commands||this.dismissDropDown()}},e.$inject=[r.default.services.$scope,r.default.services.clientResources],e}();t.ListCommandDirectiveController=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(99);var r=i(0);t.swaggerUrlOverrideHeader="CustomApiSwaggerUrlRequest",angular.module(r.default.modules.processSimpleInterceptors).factory(r.default.interceptors.removeHeadersInterceptor,[r.default.services.url,function(e){return{request:function(i){var r=i&&i.url&&e.isNpsOriginUrl(i.url),n=i&&i.headers&&i.headers[t.swaggerUrlOverrideHeader];return(r||n)&&(i.headers={}),i}}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(0),o=i(1),s=2097152;!function(e){e[e.Invalid=0]="Invalid",e[e.Reading=1]="Reading",e[e.Complete=2]="Complete",e[e.Canceled=3]="Canceled"}(r=t.FileReadStatus||(t.FileReadStatus={}));var a=function(){function e(){this.status=r.Reading,this.content=null,this.startByte=0,this.endByte=0,this.progressPercent=0,this.errorMessage=null}return e}();t.FileReadResult=a;var l=function(){function e(e,t,i,r){this.$q=e,this.resources=t,this.file=i,this.resources=t;var n=$.extend({},r);this.startByte=0,this.fileName=i.name,this.chunkSize=n.chunkSize|s,this.encoding=n.encoding,this.reader=new FileReader}return e.prototype.readNextChunk=function(e){var t,i=this,n=this.$q.defer(),s=e|this.chunkSize,l=this.startByte+s;this.file.size>0?l>this.file.size&&(l=this.file.size):(t=this.getInvalidFileReadResult(o.format(this.resources.Services.FileReaderHelper.fileHasNoContentMessage,this.fileName)),n.reject(t)),this.reader.onload=function(e){var t=new a;i.file?(t.content=e.target.result,t.progressPercent=l/i.file.size,t.progressPercent>=1?(t.progressPercent=1,t.status=r.Complete):t.status=r.Reading,t.startByte=i.startByte,t.endByte=l,i.startByte=l):t=i.getInvalidFileReadResult(o.format(i.resources.Services.FileReaderHelper.fileReadAbortedMessage,i.fileName)),n.resolve(t)},this.reader.onerror=function(e){var t=i.getFileReadErrorMessage(e),r=i.getInvalidFileReadResult(t);n.resolve(r)};var c=this.file.slice(this.startByte,l,this.file.type);return this.reader.readAsArrayBuffer(c),n.promise},e.prototype.asText=function(){var e=this,t=this.$q.defer(),i=new FileReader;return i.readAsText(this.file),i.onloadend=function(){return t.resolve(i.result)},i.onerror=function(i){var r=e.getFileReadErrorMessage(i),n=e.getInvalidFileReadResult(r);t.reject(n)},t.promise},e.prototype.asJson=function(){return this.asText().then(function(e){return JSON.parse(e)})},e.prototype.asDataURL=function(){var e=this,t=this.$q.defer(),i=new FileReader;return i.readAsDataURL(this.file),i.onloadend=function(){return t.resolve(i.result)},i.onerror=function(i){var r=e.getFileReadErrorMessage(i),n=e.getInvalidFileReadResult(r);t.reject(n)},t.promise},e.prototype.dispose=function(){this.file&&(this.file=null)},e.prototype.getFileReadErrorMessage=function(e){var t;switch(e.target.error.code){case e.target.error.NOT_FOUND_ERR:t=o.format(this.resources.Services.FileReaderHelper.fileNotFoundMessage,this.fileName);break;case e.target.error.NOT_READABLE_ERR:t=o.format(this.resources.Services.FileReaderHelper.fileNotReadableMessage,this.fileName);break;case e.target.error.ABORT_ERR:t=o.format(this.resources.Services.FileReaderHelper.fileReadAbortedMessage,this.fileName);break;default:t=o.format(this.resources.Services.FileReaderHelper.fileReadErrorMessage,this.fileName)}return t},e.prototype.getInvalidFileReadResult=function(e){var t=new a;return t.status=r.Invalid,t.errorMessage=e,t},e}();t.FileReaderHelper=l,angular.module(n.default.modules.processSimpleServices).factory(n.default.services.fileReaderHelperService,[n.default.services.$q,n.default.services.clientResources,function(e,t){return function(i,r){return new l(e,t,i,r)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(1),s=i(37),a=i(1),l=i(39);t.TrialDialogType={billingAdmin:"DIALOG_BILLINGADMIN",blockedFeatureStartTrial:"DIALOG_BLOCKEDFEATURESTARTTRIAL",blockedFeatureUpgradeToPro:"DIALOG_BLOCKEDFEATUREUPGRADETOPRO",officePortalSignup:"DIALOG_OFFICEPORTALSIGNUP",recurrenceStartTrial:"DIALOG_RECURRENCESTARTTRIAL",recurrenceUpgradeToPro:"DIALOG_RECURRENCEUPGRADETOPRO",startFreeTrial:"DIALOG_STARTFREETRIAL",upgradeToPro:"DIALOG_UPGRADETOPRO",individualPurchaseNotSupported:"DIALOG_INDIVIDUALPURCHASENOTSUPPORTED",featureBlockedOnDeveloperEnvironment:"DIALOG_FEATUREBLOCKEDONDEVELOPERENVIRONMENT"};var c=function(){function e(e,t,i,r,n,o,s,a,l,c,u,p){var d=this;this.$q=e,this.$scope=t,this.$sce=i,this.appSettings=r,this.clientResources=n,this.loggingService=o,this.planService=s,this.plansClient=a,this.policiesService=l,this.sessionService=c,this.trialDialogService=u,this.urlService=p,this.isActionInProgress=!1,t.$watch(function(){return u.show},function(){d.trialDialogService.show&&d.trialDialogService.dialogType?d.openDialog(d.trialDialogService.dialogType):d.trialDialogService.show||(d.dialog=null)})}return e.prototype.createTrialAndSetAsCurrentPlan=function(e){var t=this,i=!1;return this.planService.startTrial(e).then(function(e){i=!0}).catch(function(e){t.loggingService.logError("TrialDialogCtrl.StartTrialFailed",e)}).then(function(){return i})},Object.defineProperty(e.prototype,"showDialog",{get:function(){return!!this.dialog},enumerable:!0,configurable:!0}),e.prototype.executeCallback=function(e){var t=this.trialDialogService.callback;t&&t(e)},e.prototype.openDialog=function(e){var i=this;switch(e){case t.TrialDialogType.billingAdmin:this.dialog=this.billingAdminDialog;break;case t.TrialDialogType.startFreeTrial:this.dialog=this.startFreeTrialDialog;break;case t.TrialDialogType.recurrenceStartTrial:this.dialog=this.recurrenceStartTrialDialog;break;case t.TrialDialogType.upgradeToPro:this.dialog=this.premiumRequiredDialog;break;case t.TrialDialogType.recurrenceUpgradeToPro:this.dialog=this.recurrencePremiumRequiredDialog;break;case t.TrialDialogType.blockedFeatureStartTrial:var r=this.startFreeTrialDialog;this.dialog=r;break;case t.TrialDialogType.individualPurchaseNotSupported:this.dialog=this.individualPurchaseNotSupportedDialog;break;case t.TrialDialogType.blockedFeatureUpgradeToPro:var n=this.premiumRequiredDialog;n.acceptButton.action=function(){i.hide(),i.redirectToFlows()},this.dialog=n;break;case t.TrialDialogType.featureBlockedOnDeveloperEnvironment:this.dialog=this.featureBlockedOnDeveloperEnvironmentDialog;break;case t.TrialDialogType.officePortalSignup:this.dialog=this.officePortalSignupDialog;break;default:this.dialog=null}},e.prototype.redirectToFlows=function(){window.location.assign(this.urlService.manageRoute())},e.prototype.hide=function(){this.dialog=null,this.trialDialogService.hide()},Object.defineProperty(e.prototype,"startFreeTrialDialog",{get:function(){var e=this;return{headerImage:n.default.flowLogoBlue,title:this.clientResources.TrialDialog.StartTrial.Title,content:this.getTextWithLink(this.clientResources.TrialDialog.StartTrial.Content+" {0}",this.urlService.pricingRoute(),this.clientResources.Common.LearnMore,!0,s.TelemetryEventNames.BillingDialogLearnMoreClicked),cancelButton:{text:this.clientResources.Common.Cancel,action:function(){e.hide(),e.executeCallback(!1)},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.StartFreeTrialDialogCancelClicked)},acceptButton:{text:this.clientResources.TrialDialog.StartTrial.Button.StartTrial,action:function(){e.createTrialAndSetAsCurrentPlan(e.appSettings.p2TrialPlanLicenseId).then(function(t){e.hide(),e.executeCallback(t)})},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.StartFreeTrialDialogStartTrialClicked)},footerText:this.getTextWithLink(this.clientResources.TrialDialog.StartTrial.TermsAndConditions.Text,this.urlService.termsRoute({locale:this.appSettings.locale}),this.clientResources.Common.TermsAndConditions,!0,s.TelemetryEventNames.BillingDialogTermAndConditionsClicked)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrenceStartTrialDialog",{get:function(){var e=this;return{headerImage:n.default.flowLogoBlue,title:this.clientResources.TrialDialog.StartTrial.Title,content:this.getTextWithLink(o.format(this.clientResources.TrialDialog.Recurrence.StartTrial.Content,l.recurrenceToMinutes(this.policiesService.getMaxFlowFrequencyInSeconds()))+" {0}",this.urlService.pricingRoute(),this.clientResources.Common.LearnMore,!0,s.TelemetryEventNames.BillingDialogLearnMoreClicked),cancelButton:{text:this.clientResources.Common.Cancel,action:function(){e.hide(),e.executeCallback(!1)},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.StartFreeTrialDialogCancelClicked)},acceptButton:{text:this.clientResources.TrialDialog.StartTrial.Button.StartTrial,action:function(){e.createTrialAndSetAsCurrentPlan(e.appSettings.p2TrialPlanLicenseId).then(function(t){e.hide(),e.executeCallback(t)})},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.StartFreeTrialDialogStartTrialClicked)},footerText:this.getTextWithLink(this.clientResources.TrialDialog.StartTrial.TermsAndConditions.Text,this.urlService.termsRoute({locale:this.appSettings.locale}),this.clientResources.Common.TermsAndConditions,!0,s.TelemetryEventNames.BillingDialogTermAndConditionsClicked)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"premiumRequiredDialog",{get:function(){var e=this,t='<a data-event-name="'+a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.BillingDialogRedirectToSignupClicked)+'"href="'+this.appSettings.signUpRedirectUrl+'">'+this.clientResources.Common.OrganizationAccount+"</a>",i='<a data-event-name="'+a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.BillingDialogSignInWithOrgClicked)+'" href="'+this.urlService.signoutRoute()+'">'+this.clientResources.Common.WorkOrSchoolAccount+"</a>";return{headerImage:n.default.flowLogoBlue,title:this.clientResources.TrialDialog.Premium.Title,content:this.$sce.trustAsHtml(o.format(this.clientResources.TrialDialog.Premium.Content,i,t)),acceptButton:{text:this.clientResources.Common.Ok,action:function(){e.executeCallback(!1),e.hide()},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.PremiumRequiredDialogOkClicked)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrencePremiumRequiredDialog",{get:function(){var e=this,t='<a data-event-name="'+a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.BillingDialogRedirectToSignupClicked)+'" href="'+this.appSettings.signUpRedirectUrl+'">'+this.clientResources.Common.OrganizationAccount+"</a>",i='<a data-event-name="'+a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.BillingDialogSignInWithOrgClicked)+'" href="'+this.urlService.signoutRoute()+'">'+this.clientResources.Common.WorkOrSchoolAccount+"</a>";return{headerImage:n.default.flowLogoBlue,title:this.clientResources.TrialDialog.Premium.Title,content:this.$sce.trustAsHtml(o.format(this.clientResources.TrialDialog.Recurrence.Premium.Content,l.recurrenceToMinutes(this.policiesService.getMaxFlowFrequencyInSeconds()),i,t)),acceptButton:{text:this.clientResources.Common.Ok,action:function(){e.executeCallback(!1),e.hide()},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.PremiumRequiredDialogOkClicked)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"billingAdminDialog",{get:function(){var e=this;return{headerImage:n.default.flowLogoBlue,title:this.clientResources.TrialDialog.UpgradeToPro.Title,content:this.clientResources.TrialDialog.UpgradeToPro.Content,cancelButton:{text:this.clientResources.TrialDialog.UpgradeToPro.Button.Me,action:function(){e.hide(),e.executeCallback(!1)},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.BillingAdminDialogJustMeClicked)},acceptButton:{text:this.clientResources.TrialDialog.UpgradeToPro.Button.Team,action:function(){e.executeCallback(!0),e.hide()},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.BillingAdminDialogForMyTeamClicked)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"individualPurchaseNotSupportedDialog",{get:function(){var e=this;return{headerImage:n.default.flowLogoBlue,title:this.clientResources.TrialDialog.IndividualPurchaseNotSupported.Title,content:this.clientResources.TrialDialog.IndividualPurchaseNotSupported.Content,acceptButton:{text:this.planService.isPlanTrial()?this.clientResources.Common.Ok:this.clientResources.TrialDialog.StartTrial.Button.StartTrial,action:function(){e.createTrialAndSetAsCurrentPlan(e.appSettings.p2TrialPlanLicenseId).then(function(t){e.hide(),e.executeCallback(t),window.location.reload()})},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.IndividualPurchaseNotSupportedStartTrialClicked)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"featureBlockedOnDeveloperEnvironmentDialog",{get:function(){var e=this;return{headerImage:n.default.flowLogoBlue,title:this.clientResources.TrialDialog.FeatureBlockedOnDeveloperEnvironment.Title,content:this.clientResources.TrialDialog.FeatureBlockedOnDeveloperEnvironment.Content,acceptButton:{text:this.clientResources.Common.Ok,action:function(){e.executeCallback(!1),e.hide()},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.FeatureBlockedOnDeveloperEnvironmentOKClicked)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"officePortalSignupDialog",{get:function(){var e=this;return{headerImage:n.default.flowLogoBlue,title:this.clientResources.TrialDialog.OfficePortalSignupRequired.Title,content:this.clientResources.TrialDialog.OfficePortalSignupRequired.Content,cancelButton:{text:this.clientResources.Common.Cancel,action:function(){e.hide(),e.executeCallback(!1)},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.TrialDialogOfficePortalSignupDismissed)},acceptButton:{text:this.clientResources.TrialDialog.OfficePortalSignupRequired.GetStarted,action:function(){e.hide(),e.executeCallback(!0)},eventName:a.getEnumValue(s.TelemetryEventNames,s.TelemetryEventNames.TrialDialogOfficePortalSignupClicked)}}},enumerable:!0,configurable:!0}),e.prototype.getTextWithLink=function(e,t,i,r,n){var l=r?"_blank":"_self",c='<a href="'+t+'" target="'+l+'" data-event-name="'+a.getEnumValue(s.TelemetryEventNames,n)+'">'+i+"</a>";return o.format(e,c)},e.$inject=[r.default.services.$q,r.default.services.$scope,r.default.services.$sce,r.default.services.appSettings,r.default.services.clientResources,r.default.services.logging,r.default.services.plan,r.default.services.plansClient,r.default.services.policies,r.default.services.session,r.default.services.trialDialog,r.default.services.url],e}();t.TrialDialogCtrl=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(54),n=i(3);!function(e){e[e.PopupClosed=0]="PopupClosed",e[e.PopupBlocked=1]="PopupBlocked",e[e.Timeout=2]="Timeout",e[e.InvalidLogin=3]="InvalidLogin"}(t.OAuthErrorType||(t.OAuthErrorType={}));var o=function(){function e(e,t,i,n,o){var s=this;this.appSettings=i,this.storageService=n,this.clientResources=o,this._popupWindow=e,this._popupId=t,this._loginPromise=new Promise(function(e,t){if(s._popupWindow){var i=0,a=0;s._timer=setInterval(function(){if(300===++i)t({name:"Error",message:o.Connection.Timeout}),clearInterval(s._timer);else if(s._popupWindow.closed){var l="ProcessSimpleOAuth"+s._popupId,c=n.getItem(l,r.StorageType.Cookie),u={},p=null;if(c){for(var d=void 0,g=/\+/g,m=/([^&=]+)=?([^&]*)/g,f=function(e){return decodeURIComponent(e.replace(g," "))};d=m.exec(c);)u[f(d[1])]=f(d[2]);p=u.pid}p||a>10?(clearInterval(s._timer),n.clearItem(l,r.StorageType.Cookie),p===s._popupId?e(u):t({name:"Error",message:o.Connection.BrowserIsClosed})):a++}},1e3)}else t({name:"Error",message:o.Connection.BrowserBlocked})})}return Object.defineProperty(e.prototype,"loginPromise",{get:function(){return this._loginPromise.then(function(e){if(e.error){var t=atob(e.error);return Promise.reject(new Error(n.sanitizeError(t)))}return Promise.resolve(e)}).catch(function(e){return Promise.reject(e)})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._popupWindow&&this._popupWindow.location.href},set:function(e){this._popupWindow.location.href=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closed",{get:function(){return this._popupWindow&&this._popupWindow.closed},enumerable:!0,configurable:!0}),e.prototype.close=function(){this._popupWindow&&(this._popupWindow.close(),this._timer&&(clearInterval(this._timer),this._timer=null))},e.prototype.getRedirectUrl=function(){return this.appSettings.siteOrigin+"/Content/static/AuthRedirect.html?pid="+this._popupId},e}();t.OAuthPopup=o;var s=function(){function e(e,t,i){this.appSettings=e,this.storageService=t,this.clientResources=i}return e.prototype.openLoginPopup=function(){var e=Date.now().toString(),t=window.open("/Content/static/Auth.html",e,"width=500, height=600");return new o(t,e,this.appSettings,this.storageService,this.clientResources)},e}();t.OAuthService=s},function(e,t,i){"use strict";function r(e,t){return o.getAppSettings().featureFlags.enableEnvironments?o.getAppSettings().processSimpleResourceProviderPath+"/environments/"+s.getCurrentEnvironmentName()+"/flows/"+e+"/triggers/"+t:o.getAppSettings().processSimpleResourceProviderPath+"/flows/"+e+"/triggers/"+t}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var n=i(0),o=i(9),s=i(20),a=i(14);t.FlowTriggersConstant={urlPath:o.getAppSettings().processSimpleResourceProviderPath+"/flows/:flowName/triggers",urlPathWithEnvironments:o.getAppSettings().processSimpleResourceProviderPath+"/environments/"+s.getCurrentEnvironmentName()+"/flows/:flowName/triggers",resourceType:o.getAppSettings().processSimpleResourceProviderPath+"/flows/triggers"},t.FlowTriggersPollFrequency={listFlowTriggers:6e4,getFlowTriggers:45e3,evictionDelay:3e5},t.getFlowTriggerId=r,angular.module(n.default.modules.processSimpleData).factory(n.default.services.flowTriggersClient,[n.default.services.azureResourceClientFactory,n.default.services.appSettings,n.default.services.environment,function(e,i,r){var n=i.featureFlags.enableEnvironments?t.FlowTriggersConstant.urlPathWithEnvironments:t.FlowTriggersConstant.urlPath,o={urlBase:a.ProcessSimpleResourceProviderManagementEndpoint,urlPath:t.FlowTriggersConstant.urlPath+"/:triggerName/run",name:"run",method:"POST",params:{flowName:"@flowName",triggerName:"@triggerName"}};return e({apiVersion:i.featureFlags.enableEnvironments?i.processSimpleResourceProviderApiVersionWithEnvironments:i.processSimpleResourceProviderApiVersion,urlPath:n,resourceType:t.FlowTriggersConstant.resourceType,rest:{get:{params:{flowName:"@flowName",id:"@id"}},query:{params:{flowName:"@flowName"}}},actions:[o],options:{atomize:!1,evictionDelay:t.FlowTriggersPollFrequency.evictionDelay}})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NpsConstants={CloseNpsDialog:"closeNpsDialog",DisplayPath:"/display/flow/",LanguageParam:"culture",PuidParam:"puid",ResizeNpsDialog:"thankyouNpsDialog",RenderPath:"/render/flow/",MessageEventType:"message",IFrameId:"npsFrame",ThankYouDialogClass:"thankyoudialog"}},function(e,t,i){"use strict";function r(e){return"/providers/Microsoft.BusinessAppPlatform/servicePlans/"+e}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var n=i(0);t.PlansClientConstants={resourceType:"Microsoft.BusinessAppPlatform/servicePlans"},t.getPlanId=r,t.planSkus={p1:"P1",p2:"P2"},angular.module(n.default.modules.processSimpleData).factory(n.default.services.plansClient,[n.default.services.appSettings,n.default.services.azureResourceClientFactory,n.default.services.url,function(e,i,r){var n={name:"createPlan",params:{},urlPath:r.servicePlansRoute()},o={name:"renewPlan",method:"POST",urlPath:"/servicePlans/:licenseId/renew/",params:{licenseId:"@licenseId"}},s={name:"refreshPlans",params:{},urlPath:r.refreshServicePlansRoute()};return i({urlBase:e.siteOrigin,urlPath:r.servicePlansRoute(),actions:[n,o,s],resourceType:t.PlansClientConstants.resourceType})}])},function(e,t,i){"use strict";function r(e){var i=e&&e.filter(function(e){return!e.roleDisabled&&(o.equalsIgnoreCase(e.roleTemplateId,t.GraphConstants.companyAdminRoleObjectId)||o.equalsIgnoreCase(e.roleTemplateId,t.GraphConstants.companyBillingAdministrator))});return i&&i.length>0}function n(e){return{id:e.objectId,displayName:e.displayName,email:e.mail,type:e.objectType}}Object.defineProperty(t,"__esModule",{value:!0});var o=i(8);t.GraphConstants={companyAdminRoleObjectId:"62e90394-69f5-4237-9190-012177145e10",companyBillingAdministrator:"b0f54661-2d74-4c50-afa3-1ec803f12efe"},t.canUserPurchaseForOthers=r,t.convertGraphObjToPrincipal=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.InlineAction=0]="InlineAction",e[e.InlineTrigger=1]="InlineTrigger",e[e.Definition=2]="Definition",e[e.Undefined=3]="Undefined"}(t.Mode||(t.Mode={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(16),n=i(72),o=i(1074),s=i(34),a=i(8),l=i(27),c=i(35),u=i(1),p=i(24),d=function(){function e(e){void 0===e&&(e={}),this.options=e}return e.prototype.convertToSwagger=function(e){var t=JSON.parse(e);return _.assign({},p.BaseSwagger,this.generateFromPostman(t))},e.prototype.generateFromPostman=function(e){var t=this,i={},r={},n={};return e.requests.forEach(function(e){0===Object.keys(n).length&&(n=t.createSecurityDefinitions(e));var r=o.getRequestUpdatedWithHostParameter(e),s=o.generateSwaggerPath(r),c={},p=r.method,d=t.createOperation(r);i[s]&&(c=i[s]),a.equalsIgnoreCase(p,l.Methods.get)&&u.isNullOrUndefined(c.get)?c.get=d:a.equalsIgnoreCase(p,l.Methods.delete)&&u.isNullOrUndefined(c.delete)?c.delete=d:a.equalsIgnoreCase(p,l.Methods.post)&&u.isNullOrUndefined(c.post)?c.post=d:a.equalsIgnoreCase(p,l.Methods.put)&&u.isNullOrUndefined(c.put)?c.put=d:a.equalsIgnoreCase(p,l.Methods.patch)&&u.isNullOrUndefined(c.patch)&&(c.patch=d),i[s]=c}),{swagger:"2.0",info:{version:"1.0.0",title:e.name,description:e.description||e.name},host:this.getHost(e),schemes:o.generateSchemes(e.requests.map(function(e){return e.url})),produces:["application/json"],paths:i,definitions:r,securityDefinitions:n}},e.prototype.createOperation=function(e){return{summary:e.name,description:e.description||e.name,operationId:u.getTitleCaseString(e.name),parameters:this.createOperationParameters(e),responses:this.createResponses(e)}},e.prototype.createOperationParameters=function(e){var t=[].concat(o.generateQueryParameters(e,{assignTestValue:this.options.assignTestValues}),o.generatePathParameters(e,{assignTestValue:this.options.assignTestValues}),o.generateHeaderParameters(e,{assignTestValue:this.options.assignTestValues})),i=o.generateBodyParameter(e,{assignTestValue:this.options.assignTestValues});return i&&t.push(i),t},e.prototype.createSecurityDefinitions=function(e){var t={},i=e.headers.split("\n").filter(function(e){return e.trim().length>0});return i&&i.length>0&&i.forEach(function(e){var i=o.parseHeader(e);if(i){var r=Object.keys(i)[0],s=i[n.AuthorizationHeaderName];if(r===n.AuthorizationHeaderName&&!u.isNullOrUndefined(s)){var l=s.trim().split(" ");if(l&&l.length>0){var c=l[0];a.equalsIgnoreCase(c,n.BasicAuthTokenType)?t[n.BasicAuthSecurityDefinitionName]={type:"basic"}:a.equalsIgnoreCase(c,n.OAuthTokenType)&&(t[n.OAuthSecurityDefinitionName]={type:"oauth2",authorizationUrl:"https://your.authorization.url/here",tokenUrl:"https://your.token.url/here",flow:"accessCode"})}}}}),t},e.prototype.createResponses=function(e){var t={};return!u.isNullOrUndefined(e.responses)&&e.responses.length>0?e.responses.forEach(function(e){var i=e.responseCode.code.toString();t[i]||(t[i]={description:i.toString(),schema:s.generateSchemaFromJson(e.text)})}):t[r.DefaultName]={description:r.DefaultName,schema:{type:"string"}},t},e.prototype.getHost=function(e){if(null!==e.requests){var t=e.requests[0].url;return c.parseUri(t).host}return""},e}();t.PostmanCollectionConverter=d},function(e,t,i){"use strict";function r(e){return o.isNullOrWhitespace(e)?new n.ClientError(n.ErrorCodes.customApiNameError,s.getClientResources().Manage.CustomConnector.DisplayName.Empty,null):/^[a-zA-Z0-9_\- ]*$/.test(e)?e.length>30?new n.ClientError(n.ErrorCodes.customApiNameError,o.format(s.getClientResources().Manage.CustomConnector.DisplayName.TooLong,30),null):null:new n.ClientError(n.ErrorCodes.customApiNameError,s.getClientResources().Manage.CustomConnector.DisplayName.InvalidCharacters,null)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(15),o=i(1),s=i(69);t.validateDisplayName=r},,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(230),i(254),i(255),i(256),i(257),i(258),i(260),i(261),i(147),i(415),i(422),i(423),i(424),i(425),i(426),i(427),i(428),i(429),i(430),i(431),i(432),i(433);var r=i(31),n=i(0),o=i(151),s=i(467),a=i(170),l=i(474),c=i(171),u=i(172),p=i(484),d=i(173),g=i(174),m=i(175),f=i(497),h=i(176),v=i(194),y=i(567),w=i(196),C=i(201),S=i(124),b=i(202),P=i(606),R=i(204),T=i(205),E=i(616),A=i(621);i(625),i(633),i(638),i(649),i(676),i(833),i(849),i(863),i(871),i(879),i(885),i(1009),i(1015),i(1021),i(1029),i(1041),i(1049),i(1148),i(1155),i(1161),i(1167);var D=angular.module(n.default.modules.processSimple,[n.default.modules.powerAppsDirectives,n.default.modules.ngFileUpload,n.default.modules.processSimpleComponents,n.default.modules.processSimpleData,n.default.modules.processSimpleDirectives,n.default.modules.processSimpleInterceptors,n.default.modules.processSimpleResources,n.default.modules.processSimpleServices]);D.config([n.default.providers.authenticationProvider,n.default.providers.$httpProvider,n.default.providers.$locationProvider,n.default.services.$provide,n.default.providers.routeProvider,n.default.services.appSettings,function(e,t,i,D,F,N){i.html5Mode(!0),N.featureFlags.enableNewFlowGettingStarted&&F.when(r.getNewFlowGettingStartedUrl(),new v.FlowNewGettingStarted),N.featureFlags.enableFlowCoauthoring&&F.when(r.getFlowOwnersUrl(),new y.FlowOwners).when(r.getListSharedFlowsUrl(),new b.Flows({isSharedFlows:!0})).when(r.getRunTeamFlowUrl(),new R.RunFlow).when(r.getViewSharedFlowUrl(),new h.Flow({isSharedFlow:!0})),F.when(r.getAvailableConnectionsUrl(),new s.Apis).when(r.getCustomConnectionsUrl(),new l.CustomApis).when(r.getListFlowsUrl(),new b.Flows).when(r.getExportFlowUrl(),new f.ExportFlow).when(r.getImportFlowUrl(),new P.ImportFlow).when(r.getNewFlowUrl(),new h.Flow).when(r.getNewConnectionUrl(),new m.CreateConnection).when(r.getRunFlowUrl(),new R.RunFlow).when(r.getRuntimeWidgetRunFlowUrl(),new T.RuntimeFlowWidget).when(r.getViewConnectionUrl(),new c.Connection).when(r.getViewFlowCheckUrl(),new w.FlowRun).when(r.getViewFlowUrl(),new h.Flow).when(r.getViewFlowRunsUrl(),new C.FlowRuns).when(r.getViewFlowRunUrl(),new w.FlowRun).otherwise(r.getListFlowsUrl()),N.featureFlags.usePowerAppsConnectionsWidget?F.when(r.getListConnectionsUrl(),new p.ConnectionsWidget):F.when(r.getListConnectionsUrl(),new u.Connections),N.featureFlags.enableFlowProperty&&F.when(r.getViewFlowPropertiesUrl(),new S.FlowProperties).when(r.getViewSharedFlowPropertiesUrl(),new S.FlowProperties({isSharedFlow:!0})).when(r.getAddRunOnlyUserUrl(),new S.FlowProperties({populateRunOnlyUser:!0})).when(r.getSharedAddRunOnlyUserUrl(),new S.FlowProperties({populateRunOnlyUser:!0})),N.featureFlags.showActivityFeed&&F.when(r.getActivitiesUrl(),new o.ActivityFeed),N.featureFlags.showApprovalCenter&&F.when(r.getApprovalRequestUrl(),new a.ApprovalCenter).when(r.getApprovalsReceivedUrl(),new a.ApprovalCenter).when(r.getApprovalUrl(),new a.ApprovalCenter).when(r.getApprovalsSentUrl(),new a.ApprovalCenter).when(r.getApprovalsHistoryUrl(),new a.ApprovalCenter),N.featureFlags.showManageGateways&&F.when(r.getViewGatewayUrl(),new g.Gateway).when(r.getListGatewaysUrl(),new d.Gateways),F.when(r.getNewCustomConnectorUrl(),new E.SwaggerEditor).when(r.getNewCustomConnectorGeneralUrl(),new E.SwaggerEditor).when(r.getNewCustomConnectorSecurityUrl(),new E.SwaggerEditor),F.when(r.getNewCustomConnectorDefinitionActionUrl(),new E.SwaggerEditor).when(r.getNewCustomConnectorDefinitionDefinitionUrl(),new E.SwaggerEditor).when(r.getNewCustomConnectorDefinitionInlineActionParameterUrl(),new E.SwaggerEditor).when(r.getNewCustomConnectorDefinitionInlineActionResponseUrl(),new E.SwaggerEditor).when(r.getNewCustomConnectorDefinitionParameterUrl(),new E.SwaggerEditor).when(r.getNewCustomConnectorDefinitionResponseUrl(),new E.SwaggerEditor).when(r.getNewCustomConnectorDefinitionUrl(),new E.SwaggerEditor),N.featureFlags.enableCustomApiTrigger&&F.when(r.getNewCustomConnectorDefinitionTriggerUrl(),new E.SwaggerEditor).when(r.getNewCustomConnectorDefinitionInlineTriggerParameterUrl(),new E.SwaggerEditor).when(r.getNewCustomConnectorDefinitionInlineTriggerResponseUrl(),new E.SwaggerEditor),N.featureFlags.enableEditCustomApi&&(F.when(r.getEditCustomConnectorUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorGeneralUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorSecurityUrl(),new E.SwaggerEditor),F.when(r.getEditCustomConnectorDefinitionActionUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorDefinitionDefinitionUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorDefinitionInlineActionParameterUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorDefinitionInlineActionResponseUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorDefinitionParameterUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorDefinitionResponseUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorDefinitionUrl(),new E.SwaggerEditor),N.featureFlags.enableCustomApiTrigger&&F.when(r.getEditCustomConnectorDefinitionTriggerUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorDefinitionInlineTriggerParameterUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorDefinitionInlineTriggerResponseUrl(),new E.SwaggerEditor)),N.featureFlags.enablePropertiesPaneCustomApi&&F.when(r.getDetailsCustomApiUrl(),new A.CustomApiPropertiesPane).when(r.getShareCustomApiUrl(),new A.CustomApiPropertiesPane),N.featureFlags.enableTestPaneCustomApi&&F.when(r.getNewCustomConnectorTestUrl(),new E.SwaggerEditor).when(r.getEditCustomConnectorTestUrl(),new E.SwaggerEditor);var I=(O={},O[N.processSimpleManagementUri]=N.authResource,O[N.azureResourceManagementUri]=N.authResource,O[N.powerAppsResourceProviderEndpoint]=N.authResource,O[N.aadGraphUrl]=N.aadGraphAuthResource,O);t&&t.interceptors&&(t.interceptors.push(n.default.interceptors.loggingInterceptor),t.interceptors.push(n.default.interceptors.localeInterceptor),t.interceptors.push(n.default.interceptors.consentInterceptor),t.interceptors.push(n.default.interceptors.removeHeadersInterceptor)),e.init({clientId:N.authClientId,anonymousEndpoints:[],endpoints:I},t),D.decorator("$exceptionHandler",["$log",n.default.services.logging,function(e,t){return function(i,r){t.logError("AngularAppUnhandledError",i,r),e.error.apply(e,arguments)}}]);var O}]),D.run([n.default.services.$rootScope,n.default.services.authentication,n.default.services.connectionsClient,n.default.services.logging,n.default.services.telemetry,n.default.services.url,function(e,t,i,r,n,o){o.isManagementPage()&&i.query(e)}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(231),i(251)},function(e,t,i){i(232),e.exports=i(73).Array.fill},function(e,t,i){var r=i(126);r(r.P,"Array",{fill:i(243)}),i(248)("fill")},function(e,t,i){var r=i(234),n=i(235),o=i(237),s=Object.defineProperty;t.f=i(102)?Object.defineProperty:function(e,t,i){if(r(e),t=o(t,!0),r(i),n)try{return s(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(e[t]=i.value),e}},function(e,t,i){var r=i(74);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,i){e.exports=!i(102)&&!i(127)(function(){return 7!=Object.defineProperty(i(236)("div"),"a",{get:function(){return 7}}).a})},function(e,t,i){var r=i(74),n=i(63).document,o=r(n)&&r(n.createElement);e.exports=function(e){return o?n.createElement(e):{}}},function(e,t,i){var r=i(74);e.exports=function(e,t){if(!r(e))return e;var i,n;if(t&&"function"==typeof(i=e.toString)&&!r(n=i.call(e)))return n;if("function"==typeof(i=e.valueOf)&&!r(n=i.call(e)))return n;if(!t&&"function"==typeof(i=e.toString)&&!r(n=i.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,i){var r=i(63),n=i(101),o=i(240),s=i(128)("src"),a=Function.toString,l=(""+a).split("toString");i(73).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,i,a){var c="function"==typeof i;c&&(o(i,"name")||n(i,"name",t)),e[t]!==i&&(c&&(o(i,s)||n(i,s,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=i:a?e[t]?e[t]=i:n(e,t,i):(delete e[t],n(e,t,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(e,t){var i={}.hasOwnProperty;e.exports=function(e,t){return i.call(e,t)}},function(e,t,i){var r=i(242);e.exports=function(e,t,i){if(r(e),void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,r){return e.call(t,i,r)};case 3:return function(i,r,n){return e.call(t,i,r,n)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,i){"use strict";var r=i(244),n=i(246),o=i(247);e.exports=function(e){for(var t=r(this),i=o(t.length),s=arguments.length,a=n(s>1?arguments[1]:void 0,i),l=s>2?arguments[2]:void 0,c=void 0===l?i:n(l,i);c>a;)t[a++]=e;return t}},function(e,t,i){var r=i(245);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,i){var r=i(129),n=Math.max,o=Math.min;e.exports=function(e,t){return e=r(e),e<0?n(e+t,0):o(e,t)}},function(e,t,i){var r=i(129),n=Math.min;e.exports=function(e){return e>0?n(r(e),9007199254740991):0}},function(e,t,i){var r=i(249)("unscopables"),n=Array.prototype;void 0==n[r]&&i(101)(n,r,{}),e.exports=function(e){n[r][e]=!0}},function(e,t,i){var r=i(250)("wks"),n=i(128),o=i(63).Symbol,s="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=s&&o[e]||(s?o:n)("Symbol."+e))}).store=r},function(e,t,i){var r=i(63),n=r["__core-js_shared__"]||(r["__core-js_shared__"]={});e.exports=function(e){return n[e]||(n[e]={})}},function(e,t,i){i(252),e.exports=i(73).Number.isInteger},function(e,t,i){var r=i(126);r(r.S,"Number",{isInteger:i(253)})},function(e,t,i){var r=i(74),n=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&n(e)===e}},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,i){i(259),angular.module("PowerApps.Directives").directive("svgSrc",["$http",function(e){return{restrict:"A",template:'<span class="svg-container"></span>',replace:!0,priority:99,link:function(t,i,r){function n(t){return e({method:"GET",url:t,headers:{"Content-Type":"application/xml"},cache:!0}).then(function(e){return e.data})}r.$observe("svgSrc",function(e){n(e).then(function(e){var t=angular.element(e);i.empty().append(t)})})}}}])},function(e,t){angular.module("PowerApps.Directives",["ngSanitize"])},function(e,t){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(130),i(9),i(287),i(288),i(289),i(290),i(291),i(317),i(319),i(14),i(321),i(336),i(337),i(338),i(340),i(399),i(408),i(412);var r=i(50),n=i(4),o=i(6),s=i(108),a=i(146);window.msflowportal={hostCommunicationService:r.HostCommunicationService.instance,loggingService:n.LoggingService.instance,telemetryService:o.TelemetryService.instance,optimizelyService:s.OptimizelyService.instance,cdnUrlHelper:a.CdnUrlHelper.instance}},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){!function(e){"use strict";function t(t){function i(t){t.preventDefault();var i=e(t.currentTarget).parents(".section"),r=i.find(".sd-playinsection-embed");i.find(".sd-playinsection-close").remove(),i.find(".sd-playinsection-mask").remove(),r.attr("src",""),setTimeout(function(){r.remove()},0),n&&n.dispose&&n.dispose()}function r(){a.append(f).append(h).append(o),h.css({marginLeft:d/2+"px"}),o.css({marginLeft:"-"+d/2+"px",position:"absolute"})}t.preventDefault();var n,o,s=e(t.currentTarget),a=e(s.parents(".section")[0]),l=a.offset().top,c=s.data("src"),u=s.data("player")||"default",p=a.outerHeight(),d=p*(16/9),g=e(window).outerWidth(),m="sd-playinsection-video-"+l,f=e("<div />",{class:"sd-playinsection-mask"}),h=e("<a />",{class:"sd-playinsection-close",href:"#"});d>g&&(d=g,p=d/(16/9)),"default"===u||"ch9"===u?(o=e("<iframe />",{id:m,class:"sd-playinsection-embed",allowFullScreen:!0,frameBorder:0,height:p,src:c+"#autoplay",width:d}),r()):"amp"===u&&(o=e("<video />",{id:m,class:"azuremediaplayer amp-default-skin sd-playinsection-embed"}),r(),n=amp(m,{nativeControlsForTouch:!1,autoplay:!0,controls:!0,width:d,height:p,logo:{enabled:!1},poster:""}),n.src([{src:c,type:"application/vnd.ms-sstr+xml"}])),h.on("click",i),f.on("click",i)}e("body").on("click.playinsection",".sd-playinsection",t)}(jQuery)},function(e,t){!function(e){"use strict";function t(t){var i=e(t.target).hasClass("toggler"),r=e(t.currentTarget),n=r.data("animation");if(i)switch(n){case"slide":r.find(".toggled").slideToggle(400);break;default:r.toggleClass("open")}}e(function(){e("body").on("click",".sd-toggle .toggler",function(e){e.preventDefault()}).on("click",".sd-toggle",t)})}(jQuery)},function(e,t){!function(e){"use strict";var t=function(e,t){var i;return function(){var r=arguments;clearTimeout(i),i=setTimeout(function(){e.apply(null,r)},t)}};e.sd=e.sd||{},e.sd.debounce=t}(window)},function(e,t){!function(e){"use strict";function t(e,t){for($(e).text(t);e&&!e.clientHeight;)e=$(e).parent()[0];for(;e&&!e.scrollHeight;)e=$(e).parent()[0];return!!e&&e.clientHeight<e.scrollHeight-1}function i(e,i){var r=0,n=i.length,o=Math.floor(n/2),s=i.slice(0,o),a=t(e,s+"…"),l=!a&&t(e,s+i[o]+"…");if(t(e,i)){for(;(a||!l)&&(a?(n=o,o=Math.floor(r+(n-r)/2)):l||(r=o,o=Math.floor(r+(n-r)/2)),s=i.slice(0,o),a=t(e,s+"…"),l=!a&&t(e,s+i[o]+"…"),!(n-r<=2)););$(e).text(s+"…").attr("title",i).data("truncate-full",i)}}function r(e,t){var r=$(t);i(t,r.data("truncate-full")||r.text())}$("body").on("update.truncatetext",".sd-truncateText",function(e){i(e.currentTarget,$(e.currentTarget).text())}),$(window).on("resize",e.debounce(function(){$(".sd-truncateText").each(r)},500)),$(".sd-truncateText").each(r)}(sd)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(292),i(297),i(302),i(311),i(312),i(315)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(293)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(294);i(295);var o=function(){function e(){this.controller=n.DeveloperEnvironmentBannerCtrl,this.template=i(296),this.controllerAs="developerEnvironmentBannerCtrl"}return e}();t.DeveloperEnvironmentBanner=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.developerEnvironmentBanner,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e,t,i){this.$scope=e,this.clientResources=t,this.environmentService=i}return Object.defineProperty(e.prototype,"isDeveloperEnvironment",{get:function(){return this.environmentService.isDevEnvironment()},enumerable:!0,configurable:!0}),e.$inject=[r.default.services.$scope,r.default.services.clientResources,r.default.services.environment],e}();t.DeveloperEnvironmentBannerCtrl=n},function(e,t){},function(e,t){e.exports='<section class="context-dev-env-section" ng-if="developerEnvironmentBannerCtrl.isDeveloperEnvironment"> <div class="row dev-env-banner-container"> <div class="column dev-env-banner"> <span class="c-glyph glyph-info"></span> {{developerEnvironmentBannerCtrl.clientResources.View.Header.Developer.Environment.Banner}} <a class="c-hyperlink" href="https://go.microsoft.com/fwlink/?linkid=848070">{{developerEnvironmentBannerCtrl.clientResources.Common.LearnMore}}</a> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(298)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(299);i(300);var o=function(){function e(){this.controller=n.DownloadMenuCtrl,this.template=i(301),this.controllerAs="downloadMenuCtrl"}return e}();t.DownloadMenu=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.downloadMenu,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(65),o=function(){function e(e,t,i,r){this.$element=e,this.$scope=t,this.appSettings=i,this.clientResources=r,this.expanded=!1,this.actionsId="download-menu-actions";var n=document.getElementById("header-download-button");n&&(this.$downloadMenuButton=angular.element(n),this.registerDownloadMenuComponent())}return e.prototype.registerDownloadMenuComponent=function(){var e=this;this.downloadMenuButtonOnClick=function(t){t.preventDefault(),e.$scope.$apply(function(){e.expanded=!e.expanded,e.$downloadMenuButton.attr({"aria-expanded":e.expanded}),e.expanded?(e.documentOnClick=function(t){var i=n.isParentOrElement(e.$element[0],t.target),r=n.isParentOrElement(e.$downloadMenuButton[0],t.target);i||r||e.$scope.$apply(function(){e.close()})},document.addEventListener("click",e.documentOnClick)):e.close()})},this.$downloadMenuButton.on("click",this.downloadMenuButtonOnClick),this.downloadMenuButtonOnKeypress=function(t){13===t.keyCode&&(e.$downloadMenuButton[0].click(),angular.element("#"+e.actionsId+" a")[0].focus())},this.$downloadMenuButton.keypress(this.downloadMenuButtonOnKeypress),this.$scope.$on("$destroy",function(){e.$downloadMenuButton.off("click",e.downloadMenuButtonOnClick),e.downloadMenuButtonOnClick=null,e.$downloadMenuButton.off("keypress",e.downloadMenuButtonOnKeypress),e.downloadMenuButtonOnKeypress=null,e.close()})},e.prototype.close=function(){this.documentOnClick&&(this.expanded=!1,this.$downloadMenuButton.attr({"aria-expanded":!1}),document.removeEventListener("click",this.documentOnClick),this.documentOnClick=null)},e.$inject=[r.default.services.$element,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources],e}();t.DownloadMenuCtrl=o},function(e,t){},function(e,t){e.exports='<div class="context-header-popup context-header-popup-menu" ng-if="downloadMenuCtrl.expanded"> <section class="actions" ng-attr-id="{{downloadMenuCtrl.actionsId}}"> <ul> <li><a class="c-heading-5 menu-content" ng-href="{{downloadMenuCtrl.appSettings.mobileDownloadPageLearnMoreLink}}" data-event-name="FooterDownloadMobileClicked" data-event-from="action-menu">{{downloadMenuCtrl.clientResources.View.Header.Mobile}}</a></li> <li><a class="c-heading-5 menu-content" ng-href="{{downloadMenuCtrl.appSettings.gatewayLearnUrl}}" data-event-name="FooterDownloadGatewayClicked">{{downloadMenuCtrl.clientResources.View.Header.Gateway}}</a></li> </ul> </section> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(303),i(307),i(309)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(304);i(305);var o=function(){function e(){this.controller=n.GearMenuCtrl,this.template=i(306),this.controllerAs="gearMenuCtrl"}return e}();t.GearMenu=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.gearMenu,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(1),o=i(137),s=function(){function e(e,t,i,r,o,s,a,l,c,u,p){var d=this;this.$document=e,this.$element=t,this.$scope=i,this.appSettings=r,this.clientResources=o,this.domHelperService=s,this.flowRunCountService=a,this.planService=l,this.policiesService=c,this.sessionService=u,this.urlService=p,this.isFlowRunFetchErrored=!1,this.expanded=!1,this.flowCounterContainerId="flow-count-bar-container",this.actionsId="gear-menu-actions";var g=document.getElementById("header-gear-menu");g&&(this.$gearMenuButton=angular.element(g),this.registerGearMenuComponent()),this.maxFlowRuns=this.policiesService.getMonthlyFlowRunAllotment(),this.flowRunsText=n.format(this.clientResources.FlowRuns.RunFormattingPlaceholder,this.maxFlowRuns),this.appSettings.featureFlags.enableBilling&&this.shouldShowFlowRunTracker&&this.flowRunCountService.getFlowRunCount().then(function(e){d.currentFlowRuns=e,d.flowRunsText=n.format(o.FlowRuns.RunFormatting,Math.min(d.currentFlowRuns,d.maxFlowRuns),d.maxFlowRuns)}).catch(function(){d.isFlowRunFetchErrored=!0})}return e.prototype.registerGearMenuComponent=function(){var e=this,t=function(){e.$gearMenuButton[0].click(),angular.element("#"+e.actionsId+" a")[0].focus()};this.domHelperService.registerOpenOnClick(this,this.$scope,"header-gear-menu",this.$element,t)},e.prototype.flowRunsSeverity=function(){var e=o.getFlowRunSeverity(this.currentFlowRuns,this.maxFlowRuns);return e===o.FlowRunSeverity.low?"low-severity":e===o.FlowRunSeverity.medium?"medium-severity":"high-severity"},e.prototype.getProgressBarProgress=function(){var e=document.getElementById(this.flowCounterContainerId),t=angular.element(e),i=Math.min(this.currentFlowRuns/this.maxFlowRuns,1),r=t.width()*i;return isNaN(r)&&(r=0),"translateX("+r+"px)"},Object.defineProperty(e.prototype,"shouldShowFlowRunTracker",{get:function(){return this.planService.isPlanFreeAndNotSeeded()&&!this.isFlowRunFetchErrored},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowAdminPortalLink",{get:function(){return!this.sessionService.isConsumerDomain},enumerable:!0,configurable:!0}),e.prototype.close=function(){this.expanded=!1},e.$inject=[r.default.services.$document,r.default.services.$element,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.domHelper,r.default.services.flowRunCount,r.default.services.plan,r.default.services.policies,r.default.services.session,r.default.services.url],e}();t.GearMenuCtrl=s},function(e,t){},function(e,t){e.exports='<div class="context-header-popup context-header-popup-gear-menu" ng-show="gearMenuCtrl.expanded"> <section class="runs gear-menu-content" ng-if="gearMenuCtrl.appSettings.featureFlags.enableBilling && gearMenuCtrl.shouldShowFlowRunTracker"> <h1 class="c-heading-5">{{gearMenuCtrl.clientResources.FlowRuns.Header}}</h1> <span class="run-usage-text c-paragraph-3">{{gearMenuCtrl.flowRunsText}}</span> <div class="flowrun-counter-wrap counter" ng-class="[gearMenuCtrl.flowRunsSeverity()]" ng-attr-id="{{gearMenuCtrl.flowCounterContainerId}}"> <div class="flowrun-counter-bar counter" ng-style="{\'transform\': gearMenuCtrl.getProgressBarProgress()}"></div> </div> </section> <section class="actions" ng-attr-id="{{gearMenuCtrl.actionsId}}"> <ul> <li><a class="c-heading-5 gear-menu-content" ng-href="{{gearMenuCtrl.urlService.manageRoute()}}" data-event-name="HeaderMyFlowsClicked" data-event-from="action-menu">{{gearMenuCtrl.clientResources.Header.Flows}}</a></li> <li><a class="c-heading-5 gear-menu-content" ng-href="{{gearMenuCtrl.urlService.manageRoute(gearMenuCtrl.urlService.connectionsRoute())}}" data-event-name="HeaderMyConnectionsClicked">{{gearMenuCtrl.clientResources.Header.Connections}}</a></li> <li ng-if="gearMenuCtrl.appSettings.featureFlags.showManageGateways"><a class="c-heading-5 gear-menu-content" ng-href="{{gearMenuCtrl.urlService.manageRoute(gearMenuCtrl.urlService.gatewaysRoute())}}" data-event-name="HeaderMyGatewaysClicked">{{gearMenuCtrl.clientResources.Header.Gateways}}</a></li> <li ng-if="gearMenuCtrl.appSettings.featureFlags.showCustomApisListPage"><a class="c-heading-5 gear-menu-content" ng-href="{{gearMenuCtrl.urlService.manageRoute(gearMenuCtrl.urlService.customApisRoute())}}" data-event-name="HeaderMyCustomApisClicked">{{gearMenuCtrl.clientResources.Header.CustomApis}}</a></li> <li ng-if="gearMenuCtrl.appSettings.featureFlags.enableUserPreferences"><a id="header-settings-button" class="c-heading-5 gear-menu-content" href="" data-event-name="HeaderSettingsClicked" ng-click="gearMenuCtrl.close()">{{gearMenuCtrl.clientResources.Header.Settings}}</a></li> <li ng-if="gearMenuCtrl.shouldShowAdminPortalLink"><a class="c-heading-5 gear-menu-content" ng-href="{{gearMenuCtrl.appSettings.adminPortalUrl}}" target="_blank" data-event-name="HeaderAdminPortalClicked">{{gearMenuCtrl.clientResources.Header.Admin}}</a></li> </ul> </section> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(308)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(21);var r=i(0),n=i(14);t.UserFlowAccountClientConstant={urlPath:"providers/Microsoft.ProcessSimple/users/me"},angular.module(r.default.modules.processSimpleData).factory(r.default.services.userFlowAccountClient,[r.default.services.azureResourceClientFactory,r.default.services.appSettings,function(e,i){var r={name:"getCurrentUserBillingUsageStatistics",method:"GET",params:{$expand:"billingUsageStatistics"},urlPath:t.UserFlowAccountClientConstant.urlPath},o={name:"getCurrentUserDetails",method:"GET",urlPath:t.UserFlowAccountClientConstant.urlPath};return e({urlBase:n.ProcessSimpleResourceProviderManagementEndpoint,urlPath:t.UserFlowAccountClientConstant.urlPath,apiVersion:i.processSimpleResourceProviderApiVersionWithEnvironments,actions:[o,r]})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(310)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t){var i=function(){function e(){this.$headerActionsMenuButton=$("#header-user-menu"),this.$headerActionsMenuButton.length&&(this.$headerActionsMenuContainer=this.$headerActionsMenuButton.parent())}return e.prototype.render=function(){this.$headerActionsMenuButton.length&&this.registerEventListeners()},e.prototype.registerEventListeners=function(){var e=this;this.$headerActionsMenuButton.on("click",function(t){e.toggle()})},e.prototype.hide=function(){this.$headerActionsMenuContainer.removeClass("show"),this.$headerActionsMenuButton.attr("aria-expanded","false"),this.documentOnClick&&(this.documentOnClick=null,document.removeEventListener("click",this.documentOnClick))},e.prototype.show=function(){var e=this;this.$headerActionsMenuContainer.addClass("show"),this.$headerActionsMenuButton.attr("aria-expanded","true"),this.documentOnClick=function(t){e.$headerActionsMenuButton[0].contains(t.target)||e.hide()},document.addEventListener("click",this.documentOnClick)},e.prototype.toggle=function(){"true"===this.$headerActionsMenuButton.attr("aria-expanded")?this.hide():this.show()},e}();$(function(){(new i).render()})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(313)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(314),o=function(){function e(){this.controller=n.HeaderAvatarImageCtrl,this.controllerAs="headerAvatarImageCtrl"}return e}();t.HeaderAvatarImage=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.headerAvatarImage,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(54),o={storageCacheId:"myavatar"},s=6e5,a=function(){function e(e,t,i,r,a){if(this.appsettings=e,this.graphService=t,this.loggingService=i,this.sessionService=r,this.storageCacheFactoryService=a,!this.appsettings.isWidgetPage&&!this.sessionService.isConsumerDomain){this.storageCache=this.storageCacheFactoryService.Create(o.storageCacheId,n.StorageType.SessionStorage,s);var l=document.getElementById("header-user-menu");l&&(this.$headerActionsMenuButton=angular.element(l),this.$headerAvatarImage=this.$headerActionsMenuButton.find("img"),this.replaceAvatarImage())}}return e.prototype.replaceAvatarImage=function(){var e=this,t=this.getImageFromCache();if(t){if("imageNotFound"===t)return;var i=t;this.updateImage(i)}else{var r=this.sessionService.getUserInfo().uniqueId;this.graphService.getThumbnailPhotos([r]).then(function(t){if(t.hasOwnProperty(r)){var i=t[r];e.updateImage(i),e.saveImageToCache(i,r)}else e.saveImageToCache("imageNotFound",r)}).catch(function(t){e.loggingService.logInfo("AvatarPictureCtrl.replaceAvatarImage",t)})}},e.prototype.updateImage=function(e){this.$headerAvatarImage.attr("src",e)},e.prototype.getImageFromCache=function(){var e=this.storageCache.get(o.storageCacheId);return e?e.imageSrc:null},e.prototype.saveImageToCache=function(e,t){var i=this.sessionService.getUserInfo(),r={imageSrc:e,userName:i.displayName,userUniqueId:i.uniqueId};this.storageCache.trySet(o.storageCacheId,r)},e.$inject=[r.default.services.appSettings,r.default.services.graph,r.default.services.logging,r.default.services.session,r.default.services.storageCacheFactory],e}();t.HeaderAvatarImageCtrl=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(65),n=i(316);$(function(){n.init({mainNavWrapper:".topnav-wrapper",mainNav:".nav-ul",navDropdownLabel:"...",navDropdownClassName:"categories-dropdown-content",navDropdownToggleClassName:"categories-dropdown-btn",navDropdownBreakpointLabel:"...",breakPoint:200});var e=$("#sort-dropdown-content");$(".sort-dropdown-btn").click(function(t){e.toggleClass("show"),e.attr("aria-expanded","true"===e.attr("aria-expanded")?"false":"true")}),$(".category_btn").click(function(e){$("#category_input").val(e.target.id||e.target.parentElement.id),$("#search_form").submit()}),window.onclick=function(t){if(!r.isParentOrElement($(".sort-dropdown-btn")[0],t.target)){var i=void 0;for(i=0;i<e.length;i++){var n=e[i];n.classList.contains("show")&&n.classList.remove("show")}e.attr("aria-expanded","false")}}})},function(e,t,i){var r,n;!function(o,s){r=s(o),void 0!==(n="function"==typeof r?r.call(t,i,t,e):r)&&(e.exports=n)}(window||this,function(e){"use strict";function t(e,t,i){var r;return function(){var n=this,o=arguments,s=function(){r=null,i||e.apply(n,o)},a=i&&!r;clearTimeout(r),r=setTimeout(s,t),a&&e.apply(n,o)}}var i,r,n,o,s,a,l,c,u={},p=[],d=!!document.querySelector&&!!e.addEventListener,g={},m=0,f=0,h=0,v={initClass:"js-priorityNav",mainNavWrapper:"nav",mainNav:"ul",navDropdownClassName:"nav__dropdown",navDropdownToggleClassName:"nav__dropdown-toggle",navDropdownLabel:"more",navDropdownBreakpointLabel:"menu",breakPoint:500,throttleDelay:50,offsetPixels:0,count:!0,moved:function(){},movedBack:function(){}},y=function(e,t,i){if("[object Object]"===Object.prototype.toString.call(e))for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(i,e[r],r,e);else for(var n=0,o=e.length;n<o;n++)t.call(i,e[n],n,e)},w=function(e,t){for(var i=t.charAt(0);e&&e!==document;e=e.parentNode)if("."===i){if(e.classList.contains(t.substr(1)))return e}else if("#"===i){if(e.id===t.substr(1))return e}else if("["===i&&e.hasAttribute(t.substr(1,t.length-2)))return e;return!1},C=function(e,t){var i={};return y(e,function(t,r){i[r]=e[r]}),y(t,function(e,r){i[r]=t[r]}),i},S=function(e,t){if(e.classList)e.classList.toggle(t);else{var i=e.className.split(" "),r=i.indexOf(t);r>=0?i.splice(r,1):i.push(t),e.className=i.join(" ")}},b=function(e,t){if(c=document.createElement("span"),s=document.createElement("ul"),a=document.createElement("button"),a.innerHTML=t.navDropdownLabel,a.setAttribute("aria-controls","menu"),a.setAttribute("type","button"),s.setAttribute("aria-hidden","true"),e.querySelector(o).parentNode!==e)return void console.warn("mainNav is not a direct child of mainNavWrapper, double check please");e.insertAfter(c,e.querySelector(o)),c.appendChild(a),c.appendChild(s),s.classList.add(t.navDropdownClassName),s.classList.add("priority-nav__dropdown"),a.classList.add(t.navDropdownToggleClassName),a.classList.add("priority-nav__dropdown-toggle"),c.classList.add(t.navDropdownClassName+"-wrapper"),c.classList.add("priority-nav__wrapper"),e.classList.add("priority-nav")},P=function(e){var t=window.getComputedStyle(e),i=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.clientWidth-i},R=function(){var e=document,t=window,i=e.compatMode&&"CSS1Compat"===e.compatMode?e.documentElement:e.body,r=i.clientWidth,n=i.clientHeight;return t.innerWidth&&r>t.innerWidth&&(r=t.innerWidth,n=t.innerHeight),{width:r,height:n}},T=function(e){r=P(e),l=e.querySelector(s).parentNode===e?e.querySelector(s).offsetWidth:0,n=F(e)+g.offsetPixels,h=R().width};u.doesItFit=function(e){var i=0===e.getAttribute("instance")?i:g.throttleDelay;m++,t(function(){var t=e.getAttribute("instance");for(T(e);r<=n&&e.querySelector(o).children.length>0||h<g.breakPoint&&e.querySelector(o).children.length>0;)u.toDropdown(e,t),T(e),h<g.breakPoint&&D(e,t,g.navDropdownBreakpointLabel);for(;r>=p[t][p[t].length-1]&&h>g.breakPoint;)u.toMenu(e,t),h>g.breakPoint&&D(e,t,g.navDropdownLabel);p[t].length<1&&(e.querySelector(s).classList.remove("show"),D(e,t,g.navDropdownLabel)),e.querySelector(o).children.length<1?(e.classList.add("is-empty"),D(e,t,g.navDropdownBreakpointLabel)):e.classList.remove("is-empty"),E(e,t)},i)()};var E=function(e,t){p[t].length<1?(e.querySelector(a).classList.add("priority-nav-is-hidden"),e.querySelector(a).classList.remove("priority-nav-is-visible"),e.classList.remove("priority-nav-has-dropdown"),e.querySelector(".priority-nav__wrapper").setAttribute("aria-haspopup","false")):(e.querySelector(a).classList.add("priority-nav-is-visible"),e.querySelector(a).classList.remove("priority-nav-is-hidden"),e.classList.add("priority-nav-has-dropdown"),e.querySelector(".priority-nav__wrapper").setAttribute("aria-haspopup","true"))},A=function(e,t){e.querySelector(a).setAttribute("priorityNav-count",p[t].length)},D=function(e,t,i){e.querySelector(a).innerHTML=i};u.toDropdown=function(e,t){e.querySelector(s).firstChild&&e.querySelector(o).children.length>0?e.querySelector(s).insertBefore(e.querySelector(o).lastElementChild,e.querySelector(s).firstChild):e.querySelector(o).children.length>0&&e.querySelector(s).appendChild(e.querySelector(o).lastElementChild),p[t].push(n),E(e,t),e.querySelector(o).children.length>0&&g.count&&A(e,t),g.moved()},u.toMenu=function(e,t){e.querySelector(s).children.length>0&&e.querySelector(o).appendChild(e.querySelector(s).firstElementChild),p[t].pop(),E(e,t),e.querySelector(o).children.length>0&&g.count&&A(e,t),g.movedBack()};var F=function(e){for(var t=e.childNodes,i=0,r=0;r<t.length;r++)3!==t[r].nodeType&&(isNaN(t[r].offsetWidth)||(i+=t[r].offsetWidth));return i},N=function(e,t){window.attachEvent?window.attachEvent("onresize",function(){u.doesItFit&&u.doesItFit(e)}):window.addEventListener&&window.addEventListener("resize",function(){u.doesItFit&&u.doesItFit(e)},!0),e.querySelector(a).addEventListener("click",function(){S(e.querySelector(s),"show"),S(this,"is-open"),S(e,"is-open"),-1!==e.className.indexOf("is-open")?e.querySelector(s).setAttribute("aria-hidden","false"):(e.querySelector(s).setAttribute("aria-hidden","true"),e.querySelector(s).blur())}),document.addEventListener("click",function(i){w(i.target,"."+t.navDropdownClassName)||i.target===e.querySelector(a)||(e.querySelector(s).classList.remove("show"),e.querySelector(a).classList.remove("is-open"),e.classList.remove("is-open"))}),document.onkeydown=function(e){e=e||window.event,27===e.keyCode&&(document.querySelector(s).classList.remove("show"),document.querySelector(a).classList.remove("is-open"),i.classList.remove("is-open"))}};Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var e=0,t=this.length;e<t;e++)this[e]&&this[e].parentElement&&this[e].parentElement.removeChild(this[e])},u.destroy=function(){g&&(document.documentElement.classList.remove(g.initClass),c.remove(),g=null,delete u.init,delete u.doesItFit)},d&&"undefined"!=typeof Node&&(Node.prototype.insertAfter=function(e,t){this.insertBefore(e,t.nextSibling)});var I=function(e){var t=e.charAt(0);return"."!==t&&"#"!==t};return u.init=function(e){if(g=C(v,e||{}),!d&&"undefined"==typeof Node)return void console.warn("This browser doesn't support priorityNav");if(!I(g.navDropdownClassName)||!I(g.navDropdownToggleClassName))return void console.warn("No symbols allowed in navDropdownClassName & navDropdownToggleClassName. These are not selectors.");var t=document.querySelectorAll(g.mainNavWrapper);y(t,function(e){return p[f]=[],e.setAttribute("instance",f++),(i=e)?(o=g.mainNav,e.querySelector(o)?(b(e,g),s="."+g.navDropdownClassName,e.querySelector(s)?(a="."+g.navDropdownToggleClassName,e.querySelector(a)?(N(e,g),void u.doesItFit(e)):void console.warn("couldn't find the specified navDropdownToggle element")):void console.warn("couldn't find the specified navDropdown element")):void console.warn("couldn't find the specified mainNav element")):void console.warn("couldn't find the specified mainNavWrapper element")}),m++,document.documentElement.classList.add(g.initClass)},u})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(318)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(54),n=i(9);!function(){function e(e){s.css("top",e),a.css("top",e),t(" .context-header-popup { top:"+e+"px; }")}function t(e){$("<div />",{html:"<style>"+e+"</style>"}).appendTo("body")}var i=new r.StorageService,o=$(".eula-cookie-banner"),s=$(".flow-c-header"),a=$(".header-container");o.length&&(o.show(),e(o.outerHeight())),$(".eula-close").click(function(){i.saveItem(n.getAppSettings().eulaConfirmCookieName,"1",r.StorageType.Cookie),$(".eula-cookie-banner").css({display:"none"}),e(0)}),$(window).resize(function(){e(o.outerHeight())})}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(320);$(function(){var e=$(".section-share .share-fb");e.click(function(t){t.preventDefault(),r.openPopup(e.attr("href"))});var t=$(".section-share .share-twitter");t.click(function(e){e.preventDefault(),r.openPopup(t.attr("href"))})})},function(e,t,i){"use strict";function r(e,t){t=$.extend({windowName:"Popup",width:500,height:500},t),window.open(e,t.windowName,"width="+t.width+",height="+t.height).focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.openPopup=r},function(e,t,i){"use strict";function r(){$(document).on("keydown",function(e){e.ctrlKey&&e.altKey&&65===e.which&&n()})}function n(){var e=$.extend(!0,{},window.sessionInfo),t=s.TelemetryService.instance,i=o.LoggingService.instance,r=a.generateGuid();e.userInfo&&e.userInfo.accessToken&&(delete e.userInfo.accessToken,delete e.userInfo.givenName,delete e.userInfo.familyName,delete e.userInfo.displayName);var n={browserUrl:location.href,diagnosticsId:r,session:e,settings:window.appSettings,timeStamp:(new Date).toString(),userAgent:window.navigator.userAgent};t.tagEvent(s.TelemetryEventNames.CtrlAltAPressed),i.logInfo("CtrlAltAPressed","Control Alt A pressed",n),l.openPlainTextWindow(null,JSON.stringify(n,null,4))}Object.defineProperty(t,"__esModule",{value:!0});var o=i(4),s=i(6),a=i(1),l=i(335);$(function(){r()})},function(e,t,i){"use strict";function r(e,t){return Math.random()*(t-e)*+e}Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomNumberInclusive=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(324);t.Analytics=r.Analytics},function(e,t,i){"use strict";function r(){}function n(){var e={};return window.location.search.substring(1).split("&").forEach(function(t){var i=t.split("=");2===i.length&&(e[encodeURIComponent(i[0])]=encodeURIComponent(i[1]))}),e}function o(){var e={},t=window.navigator;return e.browserName=t.appName,e.browserVersion=t.appVersion,e.browserArch=t.platform||t.cpuClass,e.osName="",e.osVersion="",e.osArch="",e.screenResolution=s(),e}function s(){var e="";if(screen.width||screen.height){e=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:"")}return e}function a(e){var t="";if(e.hasOwnProperty("toISOString"))t=e.toISOString();else{t=e.getUTCFullYear()+"-"+l(e.getUTCMonth()+1,2)+"-"+l(e.getUTCDate(),2)+"T"+l(e.getUTCHours(),2)+":"+l(e.getUTCMinutes(),2)+":"+l(e.getUTCSeconds(),2)+"."+l(e.getUTCMilliseconds(),3)+"Z"}return t}function l(e,t){for(var i=""+e,r=i.length,n=r;n<t;n++)i="0"+i;return i}function c(){return window.performance&&window.performance.navigation&&window.performance.timing?{timing:window.performance.timing,navigation:{type:window.performance.navigation.type,redirectCount:window.performance.navigation.redirectCount},entries:u()}:{}}function u(){var e={};if(window.performance&&window.performance.getEntriesByType){var t=window.performance.getEntriesByType("resource");e.totalResourceRequests=t.length,t.forEach(function(t){var i="total-"+t.initiatorType;e[i]=(e[i]||0)+1})}return e}Object.defineProperty(t,"__esModule",{value:!0});var p=i(325),d=i(326),g=i(327),m=i(76),f=i(1),h=console.time||r,v=console.timeEnd||r,y=r,w=r;window.performance&&window.performance.mark&&window.performance.measure&&(y=function(e){return window.performance.mark(e)},w=function(e,t,i){return window.performance.measure(e,t,i)});var C=function(){function e(e){var t=this;this._contextData={},this._publishTimer=null,this._profileStartDurations={},this._postEventsToServer=function(e,i){if(m.isNullOrUndefined(t._settings.analyticsServiceUri))return Promise.reject(new Error("AnalyticsServiceUri parameter should be provided when using default 'postEventsToServer' method"));var r={method:"POST",headers:{authorization:"Bearer "+e,accept:"application/json","content-type":"application/json","x-ms-client-request-id":f.generateGuid()},body:JSON.stringify({events:i})};return window.fetch(t._settings.analyticsServiceUri,r)},this._settings=m.assign({},{analyticsServiceUri:e.analyticsServiceUri,enableConsoleTrace:!1,flushBatchThreshold:20,flushBatchTimeout:2e4,maxServerThreshold:100,postEventsToServer:this._postEventsToServer,resolvePromise:this._resolvePromise,localStorageCapacity:500,localStorageKeyPrefix:"ms",useLocalStorage:!1,onLog:r},e),this._settings.useLocalStorage&&p.LocalStorageStore.IsLocalStorageStoreSupported?this._analyticsStore=new p.LocalStorageStore(this._settings):this._analyticsStore=new d.InMemoryStore,this._userAgent=o(),this._settings.getAccessToken||(this._settings.getAccessToken=function(){return t._settings.resolvePromise(null)})}return e.prototype._resolvePromise=function(e){return window.WinJS&&window.WinJS.Promise?window.WinJS.Promise.as(e):Promise.resolve(e)},e.prototype.getContext=function(){return{data:this._contextData,browserName:this._userAgent.browserName,browserVersion:this._userAgent.browserVersion,browserArch:this._userAgent.browserArch,screenResolution:s(),osName:this._userAgent.osName,osVersion:this._userAgent.osVersion,osArch:this._userAgent.osArch,href:window.location.href,query:n()}},e.prototype.setContextData=function(e){this._contextData=m.assign(this._contextData,e)},e.prototype.replaceContextData=function(e){this._contextData=e},e.prototype.performanceNow=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},e.prototype.logInfo=function(e,t,i,r,n,o){var s={code:"info",eventName:e,eventType:g.default.Trace,message:t};this._log(s,{},i,r,n,o)},e.prototype.logWarning=function(e,t,i,r,n,o){var s={code:"warning",eventName:e,eventType:g.default.Trace,message:t};this._log(s,{},i,r,n,o)},e.prototype.logError=function(e,t,i,r,n,o){var s={eventName:e,eventType:g.default.Error,message:"string"==typeof t?t:JSON.stringify(t)},a=t;void 0!==a.code&&(s.code=a.code),void 0!==a.stack&&(s.exception=a.stack);var l={};t.toJSON&&(l.error=t.toJSON()),this._log(s,l,i,r,n,o)},e.prototype.logHttpRequestStart=function(e,t,i,r,n,o,s,a){var l={eventName:e,eventType:g.default.Request,httpMethod:t,targetUri:i},c={request:"start"};void 0!==r&&(l.clientRequestId=r),r&&y("XHR:START:"+r+":"+t+":"+i),this._log(l,c,n,o,s,a)},e.prototype.logHttpRequestEnd=function(e,t,i,r,n,o,s,a,l,c){var u={contentLength:r.contentLength,durationInMilliseconds:Math.round(n),eventName:e,eventType:g.default.Request,httpMethod:t,httpStatusCode:r.status,targetUri:i},p={preciseDurationInMilliseconds:n,request:"end"};if(r.responseBodyOnError&&(p.responseBodyOnError=r.responseBodyOnError),void 0!==o&&(u.clientRequestId=o),r.serviceRequestId&&(u.serviceRequestId=r.serviceRequestId),r.hostName&&(u.hostName=r.hostName),r.apiVersion&&(u.apiVersion=r.apiVersion),o){var d=o+":"+t+":"+i;y("XHR:END:"+d),w("XHR:"+d,"XHR:START:"+d,"XHR:END:"+d)}this._log(u,p,s,a,l,c)},e.prototype.logNavigationPerformance=function(e){var t=this;if(window.addEventListener){var i=function(){t.trackEvent(e,c()),window.removeEventListener("load",i)};window.addEventListener("load",i)}},e.prototype.trackEvent=function(e,t,i,r,n){var o={eventName:e,eventType:g.default.Telemetry};this._log(o,{},t,i,r,n)},e.prototype.profileStart=function(e,t,i,r,n,o,s){var a=this,l={eventName:t,eventType:g.default.Telemetry},u={profile:"start"};if(void 0===r&&(r=this.performanceNow()),void 0===e&&(e=f.generateGuid()),this._settings.enableConsoleTrace&&h(t+" - "+e),this._profileStartDurations[e]=r,n=n||new Date,s&&window.addEventListener){var p=function(){u.performance=c(),a._log(l,u,i,e,n,o),window.removeEventListener("load",p)};window.addEventListener("load",p)}else this._log(l,u,i,e,n,o);return e},e.prototype.profileEnd=function(e,t,i,r,n,o){var s={eventName:t,eventType:g.default.Telemetry},a={profile:"end"};void 0===r&&(r=this.performanceNow()-this._profileStartDurations[e]),this._settings.enableConsoleTrace&&v(t+" - "+e),n=n||new Date,delete this._profileStartDurations[e],a.preciseDurationInMilliseconds=r,s.durationInMilliseconds=Math.round(r),this._log(s,a,i,e,n,o)},e.prototype.profile=function(e,t,i,r,n,o){var s={eventName:t,eventType:g.default.Telemetry,durationInMilliseconds:Math.round(r)},a={profile:"profile",preciseDurationInMilliseconds:r};this._log(s,a,i,e,n,o)},e.prototype.startPublish=function(){var e=this,t=this._analyticsStore.getCount();t>=this._settings.flushBatchThreshold&&(this._settings.enableConsoleTrace&&console.debug("Logging Batch: log entry threshold count reached ("+t+"/"+this._settings.flushBatchThreshold),this._submitEvents()),this._publishTimer||(this._publishTimer=setInterval(function(){e._submitEvents()},this._settings.flushBatchTimeout))},e.prototype.stopPublish=function(){this._publishTimer&&clearInterval(this._publishTimer)},e.prototype.flush=function(){return this._submitEvents()},e.prototype.dispose=function(){var e=this;this.flush().then(function(){return e.stopPublish()}).catch(function(){return e.stopPublish()})},e.prototype._log=function(e,t,i,r,n,o){e.eventTimestamp=a(n||new Date),t.context=m.assign({},this.getContext()),e.eventId=o||f.generateGuid(),void 0!==r&&(e.eventCorrelationId=r),void 0!==i&&(t.data=i),e.eventData=t,this._settings.enableConsoleTrace&&console.debug(e.eventName,JSON.stringify(e)),this._settings.onLog(e);try{this._analyticsStore.push([e])}catch(e){this._submitEvents(),console.error(e)}},e.prototype._submitEvents=function(){var e=this,t=[];try{t=this._analyticsStore.pop(this._settings.maxServerThreshold)}catch(e){console.error(e)}return t.length?this._settings.getAccessToken().then(function(i){return e._settings.postEventsToServer(i,t)}).then(function(i){i.ok||e._handleError(t,i)},function(i){e._handleError(t,i)}):this._settings.resolvePromise(null)},e.prototype._handleError=function(e,t){var i="Error posting the log events to the service.";if(t instanceof Error)i=i+" "+t;else{i=i+" Status: "+t.statusText}console.error("Analytics Error:",i);try{this._analyticsStore.push(e)}catch(e){this._submitEvents(),console.error(e)}},e}();t.Analytics=C},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),n=function(){function e(e){this.settings=e,this.localStorageCountKey=this.settings.localStorageKeyPrefix+"analyticscount",this.localStorageDataKey=this.settings.localStorageKeyPrefix+"analyticsdata";try{void 0===localStorage[this.localStorageCountKey]&&localStorage.setItem(this.localStorageCountKey,"0")}catch(e){console.log(e)}}return Object.defineProperty(e,"IsLocalStorageStoreSupported",{get:function(){return void 0!==window.localStorage},enumerable:!0,configurable:!0}),e.prototype.push=function(t){var i=this;t.forEach(function(t){if(!(i.getCount()<i.settings.localStorageCapacity))throw new Error(e.capacityError);localStorage.setItem(i.localStorageDataKey+r.generateGuid(),JSON.stringify(t)),i.updateCount(i.getCount()+1)})},e.prototype.pop=function(e){for(var t=[],i=[],r=0;r<localStorage.length;r++){var n=localStorage.key(r);if(0===n.indexOf(this.localStorageDataKey)){try{t.push(JSON.parse(localStorage[n]))}catch(e){console.log(e)}if(i.push(n),e===t.length)break}}return i.forEach(function(e){return localStorage.removeItem(e)}),t.length>0&&this.updateCount(this.getCount()-t.length),t},e.prototype.getCount=function(){return Number(localStorage[this.localStorageCountKey])||0},e.prototype.updateCount=function(e){localStorage[this.localStorageCountKey]=e.toString()},e.capacityError="No more capacity left",e}();t.LocalStorageStore=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.dataList=[]}return e.prototype.getCount=function(){return this.dataList.length},e.prototype.push=function(e){this.dataList.concat(e)},e.prototype.pop=function(e){return this.dataList.splice(0,e)},e}();t.InMemoryStore=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={Error:"Error",Request:"Request",Telemetry:"Telemetry",Trace:"Trace"}},function(e,t,i){"use strict";function r(e,t,i,r){return new s(e,t).format(i,r)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(22),o=i(42);t.formatDottedUrl=r;var s=function(){function e(e,t){this._dottedUrlTemplate=t,this._dottedUrlBase=e}return e.prototype.format=function(e,t){var i=this;e=e||{},t=t||{};var r={},s=this._dottedUrlTemplate.replace(/:(\w+?)(\W|$)/g,function(o,s,a){if(!e[s])return""+a;var l=e[s];return"string"==typeof l&&"@"===l[0]&&(l=i._lookupDottedPath(t||{},l)),n.isFunction(l)&&(l=l()),r[s]=l,l+a}),a={};o.forEach(e,function(e){r[e.key]||(a[e.key]=n.isFunction(e.value)?e.value():e.value)}),s=[this._dottedUrlBase,s].join("/"),s=s.split("://").map(function(e){return e.replace(/[\/]{2,}/g,"/")}).join("://"),s=this._encodeUri(s);var l=this._getQueryString(a);return l&&(s=s+(/\?/.test(s)?"&":"?")+l),s},e.prototype._lookupDottedPath=function(e,t){try{return""+(t||"").split(".").reduce(function(e,t){return e[t]},e)}catch(e){return""}},e.prototype._getQueryString=function(e){var t=this;return o.map(e,function(e){var i=t._camelCaseToHypens(e.key);return t._encodeQueryStringComponent(i)+"="+t._encodeQueryStringComponent(e.value)}).join("&")},e.prototype._camelCaseToHypens=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},e.prototype._encodeUri=function(e){return encodeURI(e).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+").replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")},e.prototype._encodeQueryStringComponent=function(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")},e}()},function(e,t,i){"use strict";function r(e,t){return e[t]}Object.defineProperty(t,"__esModule",{value:!0}),t.getEnumValue=r},function(e,t,i){"use strict";function r(e){return!(!e||"object"!=typeof e||e instanceof Date||e instanceof RegExp||Array.isArray(e))}Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=r},function(e,t,i){"use strict";function r(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.isObjectEmpty=r},function(e,t,i){"use strict";function r(e,t,i){var r=[];return n.forEach(e,function(e){var n=t.call(i,e);null!==n&&void 0!==n&&r.push(n)}),r}Object.defineProperty(t,"__esModule",{value:!0});var n=i(139);t.map=r},function(e,t,i){"use strict";function r(e){var t=document.createElement("a");t.href=e;var i=t.pathname||"";return o.startsWithIgnoreCase(i,"/")||(i="/"+i),{raw:e,protocol:t.protocol?t.protocol.replace(/:/g,""):"",host:t.host||"",hostname:t.hostname||"",port:t.port?Number(t.port):void 0,path:i,parameters:n.parseQueryString(t.search||""),hash:decodeURIComponent(t.hash||"")}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(68),o=i(41);t.parseUri=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);angular.module(r.default.modules.processSimpleResources,[])},function(e,t,i){"use strict";function r(e,t){var i=window.open("","_blank"),r=i.document.createElement("textarea");r.textContent=t,r.setAttribute("style","height:100%;width:100%;border-style:none;font-family:Consolas, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New"),i.document.body.appendChild(r)}Object.defineProperty(t,"__esModule",{value:!0}),t.openPlainTextWindow=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(4);window.onerror=function(e,t,i,n,o){var s={message:e,line:i,col:n,url:t};o?r.LoggingService.instance.logError("PublicAppUnhandledError",o,s):r.LoggingService.instance.logInfo("PublicAppUnhandledError",e,s)}},function(e,t,i){"use strict";function r(){c.TelemetryService.instance.tagEvent(c.TelemetryEventNames.PageLoad,{location:window.location.pathname,isAuthenticated:sessionInfo.isAuthenticated},{featureFlags:l.getAppSettings().featureFlags}),$("body").on("click","a",function(e){o($(e.currentTarget))}),$("body").on("click","button",function(e){o($(e.currentTarget))}),$("body").on("submit","form",function(e){s($(this))})}function n(e){var t=e.data("event-name");if(t){if(void 0===c.TelemetryEventNames[t])throw new Error('Event name "'+t+'" does not exist in TelemetryEventNames');return t}}function o(e){var t=n(e);if(t){var i=a(e);c.TelemetryService.instance.tagEvent(c.TelemetryEventNames[t],i)}}function s(e){var t=n(e);if(t){var i=e.find("input[type=search]")[0];if(i){var r=a(e);r[u]=i.value.trim(),c.TelemetryService.instance.tagEvent(c.TelemetryEventNames[t],r)}}}function a(e){var t={},i=e.data();return Object.keys(i).forEach(function(e){"eventName"!==e&&0===e.indexOf("event")&&(t[e.substring("event".length)]=i[e])}),t}Object.defineProperty(t,"__esModule",{value:!0});var l=i(9),c=i(6);$(function(){r()});var u="searchQuery"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(339),n=i(9);$(function(){var e=n.getAppSettings(),t=e.templatesListPageSize;e.isWidgetPage&&(t=e.widgetInfo.templatesSettings.pageSize),r.configurePaging(1,t,".template-list-show-more",".flow-template-list",".template-list-item")})},function(e,t,i){"use strict";function r(e,t,i,r,n){var o=$(i),s=$(r);o&&s&&o.click(function(i){i.preventDefault();var r=s.children(n),a=r.size();r&&a>e*t&&(r.slice(e*t,(1+e)*t).show(),window.location.hash="page"+(e+1),++e*t>=a&&o.hide())})}Object.defineProperty(t,"__esModule",{value:!0}),t.configurePaging=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(341),n=i(6);$(function(){var e=new r.SignUpComponent;e.configureSignUpAction(".sign-up-extended",$(".template-use-flow-button").attr("href"),"Template"),e.configureSignUpAction(".sign-up-footer","","HomePageBottom"),e.configureSignUpAction(".sign-up-header","","Header"),e.configureSignUpAction(".sign-up-redirect-to-msa","","RedirectToMsa"),e.configureSignUpAction(".sign-up-nav","","HeaderNav"),$(".template-use-flow-button").click(function(e){window.sessionInfo.isAuthenticated||(n.TelemetryService.instance.tagEvent(n.TelemetryEventNames.SignUpClicked,{Source:"Template"}),e.preventDefault(),$(".sign-up-extended").show())})})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(140),n=i(6),o=i(9),s=i(141),a=i(37),l=i(43);t.SignUpConstants={loadingCssClass:"sign-up-loading"};var c=function(){function e(){this.blockEmailDomainList=[".gov",".mil"]}return e.prototype.configureSignUpAction=function(e,t,i){var r=this,n=$(e+"-button"),o=$(e+"-email"),s=$(e+"-error"),c=$(e+"-form"),u=$(e+"-warning"),p=$(e+"-continue"),d=$(e+"-msa-try-again");n&&o&&n.click(function(e){r.sendMscomEvent(n,a.WedcsTelemetryNames.SignUpClick+"-"+i.toLowerCase()),s.text(""),e.preventDefault(),r.signUp(o,s,t,c,i,u,p,d)}),c&&o&&c.submit(function(e){s.text(""),e.preventDefault(),r.signUp(o,s,t,c,i,u,p,d)}),c&&p&&p.click(function(e){e.preventDefault();var n={consumerDomain:!0,nameSpaceType:l.UserType.MicrosoftAccount,login:l.UserType.MicrosoftAccount};r.redirectUserToLogin(n,t,i,o.val())}),d&&d.click(function(e){e.preventDefault(),e.stopPropagation(),r.clearAndFocusEmailInput(o,u,p,d)})},e.prototype.signUp=function(e,t,i,o,l,c,u,p){var d=this,g=$.trim(e.val());if(e.val(g),c.text(""),u.hide(),p&&p.hide(),!this.isValidEmailAddress(g))return n.TelemetryService.instance.tagEvent(n.TelemetryEventNames.SignUpEmailProvided,{type:"InvalidEmail"}),t.text(r.getScriptsResources().SignUp.Error.invalidEmail),void(""===g?this.sendMscomEvent(o,a.WedcsTelemetryNames.SignUpEmptyEmail):this.sendMscomEvent(o,a.WedcsTelemetryNames.SignUpInvalidEmail));this.showIsLoading(!0,o),this.sendEmailBasedWedcsTelemetry(g,o),$.get("/providers/Internal.User/users/"+g+"/getType").done(function(e){var t=s.getCookieGuid();if(e.consumerDomain){u&&u.length?(c.text(r.getScriptsResources().SignUp.Warning.PersonalEmailAddress),u.show(),p.show()):d.redirectUserToLogin(e,i,l,g)}else e.isViral&&e.accountExists?d.redirectUserToLogin(e,i,l):(n.TelemetryService.instance.tagEvent(n.TelemetryEventNames.SignUpEmailProvided,{type:"WorkDomain",subtype:"Unknown",source:l}),o[0].action&&t&&(o[0].action=o[0].action+"&pbi_source_id="+t),o[0].submit())}).fail(function(e){n.TelemetryService.instance.tagEvent(n.TelemetryEventNames.SignUpEmailProvided,{type:"ErrorValidatingEmail",source:l},{emailAddress:g,error:e}),t.text(r.getScriptsResources().SignUp.Error.tryAgain)}).done(function(){d.showIsLoading(!1,o)})},e.prototype.isValidEmailAddress=function(e){return/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i.test(e)},e.prototype.showIsLoading=function(e,i){i&&(e&&!i.hasClass(t.SignUpConstants.loadingCssClass)?i.addClass(t.SignUpConstants.loadingCssClass):!e&&i.hasClass(t.SignUpConstants.loadingCssClass)&&i.removeClass(t.SignUpConstants.loadingCssClass))},e.prototype.clearAndFocusEmailInput=function(e,t,i,r){t&&t.text(""),i&&i.hide(),r&&r.hide(),e.val(""),e.focus()},e.prototype.sendMscomEvent=function(e,t){s.sendMscomCustomEvent(e,t)},e.prototype.redirectUserToLogin=function(t,i,r,o){var s={type:t.consumerDomain?"ConsumerDomain":"WorkDomain",source:r,subtype:void 0};t.consumerDomain||(s.subtype="ViralExistingUserinViralTenant"),n.TelemetryService.instance.tagEvent(n.TelemetryEventNames.SignUpEmailProvided,s);var a="/"+e.appSettings.locale+"/signin/";o&&(a+="?"+e.appSettings.signUpEmailQueryString+"="+encodeURIComponent(o)),window.location.href=i||a},e.prototype.sendEmailBasedWedcsTelemetry=function(e,t){if(e.indexOf("@microsoft.com")>=0)this.sendMscomEvent(t,a.WedcsTelemetryNames.SignUpNavigateInternal);else{this.blockEmailDomainList.filter(function(t){var i=e.lastIndexOf(t);return i>=0&&i===e.length-t.length}).length>0?this.sendMscomEvent(t,a.WedcsTelemetryNames.SignUpBlockedEmail):this.sendMscomEvent(t,a.WedcsTelemetryNames.SignUpNavigateExternal)}},e.appSettings=o.getAppSettings(),e}();t.SignUpComponent=c},function(e,t,i){e.exports=i.p+"assets/activities-zero.669c70f85ef0e4c5026146ff9dad6b82.2.svg"},function(e,t,i){e.exports=i.p+"assets/add-person.496362b806b9197dc45739062030aa34.2.svg"},function(e,t,i){e.exports=i.p+"assets/alert-warning.50840723223e4f98e513a4f3e438af56.2.svg"},function(e,t,i){e.exports=i.p+"assets/back-arrow.f399d380e8bb970b57c59f99f41b61b8.2.svg"},function(e,t,i){e.exports=i.p+"assets/clock-gray.204931a86be326aeba76e113106f2b26.2.svg"},function(e,t,i){e.exports=i.p+"assets/clock-white.08b6c5dc91dfb15a29a8a3d53908fca5.2.svg"},function(e,t,i){e.exports=i.p+"assets/close-gray.7094716df7900cdb8d1ba30c911e2445.2.svg"},function(e,t,i){e.exports=i.p+"assets/close-blue.21ef8f67476070a14855071cc7288ad0.2.svg"},function(e,t,i){e.exports=i.p+"assets/confirmation-check.10d27bb2ae0ba7c03ddba8480f1f1d5c.2.svg"},function(e,t,i){e.exports=i.p+"assets/copy-clipboard.103f06cc3f70424224f56bec80b608d2.2.svg"},function(e,t,i){e.exports=i.p+"assets/consent.a0841f2d6aeba1f352673ef32d754aaa.2.svg"},function(e,t,i){e.exports=i.p+"assets/content-upload.c183790fcfa67d40ce8f40953de32b3e.2.svg"},function(e,t,i){e.exports=i.p+"assets/custom-api.5559c3131d502d7d3a45118e681345d7.2.svg"},function(e,t,i){e.exports=i.p+"assets/default-connection-icon.6296199fc1d74aa45ca68e1253762025.2.svg"},function(e,t,i){e.exports=i.p+"assets/default-swagger-icon.c2f47c1558ac4510dcea8a6ec2966baa.2.png"},function(e,t,i){e.exports=i.p+"assets/description.9a7f2d15b8e213ecaa7f01efd997aaac.2.svg"},function(e,t,i){e.exports=i.p+"assets/full-page-error-create-edit-flow.1f4c4764d945bb6b4c06a0af30d33501.2.svg"},function(e,t,i){e.exports=i.p+"assets/full-page-error-debug-flow.bc3bc5b94a6f0b6170973db2cbb176b5.2.svg"},function(e,t,i){e.exports=i.p+"assets/full-page-error-generic.5661f27a6363263a9212b10e054fc0c6.2.svg"},function(e,t,i){e.exports=i.p+"assets/full-page-error-list-flows.6e86ca0441b4791e2be1b736b5e138af.2.svg"},function(e,t,i){e.exports=i.p+"assets/ios-appstore.81e3c4f741d12c8cbdd9c0eebce380d6.2.svg"},function(e,t,i){e.exports=i.p+"assets/android-appstore.f9b203ff3fe5fb8c498f0ba29d95708d.2.svg"},function(e,t,i){e.exports=i.p+"assets/flow-new-getting-started.7d7aee2df39dd039c87f6a9a409d831f.2.svg"},function(e,t,i){e.exports=i.p+"assets/flow-light.89e5b3bc17253b929ca05b9f89cb901e.2.svg"},function(e,t,i){e.exports=i.p+"assets/flow-logo-blue.90e3ed6811f17c525cc05a8943586b71.2.svg"},function(e,t,i){e.exports=i.p+"assets/flow-placeholder.c99a3df8756e65c3592b33b3f1f75408.2.svg"},function(e,t,i){e.exports=i.p+"assets/flows-zero.5c048eaf139c9cc992bbf2a83ed0d58a.2.svg"},function(e,t,i){e.exports=i.p+"assets/flows-zero-runs.0c13f3573a6c5b5eb82e43584f223b64.2.svg"},function(e,t,i){e.exports=i.p+"assets/flows-zero-failures.64df27b169b925697dba6058a5c229b5.2.svg"},function(e,t,i){e.exports=i.p+"assets/onboarding.5c5992c16d240aff56e712b44d1030cc.2.svg"},function(e,t,i){e.exports=i.p+"assets/group.36b50edf288b3043789f9fbb53d0bdeb.2.svg"},function(e,t,i){e.exports=i.p+"assets/import.f61ef3d4e3368644389c64f294d457e8.2.svg"},function(e,t,i){e.exports=i.p+"assets/link-white.47199db61513cdf24ec2d84bacee9551.2.svg"},function(e,t,i){e.exports=i.p+"assets/notification-error.b221b13edb75170d2e9982740e90cbcf.2.svg"},function(e,t,i){e.exports=i.p+"assets/notifications-zero.cc2488f405f8239c0402efded9df7624.2.svg"},function(e,t,i){e.exports=i.p+"assets/template-tile-failed.de1014db3487be97310af04eaf4cda98.2.svg"},function(e,t,i){e.exports=i.p+"assets/template-tile-succeed.214dec53e32584317c547c2daccf3e39.2.svg"},function(e,t,i){e.exports=i.p+"assets/template-tile-succeed-mobile.11d46f1c4c71fd5d3a649cc323aff16f.2.svg"},function(e,t,i){e.exports=i.p+"assets/smiley-happy.cd1265a5642a6ce6963c0645b07eb1c8.2.svg"},function(e,t,i){e.exports=i.p+"assets/smiley-happy-fill.1c8837e48fe8cd838d0131140ac987fa.2.svg"},function(e,t,i){e.exports=i.p+"assets/smiley-sad.5f95ace3539b618c17c622649f7ebe39.2.svg"},function(e,t,i){e.exports=i.p+"assets/smiley-sad-fill.8580543c56215ecf9e5fb11108eb49c8.2.svg"},function(e,t,i){e.exports=i.p+"assets/status-error.909bc8c22a938df8aa79403b98de8c21.2.svg"},function(e,t,i){e.exports=i.p+"assets/status-info.32ee46c2cd7f0c966c0d2a6b69a8d1d6.2.svg"},function(e,t,i){e.exports=i.p+"assets/status-inprogress.5ec3f0f1882d2a386a562520e2ddb368.2.svg"},function(e,t,i){e.exports=i.p+"assets/status-success.12fc8a84776d2a79e253e14bc2df4ff0.2.svg"},function(e,t,i){e.exports=i.p+"assets/status-warning.b90fcd8d4125d266e8768264cfc9aac4.2.svg"},function(e,t,i){e.exports=i.p+"assets/submit-as-template.14f546ed40b7543b546a51ccece7fd43.2.svg"},function(e,t,i){e.exports=i.p+"assets/support.9bc28be5ad6c60789119f51a103d0a08.2.svg"},function(e,t,i){e.exports=i.p+"assets/template-new.7ad69f5632d7412c1868c49b6cd52a16.2.svg"},function(e,t,i){e.exports=i.p+"assets/timer-white.b475f272d8478a1185988fdcf9de1d65.2.svg"},function(e,t,i){e.exports=i.p+"assets/user-placeholder.74c1d29f89e002f0f69382a62bf884c9.2.svg"},function(e,t,i){e.exports=i.p+"assets/zero-approvals.6f3049b700790cc97b613e878921a477.2.svg"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(9),n=i(4),o=i(396),s=i(40);t.defaultRpcSignature="flow.microsoft.com";var a=function(){function e(e,i){var r=this;this.appSettings=e,this.loggingService=i,this.notifyCallback="NOTIFY",this.appSettings.isWidgetPage&&(this.rpcClient=new o.Rpc({signature:e.widgetInfo.widgetId||t.defaultRpcSignature,targetOrigin:"*",rpcMessageHandler:new o.WindowPostMessageRpcHandler({targetWindow:window.parent})}),this.rpcClient.register(this.notifyCallback,function(e){return new Promise(function(t,i){if(e&&e.data&&e.data.actionName){r.loggingService.logInfo("RPCService.RPCRegisterStart","RPC register starts for action name: "+e.data.actionName);try{r.onNotify&&t(r.onNotify(e.data.actionName,e.data.actionData))}catch(e){r.loggingService.logError("RPCService.InvokingHandleNotifyFailed",e),i(e)}}else r.loggingService.logError("RPCService.RPCRegisterIssue",new Error("Wrong parameters were used to register RPC")),i("Rpc client invocation failed due to invalid action name")})}),this.rpcClient.ack())}return Object.defineProperty(e,"instance",{get:function(){return e._instance.value},enumerable:!0,configurable:!0}),e.prototype.getErrorInfo=function(e){return{widgetInfo:this.appSettings.widgetInfo,callInfo:e.callInfo,data:e.data}},e.prototype.createRequestParam=function(){return{callInfo:{widgetId:this.appSettings.widgetInfo.widgetId}}},e.prototype.triggerHostEvent=function(e,t){var i=this;return new Promise(function(r,n){var o=i.createRequestParam();t&&(o.data=t),i.rpcClient.call(e,[o])})},e.prototype.getDataFromHostEvent=function(e,t){var i=this;return new Promise(function(r,n){var o=i.createRequestParam();t&&(o.data=t),i.rpcClient.call(e,[o]).then(function(e){r(e)}).catch(function(t){i.loggingService.logError("Event name: "+e,t,i.getErrorInfo(o)),n(t)})})},e._instance=new s.Lazy(function(){return new e(r.getAppSettings(),n.LoggingService.instance)}),e}();t.RpcService=a},function(e,t,i){var r;void 0!==(r=function(){return function(e){function t(r){if(i[r])return i[r].exports;var n=i[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){var r,n;r=[i,t,i(1),i(3)],void 0!==(n=function(e,t,i,r){"use strict";function n(){var e={};return e.promise=new Promise(function(t,i){e.resolve=t,e.reject=i}),e}Object.defineProperty(t,"__esModule",{value:!0});var o="__PING__",s=function(){function e(e){var t=this;if(this._deferredResponses={},this._rpcMethods={},this._ready=!1,this._queuedRequestMessages=[],this._onRpcMessageRecieved=function(e){if(e&&e.signature===t._rpcOptions.signature){var i=e;i.method?t._onRpcRequestMessageReceived(i):t._onRpcResponseMessageReceived(e)}},this._onRpcRequestMessageReceived=function(e){var i=t._rpcMethods[e.method];if(i){var r={signature:e.signature,id:e.id,error:null};try{var n=i.apply(t,e.params);t._rpcOptions.Promise.resolve(n).then(function(e){r.result=e,t._rpcOptions.rpcMessageHandler.postMessage(r,t._rpcOptions.targetOrigin)}).catch(function(e){r.error=t._serializeError(e),t._rpcOptions.rpcMessageHandler.postMessage(r,t._rpcOptions.targetOrigin)})}catch(e){r.error=t._serializeError(e),t._rpcOptions.rpcMessageHandler.postMessage(r,t._rpcOptions.targetOrigin)}}},this._onRpcResponseMessageReceived=function(e){var i=t._deferredResponses[e.id];i&&(e.error?i.reject(t._deserializeError(e.error)):i.resolve(e.result),delete t._deferredResponses[e.id])},!e)throw new Error("rpcOptions required");e.Promise||(e.Promise={defer:n,resolve:function(e){return Promise.resolve(e)},reject:function(e){return Promise.reject(e)}}),this._rpcOptions=e,this._rpcOptions.rpcMessageHandler.addListener(this._onRpcMessageRecieved),this.register(o,this._onPing)}return e.prototype.ack=function(){var e=this;return this.unregister(o),this.call(o).then(function(t){if("__PONG__"!==t)return Promise.reject(new Error("Invalid PONG message "+t));e._ready=!0,e._processQueue()}).catch(function(t){return e.register(o,e._onPing),console.error("PING failed to receive PONG message",t),Promise.reject(t)})},e.prototype.call=function(e,t){var i=r.default(),n={signature:this._rpcOptions.signature,id:i,method:this._normalizeMethodName(e),params:t},s=this._rpcOptions.Promise.defer();return this._deferredResponses[i]=s,this._ready||e===o?this._call(n):this._queuedRequestMessages.push(n),s.promise},e.prototype.register=function(e,t){var i=this._normalizeMethodName(e);if(this._rpcMethods[i])throw new Error("Rpc method with name '"+e+"' already registered.");this._rpcMethods[i]=t},e.prototype.unregister=function(e){var t=this._normalizeMethodName(e);if(!this._rpcMethods[t])throw new Error("Rpc method with name "+e+" failed to unregister. Method not found");delete this._rpcMethods[t]},e.prototype.dispose=function(){var e=this;this._rpcMethods={},Object.keys(this._deferredResponses).forEach(function(t){return e._deferredResponses[t].reject(new Error("rpc disposed"))}),this._deferredResponses={},this._rpcOptions.rpcMessageHandler.removeListener(this._onRpcMessageRecieved)},e.prototype._call=function(e){try{this._rpcOptions.rpcMessageHandler.postMessage(e,this._rpcOptions.targetOrigin)}catch(t){this._deferredResponses[e.id].reject(t),delete this._deferredResponses[e.id]}},e.prototype._onPing=function(){return this.unregister(o),this._ready=!0,this._processQueue(),"__PONG__"},e.prototype._processQueue=function(){var e=this;this._queuedRequestMessages.forEach(function(t){return e._call(t)}),this._queuedRequestMessages=[]},e.prototype._normalizeMethodName=function(e){return e.toUpperCase()},e.prototype._serializeError=function(e){if(e instanceof Error){var t={name:e.name,message:e.message,_stack:e.stack};return Object.keys(e).forEach(function(i){t[i]=e[i]}),{value:t}}return{value:e}},e.prototype._deserializeError=function(e){return new i.RpcException("ReceiverFailed","Receiver failed",i.convertToException(e.value))},e}();t.Rpc=s;var a=function(){function e(e){if(this._listeners={},!e)throw new Error("options required");if(!e.targetWindow)throw new Error("targetWindow required");e.sourceWindow=e.sourceWindow||window,e.messageSerializer=e.messageSerializer||function(e){return e},e.messageDeserializer=e.messageDeserializer||function(e){return e},this._options=e}return e.prototype.postMessage=function(e,t){this._options.targetWindow.postMessage(this._options.messageSerializer(e),t)},e.prototype.addListener=function(e){var t=this;this._listeners[e]&&console.error("duplicate rpc listener added"),this._listeners[e]=function(i){var r=t._options.messageDeserializer(i.data);r&&e(r.method?{signature:r.signature,id:r.id,method:r.method,params:r.params}:{signature:r.signature,id:r.id,result:r.result,error:r.error})},this._options.sourceWindow.addEventListener("message",this._listeners[e])},e.prototype.removeListener=function(e){this._options.sourceWindow.removeEventListener("message",this._listeners[e]),delete this._listeners[e]},e}();t.WindowPostMessageRpcHandler=a}.apply(t,r))&&(e.exports=n)},function(e,t,i){var r,n;r=[i,t,i(2)],void 0!==(n=function(e,t,i){"use strict";function r(e){return e instanceof Error||e.name&&e.message&&!e.hasOwnProperty("_stackTrace")?new n("ErrorException","Error",e.message,e):e.type&&e.code&&e.message&&e.hasOwnProperty("_stackTrace")?e:new o(e)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var o=r&&r instanceof Error?r:new Error(i);if(!e)throw new a("Type cannot be empty for exception");if(this._type=e,!t)throw new a("Code cannot be empty for exception");if(this._code=t,!i)throw new a("Message cannot be empty for exception");this._message=i,this._data=r,this._stackTrace=o.stack,this._innerException=n}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"code",{get:function(){return this._code},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stackTrace",{get:function(){return this._stackTrace},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"innerException",{get:function(){return this._innerException},enumerable:!0,configurable:!0}),e}();t.Exception=n;var o=function(e){function t(t){return e.call(this,"UnknownException","UnknownException","Unknown error.",t)||this}return i.__extends(t,e),t}(n);t.UnknownException=o;var s=function(e){function t(t,i,r){return void 0===r&&(r=null),e.call(this,"RpcException",t,i,null,r)||this}return i.__extends(t,e),t}(n);t.RpcException=s;var a=function(e){function t(t){return e.call(this,"ArgumentException","ArgumentException",t,null,null)||this}return i.__extends(t,e),t}(n);t.ArgumentException=a,t.convertToException=r}.apply(t,r))&&(e.exports=n)},function(e,t,i){var r,n;(function(i){/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0
	
	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.
	
	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */
var o,s,a,l,c,u,p,d,g,m,f,h,v,y,w,C;!function(o){function s(e,t){return function(i,r){return e[i]=t?t(i,r):r}}var a="object"==typeof i?i:"object"==typeof self?self:"object"==typeof this?this:{};r=[t],void 0!==(n=function(e){o(s(a,s(e)))}.apply(t,r))&&(e.exports=n)}(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};o=function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)},s=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},a=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&(i[r[n]]=e[r[n]]);return i},l=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},c=function(e,t){return function(i,r){t(i,r,e)}},u=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t,i,r){return new(i||(i=Promise))(function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},d=function(e,t){function i(e){return function(t){return r([e,t])}}function r(i){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(s=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],o=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},g=function(e,t){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])},m=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}},f=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},h=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e},v=function(e){return this instanceof v?(this.v=e,this):new v(e)},y=function(e,t,i){function r(e){u[e]&&(c[e]=function(t){return new Promise(function(i,r){p.push([e,t,i,r])>1||n(e,t)})})}function n(e,t){try{o(u[e](t))}catch(e){l(p[0][3],e)}}function o(e){e.value instanceof v?Promise.resolve(e.value.v).then(s,a):l(p[0][2],e)}function s(e){n("next",e)}function a(e){n("throw",e)}function l(e,t){e(t),p.shift(),p.length&&n(p[0][0],p[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c,u=i.apply(e,t||[]),p=[];return c={},r("next"),r("throw"),r("return"),c[Symbol.asyncIterator]=function(){return this},c},w=function(e){function t(t,n){e[t]&&(i[t]=function(i){return(r=!r)?{value:v(e[t](i)),done:"return"===t}:n?n(i):i})}var i,r;return i={},t("next"),t("throw",function(e){throw e}),t("return"),i[Symbol.iterator]=function(){return this},i},C=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof m?m(e):e[Symbol.iterator]()},e("__extends",o),e("__assign",s),e("__rest",a),e("__decorate",l),e("__param",c),e("__metadata",u),e("__awaiter",p),e("__generator",d),e("__exportStar",g),e("__values",m),e("__read",f),e("__spread",h),e("__await",v),e("__asyncGenerator",y),e("__asyncDelegator",w),e("__asyncValues",C)})}).call(t,function(){return this}())},function(e,t,i){var r,n;r=[i,t],void 0!==(n=function(e,t){"use strict";function i(){for(var e,t="",i=0;i<4;i++)e=4294967296*Math.random()|0,t+=r[15&e]+r[e>>4&15]+r[e>>8&15]+r[e>>12&15]+r[e>>16&15]+r[e>>20&15]+r[e>>24&15]+r[e>>28&15];var o=r[8+4*Math.random()|0];return t.substr(0,8)+n+t.substr(9,4)+n+"4"+t.substr(13,3)+n+o+t.substr(16,3)+n+t.substr(19,12)}Object.defineProperty(t,"__esModule",{value:!0});var r=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],n="-";t.default=i}.apply(t,r))&&(e.exports=n)}])}.call(t,i,t,e))&&(e.exports=r)},function(e,t,i){"use strict";function r(e){return new Promise(function(t,i){var r=a.getAppSettings();n(e).then(function(e){t(e&&e.consentTime&&(!r.featureFlags.enableConsentEmailOptions||e.serviceSettingsSelectionTime)?!0:!1)}).catch(function(e){i(e)})})}function n(e){var t=a.getAppSettings(),i=t.featureFlags.enableEnvironments?t.processSimpleResourceProviderApiVersionWithEnvironments:t.processSimpleResourceProviderApiVersion,r=s.format("{0}/listUserDetails?api-version={1}",t.processSimpleManagementUri,i);return new Promise(function(t,i){o.default({method:"POST",url:r,headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}).then(function(e){t(e)},function(e,t,r){l.LoggingService.instance.logError(c.ProfilingEventNames.userConsentDetailsRetrievalFailed,r),i(r)})})}Object.defineProperty(t,"__esModule",{value:!0});var o=i(109),s=i(1),a=i(9),l=i(4),c=i(29);t.getUserConsentedStatus=r,t.getUserConsentDetailsFromRP=n},function(e,t,i){"use strict";function r(e,t){var i=e.split("/"),r=i.indexOf("manage");return-1===r?e:i.slice(0,r).join("/")+"/"+i[r]+"/environments/"+t+"/"+i.slice(r+1).join("/")}Object.defineProperty(t,"__esModule",{value:!0}),t.addEnvironmentToUrl=r},function(e,t,i){i(400),$(function(){$.smartbanner&&$.smartbanner({title:"Power Automate (Microsoft Flow)",author:"Microsoft"})})},function(e,t,i){var r=i(401);"string"==typeof r&&(r=[[e.i,r,""]]);i(407)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,i){t=e.exports=i(402)(void 0),t.push([e.i,'#smartbanner{position:absolute;left:0;top:0;border-bottom:2px solid #e8e8e8;width:100%;height:80px;font-family:Helvetica Neue,sans-serif;background:#fff;z-index:9998;-webkit-font-smoothing:antialiased;overflow:hidden;-webkit-text-size-adjust:none;box-sizing:border-box}#smartbanner .sb-container{margin:0 auto}#smartbanner .sb-close{position:absolute;left:0;top:0;display:block;text-align:center;text-decoration:none;-webkit-font-smoothing:subpixel-antialiased;border:0;width:17px;height:100%;line-height:25px;color:#999!important;border-radius:0;background:none;box-shadow:none;text-shadow:none;font-size:25px;padding:2px 5px}#smartbanner .sb-close:active{color:#aaa}#smartbanner .sb-icon{position:absolute;left:30px;top:10px;display:block;width:55px;height:55px;background-size:cover}#smartbanner.no-icon .sb-icon{display:none}#smartbanner .sb-info{position:absolute;left:98px;top:18px;width:44%;font-size:12px;line-height:1.2em;color:#6a6a6a;text-shadow:0 1px 0 hsla(0,0%,100%,.8)}#smartbanner #smartbanner.no-icon .sb-info{left:34px}#smartbanner .sb-info strong{display:block;font-size:13px;color:#000;line-height:18px;font-weight:700}#smartbanner .sb-info>span{display:block}#smartbanner .sb-info em{font-style:normal;text-transform:uppercase}#smartbanner .sb-button{position:absolute;right:20px;top:24px;border:1px solid #bfbfbf;padding:0 10px;min-width:10%;height:24px;font-size:14px;line-height:24px;text-align:center;font-weight:700;color:#6a6a6a!important;background:#fff;text-transform:uppercase;text-decoration:none;text-shadow:0 1px 0 hsla(0,0%,100%,.8);border-radius:3px;box-shadow:0 1px 0 hsla(0,0%,100%,.6),inset 0 1px 0 hsla(0,0%,100%,.7)}#smartbanner .sb-icon.gloss:after{content:"";position:absolute;left:0;top:-1px;border-top:1px solid hsla(0,0%,100%,.8);width:100%;height:50%;background:-webkit-linear-gradient(top,hsla(0,0%,100%,.7),hsla(0,0%,100%,.2));border-radius:10px 10px 12px 12px}#smartbanner.ios .sb-icon{border-radius:9px}#smartbanner.ios .sb-close{color:#999!important;padding:7px}#smartbanner.ios .sb-button{background-color:#fff;color:#007aff!important;border:1px solid #007aff}#smartbanner.android{border-color:#ccc;border-top:5px solid #b3c833;border-bottom:2px solid #d6d6d6;background:#f5f5f5;box-shadow:none;font-family:Roboto,Arial,sans-serif;font-size:13px;font-weight:400;color:#8d8d8d}#smartbanner.android .sb-close{color:#999!important;padding:5px}#smartbanner.android .sb-close:active{color:#eee}#smartbanner.android .sb-info{text-shadow:none;font-weight:400}#smartbanner.android .sb-info strong{color:#333}#smartbanner.android .sb-info .sb-price{color:#b3c833}#smartbanner.android .sb-button{min-width:12%;border:2px solid transparent;padding:0;color:#fff!important;border-radius:2px;box-shadow:0 1px 0 rgba(0,0,0,.2);background:#b3c833}#smartbanner.android .sb-button span{display:block;padding:0 10px;text-transform:none;text-shadow:none}#smartbanner.android .sb-button:active,#smartbanner.android .sb-button:hover{box-shadow:0 1px 0 rgba(0,0,0,.4)}#smartbanner.android .sb-button:active span,#smartbanner.android .sb-button:hover span{box-shadow:0 1px 2px rgba(0,0,0,.05)}#smartbanner.windows{background:#464646;border-bottom:8px solid #2a2a2a;font-family:wf_SegoeUI,Segoe UI,Segoe,Segoe WP,Tahoma,Verdana,Arial,"sans-serif";font-size:14px;-webkit-font-smoothing:antialiased}#smartbanner.windows .sb-container{height:100%;box-sizing:border-box;border-bottom:1px solid #00bcf2}#smartbanner.windows .sb-icon{border-radius:0}#smartbanner.windows .sb-info{color:#fff;text-shadow:none;font-weight:400}#smartbanner.windows .sb-info strong{color:#00bcf2;text-shadow:0 0 2px #222}#smartbanner.windows .sb-info .sb-price{color:#00bcf2}#smartbanner.windows .sb-button{border-radius:0;background:#00bcf2;color:#fff!important;border:2px solid #00bcf2;box-shadow:none;text-shadow:none}#smartbanner.windows .sb-button:hover{border:2px solid rgba(0,0,0,.2)}#smartbanner.windows .sb-close{color:#999!important}#smartbanner.windows-phone{background:#464646;border-bottom:8px solid #2a2a2a;font-family:wf_SegoeUI,Segoe UI,Segoe,Segoe WP,Tahoma,Verdana,Arial,"sans-serif";font-size:14px;-webkit-font-smoothing:antialiased}#smartbanner.windows-phone .sb-container{height:100%;box-sizing:border-box;border-bottom:1px solid #9b4f96}#smartbanner.windows-phone .sb-icon{border-radius:0}#smartbanner.windows-phone .sb-info{color:#fff;text-shadow:none;font-weight:400}#smartbanner.windows-phone .sb-info strong{color:#9b4f96;text-shadow:0 0 2px #222}#smartbanner.windows-phone .sb-info .sb-price{color:#9b4f96}#smartbanner.windows-phone .sb-button{border-radius:0;background:#9b4f96;color:#fff!important;border:2px solid #9b4f96;box-shadow:none;text-shadow:none}#smartbanner.windows-phone .sb-button:hover{border:2px solid rgba(0,0,0,.2)}#smartbanner.windows-phone .sb-close{color:#999!important}',""])},function(e,t,i){(function(t){function i(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t){var o=r(n);return[i].concat(n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"})).concat([o]).join("\n")}return[i].join("\n")}function r(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+new t(JSON.stringify(e)).toString("base64")+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=i(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r}).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},n=0;n<this.length;n++){var o=this[n][0];"number"==typeof o&&(r[o]=!0)}for(n=0;n<e.length;n++){var s=e[n];"number"==typeof s[0]&&r[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),t.push(s))}},t}}).call(t,i(403).Buffer)},function(e,t,i){"use strict";(function(e){function r(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function n(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,i){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,i);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return s(this,e,t,i)}function s(e,t,i,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?d(e,t,i,r):"string"==typeof t?u(e,t,i):g(e,t)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t,i,r){return a(t),t<=0?n(e,t):void 0!==i?"string"==typeof r?n(e,t).fill(i,r):n(e,t).fill(i):n(e,t)}function c(e,t){if(a(t),e=n(e,t<0?0:0|m(t)),!o.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function u(e,t,i){if("string"==typeof i&&""!==i||(i="utf8"),!o.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,i);e=n(e,r);var s=e.write(t,i);return s!==r&&(e=e.slice(0,s)),e}function p(e,t){var i=t.length<0?0:0|m(t.length);e=n(e,i);for(var r=0;r<i;r+=1)e[r]=255&t[r];return e}function d(e,t,i,r){if(t.byteLength,i<0||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===i&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,i):new Uint8Array(t,i,r),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=p(e,t),e}function g(e,t){if(o.isBuffer(t)){var i=0|m(t.length);return e=n(e,i),0===e.length?e:(t.copy(e,0,0,i),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||Q(t.length)?n(e,0):p(e,t);if("Buffer"===t.type&&Z(t.data))return p(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function m(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function f(e){return+e!=e&&(e=0),o.alloc(+e)}function h(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return G(e).length;default:if(r)return H(e).length;t=(""+t).toLowerCase(),r=!0}}function v(e,t,i){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if(i>>>=0,t>>>=0,i<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,i);case"utf8":case"utf-8":return D(this,t,i);case"ascii":return N(this,t,i);case"latin1":case"binary":return I(this,t,i);case"base64":return A(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,i);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function w(e,t,i,r,n){if(0===e.length)return-1;if("string"==typeof i?(r=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=n?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(n)return-1;i=e.length-1}else if(i<0){if(!n)return-1;i=0}if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:C(e,t,i,r,n);if("number"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):C(e,[t],i,r,n);throw new TypeError("val must be string, number or Buffer")}function C(e,t,i,r,n){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,i/=2}var c;if(n){var u=-1;for(c=i;c<a;c++)if(o(e,c)===o(t,-1===u?0:c-u)){if(-1===u&&(u=c),c-u+1===l)return u*s}else-1!==u&&(c-=c-u),u=-1}else for(i+l>a&&(i=a-l),c=i;c>=0;c--){for(var p=!0,d=0;d<l;d++)if(o(e,c+d)!==o(t,d)){p=!1;break}if(p)return c}return-1}function S(e,t,i,r){i=Number(i)||0;var n=e.length-i;r?(r=Number(r))>n&&(r=n):r=n;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[i+s]=a}return s}function b(e,t,i,r){return K(H(t,e.length-i),e,i,r)}function P(e,t,i,r){return K(W(t),e,i,r)}function R(e,t,i,r){return P(e,t,i,r)}function T(e,t,i,r){return K(G(t),e,i,r)}function E(e,t,i,r){return K(z(t,e.length-i),e,i,r)}function A(e,t,i){return 0===t&&i===e.length?J.fromByteArray(e):J.fromByteArray(e.slice(t,i))}function D(e,t,i){i=Math.min(e.length,i);for(var r=[],n=t;n<i;){var o=e[n],s=null,a=o>239?4:o>223?3:o>191?2:1;if(n+a<=i){var l,c,u,p;switch(a){case 1:o<128&&(s=o);break;case 2:l=e[n+1],128==(192&l)&&(p=(31&o)<<6|63&l)>127&&(s=p);break;case 3:l=e[n+1],c=e[n+2],128==(192&l)&&128==(192&c)&&(p=(15&o)<<12|(63&l)<<6|63&c)>2047&&(p<55296||p>57343)&&(s=p);break;case 4:l=e[n+1],c=e[n+2],u=e[n+3],128==(192&l)&&128==(192&c)&&128==(192&u)&&(p=(15&o)<<18|(63&l)<<12|(63&c)<<6|63&u)>65535&&p<1114112&&(s=p)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),n+=a}return F(r)}function F(e){var t=e.length;if(t<=X)return String.fromCharCode.apply(String,e);for(var i="",r=0;r<t;)i+=String.fromCharCode.apply(String,e.slice(r,r+=X));return i}function N(e,t,i){var r="";i=Math.min(e.length,i);for(var n=t;n<i;++n)r+=String.fromCharCode(127&e[n]);return r}function I(e,t,i){var r="";i=Math.min(e.length,i);for(var n=t;n<i;++n)r+=String.fromCharCode(e[n]);return r}function O(e,t,i){var r=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>r)&&(i=r);for(var n="",o=t;o<i;++o)n+=V(e[o]);return n}function k(e,t,i){for(var r=e.slice(t,i),n="",o=0;o<r.length;o+=2)n+=String.fromCharCode(r[o]+256*r[o+1]);return n}function M(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,i,r,n,s){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(i+r>e.length)throw new RangeError("Index out of range")}function _(e,t,i,r){t<0&&(t=65535+t+1);for(var n=0,o=Math.min(e.length-i,2);n<o;++n)e[i+n]=(t&255<<8*(r?n:1-n))>>>8*(r?n:1-n)}function U(e,t,i,r){t<0&&(t=4294967295+t+1);for(var n=0,o=Math.min(e.length-i,4);n<o;++n)e[i+n]=t>>>8*(r?n:3-n)&255}function $(e,t,i,r,n,o){if(i+r>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function L(e,t,i,r,n){return n||$(e,t,i,4,3.4028234663852886e38,-3.4028234663852886e38),Y.write(e,t,i,r,23,4),i+4}function j(e,t,i,r,n){return n||$(e,t,i,8,1.7976931348623157e308,-1.7976931348623157e308),Y.write(e,t,i,r,52,8),i+8}function q(e){if(e=B(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function B(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){t=t||1/0;for(var i,r=e.length,n=null,o=[],s=0;s<r;++s){if((i=e.charCodeAt(s))>55295&&i<57344){if(!n){if(i>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}n=i;continue}if(i<56320){(t-=3)>-1&&o.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&(t-=3)>-1&&o.push(239,191,189);if(n=null,i<128){if((t-=1)<0)break;o.push(i)}else if(i<2048){if((t-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function W(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}function z(e,t){for(var i,r,n,o=[],s=0;s<e.length&&!((t-=2)<0);++s)i=e.charCodeAt(s),r=i>>8,n=i%256,o.push(n),o.push(r);return o}function G(e){return J.toByteArray(q(e))}function K(e,t,i,r){for(var n=0;n<r&&!(n+i>=t.length||n>=e.length);++n)t[n+i]=e[n];return n}function Q(e){return e!==e}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var J=i(404),Y=i(405),Z=i(406);t.Buffer=o,t.SlowBuffer=f,t.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,i){return s(null,e,t,i)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,i){return l(null,e,t,i)},o.allocUnsafe=function(e){return c(null,e)},o.allocUnsafeSlow=function(e){return c(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,r=t.length,n=0,s=Math.min(i,r);n<s;++n)if(e[n]!==t[n]){i=e[n],r=t[n];break}return i<r?-1:r<i?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var r=o.allocUnsafe(t),n=0;for(i=0;i<e.length;++i){var s=e[i];if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,n),n+=s.length}return r},o.byteLength=h,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?D(this,0,e):v.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,i,r,n){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),t<0||i>e.length||r<0||n>this.length)throw new RangeError("out of range index");if(r>=n&&t>=i)return 0;if(r>=n)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,r>>>=0,n>>>=0,this===e)return 0;for(var s=n-r,a=i-t,l=Math.min(s,a),c=this.slice(r,n),u=e.slice(t,i),p=0;p<l;++p)if(c[p]!==u[p]){s=c[p],a=u[p];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},o.prototype.indexOf=function(e,t,i){return w(this,e,t,i,!0)},o.prototype.lastIndexOf=function(e,t,i){return w(this,e,t,i,!1)},o.prototype.write=function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===r&&(r="utf8")):(r=i,i=void 0)}var n=this.length-t;if((void 0===i||i>n)&&(i=n),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return S(this,e,t,i);case"utf8":case"utf-8":return b(this,e,t,i);case"ascii":return P(this,e,t,i);case"latin1":case"binary":return R(this,e,t,i);case"base64":return T(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var X=4096;o.prototype.slice=function(e,t){var i=this.length;e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);var r;if(o.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=o.prototype;else{var n=t-e;r=new o(n,void 0);for(var s=0;s<n;++s)r[s]=this[s+e]}return r},o.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||M(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return r},o.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||M(e,t,this.length);for(var r=this[e+--t],n=1;t>0&&(n*=256);)r+=this[e+--t]*n;return r},o.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||M(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return n*=128,r>=n&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||M(e,t,this.length);for(var r=t,n=1,o=this[e+--r];r>0&&(n*=256);)o+=this[e+--r]*n;return n*=128,o>=n&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},o.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},o.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),Y.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),Y.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),Y.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),Y.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,i,r){if(e=+e,t|=0,i|=0,!r){x(this,e,t,i,Math.pow(2,8*i)-1,0)}var n=1,o=0;for(this[t]=255&e;++o<i&&(n*=256);)this[t+o]=e/n&255;return t+i},o.prototype.writeUIntBE=function(e,t,i,r){if(e=+e,t|=0,i|=0,!r){x(this,e,t,i,Math.pow(2,8*i)-1,0)}var n=i-1,o=1;for(this[t+n]=255&e;--n>=0&&(o*=256);)this[t+n]=e/o&255;return t+i},o.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||x(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||x(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):_(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||x(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):_(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||x(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):U(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||x(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,i,r){if(e=+e,t|=0,!r){var n=Math.pow(2,8*i-1);x(this,e,t,i,n-1,-n)}var o=0,s=1,a=0;for(this[t]=255&e;++o<i&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+i},o.prototype.writeIntBE=function(e,t,i,r){if(e=+e,t|=0,!r){var n=Math.pow(2,8*i-1);x(this,e,t,i,n-1,-n)}var o=i-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+i},o.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||x(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||x(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):_(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||x(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):_(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||x(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):U(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,i){return L(this,e,t,!0,i)},o.prototype.writeFloatBE=function(e,t,i){return L(this,e,t,!1,i)},o.prototype.writeDoubleLE=function(e,t,i){return j(this,e,t,!0,i)},o.prototype.writeDoubleBE=function(e,t,i){return j(this,e,t,!1,i)},o.prototype.copy=function(e,t,i,r){if(i||(i=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<i&&(r=i),r===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);var n,s=r-i;if(this===e&&i<t&&t<r)for(n=s-1;n>=0;--n)e[n+t]=this[n+i];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(n=0;n<s;++n)e[n+t]=this[n+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+s),t);return s},o.prototype.fill=function(e,t,i,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0);var s;if("number"==typeof e)for(s=t;s<i;++s)this[s]=e;else{var a=o.isBuffer(e)?e:H(new o(e,r).toString()),l=a.length;for(s=0;s<i-t;++s)this[s+t]=a[s%l]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,i(75))},function(e,t,i){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function n(e){return 3*e.length/4-r(e)}function o(e){var t,i,n,o,s,a=e.length;o=r(e),s=new p(3*a/4-o),i=o>0?a-4:a;var l=0;for(t=0;t<i;t+=4)n=u[e.charCodeAt(t)]<<18|u[e.charCodeAt(t+1)]<<12|u[e.charCodeAt(t+2)]<<6|u[e.charCodeAt(t+3)],s[l++]=n>>16&255,s[l++]=n>>8&255,s[l++]=255&n;return 2===o?(n=u[e.charCodeAt(t)]<<2|u[e.charCodeAt(t+1)]>>4,s[l++]=255&n):1===o&&(n=u[e.charCodeAt(t)]<<10|u[e.charCodeAt(t+1)]<<4|u[e.charCodeAt(t+2)]>>2,s[l++]=n>>8&255,s[l++]=255&n),s}function s(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function a(e,t,i){for(var r,n=[],o=t;o<i;o+=3)r=(e[o]<<16)+(e[o+1]<<8)+e[o+2],n.push(s(r));return n.join("")}function l(e){for(var t,i=e.length,r=i%3,n="",o=[],s=0,l=i-r;s<l;s+=16383)o.push(a(e,s,s+16383>l?l:s+16383));return 1===r?(t=e[i-1],n+=c[t>>2],n+=c[t<<4&63],n+="=="):2===r&&(t=(e[i-2]<<8)+e[i-1],n+=c[t>>10],n+=c[t>>4&63],n+=c[t<<2&63],n+="="),o.push(n),o.join("")}t.byteLength=n,t.toByteArray=o,t.fromByteArray=l;for(var c=[],u=[],p="undefined"!=typeof Uint8Array?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0,m=d.length;g<m;++g)c[g]=d[g],u[d.charCodeAt(g)]=g;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,i,r,n){var o,s,a=8*n-r-1,l=(1<<a)-1,c=l>>1,u=-7,p=i?n-1:0,d=i?-1:1,g=e[t+p];for(p+=d,o=g&(1<<-u)-1,g>>=-u,u+=a;u>0;o=256*o+e[t+p],p+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+e[t+p],p+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(g?-1:1);s+=Math.pow(2,r),o-=c}return(g?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,i,r,n,o){var s,a,l,c=8*o-n-1,u=(1<<c)-1,p=u>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:o-1,m=r?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),t+=s+p>=1?d/l:d*Math.pow(2,1-p),t*l>=2&&(s++,l/=2),s+p>=u?(a=0,s=u):s+p>=1?(a=(t*l-1)*Math.pow(2,n),s+=p):(a=t*Math.pow(2,p-1)*Math.pow(2,n),s=0));n>=8;e[i+g]=255&a,g+=m,a/=256,n-=8);for(s=s<<n|a,c+=n;c>0;e[i+g]=255&s,g+=m,s/=256,c-=8);e[i+g-m]|=128*f}},function(e,t){var i={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},function(e,t){function i(e,t){for(var i=0;i<e.length;i++){var r=e[i],n=d[r.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](r.parts[o]);for(;o<r.parts.length;o++)n.parts.push(l(r.parts[o],t))}else{for(var s=[],o=0;o<r.parts.length;o++)s.push(l(r.parts[o],t));d[r.id]={id:r.id,refs:1,parts:s}}}}function r(e){for(var t=[],i={},r=0;r<e.length;r++){var n=e[r],o=n[0],s=n[1],a=n[2],l=n[3],c={css:s,media:a,sourceMap:l};i[o]?i[o].parts.push(c):t.push(i[o]={id:o,parts:[c]})}return t}function n(e,t){var i=f(),r=y[y.length-1];if("top"===e.insertAt)r?r.nextSibling?i.insertBefore(t,r.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),y.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");i.appendChild(t)}}function o(e){e.parentNode.removeChild(e);var t=y.indexOf(e);t>=0&&y.splice(t,1)}function s(e){var t=document.createElement("style");return t.type="text/css",n(e,t),t}function a(e){var t=document.createElement("link");return t.rel="stylesheet",n(e,t),t}function l(e,t){var i,r,n;if(t.singleton){var l=v++;i=h||(h=s(t)),r=c.bind(null,i,l,!1),n=c.bind(null,i,l,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=a(t),r=p.bind(null,i),n=function(){o(i),i.href&&URL.revokeObjectURL(i.href)}):(i=s(t),r=u.bind(null,i),n=function(){o(i)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else n()}}function c(e,t,i,r){var n=i?"":r.css;if(e.styleSheet)e.styleSheet.cssText=w(t,n);else{var o=document.createTextNode(n),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(o,s[t]):e.appendChild(o)}}function u(e,t){var i=t.css,r=t.media;t.sourceMap;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function p(e,t){var i=t.css,r=(t.media,t.sourceMap);r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var n=new Blob([i],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(n),o&&URL.revokeObjectURL(o)}var d={},g=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},m=g(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),f=g(function(){return document.head||document.getElementsByTagName("head")[0]}),h=null,v=0,y=[];e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");t=t||{},void 0===t.singleton&&(t.singleton=m()),void 0===t.insertAt&&(t.insertAt="bottom");var n=r(e);return i(n,t),function(e){for(var o=[],s=0;s<n.length;s++){var a=n[s],l=d[a.id];l.refs--,o.push(l)}if(e){i(r(e),t)}for(var s=0;s<o.length;s++){var l=o[s];if(0===l.refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete d[l.id]}}}};var w=function(){var e=[];return function(t,i){return e[t]=i,e.filter(Boolean).join("\n")}}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(409)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(410);!function(){var e=$(".context-home-mobile .mobile-image-container .c-image");if(e&&e.length>0){var t=$(".context-home-mobile").offset().top,i=$(window),n=i.height();i.width();i.scroll(r(function(){i.scrollTop()+n>t&&e.addClass("animate")},50))}}()},function(e,t,i){function r(e,t,i){var r=!0,a=!0;if("function"!=typeof e)throw new TypeError(s);return o(i)&&(r="leading"in i?!!i.leading:r,a="trailing"in i?!!i.trailing:a),n(e,t,{leading:r,maxWait:t,trailing:a})}var n=i(79),o=i(45),s="Expected a function";e.exports=r},function(e,t){var i=Date.now;e.exports=i},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(413),i(414)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(14),n=i(79),o=function(){function e(){this.responsiveDrawers=$(".c-drawer.responsive"),this.toggleButtons=this.responsiveDrawers.find("button[aria-controls]")}return e.prototype.setResponsiveDrawers=function(){var e=this;window.innerWidth<=r.MediaConstants.resolutionLarge?this.toggleButtons.each(function(t,i){"true"===$(e.toggleButtons[t]).attr("aria-expanded")&&e.toggleButtons[t].click()}):this.toggleButtons.each(function(t,i){"false"===$(e.toggleButtons[t]).attr("aria-expanded")&&e.toggleButtons[t].click()})},e.prototype.registerResponsiveDrawers=function(){var e=this;$(window).on("resize",function(){n(function(){e.setResponsiveDrawers()},100)()})},e.prototype.render=function(){var e=$(".flow-pricing");e&&e.length>0&&(this.setResponsiveDrawers(),this.registerResponsiveDrawers())},e}();$(function(){return(new o).render()})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(14),n=i(79),o=function(){function e(){this.selectionClasses=$(".selected-plan-features option"),this.selectedPlanFeatures=$(".selected-plan-features"),this.selections=[]}return e.prototype.getElementsByOptionValues=function(){var e=this;this.selectionClasses.each(function(t,i){e.selections.push($("."+$(i).attr("value")))})},e.prototype.clearPlanDisplay=function(){0===this.selections.length&&this.getElementsByOptionValues();for(var e=0,t=this.selections;e<t.length;e++){t[e].addClass("pricing-table-hide")}},e.prototype.setSelectedPlan=function(){this.clearPlanDisplay();var e=$(".selected-plan-features option:selected");if(e&&1===e.length){var t=$(e[0]).attr("value");$("."+t).removeClass("pricing-table-hide")}},e.prototype.setAllPlanDisplay=function(){0===this.selections.length&&this.getElementsByOptionValues();for(var e=0,t=this.selections;e<t.length;e++){t[e].removeClass("pricing-table-hide")}},e.prototype.setResponsiveTable=function(){var e=this;window.innerWidth<=r.MediaConstants.resolutionLarge?(this.setSelectedPlan(),this.selectedPlanFeatures.change(function(t){e.setSelectedPlan()})):this.setAllPlanDisplay()},e.prototype.registerResponsiveTableResizeEvent=function(){var e=this;$(window).on("resize",function(){n(function(){e.setResponsiveTable()},100)()})},e.prototype.render=function(){var e=$(".flow-pricing");e&&e.length>0&&(this.setResponsiveTable(),this.registerResponsiveTableResizeEvent())},e}();$(function(){return(new o).render()})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(81),o=i(30),s=function(){function e(e,t,i,r,o){this.refCountCacheFactory=e,this.resourceIdentifierFactory=t,this.resourceArrayFactory=i,this.config=r,this.resourceFunctions=o,this.refCountCache=e(n.uuid(),{evictionDelay:this.config.options&&this.config.options.evictionDelay}),this.resourceIdentifier=t(r)}return e.prototype.getOrCreate=function(e,t){var i=this;return this.refCountCache.getOrPut(e,function(){var n=i.resourceArrayFactory(i.config,e,i.resourceFunctions);return r.isFunction(t)&&t(n),n})},e.prototype.release=function(e){return this.refCountCache.release(e,function(e){e&&e.$destroy()})},e.prototype.peek=function(e){return this.refCountCache.peek(e)},e}();o.default.factory("resourceArrayCacheFactory",["refCountCacheFactory","resourceIdentifierFactory","resourceArrayFactory",function(e,t,i){return function(r,n){return new s(e,t,i,r,n)}}])},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0}),r(i(78)),r(i(82))},function(e,t,i){"use strict";function r(e,t){var i=[],r=function(e,t){if(null!==t&&"object"==typeof t){if(i.indexOf(t)>=0)return;i.push(t)}return t};return e?JSON.stringify(e,r,t?"\t":4):""}Object.defineProperty(t,"__esModule",{value:!0}),t.prettyStringify=r},function(e,t,i){"use strict";function r(){var e,t=Array.prototype.slice.apply(arguments),i=t[0]||"",r=t.slice(1),n=/\{[a-zA-Z$_\d]*\}/g,o=/\{(\d+)\}/g,s=!1;if(r&&1===r.length&&r[0]&&"object"==typeof r[0]){var a=r[0];e=i.replace(n,function(e){var t=e.substring(1,e.length-1);return a.hasOwnProperty(t)?(s=!0,a[t]):e})}return s||(e=i.replace(o,function(e,i){return void 0!==t[i]?t[i]:e})),e}Object.defineProperty(t,"__esModule",{value:!0}),t.format=r},function(e,t,i){"use strict";function r(e){return null===e||void 0===e}Object.defineProperty(t,"__esModule",{value:!0}),t.isNullOrUndefined=r},function(e,t,i){"use strict";function r(e,t,i){return void 0===i&&(i=0),String.prototype.indexOf.call(e,t,i)>=0}Object.defineProperty(t,"__esModule",{value:!0}),t.stringIncludes=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.initialized=!1,this.func=e}return Object.defineProperty(e.prototype,"value",{get:function(){if(this.initialized){if(this.cachedError)throw this.cachedError;return this.cachedValue}try{return this.cachedValue=this.func(),this.cachedValue}catch(e){throw this.cachedError=e,e}finally{this.initialized=!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValueCreated",{get:function(){return this.initialized},enumerable:!0,configurable:!0}),e}();t.Lazy=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(42),o=i(30),s=function(){function e(e,t,i,n,o,s,a,l,c){var u=this;this.$resolved=!1,this.$lastModified=new Date,this._isApplying=!1,this._resourceWatches={},this._scope=e.$new(!0),this._deferred=t.defer(),this.$promise=this._deferred.promise,this.$params=l,this._config=a;var p=this._config.options.queryPollInterval;this._poll=i({poll:function(){return u._refresh(!0)},interval:r.isFunction(p)?function(){return p(u.resourceArray)}:p}),this._watcher=n(function(){return u.$lastModified.getTime()},[this]),this._resourceFunctions=c,this._resourceHttpClient=o(this._config),this._resourceIdentifier=s(this._config),this._resourceArray=[],["$params","$resolved","$promise","$lastModified","$nextLink","$destroy","$refresh","$remove","$hasNextPage","$getNextPage","$watch","$apply","$startPolling"].forEach(function(e){Object.defineProperty(u._resourceArray,e,{get:function(){var t=u[e];if(r.isFunction(t)){var i=u;return function(){return t.apply(i,arguments)}}return t},set:function(t){u[e]=t},enumerable:!0})}),this._resourceArray.toJSON=function(){return[].concat(u._resourceArray.map(function(e){return r.isFunction(e.toJSON)?e.toJSON():e}))}}return Object.defineProperty(e.prototype,"resourceArray",{get:function(){return this._resourceArray},enumerable:!0,configurable:!0}),e.prototype.$destroy=function(){this._poll.destroy(),this._scope.$destroy(),this.$apply([])},e.prototype.$startPolling=function(e){var t=this;this.$promise.then(function(){t._poll.start(e)})},e.prototype.$refresh=function(){return this._refresh()},e.prototype.$remove=function(e){return!!this._removeResource(e)&&(this.$apply(),!0)},e.prototype.$hasNextPage=function(){return null!==this.$nextLink&&void 0!==this.$nextLink},e.prototype.$getNextPage=function(){var e=this,t=r.extend({},this.$params,{url:this.$nextLink});return this._resourceHttpClient.query(null,t).then(function(t){if(t.modified||!e.$resolved)return e.$apply(t.data,!0),t.data}).catch(function(t){e._deferred.reject(t)})},e.prototype.$watch=function(e,t,i){r.isArray(t)||(i=t,t=[]);var n=!0;return this._watcher.watch(e,t,function(){i(n),n=!1})},e.prototype.$apply=function(e,t){this._isApplying||(this._isApplying=!0,e?this._isDataChanged(e)&&(this._merge(e,t),this.$nextLink=e.nextLink,this.$resolved=!0,this.$lastModified=new Date,this._deferred.resolve(e)):this.$lastModified=new Date,this._isApplying=!1)},e.prototype.$query=function(e){var t=this.$params;return e&&(t=r.extend({},this.$params,{_poll:!0})),this._resourceHttpClient.query(null,t)},e.prototype._refresh=function(e){var t=this,i=this.$query(e);return i.then(function(e){!e.modified&&t.$resolved||t.$apply(e.data)}).catch(function(e){e.status>=400&&e.status<=499&&t._poll.destroy(),t._deferred.reject(e)}),e||this._poll.reset(),i},e.prototype._isDataChanged=function(e){return!this.$resolved||(!this._config.options.isResourceArrayChanged||this._config.options.isResourceArrayChanged(this.resourceArray.toJSON(),e))},e.prototype._merge=function(e,t){var i=this,r={},o={};if(e.forEach(function(e,t){var n=i._resourceIdentifier.resourceToId(e);r[n]=e,o[n]=t}),!t){var s=[];this.resourceArray.forEach(function(e){var t=i._resourceIdentifier.resourceToId(e),n=r[t];n?(e.$apply(n),delete r[t]):s.push(e)}),s.forEach(function(e){i._removeResource(e)})}n.forEach(r,function(e){i._insertResource(o[e.key],e.value)})},e.prototype._getResource=function(e){var t=this;return this.resourceArray.filter(function(i){return t._resourceIdentifier.doesResourceMatchParams(i,e)})[0]},e.prototype._insertResource=function(e,t){var i=this,r=this._resourceIdentifier.resourceToParams(t);if(this._getResource(r))return!1;var n=this._resourceFunctions.create(r),o=this._resourceIdentifier.paramsToId(r);return n.$apply(t),this._resourceWatches[o]=n.$watch(this._scope,function(e){e||(i.$lastModified=n.$lastModified)}),e>=0?this._resourceArray.splice(e,0,n):this._resourceArray.push(n),!0},e.prototype._removeResource=function(e){for(var t=-1,i=0;i<this._resourceArray.length;i++)if(this._resourceArray[i]===e){t=i;break}if(t>=0){var r=this._resourceArray.splice(t,1)[0],n=this._resourceIdentifier.resourceToParams(r),o=this._resourceIdentifier.paramsToId(n);return this._resourceWatches[o]&&this._resourceWatches[o](),this._resourceFunctions.remove(n),!0}return!1},e}();o.default.factory("resourceArrayFactory",["$rootScope","$q","poll","watcherFactory","resourceHttpClientFactory","resourceIdentifierFactory",function(e,t,i,r,n,o){return function(a,l,c){return new s(e,t,i,r,n,o,a,l,c).resourceArray}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(81),o=i(30),s=function(){function e(e,t,i){this.refCountCacheFactory=e,this.resourceFactory=t,this.config=i,this.refCountCache=e(n.uuid(),{evictionDelay:this.config.options&&this.config.options.evictionDelay})}return e.prototype.getOrCreate=function(e,t){var i=this;return this.refCountCache.getOrPut(e,function(){var n=i.resourceFactory(i.config,e);return r.isFunction(t)&&t(n),n})},e.prototype.release=function(e){return this.refCountCache.release(e,function(e){e&&e.$destroy()})},e.prototype.peek=function(e){return this.refCountCache.peek(e)},e}();o.default.factory("resourceCacheFactory",["refCountCacheFactory","resourceFactory",function(e,t){return function(i){return new s(e,t,i)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(30),o=function(){function e(e,t,i,r){this.resourceFactory=e,this.resourceCacheFactory=t,this.resourceArrayCacheFactory=i,this.resourceIdentifierFactory=r,this.resourceCachesByResourceType={}}return e.prototype.getCaches=function(e){var t,i=this,n=e.options||{},o=n.atomize,s=n.atomizeGloballyByResourceType,a=e.resourceType;s&&a?(this.resourceCachesByResourceType[a]||(this.resourceCachesByResourceType[a]=this.resourceCacheFactory(e)),t=this.resourceCachesByResourceType[a]):t=this.resourceCacheFactory(e);var l;return l=o?this.resourceArrayCacheFactory(e,{create:function(e){return t.getOrCreate(e)},remove:function(e){return t.release(e)}}):this.resourceArrayCacheFactory(e,{create:function(t){return i.resourceFactory(e,t)},remove:function(e){return r.noop}}),[t,l]},e}();o.$inject=["resourceFactory","resourceCacheFactory","resourceArrayCacheFactory","resourceIdentifierFactory"],n.default.service("resourceCacheManager",o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(30),n=function(){function e(e,t){this.resourceCacheManager=e,this.config=t,i=e.getCaches(t),this.resourceCache=i[0],this.resourceArrayCache=i[1];var i}return e.prototype.getOrCreateResource=function(e,t,i){var r=this,n=this.resourceCache.getOrCreate(t,i);return e.$on("$destroy",function(){r.resourceCache.release(t)}),n},e.prototype.getOrCreateResourceArray=function(e,t,i){var r=this,n=this.resourceArrayCache.getOrCreate(t,i);return e.$on("$destroy",function(){r.resourceArrayCache.release(t)}),n},e.prototype.peekAtResource=function(e){return this.resourceCache.peek(e)},e.prototype.peekAtResourceArray=function(e){return this.resourceArrayCache.peek(e)},e}();r.default.factory("resourceDataSetFactory",["resourceCacheManager",function(e){return function(t){return new n(e,t)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(42),o=i(30),s=function(){function e(e,t,i,n,o,s,a){var l=this;this.$resolved=!1,this.$lastModified=new Date,this._isApplying=!1,this._deferred=t.defer(),this.$promise=this._deferred.promise,this.$params=a,this._config=s;var c=this._config.options.getPollInterval;this._poll=i({poll:function(){return l._refresh(!0)},interval:r.isFunction(c)?function(){return c(l)}:c}),this._watcher=n(function(){return l.$lastModified.getTime()},[this]),this._resourceHttpClient=o(this._config),Object.keys(this._config.actions||{}).forEach(function(e){l["$"+e]=function(t){return l._resourceHttpClient.action(e,null,l.$params,t)}})}return e.prototype.$destroy=function(){this._poll.destroy()},e.prototype.$startPolling=function(e){var t=this;this.$promise.then(function(){t._poll.start(e)})},e.prototype.$refresh=function(){return this._refresh()},e.prototype.$watch=function(e,t,i){r.isArray(t)||(i=t,t=[]);var n=!0;return this._watcher.watch(e,t,function(){i(n),n=!1})},e.prototype.$apply=function(e){this._isApplying||(this._isApplying=!0,e?this._isDataChanged(e)&&(this._merge(e),this.$resolved=!0,this.$lastModified=new Date,this._deferred.resolve(e)):this.$lastModified=new Date,this._isApplying=!1)},e.prototype.$get=function(e){var t=this.$params;return e&&(t=r.extend({},this.$params,{_poll:!0})),this._resourceHttpClient.get(null,t)},e.prototype.$put=function(){var e=this,t=this._resourceHttpClient.put(null,this.$params,this);return t.then(function(){return e.$apply()}),t},e.prototype.$post=function(){var e=this,t=this._resourceHttpClient.post(null,this.$params,this);return t.then(function(){return e.$apply()}),t},e.prototype.$patch=function(e){var t=this,i=this._resourceHttpClient.patch(null,this.$params,e);return i.then(function(){return t.$apply(e)}),i},e.prototype.$delete=function(){return this._resourceHttpClient.delete(null,this.$params)},e.prototype.toJSON=function(){var e=this,t={};return n.forEach(this,function(i){e._isReservedProperty(e,i.key)||(t[i.key]=i.value)}),t},e.prototype._refresh=function(e){var t=this,i=this.$get(e);return i.then(function(e){!e.modified&&t.$resolved||t.$apply(e.data)}).catch(function(e){e.status>=400&&e.status<=499&&t._poll.destroy(),t._deferred.reject(e)}),e||this._poll.reset(),i},e.prototype._isDataChanged=function(e){return!this.$resolved||(!this._config.options.isResourceChanged||this._config.options.isResourceChanged(this.toJSON(),e))},e.prototype._merge=function(e){this._mergeObjects(this,e)},e.prototype._mergeObjects=function(e,t){var i=this;n.forEach(t,function(t){i._isReservedProperty(e,t.key)||void 0===typeof t.value||(n.isObject(e[t.key])&&n.isObject(t.value)?i._mergeObjects(e[t.key],t.value):e[t.key]=t.value)}),Object.keys(e).forEach(function(r){i._isReservedProperty(e,r)||t.hasOwnProperty(r)||delete e[r]})},e.prototype._isReservedProperty=function(e,t){return e===this&&(0===t.indexOf("_")||0===t.indexOf("$")||r.isFunction(e[t]))},e}();o.default.factory("resourceFactory",["$rootScope","$q","poll","watcherFactory","resourceHttpClientFactory",function(e,t,i,r,n){return function(o,a){return new s(e,t,i,r,n,o,a)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(81),o=i(30),s=function(){function e(e,t,i){var o=this;this._$q=e,this._$http=t,this._config=i;var s={query:{method:"GET",urlPath:this._urlPathToArrayPath(i.urlPath)},get:{method:"GET",urlPath:i.urlPath},put:{method:"PUT",urlPath:i.urlPath},post:{method:"POST",urlPath:i.urlPath},patch:{method:"PATCH",urlPath:i.urlPath},delete:{method:"DELETE",urlPath:i.urlPath}};this._rest=s,n.object.forEach(i.rest||{},function(e){o._rest[e.key]=r.extend({},s[e.key]||{},e.value),o._rest[e.key].headers=r.extend({},i.headers||{},e.value.headers||{}),o._rest[e.key].params=r.extend({},i.params||{},e.value.params||{})}),this._actions={},n.object.forEach(i.actions||{},function(e){o._actions[e.key]=r.extend({},e.value),o._actions[e.key].headers=r.extend({},i.headers||{},e.value.headers),o._actions[e.key].params=r.extend({},i.params||{},e.value.params)})}return e.prototype.query=function(e,t){return this._request(this._rest.query,e,t)},e.prototype.get=function(e,t){return this._request(this._rest.get,e,t)},e.prototype.put=function(e,t,i){return this._request(this._rest.put,e,t,i)},e.prototype.post=function(e,t,i){return this._request(this._rest.post,e,t,i)},e.prototype.patch=function(e,t,i){return this._request(this._rest.patch,e,t,i)},e.prototype.delete=function(e,t){return this._request(this._rest.delete,e,t)},e.prototype.action=function(e,t,i,r){var n=this._actions[e];if(!n)throw new Error("resourceHttpClient: action "+e+" not defined");return this._request(n,t,i,r)},e.prototype._request=function(t,i,o,s){var a=this;i=r.extend({},t.headers||{},this._config.headers||{},i||{}),o=r.extend({},t.params||{},this._config.params||{},o||{}),s=r.extend({},this._toJSON(t.data)||{},this._toJSON(s)||{});var l=r.extend({},t);delete l.params,delete l.data,o.url?l.url=o.url:l.url=n.url.formatDottedUrl(this._config.urlBase,t.urlPath,o,s),l.headers=i,l.data=/^(POST|PUT|PATCH)$/i.test(l.method)?s:void 0,t.requestInterceptor&&t.requestInterceptor&&(l=t.requestInterceptor(l));var c=!0;n.string.equalsIgnoreCase(l.method,"GET")&&this._prependResponseTransformer(l,function(t){if("string"==typeof t){var i=(l.url||"").replace(/[?|&]_.+?=.+?(?=(&|$))/gi,"").toLowerCase();t===e.responseBodyCache[i]&&(c=!1),e.responseBodyCache[i]=t}return t});var u=this._$http(l);return t.isODataArray&&(u=u.then(function(e){return a._processODataArrayResponse(e,t.lazyPaging)})),u=u.then(function(e){return e.modified=c,e}),t.responseInterceptor&&(u=u.then(function(e){var i=t.responseInterceptor(e);return r.isFunction(i.then)?i.then(function(t){return e.data=t,e}):(e.data=i,e)})),u},e.prototype._urlPathToArrayPath=function(e){var t=e.split("/");return t.length&&0===t.pop().indexOf(":")&&(e=t.join("/")),e},e.prototype._processODataArrayResponse=function(e,t){var i=this;if(Array.isArray(e.data))return e.data;var n=this._$q.defer(),o=[],s=function(a){var l=Array.isArray(a.data)?a.data:a.data.value||[];if(o.push.apply(o,l),a.data&&a.data.nextLink)if(t)o.nextLink=a.data.nextLink,e.data=o,n.resolve(e);else{var c=r.extend({},e.config);c.url=a.data.nextLink,i._$http(c).then(s)}else e.data=o,n.resolve(e)};return s(e),n.promise},e.prototype._prependResponseTransformer=function(e,t){var i=e.transformResponse||this._$http.defaults.transformResponse,n=r.isArray(i)?i:[i];n=n.slice(),n.unshift(t),e.transformResponse=n},e.prototype._toJSON=function(e){return e&&r.isFunction(e.toJSON)?e.toJSON():e},e}();s.responseBodyCache={},o.default.factory("resourceHttpClientFactory",["$q","$http",function(e,t){return function(i){return new s(e,t,i)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(81),o=i(30),s=function(){function e(e){this._config=e}return e.prototype.resourceToParams=function(e){return this._config.resourceToParams(e)},e.prototype.paramsToId=function(e){return e=e||{},r.isFunction(e.toJSON)&&(e=e.toJSON()),n.object.isObject(e)&&(e=r.extend({},e||{})),n.object.isObject(e)&&(e=r.extend({},e),Object.keys(e).forEach(function(t){r.isFunction(e[t])&&(e[t]=e[t]())})),n.json.stableStringify(e)},e.prototype.resourceToId=function(e){return this.paramsToId(this.resourceToParams(e))},e.prototype.doesResourceMatchParams=function(e,t){var i=this.paramsToId(t),r=this.resourceToId(e);return n.string.equalsIgnoreCase(i,r)},e}();o.default.factory("resourceIdentifierFactory",function(){return function(e){return new s(e)}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(30),n=function(){function e(e,t){void 0===t&&(t=[]),this.watchExpression=e,this.defaultDependencies=t}return e.prototype.watch=function(e,t,i){t=[].concat(this.defaultDependencies,t);var r=function(){return t.every(function(e){return e.$resolved})};return e.$watchGroup([this.watchExpression,r],function(e,t){var r=e[0],n=e[1],o=t[0];n&&i(r,o)})},e}();t.Watcher=n,r.default.factory("watcherFactory",function(){return function(e,t){return new n(e,t)}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(42);i(30).default.factory("azureResourceClientFactory",["resourceClientFactory","AppSettings",function(e){return function(t){var i=function(e){return{id:e.id}},o={apiVersion:t.apiVersion||"2016-01-01-alpha"},s={urlBase:t.urlBase||"https://management.azure.com",urlPath:t.urlPath||"",resourceType:t.resourceType,resourceToParams:t.resourceToParams||i,headers:t.headers,params:r.extend({},o,t.params||{}),options:t.options},a=function(){return{urlPath:":id",params:{id:"@id"}}},l={query:{isODataArray:!0},get:a(),put:a(),post:a(),patch:a(),delete:a()};return s.rest=l,t.rest&&n.forEach(t.rest,function(e){l[e.key]=r.extend(l[e.key]||{},e.value)}),s.actions={},t.actions&&t.actions.forEach(function(e){var t="string"==typeof e?{name:e}:e,i={urlPath:":id/"+t.name,method:"POST",params:{id:"@id"}};s.actions[t.name]=r.extend({},i,t)}),e(s)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(30),o=function(){function e(e,t,i,n){this._references={},this._$interval=e,this.options=r.extend({},{evictionDelay:0},n||{}),this._cache=t(i,this.options)}return e.prototype.info=function(){return this._cache.info()},e.prototype.put=function(e,t){this._cache.hasKey(e)||void 0===t||this._incrementReferences(e),this._cache.put(e,t)},e.prototype.get=function(e){return this._cache.hasKey(e)&&this._incrementReferences(e),this._cache.get(e)},e.prototype.getOrPut=function(e,t){if(this._cache.hasKey(e))return this.get(e);var i=r.isFunction(t)?t():t;return this.put(e,i),i},e.prototype.peek=function(e){return this._cache.get(e)},e.prototype.release=function(e,t){this._decrementReferences(e)<=0&&this.remove(e,t)},e.prototype.remove=function(e,t){this._scheduleEviction(this._cache.serializeKey(e),t)},e.prototype.removeAll=function(e){var t=this;Object.keys(this._references).forEach(function(i){t._scheduleEviction(i,e)})},e.prototype.hasKey=function(e){return this._cache.hasKey(e)},e.prototype.serializeKey=function(e){return this._cache.serializeKey(e)},e.prototype.destroy=function(e){this.options.evictionDelay=0,this.removeAll(e),this._references={},this._cache.destroy()},e.prototype._scheduleEviction=function(e,t){var i=this;delete this._references[e];var r=function(){if(!(i._references[e]>0)){var r=i._cache.raw().get(e);i._cache.raw().remove(e),t&&t(r)}};this.options.evictionDelay>0?this._$interval(r,this.options.evictionDelay,1):r()},e.prototype._incrementReferences=function(e){var t=this._cache.serializeKey(e);return this._references[t]?this._references[t]++:this._references[t]=1,this._references[t]},e.prototype._decrementReferences=function(e){var t=this._cache.serializeKey(e);return!this._references[t]||this._references[t]<0?delete this._references[t]:this._references[t]--,this._references[t]||0},e}();t.RefCountCache=o,n.default.factory("refCountCacheFactory",["$interval","typedCacheFactory",function(e,t){return function(i,r){if(r&&r.capacity)throw new Error("refCountCacheFactory: ref-counted caches cannot have a capacity");return new o(e,t,i,r)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(147),o=i(30);t.DefaultResourceConfigOptions={atomize:!0,atomizeGloballyByResourceType:!0,getPollInterval:n.PollInterval.Never,queryPollInterval:n.PollInterval.Never,evictionDelay:0};var s=function(){function e(e,i,n,o){var s=this;this.$q=e,this.$q=e,o.options=r.extend({},t.DefaultResourceConfigOptions,o.options||{}),this.resourceHttpClient=i(o),this.resourceDataSet=n(o),Object.keys(o.actions||{}).forEach(function(e){s[e]=function(t,i){return s.resourceHttpClient.action(e,null,t,i)}})}return e.prototype.query=function(e,t){var i=this.resourceDataSet.getOrCreateResourceArray(e,t,function(e){e.$refresh()});return i.$startPolling(e),i},e.prototype.get=function(e,t){var i=this.resourceDataSet.getOrCreateResource(e,t,function(e){e.$refresh()});return i.$startPolling(e),i},e.prototype.put=function(e,t){return this.resourceHttpClient.put(null,e,t)},e.prototype.post=function(e,t){return this.resourceHttpClient.post(null,e,t)},e.prototype.patch=function(e,t){return this.resourceHttpClient.patch(null,e,t)},e.prototype.delete=function(e){return this.resourceHttpClient.delete(null,e)},e.prototype.refreshQuery=function(e){var t=this.$q.defer(),i=this.resourceDataSet.peekAtResourceArray(e);return i?i.$refresh().then(function(){return t.resolve()},function(){return t.reject()}):t.resolve(),t.promise},e.prototype.refresh=function(e){var t=this.$q.defer(),i=this.resourceDataSet.peekAtResource(e);return i?i.$refresh().then(function(){return t.resolve()},function(){return t.reject()}):t.resolve(),t.promise},e.prototype.updateQueryCache=function(){var e,t,i;arguments.length<=2?(e=arguments[0],t=void 0,i=arguments[1]):(e=arguments[0],t=arguments[1],i=arguments[2]),this.resourceDataSet.getOrCreateResourceArray(e,t).$apply(i)},e.prototype.updateCache=function(e,t,i){this.resourceDataSet.getOrCreateResource(e,t).$apply(i)},e}();o.default.factory("resourceClientFactory",["$q","resourceHttpClientFactory","resourceDataSetFactory",function(e,t,i){return function(r){return new s(e,t,i,r)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(22),n=i(148),o=i(30),s=function(){function e(e,t,i){this.options=r.extend({},{serializeKey:n.stableStringify},i||{}),this._cache=e(t,this.options)}return e.prototype.info=function(){return this._cache.info()},e.prototype.put=function(e,t){this._cache.put(this.serializeKey(e),t)},e.prototype.get=function(e){return this._cache.get(this.serializeKey(e))},e.prototype.remove=function(e){this._cache.remove(this.serializeKey(e))},e.prototype.removeAll=function(){this._cache.removeAll()},e.prototype.hasKey=function(e){return void 0!==this.get(e)},e.prototype.serializeKey=function(e){return this.options.serializeKey(e)},e.prototype.destroy=function(){this._cache.destroy()},e.prototype.raw=function(){return this._cache},e}();o.default.factory("typedCacheFactory",["$cacheFactory",function(e){return function(t,i){return new s(e,t,i)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(152),o=i(153),s=i(7),a=i(55),l=i(4),c=i(3),u=function(){function e(e,t,i,r,n,o,u,p){var d=this;this.$q=e,this.$scope=t,this.$window=i,this.clientResources=r,this.dateTimeService=n,this.feedEventDefinitionsClient=o,this.flowsClient=u,this.loggingService=p,this.DefaultOptions=[{displayName:this.clientResources.Manage.ActivityFilter.AllActivity,name:""},{displayName:this.clientResources.Manage.ActivityFilter.Notifications,name:a.FeedEventDefinitionType.PushNotification},{displayName:this.clientResources.Manage.ActivityFilter.Failures,name:a.FeedEventDefinitionType.AggregatedFail}],this.spinner={size:s.SpinnerSize.Large,show:!0,local:s.SpinnerPosition.Local},this.options={options:this.DefaultOptions,selectedOption:this.DefaultOptions[0]};var g=this.loggingService.profilePageStart(l.ProfilingEventNames.activityFeedLoadStart);this.activityFeed=this.getActivityFeed(new Date),this.fullPageErrorModel={isPageErrored:!1,pageTitle:this.clientResources.Manage.Activity.Activity},this.$q.all(this.activityFeed.eventCollections.map(function(e){return e.events.$promise})).then(function(){return d.loggingService.profilePageEnd(g,l.ProfilingEventNames.activityFeedLoadEnd,{status:l.Status.Success})}).catch(function(e){throw d.loggingService.profilePageEnd(g,l.ProfilingEventNames.activityFeedLoadEnd,{status:c.inferErrorStatus(e),error:c.parseErrorMessage(e)}),d.loggingService.logError("ActivityFeedCtrl.ActivityFeedLoad",e),c.showFullPageError(d.fullPageErrorModel,e),e}).finally(function(){d.spinner.show=!1,d.activityFeed.pagesLoaded=1})}return e.prototype.getActivityFeed=function(e){var t=this;return{id:"feedEvents",date:e,pagesLoaded:0,eventCollections:this.getEventCollections(e),loadingMore:!1,loadMore:function(){var i=t.loggingService.profileStart(l.ProfilingEventNames.activityFeedLoadMoreStart);t.activityFeed.loadingMore=!0,t.activityFeed.loadingMoreSpinner.show=!0;var r=o.PagingConstants.PagingIntervals[t.activityFeed.pagesLoaded],s=o.PagingConstants.PagingIntervals[t.activityFeed.pagesLoaded+1];switch(t.activityFeed.pagesLoaded){case o.PagingConstants.MaximumPagesToLoad:t.activityFeed.loadingMore=!1,t.activityFeed.loadingMoreSpinner.show=!1;break;default:var a=t.feedEventDefinitionsClient.query(t.$scope,{$filter:n.getFilterString(e,s,r)});a.$promise.then(function(){return t.loggingService.profileEnd(i,l.ProfilingEventNames.activityFeedLoadMoreEnd,{status:l.Status.Success})}).catch(function(e){throw t.loggingService.profileEnd(i,l.ProfilingEventNames.activityFeedLoadMoreEnd,{status:c.inferErrorStatus(e),error:c.parseErrorMessage(e)}),t.loggingService.logError("ActivityFeedCtrl.ActivityFeedLoadMore",e),e}).finally(function(){t.activityFeed.eventCollections[o.EventTimeline.Older].events.$apply(a),t.activityFeed.pagesLoaded++,t.activityFeed.loadingMore=!1,t.activityFeed.loadingMoreSpinner.show=!1})}},hasMore:function(){return t.activityFeed.pagesLoaded!==o.PagingConstants.MaximumPagesToLoad},spinner:this.spinner,loadingMoreSpinner:{size:s.SpinnerSize.Small,show:!1,local:s.SpinnerPosition.LocalHorizontal},options:this.options,tables:[]}},e.prototype.getEventCollections=function(e){return[{events:this.feedEventDefinitionsClient.query(this.$scope,{$filter:n.getFilterString(e,o.PagingConstants.TodayStartInterval)}),heading:this.clientResources.Manage.Activity.Today},{events:this.feedEventDefinitionsClient.query(this.$scope,{$filter:n.getFilterString(e,o.PagingConstants.YesterdayStartInterval,o.PagingConstants.YesterdayEndInterval)}),heading:this.clientResources.Manage.Activity.Yesterday},{events:this.feedEventDefinitionsClient.query(this.$scope,{$filter:n.getFilterString(e,o.PagingConstants.PagingIntervals[1],o.PagingConstants.PagingIntervals[0])}),heading:this.clientResources.Manage.Activity.Older,shouldMerge:!0,expandDateTime:!0}]},e.$inject=[r.default.services.$q,r.default.services.$scope,r.default.services.$window,r.default.services.clientResources,r.default.services.dateTime,r.default.services.feedEventDefinitionsClient,r.default.services.flowsClient,r.default.services.logging],e}();t.ActivityFeedCtrl=u},function(e,t,i){"use strict";function r(e,t){return e&&e.api&&e.api.id&&e.type&&(s.equalsIgnoreCase(e.type,l.FlowTemplateOperationType.ApiConnection)||s.equalsIgnoreCase(e.type,l.FlowTemplateOperationType.ApiConnectionWebhook)||s.equalsIgnoreCase(e.type,l.FlowTemplateOperationType.Request)&&s.equalsIgnoreCase(e.kind,a.FlowTemplateOperationKind.ApiConnection))?Object.keys(t||{}).filter(function(i){var r=t[i];return s.equalsIgnoreCase(r.id,e.api.id)||r.api&&s.equalsIgnoreCase(r.api.id,e.api.id)}).map(function(e){return t[e]})[0]||null:null}function n(e,t){return e.map(function(e){if(e.api){var i=o(t,e.api.id);if(i)return i.api?i.api.properties.displayName:i.displayName}else if(!s.equalsIgnoreCase(e.type,l.FlowTemplateOperationType.ApiConnection))return e.type;return""}).filter(function(e){return""!==e})}function o(e,t){return Object.keys(e).filter(function(i){return(e[i].api?e[i].api.id:e[i].id)===t}).map(function(t){return e[t]})[0]||null}Object.defineProperty(t,"__esModule",{value:!0});var s=i(8),a=i(154),l=i(70);t.getConnectionReference=r,t.getTriggerDisplayNames=n,t.getConnectionReferenceById=o},function(e,t,i){function r(e,t,i){var r=g.imports._.templateSettings||g;i&&u(e,t,i)&&(t=void 0),e=m(e),t=o({},t,r,n);var S,b,P=o({},t.imports,r.imports,n),R=p(P),T=a(P,R),E=0,A=t.interpolate||w,D="__p += '",F=RegExp((t.escape||w).source+"|"+A.source+"|"+(A===d?y:w).source+"|"+(t.evaluate||w).source+"|$","g"),N="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";e.replace(F,function(t,i,r,n,o,s){return r||(r=n),D+=e.slice(E,s).replace(C,l),i&&(S=!0,D+="' +\n__e("+i+") +\n'"),o&&(b=!0,D+="';\n"+o+";\n__p += '"),r&&(D+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),E=s+t.length,t}),D+="';\n";var I=t.variable;I||(D="with (obj) {\n"+D+"\n}\n"),D=(b?D.replace(f,""):D).replace(h,"$1").replace(v,"$1;"),D="function("+(I||"obj")+") {\n"+(I?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(S?", __e = _.escape":"")+(b?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+D+"return __p\n}";var O=s(function(){return Function(R,N+"return "+D).apply(void 0,T)});if(O.source=D,c(O))throw O;return O}var n=i(437),o=i(438),s=i(451),a=i(452),l=i(453),c=i(454),u=i(156),p=i(112),d=i(166),g=i(456),m=i(113),f=/\b__p \+= '';/g,h=/\b(__p \+=) '' \+/g,v=/(__e\(.*?\)|\b__t\)) \+\n'';/g,y=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,w=/($^)/,C=/['\n\r\u2028\u2029\\]/g;e.exports=r},function(e,t,i){function r(e,t,i,r){return void 0===e||n(e,o[i])&&!s.call(r,i)?t:e}var n=i(84),o=Object.prototype,s=o.hasOwnProperty;e.exports=r},function(e,t,i){var r=i(439),n=i(441),o=i(444),s=n(function(e,t,i,n){r(t,o(t),e,n)});e.exports=s},function(e,t,i){function r(e,t,i,r){i||(i={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=r?r(i[a],e[a],a,i,e):e[a];n(i,a,l)}return i}var n=i(440);e.exports=r},function(e,t,i){function r(e,t,i){var r=e[t];n(r,i)&&(!n(r,o[t])||s.call(e,t))&&(void 0!==i||t in e)||(e[t]=i)}var n=i(84),o=Object.prototype,s=o.hasOwnProperty;e.exports=r},function(e,t,i){function r(e){return o(function(t,i){var r=-1,o=i.length,s=o>1?i[o-1]:void 0,a=o>2?i[2]:void 0;for(s="function"==typeof s?(o--,s):void 0,a&&n(i[0],i[1],a)&&(s=o<3?void 0:s,o=1),t=Object(t);++r<o;){var l=i[r];l&&e(t,l,r,s)}return t})}var n=i(156),o=i(158);e.exports=r},function(e,t,i){var r=i(157),n=r("length");e.exports=n},function(e,t,i){function r(e){if(!e)return 0===e?e:0;if((e=n(e))===o||e===-o){return(e<0?-1:1)*s}var t=e%1;return e===e?t?e-t:e:0}var n=i(145),o=1/0,s=1.7976931348623157e308;e.exports=r},function(e,t,i){function r(e){for(var t=-1,i=a(e),r=n(e),l=r.length,u=o(e),p=!!u,d=u||[],g=d.length;++t<l;){var m=r[t];p&&("length"==m||s(m,g))||"constructor"==m&&(i||!c.call(e,m))||d.push(m)}return d}var n=i(445),o=i(160),s=i(86),a=i(163),l=Object.prototype,c=l.hasOwnProperty;e.exports=r},function(e,t,i){function r(e){e=null==e?e:Object(e);var t=[];for(var i in e)t.push(i);return t}var n=i(446),o=i(448),s=Object.prototype,a=n?n.enumerate:void 0,l=s.propertyIsEnumerable;a&&!l.call({valueOf:1},"valueOf")&&(r=function(e){return o(a(e))}),e.exports=r},function(e,t,i){var r=i(56),n=r.Reflect;e.exports=n},function(e,t){function i(e){return e&&e.Object===Object?e:null}e.exports=i},function(e,t){function i(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i}e.exports=i},function(e,t){function i(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}e.exports=i},function(e,t,i){function r(e){return o(e)&&n(e)}var n=i(111),o=i(51);e.exports=r},function(e,t,i){var r=i(159),n=i(45),o=i(158),s=o(function(e,t){try{return r(e,void 0,t)}catch(e){return n(e)?e:new Error(e)}});e.exports=s},function(e,t,i){function r(e,t){return n(t,function(t){return e[t]})}var n=i(164);e.exports=r},function(e,t){function i(e){return"\\"+r[e]}var r={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};e.exports=i},function(e,t,i){function r(e){return n(e)&&"string"==typeof e.message&&a.call(e)==o}var n=i(51),o="[object Error]",s=Object.prototype,a=s.toString;e.exports=r},function(e,t){function i(e){return r(Object(e))}var r=Object.keys;e.exports=i},function(e,t,i){var r=i(457),n=i(460),o=i(461),s=i(166),a={escape:n,evaluate:o,interpolate:s,variable:"",imports:{_:{escape:r}}};e.exports=a},function(e,t,i){function r(e){return e=o(e),e&&a.test(e)?e.replace(s,n):e}var n=i(458),o=i(113),s=/[&<>"'`]/g,a=RegExp(s.source);e.exports=r},function(e,t){function i(e){return r[e]}var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};e.exports=i},function(e,t,i){function r(e){return"symbol"==typeof e||n(e)&&a.call(e)==o}var n=i(51),o="[object Symbol]",s=Object.prototype,a=s.toString;e.exports=r},function(e,t){var i=/<%-([\s\S]+?)%>/g;e.exports=i},function(e,t){var i=/<%([\s\S]+?)%>/g;e.exports=i},function(e,t){},function(e,t){e.exports='<div class="context-icon-template"> <% if (shouldShowError) { %> <div class="error-icon"> <img cdn-src="<%= errorIcon %>" aria-hidden="true"/> </div> <% } %> <div class="multi-icon-set <%= className %>"> <% iconInfos.forEach(function(iconInfo) { %> <div style="background-color: <%= iconInfo.brandColor %>"> <img src="<%= iconInfo.iconUri %>" aria-hidden="true" onerror=\'this.onerror=null,this.src="\\t<%= iconInfo.onErrorImagePath %>\\t",this.parentNode.removeAttribute("style"),this.parentNode.className+=" api-fallback-icon"\'/> </div> <% }) %> <% if (excessCount > 0) { %> <div class="icon multi-icon-excess-count"> <p>+<%= excessCount %></p> </div> <% } %> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionStatusCode={ConfigurationNeeded:"configuration needed",Unauthorized:"unauthorized",Unauthenticated:"unauthenticated",TooManyRequests:"too many requests"}},function(e,t){},function(e,t){e.exports='<div> <div class="subsection-manage context-manage-activityfeed" ng-if="!activityFeedCtrl.fullPageErrorModel.isPageErrored"> <div class="heading"> <div class="row"> <div class="column large-4"> <h1>{{activityFeedCtrl.clientResources.Manage.Activity.Activity}}</h1> </div> <div class="column large-4"> <div class="activityfeed-search"> <form class="c-search flow-f-search-alt"> <input type="search" aria-label="{{activityFeedCtrl.clientResources.Manage.Activity.SearchRecentActivity}}" placeholder="{{activityFeedCtrl.clientResources.Manage.Activity.SearchRecentActivity}}" ng-model="activityFeedCtrl.activityFeed.searchFilter" autocomplete="off" spellcheck="false"/> <button type="submit" disabled="true" class="c-glyph"> <span class="x-screen-reader">{{activityFeedCtrl.clientResources.Manage.Activity.Search}}</span> </button> </form> </div> </div> <div class="column large-4"> <div class="activityfeed-options"> <options model="activityFeedCtrl.options"/> </div> </div> </div> </div> <div class="row"> <div class="column"> <spinner model="activityFeedCtrl.spinner"></spinner> <activity-feed-list model="activityFeedCtrl.activityFeed"></activity-feed-list> </div> </div> </div> <full-page-error model="activityFeedCtrl.fullPageErrorModel" ng-if="activityFeedCtrl.fullPageErrorModel.isPageErrored"></full-page-error> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(468);i(469);var o=function(){function e(){this.controller=n.ApisCtrl,this.template=i(470),this.controllerAs="apisCtrl",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Connections}]}}return e}();t.Apis=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.apis,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(114),o=i(7),s=i(58),a=i(10),l=function(){function e(e,t,i,r,l,c){var u=this;this.$location=e,this.$scope=t,this.apisclient=i,this.clientResources=r,this.sessionService=l,this.urlService=c,this.backButton={url:this.urlService.connectionsRoute()},this.statusAlert={type:a.AlertType.None,message:"",options:{}},s.updateConnectorHideKey(this.apisclient,this.sessionService,this.$location.search()[s.QueryParameters.AddConnectorHideKey],s.UpdateConnectorHideKeyAction.Add),s.updateConnectorHideKey(this.apisclient,this.sessionService,this.$location.search()[s.QueryParameters.RemoveConnectorHideKey],s.UpdateConnectorHideKeyAction.Remove),this.apiList={id:"apis",apis:[],apiType:n.ApiType.Default,markedForDeletion:[],onLoading:!1,hideCommandsInDropDown:!0,statusAlert:this.statusAlert},this.spinner={size:o.SpinnerSize.Large,show:!0,local:o.SpinnerPosition.Local};var p=this.apisclient.query(t);p.$watch(this.$scope,function(){u.apiList.loaded=!0,u.apiList.apis=p,u.spinner.show=!1})}return e.prototype.onAddConnection=function(){this.spinner.show=this.apiList.onLoading},e.$inject=[r.default.services.$location,r.default.services.$scope,r.default.services.apisClient,r.default.services.clientResources,r.default.services.session,r.default.services.url],e}();t.ApisCtrl=l},function(e,t){},function(e,t){e.exports='<div class="subsection-manage"> <heading label="apisCtrl.clientResources.Manage.Connections.AvailableConnections" back="apisCtrl.backButton" ng-hide="apisCtrl.spinner.show"></heading> <alert class="sticky-header" model="apisCtrl.statusAlert"></alert> <div class="row top-align c-table" ng-hide="apisCtrl.spinner.show"> <div class="column"> <api-list model="apisCtrl.apiList" on-add-connection="apisCtrl.onAddConnection()"></api-list> </div> </div> <spinner model="apisCtrl.spinner"></spinner> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(31),o=i(5),s=function(){function e(e,t,i,r,s,a){var l=this;this.$window=e,this.$locationService=t,this.appSettings=i,this.clientResources=r,this.environmentService=s,this.urlService=a,this.TabNames={received:"received",sent:"sent",history:"history"},this.selectedTab=this.$locationService.path().replace(n.getApprovalsBaseUrl()+"/","").split("/")[0],this.tabs={tabSelected:this.selectedTab,tabsInfo:[{tabHeader:this.clientResources.Approvals.Tabs.Received,tabName:this.TabNames.received,href:this.urlService.manageApprovalRouteWithEnvironment(this.environmentService.getCurrentEnvironmentName(),n.getApprovalsReceivedUrl()),eventName:"ApprovalsReceivedTabClicked"},{tabHeader:this.clientResources.Approvals.Tabs.Sent,tabName:this.TabNames.sent,href:this.urlService.manageApprovalRouteWithEnvironment(this.environmentService.getCurrentEnvironmentName(),n.getApprovalsSentUrl()),eventName:"ApprovalsSentTabClicked"}]},this.appSettings.isWidgetPage||(this.headingLinks=[{label:this.clientResources.Approvals.CreateApprovalFlow,action:function(){l.$window.open(l.urlService.approvalsServiceRoute(),"_self")},image:o.default.templateNew}])}return e.$inject=[r.default.services.$window,r.default.services.$location,r.default.services.appSettings,r.default.services.clientResources,r.default.services.environment,r.default.services.url,r.default.services.navigation],e}();t.ApprovalCenterCtrl=s},function(e,t){},function(e,t){e.exports='<div class="approval-center-content"> <heading tabs="approvalCenterCtrl.tabs" links="approvalCenterCtrl.headingLinks"></heading> <section> <div ng-if="approvalCenterCtrl.selectedTab === approvalCenterCtrl.TabNames.received"> <received-tab></received-tab> </div> <div ng-if="approvalCenterCtrl.selectedTab === approvalCenterCtrl.TabNames.sent"> <sent-tab></sent-tab> </div> </section> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(475);i(476);var o=function(){function e(){this.controller=n.CustomApisCtrl,this.template=i(477),this.controllerAs="customApisCtrl",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.CustomApis}]}}return e}();t.CustomApis=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.apis,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(8),o=i(114),s=i(28),a=i(7),l=i(31),c=i(29),u=i(3),p=i(169),d=i(10),g=function(){function e(e,t,i,r,n,s,g,m,f,h,v,y){var w=this;this.$q=e,this.$scope=t,this.apisclient=i,this.appSettings=r,this.clientResources=n,this.loggingService=s,this.navigationService=g,this.policiesService=m,this.promiseHelperService=f,this.sessionService=h,this.trialDialog=v,this.urlService=y,this.customConnectorDialogModel={},this.backUrl=this.urlService.connectionsRoute(),this.newCustomConnectorUrl=l.getNewCustomConnectorGeneralUrl(),this.showHeaderSpinner=!1,this.statusAlert={type:d.AlertType.None,message:"",options:{}},this.onClickUpdate=function(e,t){w.customConnectorDialogModel={api:t,dialogMode:e,show:!0}},this.trialDialog.tryBlockMSA(),this.headingLinks=[{label:this.clientResources.Manage.CustomConnection.Create.Api.button,action:function(){return w.onCreateOrUpdateCustomApi()},svgId:"glyph-create",eventName:"CreateCustomApiButtonClicked"}],this.dropdown={label:this.clientResources.Manage.CustomConnection.Create.Api.button,glyph:"glyph-create"},this.dropdownCommands=[{text:this.clientResources.Manage.CustomApi.Create.FromBlank.MenuLabel,click:function(){w.customConnectorDialogModel={dialogMode:p.DialogMode.Blank,show:!0}}},{text:this.clientResources.Manage.CustomApi.Create.FromOpenAPIFile.MenuLabel,click:function(){w.customConnectorDialogModel={dialogMode:p.DialogMode.OpenApiFile,show:!0}}},{text:this.clientResources.Manage.CustomApi.Create.FromOpenAPIUrl.MenuLabel,click:function(){w.customConnectorDialogModel={dialogMode:p.DialogMode.OpenApiUrl,show:!0}}},{text:this.clientResources.Manage.CustomApi.Create.FromPostman.MenuLabel,click:function(){w.customConnectorDialogModel={dialogMode:p.DialogMode.Postman,show:!0}}}],this.customApiList={id:"customApis",apis:[],apiType:o.ApiType.Custom,markedForDeletion:[],onLoading:!1,hideCommandsInDropDown:!1,statusAlert:this.statusAlert},this.spinner={size:a.SpinnerSize.Large,show:!0,local:a.SpinnerPosition.Local};var C=this.loggingService.profilePageStart(c.ProfilingEventNames.myCustomApisLoadStart),S=this.apisclient.query(t);this.shouldShowFreePlanDialogPromise=this.policiesService.checkShouldShowFreePlanDialog(),S.$watch(t,function(e){w.loggingService.profilePageEnd(C,c.ProfilingEventNames.myCustomApisLoadEnd,{status:u.Status.Success}),w.customApiList.apis=w.getCustomApisNotMarkedForDeletion(S),w.customApiList.loaded=!0,w.spinner.show=!1})}return e.prototype.onCreateOrUpdateCustomApi=function(e){var t=this;if(e)return void this.navigationService.navigate(l.getEditCustomConnectorGeneralUrl(e.name));var i=document.referrer||"/";if(this.policiesService.shouldShowUpgradeToProDialog())return void this.trialDialog.showUpgradeToProRequiredDialog(function(){window.location.assign(i)});this.showHeaderSpinner=!0,this.userHasCreatedMoreThanOneCustomApi.then(function(e){e?t.shouldShowFreePlanDialogPromise.then(function(e){t.showHeaderSpinner=!1,e?t.trialDialog.showStartFreeTrialDialog(function(e){e&&t.navigationService.navigate(t.newCustomConnectorUrl)}):t.navigationService.navigate(t.newCustomConnectorUrl)}):(t.showHeaderSpinner=!1,t.navigationService.navigate(t.newCustomConnectorUrl))})},e.prototype.onAddConnection=function(){this.spinner.show=this.customApiList.onLoading},Object.defineProperty(e.prototype,"userHasCreatedMoreThanOneCustomApi",{get:function(){var e=this;return this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(t){return e.customApiList.apis.filter(function(i){return i.properties&&i.properties.createdBy&&n.equalsIgnoreCase(i.properties.createdBy.id,t.userInfo.uniqueId)&&!e.isMarkedForDeletion(i)}).length>0})},enumerable:!0,configurable:!0}),e.prototype.getCustomApisNotMarkedForDeletion=function(e){var t=this;return e.filter(function(e){return s.isApiCustom(e)&&!t.isMarkedForDeletion(e)}).sort(function(e,t){return e.properties.displayName>t.properties.displayName?1:-1})},e.prototype.isMarkedForDeletion=function(e){return this.customApiList.markedForDeletion.filter(function(t){return t.id===e.id}).length>0},e.$inject=[r.default.services.$q,r.default.services.$scope,r.default.services.apisClient,r.default.services.appSettings,r.default.services.clientResources,r.default.services.logging,r.default.services.navigation,r.default.services.policies,r.default.services.promiseHelperService,r.default.services.session,r.default.services.trialDialog,r.default.services.url],e}();t.CustomApisCtrl=g},function(e,t){},function(e,t){e.exports='<div class="subsection-manage section-manage-apis" ng-if="!customApisCtrl.fullPageErrorModel.isPageErrored"> <heading ng-if="!customApisCtrl.appSettings.featureFlags.enableBlankConnector" label="customApisCtrl.clientResources.Manage.CustomConnections.title" links="customApisCtrl.headingLinks" show-spinner="customApisCtrl.showHeaderSpinner"></heading> <heading ng-if="customApisCtrl.appSettings.featureFlags.enableBlankConnector" label="customApisCtrl.clientResources.Manage.CustomConnections.title" dropdown="customApisCtrl.dropdown" dropdown-commands="customApisCtrl.dropdownCommands" show-spinner="customApisCtrl.showHeaderSpinner"></heading> <alert model="customApisCtrl.statusAlert"></alert> <div class="row top-align" ng-show="customApisCtrl.customApiList.loaded && !customApisCtrl.spinner.show"> <div class="column"> <api-list model="customApisCtrl.customApiList" on-add-connection="customApisCtrl.onAddConnection()" on-click-update="customApisCtrl.onClickUpdate(dialogMode, api)"></api-list> </div> </div> <custom-connector-dialog model="customApisCtrl.customConnectorDialogModel" on-continue="customApisCtrl.onCreateOrUpdateCustomApi(api)"></custom-connector-dialog> <spinner model="customApisCtrl.spinner"></spinner> </div> <full-page-error model="customApisCtrl.fullPageErrorModel" ng-if="customApisCtrl.fullPageErrorModel.isPageErrored"></full-page-error>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(28),o=i(33),s=i(6),a=i(7),l=function(){function e(e,t,i,r,s,l,c,u,p,d,g){var m=this;this.$routeParams=e,this.$scope=t,this.$q=i,this.apisClient=r,this.clientResources=s,this.connectionsClient=l,this.dateTimeService=c,this.navigationService=u,this.telemetryService=p,this.connectionHelperService=d,this.urlService=g,this.spinner={size:a.SpinnerSize.Large,show:!0,local:a.SpinnerPosition.Local},this.backButton={url:this.urlService.connectionsRoute()},this.isDeleting=!1,this.apiName=e.apiName,this.apiId=n.getApiId(this.apiName),this.connectionName=e.connectionName,this.connectionId=o.getConnectionId(this.apiName,this.connectionName);var f=r.get(t,{id:this.apiId}),h=this.connectionsClient.get(t,{id:this.connectionId});this.connection=h,f.$watch(t,function(){m.title=n.getDisplayName(f),m.publisher=n.getPublisher(f,s)}),h.$watch(t,function(){m.createdText=m.dateTimeService.getSimpleDateTimeString(o.getCreatedTime(h)),m.modifiedText=m.dateTimeService.getSimpleDateTimeString(o.getDateModified(h)),m.owner=o.getOwnerDisplayName(h),m.statusText=o.getStatusMessage(h,m.clientResources),m.subtitle=o.getDisplayName(h),m.isAuthError=o.isConnectionInAuthError(h)}),this.$q.all([f.$promise,h.$promise]).finally(function(){return m.spinner.show=!1}),this.headingLinks=[{label:this.clientResources.Manage.Connection.Delete,action:function(){return m.deleteConnection()},svgId:"glyph-delete"}]}return e.prototype.deleteConnection=function(){var e=this;confirm(this.clientResources.Dialogs.ConfirmDelete.DeleteConnectionMessage)&&(this.isDeleting=!0,this.telemetryService.tagEvent(s.TelemetryEventNames.DeleteConnectionFromDetails,{connectionName:this.connectionName}),this.connectionsClient.delete({id:this.connectionId}).then(function(){e.connectionsClient.refreshQuery(),e.navigationService.navigate(e.backButton.url)}).finally(function(){e.isDeleting=!1}),this.headingLinks[0].label=this.clientResources.Manage.Connection.Deleting,this.headingLinks[0].disabled=!0)},e.prototype.reauthorizeConnection=function(){this.connectionHelperService.consent(this.connection)},e.$inject=[r.default.services.$routeParams,r.default.services.$scope,r.default.services.$q,r.default.services.apisClient,r.default.services.clientResources,r.default.services.connectionsClient,r.default.services.dateTime,r.default.services.navigation,r.default.services.telemetry,r.default.services.connectionHelper,r.default.services.url],e}();t.ConnectionCtrl=l},function(e,t){},function(e,t){e.exports='<section class="subsection-manage section-manage-connection-details"> <heading label="connectionCtrl.title" back="connectionCtrl.backButton" links="connectionCtrl.headingLinks" ng-hide="connectionCtrl.spinner.show"></heading> <div class="row"> <h3>{{connectionCtrl.subtitle}}</h3> </div> <div class="row top-align"> <spinner model="connectionCtrl.spinner"></spinner> <div class="column" ng-hide="connectionCtrl.spinner.show"> <div class="form-row"> <label>{{connectionCtrl.clientResources.Manage.Connection.Status}}</label> <span class="form-element">{{connectionCtrl.statusText}}</span> <a ng-show="connectionCtrl.isAuthError" ng-click="connectionCtrl.reauthorizeConnection()" class="text-ellipse c-hyperlink">{{connectionCtrl.clientResources.Manage.Connection.UpdatePassword}}</a> </div> <div class="form-row"> <label>{{connectionCtrl.clientResources.Manage.Connection.Publisher}}</label> <span class="form-element">{{connectionCtrl.publisher}}</span> </div> <div class="form-row"> <label>{{connectionCtrl.clientResources.Manage.Connection.Owner}}</label> <span class="form-element">{{connectionCtrl.owner}}</span> </div> <div class="form-row"> <label>{{connectionCtrl.clientResources.Manage.Connection.Created}}</label> <span class="form-element">{{connectionCtrl.createdText}}</span> </div> <div class="form-row"> <label>{{connectionCtrl.clientResources.Manage.Connection.Modified}}</label> <span class="form-element">{{connectionCtrl.modifiedText}}</span> </div> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(6),o=i(7),s=i(4),a=i(3),l=i(31),c=i(58),u=function(){function e(e,t,i,r,n,u,p,d,g,m){var f=this;this.$location=e,this.$scope=t,this.$q=i,this.apisClient=r,this.connectionsClient=n,this.clientResources=u,this.loggingService=p,this.navigationService=d,this.sessionService=g,this.telemetryService=m,this.spinner={size:o.SpinnerSize.Large,local:o.SpinnerPosition.Local},this.availableConnectionsUrl=l.getAvailableConnectionsUrl(),c.updateConnectorHideKey(this.apisClient,this.sessionService,this.$location.search()[c.QueryParameters.AddConnectorHideKey],c.UpdateConnectorHideKeyAction.Add),c.updateConnectorHideKey(this.apisClient,this.sessionService,this.$location.search()[c.QueryParameters.RemoveConnectorHideKey],c.UpdateConnectorHideKeyAction.Remove),this.headingButtons=[{label:this.clientResources.Manage.Connections.AddConnection,action:function(){return f.onCreate()},svgId:"glyph-create"}],this.connectionList={id:"connections",connections:this.connectionsClient.query(t),markedForDeletion:new Array,apis:this.apisClient.query(t)},this.fullPageErrorModel={isPageErrored:!1,pageTitle:this.clientResources.Manage.Connections.MyConnections},this.spinner.show=!0;var h=this.loggingService.profilePageStart(s.ProfilingEventNames.myConnectionsLoadStart);this.$q.all([this.connectionList.connections.$promise,this.connectionList.apis.$promise]).then(function(){f.connectionList.loaded=!0,f.loggingService.profilePageEnd(h,s.ProfilingEventNames.myConnectionsLoadEnd,{status:a.Status.Success})}).catch(function(e){throw f.loggingService.profilePageEnd(h,s.ProfilingEventNames.myConnectionsLoadEnd,{status:a.inferErrorStatus(e),error:a.parseErrorMessage(e)}),f.loggingService.logError("ConnectionCtrl.MyConnectionsLoad",e),a.showFullPageError(f.fullPageErrorModel,e),e}).finally(function(){f.spinner.show=!1})}return e.prototype.onCreate=function(){this.telemetryService.tagEvent(n.TelemetryEventNames.AddConnectionButtonClicked),this.navigationService.navigate(this.availableConnectionsUrl)},e.$inject=[r.default.services.$location,r.default.services.$scope,r.default.services.$q,r.default.services.apisClient,r.default.services.connectionsClient,r.default.services.clientResources,r.default.services.logging,r.default.services.navigation,r.default.services.session,r.default.services.telemetry],e}();t.ConnectionsCtrl=u},function(e,t){},function(e,t){e.exports='<div class="subsection-manage section-manage-connections"> <div ng-if="!connectionsCtrl.fullPageErrorModel.isPageErrored"> <heading label="connectionsCtrl.clientResources.Manage.Connections.MyConnections" buttons="connectionsCtrl.headingButtons"></heading> <div class="row top-align"> <div class="column"> <spinner model="connectionsCtrl.spinner"></spinner> <connection-list model="connectionsCtrl.connectionList"></connection-list> </div> </div> </div> <full-page-error model="connectionsCtrl.fullPageErrorModel" ng-if="connectionsCtrl.fullPageErrorModel.isPageErrored"></full-page-error> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(485);i(486);var o=function(){function e(){this.controller=n.ConnectionsWidgetCtrl,this.template=i(487),this.controllerAs="connectionsWidgetCtrl",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.Connections}]}}return e}();t.ConnectionsWidget=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.connectionsWidget,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13);i(88);var n=i(4),o=i(116),s=i(0),a={manageCustomApiButtonClicked:"CONNECTIONS_MANAGECUSTOMAPI_CLICKED",manageConnectionGatewayLinkClicked:"CONNECTIONS_MANAGECONNECTION_GATEWAY_CLICKED"},l=function(e){function t(t,i,r,o,s,l,c,u){var p=e.call(this,i,r,s,c,"connections",{container:"powerapps-connections"},{environmentName:o.getCurrentEnvironmentName()},n.ProfilingEventNames.flowConnectionsPageLoadStart,n.ProfilingEventNames.flowConnectionsPageLoadEnd)||this;return p.$routeParams=t,p.$scope=i,p.appSettings=r,p.environmentService=o,p.loggingService=s,p.navigationService=l,p.sessionService=c,p.urlService=u,p.widget.listen(a.manageCustomApiButtonClicked,function(){p.$scope.$apply(function(){p.navigationService.navigate(p.urlService.customApisRoute())})}),p.widget.listen(a.manageConnectionGatewayLinkClicked,function(){p.$scope.$apply(function(){p.navigationService.navigate(p.urlService.gatewaysRoute())})}),p}return r.__extends(t,e),t.$inject=[s.default.services.$routeParams,s.default.services.$scope,s.default.services.appSettings,s.default.services.environment,s.default.services.logging,s.default.services.navigation,s.default.services.session,s.default.services.url],t}(o.PowerAppsWidgetCtrl);t.ConnectionsWidgetCtrl=l},function(e,t){},function(e,t){e.exports='<spinner model="connectionsWidgetCtrl.spinner"></spinner> <div id="powerapps-connections" class="powerapps-connections" ng-show="connectionsWidgetCtrl.contentLoaded"></div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(7),o=i(4),s=i(3),a=function(){function e(e,t,i,r,s,a,l,c,u,p,d,g,m){var f=this;this.$q=e,this.$scope=t,this.apisClient=i,this.appSettings=r,this.clientResources=s,this.environmentService=a,this.gatewaysClient=l,this.loggingService=c,this.planService=u,this.policiesService=p,this.sessionService=d,this.telemetryService=g,this.trialDialog=m,this.spinner={size:n.SpinnerSize.Large,local:n.SpinnerPosition.Local},this.gatewayList={id:"gateways",gateways:this.gatewaysClient.query(t),markedForDeletion:new Array,apis:this.apisClient.query(t)},this.fullPageErrorModel={isPageErrored:!1,pageTitle:this.clientResources.Manage.Gateways.MyGateways},this.showEnvironmentLimitation=this.appSettings.featureFlags.enableEnvironments&&!this.environmentService.isDefaultOrLegacyEnvironment;var h=this.loggingService.profilePageStart(o.ProfilingEventNames.myGatewaysLoadStart);this.policiesService.checkUserCanCreateGateways().then(function(e){f.allowCreate=e&&!f.showEnvironmentLimitation,f.sessionService.isConsumerDomain?f.trialDialog.tryBlockMSA():f.showEnvironmentLimitation||(f.allowCreate||f.trialDialog.showBlockedFeatureStartTrialDialog(function(e){f.allowCreate=e,e||window.location.assign("/")}),f.loadGateways(h)),f.headingLinks=[{label:f.clientResources.Manage.Gateways.AddGateway,eventName:"AddGatewayButtonClicked",disabled:!f.allowCreate,href:f.allowCreate?f.appSettings.gatewayInstallerUrl:void 0,svgId:"glyph-create"}]})}return e.prototype.loadGateways=function(e){var t=this;this.spinner.show=!0,this.$q.all([this.gatewayList.gateways.$promise,this.gatewayList.apis.$promise]).then(function(){t.gatewayList.loaded=!0,t.loggingService.profilePageEnd(e,o.ProfilingEventNames.myGatewaysLoadEnd,{status:s.Status.Success})}).catch(function(i){throw t.loggingService.profilePageEnd(e,o.ProfilingEventNames.myGatewaysLoadEnd,{status:s.inferErrorStatus(i),error:s.parseErrorMessage(i)}),t.loggingService.logError("GatewaysCtrl.MyGatewaysLoad",i),s.showFullPageError(t.fullPageErrorModel,i),i}).finally(function(){t.spinner.show=!1})},e.$inject=[r.default.services.$q,r.default.services.$scope,r.default.services.apisClient,r.default.services.appSettings,r.default.services.clientResources,r.default.services.environment,r.default.services.gatewaysClient,r.default.services.logging,r.default.services.plan,r.default.services.policies,r.default.services.session,r.default.services.telemetry,r.default.services.trialDialog],e}();t.GatewaysCtrl=a},function(e,t){},function(e,t){e.exports='<div class="subsection-manage section-manage-gateways" ng-if="!gatewaysCtrl.fullPageErrorModel.isPageErrored"> <heading label="gatewaysCtrl.clientResources.Manage.Gateways.MyGateways" links="gatewaysCtrl.headingLinks"></heading> <div class="row top-align"> <div class="column" ng-if="!gatewaysCtrl.showEnvironmentLimitation"> <spinner model="gatewaysCtrl.spinner"></spinner> <gateway-list model="gatewaysCtrl.gatewayList"></gateway-list> </div> <div class="column" ng-if="gatewaysCtrl.showEnvironmentLimitation"> <p>{{gatewaysCtrl.clientResources.Manage.Gateways.List.Evironment.Limitation.Message}}</p> </div> </div> </div> <full-page-error model="gatewaysCtrl.fullPageErrorModel" ng-if="gatewaysCtrl.fullPageErrorModel.isPageErrored"></full-page-error>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(89),o=i(7),s=function(){function e(e,t,i,r,s,a,l,c,u){var p=this;this.$routeParams=e,this.$scope=t,this.$q=i,this.clientResources=r,this.gatewaysClient=s,this.dateTimeService=a,this.navigationService=l,this.telemetryService=c,this.urlService=u,this.spinner={size:o.SpinnerSize.Large,show:!0,local:o.SpinnerPosition.Local},this.backButton={url:this.urlService.gatewaysRoute()},this.isDeleting=!1,this.gatewayName=e.gatewayName,this.gateway=this.gatewaysClient.get(t,{id:n.getGatewayId(this.gatewayName)}),this.gateway.$watch(t,function(){p.title=n.getDisplayName(p.gateway),p.statusText=n.getStatusMessage(p.gateway),p.contactInfo=n.getContactInfo(p.gateway),p.description=n.getDescription(p.gateway)}),this.$q.all([this.gateway.$promise]).finally(function(){return p.spinner.show=!1})}return e.$inject=[r.default.services.$routeParams,r.default.services.$scope,r.default.services.$q,r.default.services.clientResources,r.default.services.gatewaysClient,r.default.services.dateTime,r.default.services.navigation,r.default.services.telemetry,r.default.services.url],e}();t.GatewayCtrl=s},function(e,t){},function(e,t){e.exports='<section class="subsection-manage section-manage-gateway-details"> <heading label="gatewayCtrl.title" back="gatewayCtrl.backButton" ng-hide="gatewayCtrl.spinner.show"></heading> <div class="row top-align"> <spinner model="gatewayCtrl.spinner"></spinner> <div class="column" ng-hide="gatewayCtrl.spinner.show"> <div class="form-row"> <label>{{gatewayCtrl.clientResources.Manage.Gateways.Detail.Header.ContactInfo}}</label> <span class="form-element" ng-repeat="contact in gatewayCtrl.contactInfo">{{contact}}</span> </div> <div class="form-row"> <label>{{gatewayCtrl.clientResources.Manage.Gateways.Detail.Header.Description}}</label> <span class="form-element">{{gatewayCtrl.description}}</span> </div> <div class="form-row"> <label>{{gatewayCtrl.clientResources.Manage.Gateways.Detail.Header.Status}}</label> <span class="form-element">{{gatewayCtrl.statusText}}</span> </div> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(28),o=i(33),s=i(117),a=i(20),l=i(7),c=i(10),u=i(3),p=i(6),d=i(38),g=i(1),m=i(89),f=function(){function e(e,t,i,r,o,a,p,d,m,f,h,v,y,w,C){var S=this;this.$location=e,this.$routeParams=t,this.$scope=i,this.$window=r,this.apisClient=o,this.appSettings=a,this.clientResources=p,this.connectionFormService=d,this.connectionHelperService=m,this.environmentService=f,this.gatewaysClient=h,this.loggingService=v,this.navigationService=y,this.telemetryService=w,this.urlService=C,this.statusAlert={type:c.AlertType.None,message:"",options:{}},this.spinner={size:l.SpinnerSize.Large,local:l.SpinnerPosition.Local},this.isSaving=!1,this.backButton={url:this.urlService.availableConnectionsRoute()},this.automaticallyCloseTabOnCreate=this.$location.search().closeOnCreate,this.apiName=t.apiName,this.spinner.show=!0,o.get(this.$scope,{id:n.getApiId(this.apiName)}).$promise.then(function(e){if(S.api=e,S.hasGatewaySupport=S.appSettings.featureFlags.showManageGateways&&n.isApiGatewayCompatible(e),S.isApiConfigurable=n.isApiConfigurable(e),S.isApiConfigurable||S.hasGatewaySupport){S.hasGatewaySupport&&S.populateGatewaySection(),S.title=g.format(p.Manage.Connection.Create.Title,n.getDisplayName(e));var t=S.connectionFormService.createFormItemsFromConnectionParameters(s.FormType.Create,n.getConnectionParameters(e));S.formScope={formItems:t}}else S.navigationService.navigate("/connections/available")}).catch(function(e){S.loggingService.logError("CreateConnectionCtrl.Constructor.GetApi",e),S.statusAlert.type=c.AlertType.Error,S.statusAlert.message=u.parseErrorMessage(e,S.clientResources.Common.SomethingWentWrong)}).finally(function(){S.spinner.show=!1})}return e.prototype.showApiConfigurationForm=function(){return this.isApiConfigurable||this.isUseGateway},e.prototype.populateGatewaySection=function(){var e=this;this.gatewayPickerMessage=this.clientResources.Manage.Connection.Create.GatewayPicker.LoadingMessage,this.availableGateways=this.gatewaysClient.query(this.$scope,a.extendQueryParamsWithEnvironment({$filter:g.format(m.apiFilter,this.api.name)},this.appSettings.featureFlags.enableEnvironments,this.environmentService.getCurrentEnvironmentName())),this.availableGateways.$promise.finally(function(){e.updateGatewayPickerText()})},e.prototype.updateGatewayPickerText=function(){0===this.availableGateways.length?this.gatewayPickerMessage=this.clientResources.Manage.Connection.Create.GatewayPicker.NoGatewayMessage:(this.selectedGateway||(this.selectedGateway=this.availableGateways[0]),this.gatewayPickerMessage="")},e.prototype.getGatewayOptionName=function(e){return e.properties.displayName},Object.defineProperty(e.prototype,"submitButtonText",{get:function(){return this.isSaving?this.clientResources.Manage.Connection.Create.Creating:this.clientResources.Manage.Connection.Create.Create},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisabled",{get:function(){var e=this.showApiConfigurationForm()&&this.connectionForm.$invalid;return this.isUseGateway&&!this.selectedGateway&&(e=!0),this.isSaving||e},enumerable:!0,configurable:!0}),e.prototype.submit=function(){var e=this;this.telemetryService.tagEvent(p.TelemetryEventNames.CreateConfigurableConnection);var t=this.connectionFormService.convertFormItemsToParameterValues(this.formScope.formItems),i=o.createConnectionPutObject(t),r=d.uuid().replace(/-/g,""),n=o.getConnectionId(this.api.name,r);this.isUseGateway&&(t=this.connectionFormService.addGatewayToParameterValues(t,this.selectedGateway,this.api)),this.isSaving=!0,this.statusAlert.type=c.AlertType.None,this.statusAlert.message="",this.connectionHelperService.addConnection(this.api,n,i).then(function(t){return e.connectionHelperService.testConnection(t)}).then(function(){e.navigationService.navigate("/connections"),e.automaticallyCloseTabOnCreate&&e.$window.close()}).catch(function(t){e.loggingService.logError("CreateConnectionCtrl.Submit",t),e.statusAlert.type=c.AlertType.Error,e.statusAlert.message=u.parseErrorMessage(t,e.clientResources.Common.SomethingWentWrong)}).finally(function(){e.isSaving=!1})},e.prototype.cancel=function(){this.navigationService.navigate(this.backButton.url)},e.$inject=[r.default.services.$location,r.default.services.$routeParams,r.default.services.$scope,r.default.services.$window,r.default.services.apisClient,r.default.services.appSettings,r.default.services.clientResources,r.default.services.connectionForm,r.default.services.connectionHelper,r.default.services.environment,r.default.services.gatewaysClient,r.default.services.logging,r.default.services.navigation,r.default.services.telemetry,r.default.services.url],e}();t.CreateConnectionCtrl=f},function(e,t){},function(e,t){e.exports='<div class="subsection-manage context-manage-create-connection"> <heading label="controller.title" back="controller.backButton" ng-hide="controller.spinner.show"></heading> <alert model="controller.statusAlert"></alert> <div class="row top-align"> <div class="column" ng-hide="controller.spinner.show"> <form name="controller.connectionForm" novalidate> <div ng-show="controller.hasGatewaySupport"> <div class="c-checkbox"> <label class="c-label"> <input type="checkbox" ng-model="controller.isUseGateway" checked="checked"/> <span>{{controller.clientResources.Manage.Connection.Create.UseGatewayCheckboxLabel}}</span> </label> </div> </div> <connection-form model="controller.formScope" ng-show="controller.showApiConfigurationForm()"></connection-form> <div ng-show="controller.isUseGateway"> <label class="c-label" for="ddlGatewayPicker">{{controller.clientResources.Manage.Connection.Create.SelectGatewayLabel}}<span class="context-required-text">*</span></label> <div class="c-select"> <select class="form-control" ng-required ng-model="controller.selectedGateway" ng-disabled="controller.availableGateways.length == 0" ng-options="controller.getGatewayOptionName(gateway) for gateway in controller.availableGateways"> <option value="" ng-show="controller.gatewayPickerMessage !== \'\'">{{controller.gatewayPickerMessage}}</option> </select> </div> <label class="c-label"> {{controller.clientResources.Manage.Connection.Create.GatewayInstallerInfo}} <a ng-href="{{controller.appSettings.gatewayInstallerUrl}}" class="c-hyperlink" data-event-name="IntallGatewayFromCreateConnectionClicked"> {{controller.clientResources.Manage.Connection.Create.GatewayInstallerLinkInfo}} </a> </label>  </div> <button class="c-button" ng-click="controller.cancel()" ng-disabled="controller.isSaving">{{controller.clientResources.Manage.Connection.Create.Cancel}}</button> <button type="submit" class="c-button" ng-click="controller.submit()" ng-disabled="controller.isDisabled">{{controller.submitButtonText}}</button> </form> </div> </div> <spinner model="controller.spinner"></spinner> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(498);i(499);var o=function(){function e(){this.template=i(500),this.controller=n.ExportFlowCtrl,this.controllerAs="exportFlowCtrl"}return e}();t.ExportFlow=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.exportFlow,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13);i(88);var n=i(7),o=i(4),s=i(1),a=i(116),l=i(0),c={cancelExportPackageClicked:"CANCEL_EXPORT_PACKAGE_CLICKED"},u=function(e){function t(t,i,r,a,l,u,p,d,g){var m=e.call(this,i,r,u,d,"export",{container:"powerapps-export"},{environmentName:l.getCurrentEnvironmentName(),flowName:t.flowName||null},o.ProfilingEventNames.exportFlowPageLoadStart,o.ProfilingEventNames.exportFlowPageLoadEnd)||this;return m.$routeParams=t,m.$scope=i,m.appSettings=r,m.clientResources=a,m.environmentService=l,m.loggingService=u,m.navigationService=p,m.sessionService=d,m.urlService=g,m.spinner={size:n.SpinnerSize.Large,show:!0,local:n.SpinnerPosition.Local},m.contentLoaded=!1,m.widget.listen(c.cancelExportPackageClicked,function(){m.$scope.$apply(function(){m.navigationService.navigate(m.urlService.flowsRoute())})}),m.widget.callbacks.EXPORT_GET_ENVIRONMENT_DISPLAYNAME=function(e,t){t(null,m.environmentService.getCurrentEnvironmentDisplayName())},m.widget.callbacks.EXPORT_GET_USER_DISPLAYNAME=function(e,t){var i=m.sessionService.getUserInfo().givenName,r=m.sessionService.getUserInfo().familyName;t(null,s.format(m.clientResources.User.Name.Formatting,i,r))},m}return r.__extends(t,e),t.$inject=[l.default.services.$routeParams,l.default.services.$scope,l.default.services.appSettings,l.default.services.clientResources,l.default.services.environment,l.default.services.logging,l.default.services.navigation,l.default.services.session,l.default.services.url],t}(a.PowerAppsWidgetCtrl);t.ExportFlowCtrl=u},function(e,t){},function(e,t){e.exports='<spinner model="exportFlowCtrl.spinner"></spinner> <div id="powerapps-export" class="powerapps-export" ng-show="exportFlowCtrl.contentLoaded"></div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(0),o=i(19),s=i(14),a=i(39),l=i(20),c=i(33),u=i(1),p=i(118),d=i(119),g=i(6),m=i(4),f=i(5),h=i(8),v=i(503),y=i(7),w=i(10),C=i(3),S=i(23),b=i(121),P=i(14),R=i(31),T=i(24),E=i(15),A=i(18),D=i(47),F=i(19),N=i(561);!function(e){e[e.editingFlow=0]="editingFlow",e[e.savingFlow=1]="savingFlow",e[e.savingFlowSucceeded=2]="savingFlowSucceeded",e[e.renderingTestRun=3]="renderingTestRun"}(r||(r={}));var I;!function(e){e[e.newFlowFromBlank=0]="newFlowFromBlank",e[e.newFlowFromTemplate=1]="newFlowFromTemplate",e[e.editExistingFlow=2]="editExistingFlow"}(I||(I={}));var O=function(){function e(e,t,i,n,o,a,l,c,u,p,d,g,v,C,P,R,T,E,A,D,F,I,O,k,M,x,_,U,$,L,j,q){var B=this;if(this.$interval=e,this.$q=t,this.$routeParams=i,this.$sce=n,this.$scope=o,this.$window=a,this.alertService=l,this.algorithms=c,this.apisClient=u,this.appSettings=p,this.clientResources=d,this.connectionsClient=g,this.environmentService=v,this.environmentsClient=C,this.flowConnectionsClient=P,this.flowRunService=R,this.flowRunsClient=T,this.flowsClient=E,this.flowTriggerCallbackUrlClient=A,this.flowTriggerHistoriesClient=D,this.flowTriggersClient=F,this.loggingService=I,this.navigationService=O,this.policiesService=k,this.poll=M,this.sessionService=x,this.storageCacheFactory=_,this.telemetry=U,this.templatesClient=$,this.trialDialogService=L,this.urlService=j,this.isSharedFlow=q,this.spinner={size:y.SpinnerSize.Large,local:y.SpinnerPosition.Local},this.flowDisplayName="",this.flowNameMaxLength=s.FlowNameMaxLength,this.toggleButtonLabel="",this.runNowButtonLabel=this.clientResources.Flow.RunNowButtonLabel,this.closeImage=f.default.close,this.flowPlanError="InvalidPlanForRecurrence",this.servicePrincipalNotProvisionedError="ServicePrincipalNotProvisionedInTenant",this.hasDefinitionLoaded=!1,this.designerRenderingComplete=!1,this.designerContext={},this.statusAlert={type:w.AlertType.None,message:"",options:{}},this.flowRunAction=b.FlowRunAction.None,this.fullPageErrorModel={image:f.default.fullPageErrorCreateEditFlow,isPageErrored:!1,pageTitle:this.clientResources.Flow.Editor.PageTitle,time:new Date},this.isFlowRunnable=!1,this.isFlowRunCompleted=!1,this.runFlowDialog={show:!1,disableDefaultStyles:!0},this.flowInterfaceState=r.editingFlow,this.setCallback=function(e){return e?B.flowTriggerCallbackUrlClient.post({id:N.getFlowTriggerCallbackUrlId(e,S.FlowTriggerName.manual)},{}).then(function(e){var t=e.data.response,i=t&&t.value||"",r=t&&t.method||"",n=t.relativePath;if(n){i=t.basePath,"/"===n.charAt(0)?i+=n:i+="/"+n;var o=t.queries,s="?";Object.keys(o).forEach(function(e){var t=encodeURIComponent(e)+"="+encodeURIComponent(o[e])+"&";s+=t}),s=s.slice(0,-1),i+=s}B.setUpdateCallbacks({manual:{urlTemplate:i,method:r}})}).catch(function(e){return B.$q.reject(e)}):B.$q.resolve()},this.hasHttpRequestTrigger=function(e){if(!e||!e.triggers)return!1;var t=e.triggers,i=[];return Object.keys(t).forEach(function(e){var r=t[e];h.equalsIgnoreCase(r.kind,S.FlowTriggerKind.HTTP)&&h.equalsIgnoreCase(r.type,S.FlowTriggerName.httpRequestTrigger)&&i.push(r)}),i.length>0},this.flowRunCompleted=function(){B.appSettings.featureFlags.enableFlowRunAction&&B.updateFlowRunActionButton(b.FlowRunAction.None)},this.designerReadyDeferred=t.defer(),this.flowName=i.flowName||null,this.galleryName=i.gallery||null,this.templateName=i.template||null,this.backUrl=i.backUrl||null,this.isSharedFlow&&!this.appSettings.featureFlags.enableFlowCoauthoring)return void this.navigationService.navigate(this.urlService.flowsRoute());this.$window.document.title=this.isNewFlow?this.clientResources.PageTitle.CreateFlow:this.clientResources.PageTitle.EditFlow,this.pageLoadStart=this.loggingService.performanceNow(),this.pageEventData={galleryName:this.galleryName,flowName:this.flowName,templateName:this.templateName,isSharedFlow:this.isSharedFlow},this.pageEventCorrelationId=this.loggingService.profilePageStart(m.ProfilingEventNames.flowLoadStart,this.pageEventData,void 0,this.pageLoadStart),this.setInterfaceState(r.editingFlow),this.spinner.show=!0,this.setIsFlowRunnable(this.flowName)}return e.prototype.onInitDesigner=function(){var e=this;if(this.telemetry.tagEvent(g.TelemetryEventNames.DesignerLoad,{fromTemplate:this.templateName||g.TelemetryAttributes.CreateNew}),this.appSettings.featureFlags.enableConnectionCaching&&this.urlService.cameFromTemplateDetailsPage&&this.scenario===I.newFlowFromTemplate){var t=this.storageCacheFactory.Create(c.ConnectionsConstant.storageCacheId);this.cachedConnections=t.get(c.ConnectionsConstant.urlPath),this.cachedConnections&&t.remove(c.ConnectionsConstant.urlPath)}$.extend(this.pageEventData,{usingCachedConnections:!!this.cachedConnections});var i,r,n=this.connectionsClient.query(this.$scope).$promise;this.isSharedFlow?(r=this.flowConnectionsClient.query(this.$scope,{flowName:this.flowName}).$promise,i=this.$q.all([n.then(function(){$.extend(e.pageEventData,{myConnectionsFetchDuration:e.loggingService.performanceNow()-e.pageLoadStart})}),r.then(function(){$.extend(e.pageEventData,{flowConnectionsFetchDuration:e.loggingService.performanceNow()-e.pageLoadStart})})])):(i=this.cachedConnections?this.$q.resolve():n,r=this.$q.resolve([])),this.isFlowLoaded=!1;var s=this.fetchDefinition();s.then(function(){return e.isFlowLoaded=!0}).then(function(){return e.handleRedirectForCoauthoredFlows()});var a,l=this.isNewFlow&&this.trigger&&o.parseOperationId(this.appSettings,this.trigger);a=l?this.apisClient.get(this.$scope,{id:l.apiId}).$promise.then(function(t){return $.extend(e.pageEventData,{apisFetchDuration:e.loggingService.performanceNow()-e.pageLoadStart}),[t]}):s.then(function(t){var i=t.connectionReferences;$.extend(e.pageEventData,{definitionFetchDuration:e.loggingService.performanceNow()-e.pageLoadStart});var r=Object.keys(i||{}).map(function(t){var r=i[t];if(!r)return e.$q.resolve(null);var n=angular.copy(r.apiDefinition||r.api);if(n&&n.properties&&(n.properties.swagger||(n.properties.swagger=r.swagger),n.properties.swagger))return e.$q.resolve(n);var o=r.id||r.api.id;return e.apisClient.get(e.$scope,{id:o}).$promise.catch(function(t){e.loggingService.logError("FlowCtrl.onInitDesigner",t,{apiId:o}),e.$q.resolve(n)})});return e.$q.all(r).then(function(t){return $.extend(e.pageEventData,{apisFetchDuration:e.loggingService.performanceNow()-e.pageLoadStart}),t})}),i.then(function(){$.extend(e.pageEventData,{connectionsFetchDuration:e.loggingService.performanceNow()-e.pageLoadStart})}),this.appSettings.featureFlags.enableConnectionCaching&&!this.cachedConnections&&(this.cachedConnections=this.getCachedArrayFromClient(this.connectionsClient),this.cachedConnections&&(n=this.$q.resolve([])));var u,p,d=this.$q.all([s,a,r,n]).then(function(t){var i=t[0],r=t[1],n=t[2],o=t[3];e.designerReadyDeferred.resolve(),p=i,r=$.grep(r,function(e){return!!e});var s,a;return a=e.appSettings.featureFlags.enableConnectionCaching&&e.cachedConnections?e.cachedConnections:o,s=e.isSharedFlow&&n&&n.length>0&&a?v(a.concat(n),function(e){return e.id}):a,$.extend(e.pageEventData,{myConnectionsPending:!a,flowConnectionsPending:!n}),u={prefetchedData:{connections:s,apis:r},allowCoauthoring:!e.isNewFlow&&e.isSharedFlow,showCalloutHints:e.isNewFlow,flowName:e.flowName,onSaveFlow:function(){e.$scope.$apply(function(){e.save()})}}});return d.then(function(){if(e.definitionSummary=p.definitionSummary,e.trigger&&u&&u.prefetchedData&&u.prefetchedData.apis){var t=u.prefetchedData.apis.filter(function(e){return h.equalsIgnoreCase(e.id,l.apiId)})[0],i=e.getOperationFromApi(t,l.operationName);if(i){var r={id:t.id+"/"+i.operationId,name:i.operationId,type:e.appSettings.processSimpleProviderName+"/apis/apiOperations",properties:{summary:i.summary,api:{id:t.id,displayName:t.properties.displayName}}};return e.designerContext.loadTrigger(r)}throw new E.ClientError(E.ErrorCodes.apiOperationNotFound,e.clientResources.Flow.Error.ApiOperationNotFound,null,{trigger:e.trigger})}return e.designerContext.loadDefinition(p.definition,p.connectionReferences,e.scenario===I.newFlowFromTemplate)}).then(function(){e.designerRenderingComplete=!0,e.hasHttpRequestTrigger(p.definition)&&e.setCallback(e.flowName),e.environmentsClient.checkEnvironmentAccess({environmentName:e.environmentService.getCurrentEnvironmentName()})}).then(function(){e.hasDefinitionLoaded=!0,e.loggingService.profilePageEnd(e.pageEventCorrelationId,m.ProfilingEventNames.flowLoadEnd,$.extend({status:C.Status.Success},e.pageEventData))}).catch(function(t){var i=C.parseErrorCode(t),r=i===C.errorConstants.softDeletedFlowCode,n=C.Status.Abort;throw r||(n=C.inferErrorStatus(t),e.loggingService.logError("FlowCtrl.LoadDefinition",t)),e.loggingService.profilePageEnd(e.pageEventCorrelationId,m.ProfilingEventNames.flowLoadEnd,$.extend({status:n,error:C.parseErrorMessage(t),errorCode:i},e.pageEventData)),e.designerRenderingComplete?e.showErrorMessageInAlert(t):r?(e.alertService.enqueueAlert({message:C.parseErrorMessage(t)}),e.navigationService.navigate(e.urlService.flowsRoute())):C.showFullPageError(e.fullPageErrorModel,t),t}).finally(function(){e.spinner.show=!1}),d},e.prototype.setIsFlowRunnable=function(e){var t=this;if(this.flowName){var i=A.getFlowId(this.flowName),r=this.flowsClient.get(this.$scope,{id:i});r.$promise.then(function(){t.isFlowRunnable=F.isRunnableFlow(r)})}},e.prototype.getOperationFromApi=function(e,t){return e&&e.properties&&e.properties.swagger?T.getOperationFromSwagger(e.properties.swagger,t):null},e.prototype.getCachedArrayFromClient=function(e,t){var i=e.resourceDataSet;return i&&i.peekAtResourceArray&&i.peekAtResourceArray(t)&&i.peekAtResourceArray(t).length&&i.peekAtResourceArray(t).length>=1?i.peekAtResourceArray(t):void 0},e.prototype.handleRedirectForCoauthoredFlows=function(){if(!(this.isNewFlow||this.isSharedFlow||this.templateName||this.galleryName)){var e=A.getFlowId(this.flowName),t=this.flowsClient.get(this.$scope,{id:e});this.appSettings.featureFlags.enableFlowCoauthoring&&o.isCoauthoredFlow(t)&&(this.loggingService.logInfo("FlowCtrl.onInitDesigner","navigating to editing coauthored flow url",{flowName:this.flowName}),this.navigationService.navigate(this.urlService.editSharedFlowRoute({flowName:t.name})))}},e.prototype.fetchDefinition=function(){var e=this.scenario;if(e===I.editExistingFlow)return this.getFlow();if(e===I.newFlowFromTemplate)return this.getTemplate();var t={actions:null,triggers:null};return this.$q.resolve({definition:{$schema:this.appSettings.designer.definitionSchemaUri,contentversion:"1.0.0.0",actions:{},triggers:{},parameters:{},outputs:{}},connectionReferences:{},definitionSummary:t})},Object.defineProperty(e.prototype,"scenario",{get:function(){return this.flowName?I.editExistingFlow:this.templateName&&this.galleryName?I.newFlowFromTemplate:I.newFlowFromBlank},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNewFlow",{get:function(){return this.scenario!==I.editExistingFlow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trigger",{get:function(){return this.$routeParams.trigger||null},enumerable:!0,configurable:!0}),e.prototype.onInitMonitor=function(){this.monitorReadyDeferred.resolve()},e.prototype.onMonitorLoadComplete=function(){},e.prototype.onMonitorLoadError=function(){this.showErrorMessageInAlert(this.monitorModel.monitorLoadError)},e.prototype.getFlow=function(){var e=this,t=A.getFlowId(this.flowName);return this.flowsClient.refresh({id:t}).then(function(){return e.flowsClient.get(e.$scope,{id:t}).$promise}).then(function(t){if(t)return e.flowDisplayName=t.properties&&t.properties.displayName||"",e.originalConnectionReferences=t.properties&&t.properties.connectionReferences,{definition:d.toDesignerFlowDefinition(t.properties.definition),connectionReferences:t.properties.connectionReferences,definitionSummary:t.properties.definitionSummary};throw new E.ClientError(E.ErrorCodes.flowNotFound,e.clientResources.Flow.Error.FlowNotFound,null,{flowName:e.flowName})})},e.prototype.getTemplate=function(){var e=this,t=D.getTemplateId(this.galleryName,this.templateName);return this.templatesClient.get(this.$scope,{id:t}).$promise.then(function(t){if(t){e.flowDisplayName=t.properties&&t.properties.displayName||"";try{return{definition:p.replaceParameterValues(t.properties.definition,e.$routeParams),connectionReferences:o.getMergedConnectionReferencesFromRouteParams(t.properties.connectionReferences,e.$routeParams),definitionSummary:t.properties.definitionSummary}}catch(t){e.loggingService.logError("FlowCtrl.GetTemplate",t)}return{definition:t.properties.definition,connectionReferences:t.properties.connectionReferences,definitionSummary:t.properties.definitionSummary}}throw new E.ClientError(E.ErrorCodes.templateNotFoundError,u.format(e.clientResources.Manage.Flows.Template.NotFound,e.templateName,e.galleryName),null,{galleryName:e.galleryName,templateName:e.templateName})})},e.prototype.validateFlowFrequency=function(e){var t=this,i=this.$q.defer();return this.policiesService.checkFlowFrequencyIsAllowed(e).then(function(r){r?i.resolve(e):i.reject({code:t.flowPlanError})}),i.promise},e.prototype.save=function(){var e=this,t=this.loggingService.profileStart(m.ProfilingEventNames.saveFlowStart);this.setInterfaceState(r.savingFlow),this.flowRunAction=b.FlowRunAction.None;var i=this.isNewFlow;this.designerReadyDeferred.promise.then(function(){return o.validateFlowDisplayName(e.flowDisplayName,e.clientResources,i)}).then(function(){return e.getFlowFromDesigner()}).then(function(t){return e.validateFlowFrequency(t)}).then(function(t){return e.saveOrUpdateFlow(t)}).then(function(t){return t.data&&t.data.name&&t.data.properties&&t.data.properties.definition&&e.hasHttpRequestTrigger(t.data.properties.definition)?e.setCallback(t.data.name).then(function(){return e.$q.resolve(t)}):e.$q.resolve(t)}).then(function(t){return e.flowName=t.data.name,e.flowDisplayName=t.data.properties&&t.data.properties.displayName||"",i?e.telemetry.tagEvent(g.TelemetryEventNames.CreateFlowCompleted,{status:g.TelemetryEventStatus.succeeded,fromTemplate:e.templateName||g.TelemetryAttributes.CreateNew},{flowName:e.flowName}):e.telemetry.tagEvent(g.TelemetryEventNames.UpdateFlowCompleted,{status:g.TelemetryEventStatus.succeeded},{flowName:e.flowName}),t.data}).then(function(t){return e.refreshFlowsClient(),e.isSharedFlow&&e.flowConnectionsClient.refreshQuery(),e.flowData=t,t}).then(function(r){e.loggingService.profileEnd(t,m.ProfilingEventNames.saveFlowEnd,{flowName:e.flowName,status:C.Status.Success}),e.isFlowRunnable=F.isRunnableFlow(r),e.saveFlowSucceededState(r,i)}).catch(function(i){if(e.setInterfaceState(r.editingFlow),h.equalsIgnoreCase(i.code,a.DESIGNER_INVALID_SKU_ERROR_CODE))return e.showAlert(w.AlertType.Error,u.format(e.clientResources.Plans.InvalidRecurrenceErrorFormatting,e.policiesService.getMaxFlowFrequencyInSeconds()),"",null,{url:e.urlService.pricingRoute(),text:e.clientResources.Common.LearnMore});if(h.equalsIgnoreCase(i.code,e.flowPlanError))return e.sessionService.isConsumerDomain?e.trialDialogService.showRecurrenceUpgradeToProRequiredDialog():e.trialDialogService.showRecurrenceStartTrialDialog(function(t){t&&e.save()});var n=C.parseErrorMessage(i,e.clientResources.Common.SomethingWentWrong);if(e.loggingService.profileEnd(t,m.ProfilingEventNames.saveFlowEnd,{flowName:e.flowName,status:C.Status.Failure,error:n}),e.loggingService.logError("FlowCtrl.Save",i),e.isNewFlow?e.telemetry.tagEvent(g.TelemetryEventNames.CreateFlowCompleted,{status:g.TelemetryEventStatus.failed,error:n,fromTemplate:e.templateName||g.TelemetryAttributes.CreateNew}):e.telemetry.tagEvent(g.TelemetryEventNames.UpdateFlowCompleted,{status:g.TelemetryEventStatus.failed,error:n},{flowName:e.flowName}),i&&i.data&&i.data.error&&h.equalsIgnoreCase(i.data.error.code,e.servicePrincipalNotProvisionedError))return e.sessionService.isConsumerDomain?e.trialDialogService.showUpgradeToProRequiredDialog():e.trialDialogService.showOfficePortalSignupDialog(function(t){t&&e.onOfficePortalSignupClicked()});e.showErrorMessageInAlert(i)})},e.prototype.onDone=function(){this.appSettings.isWidgetPage?this.returnToWidgetStartPage():this.navigationService.navigate(this.urlService.redirectRouteAfterSavingFlow({flowName:this.flowName,isSharedFlow:this.isSharedFlow}))},e.prototype.onSave=function(){this.isTesting()?(this.telemetry.tagEvent(g.TelemetryEventNames.EditFlowClicked),this.setInterfaceState(r.editingFlow)):(this.telemetry.tagEvent(g.TelemetryEventNames.SaveFlowClicked),this.save())},e.prototype.onRunNow=function(){this.flowId=A.getFlowId(this.flowName),this.runFlowDialog.show=!0},e.prototype.onFlowDesignerClose=function(){this.telemetry.tagEvent(g.TelemetryEventNames.FlowDesignerCloseClicked),this.onGoBack()},e.prototype.onGoBack=function(){this.appSettings.isWidgetPage?this.returnToWidgetStartPage():this.backUrl?this.navigationService.navigate(this.backUrl):this.isSharedFlow?this.navigationService.navigate(this.urlService.sharedFlowsRoute()):this.navigationService.navigate(this.urlService.flowsRoute())},e.prototype.returnToWidgetStartPage=function(){u.equals(this.appSettings.widgetInfo.widgetType,P.WidgetType.templates,!0)?this.$window.open(this.urlService.newTemplateFlowRoute(this.environmentService.getCurrentEnvironmentName()),"_self"):this.navigationService.navigate(this.urlService.flowsRoute())},e.prototype.isSaving=function(){return this.flowInterfaceState===r.savingFlow},e.prototype.isTesting=function(){return this.flowInterfaceState!==r.editingFlow&&this.flowInterfaceState!==r.savingFlow},e.prototype.isMonitorEnabled=function(){return this.flowInterfaceState===r.renderingTestRun},e.prototype.hideRunNowButton=function(){return(!this.isTesting()||this.isMonitorEnabled())&&!this.isFlowRunCompleted},e.prototype.getFlowFromDesigner=function(e){var t=this,i=this.$q.defer();return this.designerContext.getDefinition().then(function(e){var r={};return e.displayName=t.flowDisplayName,e.connectionReferences=t.getConnectionReferences(e.connectionReferences),e.definition=d.toPortalFlowDefinition(e.definition),r.properties=e,i.resolve(r),i.promise}).catch(function(r){return h.equalsIgnoreCase(r.code,a.DESIGNER_INVALID_SKU_ERROR_CODE)?i.reject(r):(t.loggingService.logError("FlowCtrl.GetFlowFromDesigner",r),e?i.reject(new Error(u.format(e,r.message))):i.reject(new Error(r.message))),i.promise})},e.prototype.saveOrUpdateFlow=function(e){var t,i=this.scenario;return l.extendPropsWithEnvironment(e,this.appSettings.featureFlags.enableEnvironments,this.environmentService.getCurrentEnvironmentName()),i!==I.editExistingFlow?(i===I.newFlowFromTemplate&&(e.properties.templateName=this.templateName),t=this.flowsClient.post({id:A.getNewFlowId()},e)):t=this.flowsClient.patch({id:A.getFlowId(this.flowName)},e),t},e.prototype.refreshFlowsClient=function(){var e=this,t=[];return t.push(this.flowsClient.refresh({id:A.getFlowId(this.flowName)})),t.push(this.flowsClient.refreshQuery(A.getFlowsQueryParams({isPersonal:!0}))),this.$q.all(t).catch(function(t){return e.loggingService.logError("FlowCtrl.RefreshFlowsClient",t)})},e.prototype.getConnectionReferences=function(e){var t=this;return Object.keys(e).forEach(function(i){delete e[i].connectionId,t.originalConnectionReferences&&t.originalConnectionReferences[i]&&(e[i].source=t.originalConnectionReferences[i].source)}),e},e.prototype.showAlert=function(e,t,i,r,n){this.statusAlert.type=e,this.statusAlert.message=t,this.statusAlert.options.title=i,this.statusAlert.options.control=r,this.statusAlert.options.link=n},e.prototype.showAlertWithDoneButton=function(e,t,i,r){var n=this;this.showAlert(e,t,i,{text:this.clientResources.Flow.DoneButtonLabel,className:"glyph-play flow-done",action:function(){return n.onDone()}},r)},e.prototype.hideAlert=function(){this.showAlert(w.AlertType.None,null,null)},e.prototype.setDesignerReadOnlyState=function(e){this.designerContext&&this.designerContext.setReadOnly&&this.designerContext.setReadOnly(e)},e.prototype.setUpdateCallbacks=function(e){this.designerContext&&this.designerContext.updateCallbacksOnSave&&this.designerContext.updateCallbacksOnSave(e)},e.prototype.showErrorMessageInAlert=function(e){this.showAlert(w.AlertType.Error,C.parseErrorMessage(e,this.clientResources.Common.SomethingWentWrong))},e.prototype.showRunStatus=function(e){F.isSuccessful(e)?(this.isFlowRunCompleted=!0,this.showAlertWithDoneButton(w.AlertType.Info,"",this.clientResources.Flow.Status.RunSuccessful)):F.isRunning(e)?this.showAlertWithDoneButton(w.AlertType.Progress,this.clientResources.Flow.Status.Running,""):F.hasFailed(e)&&(this.isFlowRunCompleted=!0,this.showAlertWithDoneButton(w.AlertType.Error,this.clientResources.Flow.Status.RunFailed,""))},e.prototype.setInterfaceState=function(e){switch(this.flowInterfaceState=e,this.isFlowRunCompleted=!1,e){default:case r.editingFlow:this.hideAlert(),this.toggleButtonLabel=this.flowName?this.clientResources.Flow.CreateButtonLabel.Update:this.clientResources.Flow.CreateButtonLabel.Create,this.setDesignerReadOnlyState(!1);break;case r.savingFlow:this.showAlert(w.AlertType.Progress,this.clientResources.Flow.Status.Saving),this.toggleButtonLabel=this.flowName?this.clientResources.Flow.CreateButtonLabel.Update:this.clientResources.Flow.CreateButtonLabel.Create,this.setDesignerReadOnlyState(!0);break;case r.savingFlowSucceeded:this.toggleButtonLabel=this.clientResources.Flow.CreateButtonLabel.Edit,this.setDesignerReadOnlyState(!0);break;case r.renderingTestRun:this.toggleButtonLabel=this.clientResources.Flow.CreateButtonLabel.Edit,this.setDesignerReadOnlyState(!1)}},e.prototype.showFlowTriggerPrompt=function(e){var t=this;return this.designerContext.getTriggers().then(function(i){var r,n=!1,o=t.clientResources.Flow.DefaultTriggerHint;i&&i[0]&&(n=F.isRecurrenceTrigger(i[0]),i[0].hint&&(o=i[0].hint)),n||(r=u.format(t.clientResources.Flow.TriggerPrompt,o)),t.showAlertWithDoneButton(w.AlertType.Info,r,e?t.clientResources.Flow.Status.Created.WaitingForRun:t.clientResources.Flow.Status.Updated.WaitingForRun)})},e.prototype.saveFlowSucceededState=function(e,t){var i=this;this.setInterfaceState(r.savingFlowSucceeded),F.isDisabled(e)?this.showAlertWithDoneButton(w.AlertType.Warning,t?this.clientResources.Flow.Status.Created.ViolatesPolicy:this.clientResources.Flow.Status.Updated.ViolatesPolicy,"",C.dlpViolationLink):F.isStarted(e)?this.showFlowTriggerPrompt(t).then(function(){return i.waitForNewFlowRun(e)}).then(function(e){return i.renderTestRunState(e),i.updateFlowRunActionButton(b.FlowRunAction.Cancel),i.flowRunService.waitForFlowRunToComplete(i.$scope,e,i.monitorContext,i.flowRunCompleted)}).then(function(e){return i.showRunStatus(e)}).catch(function(e){i.loggingService.logError("FlowCtrl.saveFlowSucceededState",e),e.code&&h.equalsIgnoreCase(e.code,E.ErrorCodes.operationCanceled)||i.showErrorMessageInAlert(e)}):this.showAlertWithDoneButton(w.AlertType.Info,"",t?this.clientResources.Flow.Status.Created.WaitingForRun:this.clientResources.Flow.Status.Updated.WaitingForRun)},e.prototype.renderTestRunState=function(e){this.monitorContext={},this.monitorReadyDeferred=this.$q.defer(),this.monitorModel={flowRunId:this.flowName+"/runs/"+e.name,monitorLoadError:""},this.showRunStatus(e),this.setInterfaceState(r.renderingTestRun)},e.prototype.onFlowRunCancelClick=function(){var e=this;confirm(this.clientResources.Dialogs.ConfirmFlowRunCancelMessage)&&this.flowRunService.cancelFlowRun(this.flowName,this.flowRunName).then(function(){e.showAlertWithDoneButton(w.AlertType.Info,"",e.clientResources.FlowRun.CancelText),e.setInterfaceState(r.savingFlowSucceeded)}).catch(function(t){e.loggingService.logError("FlowRunCtrl.FlowRunCancel",t),e.showErrorMessageInAlert(t)})},e.prototype.updateFlowRunActionButton=function(e){this.flowRunAction=e},e.prototype.showFlowRunActionButton=function(){return this.appSettings.featureFlags.enableFlowRunAction&&this.flowRunAction!==b.FlowRunAction.None},e.prototype.isFlowRunActionCancel=function(){return this.appSettings.featureFlags.enableFlowRunAction&&this.flowRunAction===b.FlowRunAction.Cancel},e.prototype.shouldShowSaveButton=function(){return this.designerContext.areAllConnectionReferencesValid&&this.hasDefinitionLoaded},e.prototype.onOfficePortalSignupClicked=function(){$("#officePortalSignup").submit()},Object.defineProperty(e.prototype,"officePortalSignupAction",{get:function(){return this.$sce.trustAsResourceUrl(u.format("{0}&pi=1&ru={1}",this.appSettings.signUpRedirectUrl,this.urlService.manageApprovalRouteWithEnvironment(this.environmentService.getCurrentEnvironmentName(),R.getApprovalsReceivedUrl())))},enumerable:!0,configurable:!0}),e.prototype.waitForNewFlowRun=function(e){var t=this,i=this.$q.defer(),r=e.properties.lastModifiedTime?new Date(e.properties.lastModifiedTime).getTime():Date.now(),n=this.appSettings.flowTesting,o=n.pollingInterval,s=n.pollingTimeout,a=n.pollRetryCount,l=n.pollRetryDelay,c=this.poll({poll:function(){return t.algorithms.asyncRetry(a,l,function(){return t.designerContext.getTriggers().then(function(e){var n=t.$q.defer();if(e&&e[0]&&e[0].type&&u.equals(e[0].type,"apiconnection")){var o={flowName:t.flowName,triggerName:e[0].name};t.flowTriggersClient.run(o).then(function(){n.resolve()}).catch(function(e){n.reject(e)})}else n.resolve();n.promise.then(function(){t.flowTriggerName=e[0].name;var n=t.flowTriggerHistoriesClient.query(t.$scope,{flowName:t.flowName,flowTriggerName:t.flowTriggerName});n.$refresh().then(function(){if(t.isTesting()){var e=n.filter(function(e){return F.hasFailed(e)&&new Date(e.properties.startTime).getTime()>r});if(e.length>0)t.telemetry.tagEvent(g.TelemetryEventNames.TestFlowWaitForRun,{status:g.TelemetryEventStatus.succeeded},{flowName:t.flowName}),i.resolve(e[0]);else{var o=n.filter(function(e){return F.isSuccessful(e)&&new Date(e.properties.startTime).getTime()>r&&void 0!==e.properties.run});if(o.length>0){var s=o[0].properties.run;t.flowRunName=s.name,t.telemetry.tagEvent(g.TelemetryEventNames.TestFlowWaitForRun,{status:g.TelemetryEventStatus.succeeded},{flowName:t.flowName}),i.resolve(s)}}}else t.telemetry.tagEvent(g.TelemetryEventNames.TestFlowWaitForRun,{status:g.TelemetryEventStatus.canceled},{flowName:t.flowName}),i.reject(new E.ClientError(E.ErrorCodes.operationCanceled,"the user exited test mode",null))})})})}).catch(function(e){t.telemetry.tagEvent(g.TelemetryEventNames.TestFlowWaitForRun,{status:g.TelemetryEventStatus.failed},{flowName:t.flowName,error:e}),C.inferErrorStatus(e)===C.Status.Abort?t.loggingService.logWarning("FlowCtrl.WaitForNewFlowRun",C.parseErrorMessage(e),e):t.loggingService.logError("FlowCtrl.WaitForNewFlowRun",e),i.reject(e)})},interval:o}),p=this.$interval(function(){t.telemetry.tagEvent(g.TelemetryEventNames.TestFlowWaitForRun,{status:g.TelemetryEventStatus.timedout},{flowName:t.flowName}),i.reject(new Error(t.clientResources.Flow.Error.TimeoutWaitingForRun))},s,1);return i.promise.finally(function(){t.$interval.cancel(p),c.destroy()}),c.start(this.$scope),i.promise},e.$inject=[n.default.services.$interval,n.default.services.$q,n.default.services.$routeParams,n.default.services.$sce,n.default.services.$scope,n.default.services.$window,n.default.services.alertService,n.default.services.algorithms,n.default.services.apisClient,n.default.services.appSettings,n.default.services.clientResources,n.default.services.connectionsClient,n.default.services.environment,n.default.services.environmentsClient,n.default.services.flowConnectionsClient,n.default.services.flowRun,n.default.services.flowRunsClient,n.default.services.flowsClient,n.default.services.flowTriggerCallbackUrlClient,n.default.services.flowTriggerHistoriesClient,n.default.services.flowTriggersClient,n.default.services.logging,n.default.services.navigation,n.default.services.policies,n.default.services.poll,n.default.services.session,n.default.services.storageCacheFactory,n.default.services.telemetry,n.default.services.templatesClient,n.default.services.trialDialog,n.default.services.url,S.isShared],e}();t.FlowCtrl=O},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowInstallationStatus={broken:"Broken",installed:"Installed",notApplicable:"NotApplicable",notSpecified:"NotSpecified",uninstalled:"Uninstalled"},t.FlowUserTypes={owner:"Owner",user:"User",notSpecified:"NotSpecified"},t.FlowSharingTypes={coauthor:"Coauthor"}},function(e,t,i){function r(e,t){return e&&e.length?o(e,n(t)):[]}var n=i(504),o=i(547);e.exports=r},function(e,t,i){function r(e){var t=typeof e;return"function"==t?e:null==e?s:"object"==t?a(e)?o(e[0],e[1]):n(e):l(e)}var n=i(505),o=i(536),s=i(544),a=i(52),l=i(545);e.exports=r},function(e,t,i){function r(e){var t=o(e);if(1==t.length&&t[0][2]){var i=t[0][0],r=t[0][1];return function(e){return null!=e&&(e[i]===r&&(void 0!==r||i in Object(e)))}}return function(i){return i===e||n(i,e,t)}}var n=i(506),o=i(532);e.exports=r},function(e,t,i){function r(e,t,i,r){var l=i.length,c=l,u=!r;if(null==e)return!c;for(e=Object(e);l--;){var p=i[l];if(u&&p[2]?p[1]!==e[p[0]]:!(p[0]in e))return!1}for(;++l<c;){p=i[l];var d=p[0],g=e[d],m=p[1];if(u&&p[2]){if(void 0===g&&!(d in e))return!1}else{var f=new n,h=r?r(g,m,d,e,t,f):void 0;if(!(void 0===h?o(m,g,r,s|a,f):h))return!1}}return!0}var n=i(178),o=i(186),s=1,a=2;e.exports=r},function(e,t){function i(){this.__data__={array:[],map:null}}e.exports=i},function(e,t,i){function r(e){var t=this.__data__,i=t.array;return i?n(i,e):t.map.delete(e)}var n=i(179);e.exports=r},function(e,t,i){function r(e){var t=this.__data__,i=t.array;return i?n(i,e):t.map.get(e)}var n=i(180);e.exports=r},function(e,t,i){function r(e){var t=this.__data__,i=t.array;return i?n(i,e):t.map.has(e)}var n=i(181);e.exports=r},function(e,t,i){function r(e,t){var i=this.__data__,r=i.array;r&&(r.length<s-1?o(r,e,t):(i.array=null,i.map=new n(r)));var a=i.map;return a&&a.set(e,t),this}var n=i(182),o=i(185),s=200;e.exports=r},function(e,t,i){function r(){this.__data__={hash:new n,map:o?new o:[],string:new n}}var n=i(513),o=i(59);e.exports=r},function(e,t,i){function r(){}var n=i(91),o=Object.prototype;r.prototype=n?n(null):o,e.exports=r},function(e,t,i){function r(e){return null!=e&&(n(e)?d.test(u.call(e)):s(e)&&(o(e)?d:l).test(e))}var n=i(80),o=i(183),s=i(51),a=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,c=Object.prototype,u=Function.prototype.toString,p=c.hasOwnProperty,d=RegExp("^"+u.call(p).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},function(e,t,i){function r(e){var t=this.__data__;return a(e)?s("string"==typeof e?t.string:t.hash,e):n?t.map.delete(e):o(t.map,e)}var n=i(59),o=i(179),s=i(516),a=i(60);e.exports=r},function(e,t,i){function r(e,t){return n(e,t)&&delete e[t]}var n=i(184);e.exports=r},function(e,t,i){function r(e){var t=this.__data__;return a(e)?s("string"==typeof e?t.string:t.hash,e):n?t.map.get(e):o(t.map,e)}var n=i(59),o=i(180),s=i(518),a=i(60);e.exports=r},function(e,t,i){function r(e,t){if(n){var i=e[t];return i===o?void 0:i}return a.call(e,t)?e[t]:void 0}var n=i(91),o="__lodash_hash_undefined__",s=Object.prototype,a=s.hasOwnProperty;e.exports=r},function(e,t,i){function r(e){var t=this.__data__;return a(e)?s("string"==typeof e?t.string:t.hash,e):n?t.map.has(e):o(t.map,e)}var n=i(59),o=i(181),s=i(184),a=i(60);e.exports=r},function(e,t,i){function r(e,t){var i=this.__data__;return a(e)?s("string"==typeof e?i.string:i.hash,e,t):n?i.map.set(e,t):o(i.map,e,t),this}var n=i(59),o=i(185),s=i(521),a=i(60);e.exports=r},function(e,t,i){function r(e,t,i){e[t]=n&&void 0===i?o:i}var n=i(91),o="__lodash_hash_undefined__";e.exports=r},function(e,t,i){function r(e,t,i,r,h,y){var w=c(e),C=c(t),S=m,b=m;w||(S=l(e),S==g?S=f:S!=f&&(w=p(e))),C||(b=l(t),b==g?b=f:b!=f&&(C=p(t)));var P=S==f&&!u(e),R=b==f&&!u(t),T=S==b;if(T&&!w&&!P)return s(e,t,S,i,r,h);if(!(h&d)){var E=P&&v.call(e,"__wrapped__"),A=R&&v.call(t,"__wrapped__");if(E||A)return i(E?e.value():e,A?t.value():t,r,h,y)}return!!T&&(y||(y=new n),(w?o:a)(e,t,i,r,h,y))}var n=i(178),o=i(523),s=i(525),a=i(528),l=i(529),c=i(52),u=i(183),p=i(531),d=2,g="[object Arguments]",m="[object Array]",f="[object Object]",h=Object.prototype,v=h.hasOwnProperty;e.exports=r},function(e,t,i){function r(e,t,i,r,a,l){var c=-1,u=a&s,p=a&o,d=e.length,g=t.length;if(d!=g&&!(u&&g>d))return!1;var m=l.get(e);if(m)return m==t;var f=!0;for(l.set(e,t);++c<d;){var h=e[c],v=t[c];if(r)var y=u?r(v,h,c,t,e,l):r(h,v,c,e,t,l);if(void 0!==y){if(y)continue;f=!1;break}if(p){if(!n(t,function(e){return h===e||i(h,e,r,a,l)})){f=!1;break}}else if(h!==v&&!i(h,v,r,a,l)){f=!1;break}}return l.delete(e),f}var n=i(524),o=1,s=2;e.exports=r},function(e,t){function i(e,t){for(var i=-1,r=e.length;++i<r;)if(t(e[i],i,e))return!0;return!1}e.exports=i},function(e,t,i){function r(e,t,i,r,C,b){switch(i){case w:return!(e.byteLength!=t.byteLength||!r(new o(e),new o(t)));case u:case p:return+e==+t;case d:return e.name==t.name&&e.message==t.message;case m:return e!=+e?t!=+t:e==+t;case f:case v:return e==t+"";case g:var P=s;case h:var R=b&c;return P||(P=a),(R||e.size==t.size)&&r(P(e),P(t),C,b|l);case y:return!!n&&S.call(e)==S.call(t)}return!1}var n=i(167),o=i(526),s=i(527),a=i(187),l=1,c=2,u="[object Boolean]",p="[object Date]",d="[object Error]",g="[object Map]",m="[object Number]",f="[object RegExp]",h="[object Set]",v="[object String]",y="[object Symbol]",w="[object ArrayBuffer]",C=n?n.prototype:void 0,S=n?C.valueOf:void 0;e.exports=r},function(e,t,i){var r=i(56),n=r.Uint8Array;e.exports=n},function(e,t){function i(e){var t=-1,i=Array(e.size);return e.forEach(function(e,r){i[++t]=[r,e]}),i}e.exports=i},function(e,t,i){function r(e,t,i,r,a,l){var c=a&s,u=o(e),p=u.length;if(p!=o(t).length&&!c)return!1;for(var d=p;d--;){var g=u[d];if(!(c?g in t:n(t,g)))return!1}var m=l.get(e);if(m)return m==t;var f=!0;l.set(e,t);for(var h=c;++d<p;){g=u[d];var v=e[g],y=t[g];if(r)var w=c?r(y,v,g,t,e,l):r(v,y,g,e,t,l);if(!(void 0===w?v===y||i(v,y,r,a,l):w)){f=!1;break}h||(h="constructor"==g)}if(f&&!h){var C=e.constructor,S=t.constructor;C!=S&&"constructor"in e&&"constructor"in t&&!("function"==typeof C&&C instanceof C&&"function"==typeof S&&S instanceof S)&&(f=!1)}return l.delete(e),f}var n=i(165),o=i(112),s=2;e.exports=r},function(e,t,i){function r(e){return c.call(e)}var n=i(59),o=i(188),s=i(530),a=Object.prototype,l=Function.prototype.toString,c=a.toString,u=n?l.call(n):"",p=o?l.call(o):"",d=s?l.call(s):"";(n&&"[object Map]"!=r(new n)||o&&"[object Set]"!=r(new o)||s&&"[object WeakMap]"!=r(new s))&&(r=function(e){var t=c.call(e),i="[object Object]"==t?e.constructor:null,r="function"==typeof i?l.call(i):"";if(r)switch(r){case u:return"[object Map]";case p:return"[object Set]";case d:return"[object WeakMap]"}return t}),e.exports=r},function(e,t,i){var r=i(92),n=i(56),o=r(n,"WeakMap");e.exports=o},function(e,t,i){function r(e){return o(e)&&n(e.length)&&!!s[l.call(e)]}var n=i(85),o=i(51),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1;var a=Object.prototype,l=a.toString;e.exports=r},function(e,t,i){function r(e){for(var t=o(e),i=t.length;i--;)t[i][2]=n(t[i][1]);return t}var n=i(533),o=i(534);e.exports=r},function(e,t,i){function r(e){return e===e&&!n(e)}var n=i(45);e.exports=r},function(e,t,i){function r(e){return n(e,o(e))}var n=i(535),o=i(112);e.exports=r},function(e,t,i){function r(e,t){return n(t,function(t){return[t,e[t]]})}var n=i(164);e.exports=r},function(e,t,i){function r(e,t){return function(i){var r=o(i,e);return void 0===r&&r===t?s(i,e):n(t,r,void 0,a|l)}}var n=i(186),o=i(189),s=i(538),a=1,l=2;e.exports=r},function(e,t,i){function r(e){var t=[];return n(e).replace(o,function(e,i,r,n){t.push(r?n.replace(s,"$1"):i||e)}),t}var n=i(113),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,s=/\\(\\)?/g;e.exports=r},function(e,t,i){function r(e,t){return o(e,t,n)}var n=i(539),o=i(540);e.exports=r},function(e,t){function i(e,t){return t in Object(e)}e.exports=i},function(e,t,i){function r(e,t,i){if(null==e)return!1;var r=i(e,t);r||l(t)||(t=n(t),null!=(e=d(e,t))&&(t=p(t),r=i(e,t)));var g=e?e.length:void 0;return r||!!g&&c(g)&&a(t,g)&&(s(e)||u(e)||o(e))}var n=i(191),o=i(161),s=i(52),a=i(86),l=i(120),c=i(85),u=i(162),p=i(541),d=i(542);e.exports=r},function(e,t){function i(e){var t=e?e.length:0;return t?e[t-1]:void 0}e.exports=i},function(e,t,i){function r(e,t){return 1==t.length?e:o(e,n(t,0,-1))}var n=i(543),o=i(189);e.exports=r},function(e,t){function i(e,t,i){var r=-1,n=e.length;t<0&&(t=-t>n?0:n+t),i=i>n?n:i,i<0&&(i+=n),n=t>i?0:i-t>>>0,t>>>=0;for(var o=Array(n);++r<n;)o[r]=e[r+t];return o}e.exports=i},function(e,t){function i(e){return e}e.exports=i},function(e,t,i){function r(e){return s(e)?n(e):o(e)}var n=i(157),o=i(546),s=i(120);e.exports=r},function(e,t,i){function r(e){return function(t){return n(t,e)}}var n=i(190);e.exports=r},function(e,t,i){function r(e,t,i){var r=-1,p=o,d=e.length,g=!0,m=[],f=m;if(i)g=!1,p=s;else if(d>=u){var h=t?null:l(e);if(h)return c(h);g=!1,p=a,f=new n}else f=t?[]:m;e:for(;++r<d;){var v=e[r],y=t?t(v):v;if(g&&y===y){for(var w=f.length;w--;)if(f[w]===y)continue e;t&&f.push(y),m.push(v)}else p(f,y,i)||(f!==m&&f.push(y),m.push(v))}return m}var n=i(548),o=i(550),s=i(553),a=i(554),l=i(555),c=i(187),u=200;e.exports=r},function(e,t,i){function r(e){var t=-1,i=e?e.length:0;for(this.__data__=new n;++t<i;)this.push(e[t])}var n=i(182),o=i(549);r.prototype.push=o,e.exports=r},function(e,t,i){function r(e){var t=this.__data__;if(n(e)){var i=t.__data__;("string"==typeof e?i.string:i.hash)[e]=o}else t.set(e,o)}var n=i(60),o="__lodash_hash_undefined__";e.exports=r},function(e,t,i){function r(e,t){return!!e.length&&n(e,t,0)>-1}var n=i(551);e.exports=r},function(e,t,i){function r(e,t,i){if(t!==t)return n(e,i);for(var r=i-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}var n=i(552);e.exports=r},function(e,t){function i(e,t,i){for(var r=e.length,n=t+(i?0:-1);i?n--:++n<r;){var o=e[n];if(o!==o)return n}return-1}e.exports=i},function(e,t){function i(e,t,i){for(var r=-1,n=e.length;++r<n;)if(i(t,e[r]))return!0;return!1}e.exports=i},function(e,t,i){function r(e,t){var i=e.__data__;if(n(t)){var r=i.__data__;return("string"==typeof t?r.string:r.hash)[t]===o}return i.has(t)}var n=i(60),o="__lodash_hash_undefined__";e.exports=r},function(e,t,i){var r=i(188),n=i(556),o=r&&2===new r([1,2]).size?function(e){return new r(e)}:n;e.exports=o},function(e,t){function i(){}e.exports=i},function(e,t,i){var r,n,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};r=[i,t,i(93)],void 0!==(n=function(e,t,i){"use strict";function r(e,t){if(!e)return{};var r=o({},s,t).$refs;switch(Object.keys(r).reduce(n(r),{})[e]){case i.Types.Array:return{items:{},type:i.Types.Array};case i.Types.Object:return{type:i.Types.Object};default:return{}}}function n(e){return function(t,i){var r=e[i].type;return o({},t,(n={},n[i]=r,n));var n}}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.freeze({$refs:{}});t.dereferenceRefSchema=r}.apply(t,r))&&(e.exports=n)},function(e,t,i){var r,n;r=[i,t,i(93),i(122),i(559)],void 0!==(n=function(e,t,i,r,n){"use strict";function o(e,t){return e.enum?e.enum.map(function(e){return{displayName:r.isNullOrUndefined(e)?"":e.toString(),value:e}}):e.type===i.Types.Boolean?t?[{displayName:n.default.BOOLEAN_PARAMETER_DISPLAYNAME_TRUE,value:"true"},{displayName:n.default.BOOLEAN_PARAMETER_DISPLAYNAME_FALSE,value:"false"}]:[{displayName:"",value:""},{displayName:n.default.BOOLEAN_PARAMETER_DISPLAYNAME_TRUE,value:"true"},{displayName:n.default.BOOLEAN_PARAMETER_DISPLAYNAME_FALSE,value:"false"}]:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getEnum=o}.apply(t,r))&&(e.exports=n)},function(e,t){e.exports=resources},function(e,t,i){var r,n,o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};r=[i,t,i(93),i(122),i(193),i(192)],void 0!==(n=function(e,t,i,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){if(void 0===t&&(t={}),this.parameter=e,this.options=t,!e)throw new Error("parameter is required.");if(e.in!==i.ParameterLocations.Body)throw new Error("The value of parameter.in should be '"+i.ParameterLocations.Body+"'.");this.options=o({excludeAdvanced:!1,excludeInternal:!0},t)}return e.prototype.getParameters=function(){switch(this.parameter.schema.type){case i.Types.Array:case i.Types.Boolean:case i.Types.Integer:case i.Types.Null:case i.Types.Number:case i.Types.String:return this._getScalarParameter();case i.Types.Object:return this._getObjectParameters();default:return[]}},e.prototype._getObjectParameters=function(){var e=this.parameter,t=e.schema,i=this._getObjectPropertyParameters(t);return i.length?i:this._getScalarParameter()},e.prototype._getObjectPropertyParameters=function(e){var t=this,n=e.properties||{},o=Object.keys(n),a=r.hasProperty(e,i.ExtensionProperties.DynamicSchema),l=a?this.parameter.name:null;if(o.length||a){return new s.SchemaProcessor({prefix:l,isInputSchema:!0,required:this.parameter.required,excludeAdvanced:this.options.excludeAdvanced,excludeInternal:this.options.excludeInternal}).getSchemaProperties(e).map(function(e){return t._convertSchemaPropertyToInputParameter(e)})}return[]},e.prototype._convertSchemaPropertyToInputParameter=function(e){return o({},e,{in:i.ParameterLocations.Body})},e.prototype._getScalarParameter=function(){var e=this.parameter.schema,t=e.enum;return[o({},this._getParameterDetails(),{enum:t})]},e.prototype._getParameterDetails=function(){var e=this.parameter,t=e.schema,r=e.description,o=t[i.ExtensionProperties.DynamicSchema],s=e[i.ExtensionProperties.DynamicValues],a=e[i.ExtensionProperties.Encode],l=t.format,c=t.items,u=e.name,p=t[i.ExtensionProperties.Permission],d=e[i.ExtensionProperties.SchedulerRecommendation],g=e.required,m=e[i.ExtensionProperties.Summary],f=t.type,h=e[i.ExtensionProperties.Visibility];return{key:n.create([e.in,"$"]),description:r,dynamicSchema:o,dynamicValues:s,encode:a,format:l,itemSchema:c,isNested:!1,in:e.in,name:u,permission:p,recommended:d,required:g,summary:m,type:f,visibility:h}},e}();t.BodyParameterProcessor=a}.apply(t,r))&&(e.exports=n)},function(e,t,i){"use strict";function r(e,t){return o.getAppSettings().featureFlags.enableEnvironments?"/providers/Microsoft.ProcessSimple/environments/"+s.getCurrentEnvironmentName()+"/flows/"+e+"/triggers/"+t+"/listCallbackUrl":"/providers/Microsoft.ProcessSimple/flows/"+e+"/triggers/"+t+"/listCallbackUrl"}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var n=i(0),o=i(9),s=i(20),a=i(14);t.IFlowTriggerCallbackUrlConstant={urlPath:"/providers/Microsoft.ProcessSimple/flows/:flowName/triggers/:flowTriggerName/listCallbackUrl",urlPathWithEnvironments:"/providers/Microsoft.ProcessSimple/environments/"+s.getCurrentEnvironmentName()+"/flows/:flowName/triggers/:flowTriggerName/listCallbackUrl",resourceType:"/providers/Microsoft.ProcessSimple/flows/triggers"},t.getFlowTriggerCallbackUrlId=r,angular.module(n.default.modules.processSimpleData).factory(n.default.services.flowTriggerCallbackUrlClient,[n.default.services.azureResourceClientFactory,n.default.services.appSettings,n.default.services.environment,function(e,i,r){var n=i.featureFlags.enableEnvironments?t.IFlowTriggerCallbackUrlConstant.urlPathWithEnvironments:t.IFlowTriggerCallbackUrlConstant.urlPath;return e({apiVersion:i.featureFlags.enableEnvironments?i.processSimpleResourceProviderApiVersionWithEnvironments:i.processSimpleResourceProviderApiVersion,urlBase:a.ProcessSimpleResourceProviderManagementEndpoint,urlPath:n,resourceType:t.IFlowTriggerCallbackUrlConstant.resourceType,rest:{post:{params:{id:"@id"}}},options:{atomize:!1}})}])},function(e,t){},function(e,t){e.exports='<div> <div class="subsection-manage section-manage-flow" ng-class="{\'widget\' : flowCtrl.appSettings.isWidgetPage}" ng-if="!flowCtrl.fullPageErrorModel.isPageErrored"> <div class="sticky-save" ng-if="flowCtrl.isFlowLoaded" ng-class="{\'sticky-save-shifted\': flowCtrl.statusAlert.type, \'testing\': flowCtrl.isTesting()}"> <hr/> <div class="sticky-container"> <div class="form-row save-form"> <form ng-submit="flowCtrl.onSave()"> <div class="row"> <div class="large-2 column flow-name-label-container"> <label for="flowNameInput" class="c-label flow-name-label">{{flowCtrl.clientResources.Flow.FlowDisplayNameLabel}}</label> </div> <div class="large-6 medium-9 small-8 column" ng-class="{\'large-4 medium-8 small-6\': flowCtrl.isFlowRunnable && !flowCtrl.isTesting()}"> <input type="text" class="c-text-field" ng-model="flowCtrl.flowDisplayName" title="{{flowCtrl.flowDisplayName}}" ng-readonly="flowCtrl.isSaving() || flowCtrl.isTesting()" maxlength="{{flowCtrl.flowNameMaxLength}}" id="flowNameInput" placeholder="{{flowCtrl.clientResources.Flow.FlowNamePlaceholder.Text}}"> </div> <div class="medium-2 column flow-run-action-button-container" ng-show="flowCtrl.isTesting() && flowCtrl.showFlowRunActionButton()"> <a role="button" ng-click="flowCtrl.onFlowRunCancelClick()" href="" class="c-action-trigger c-glyph glyph-stop">{{flowCtrl.clientResources.FlowRun.Cancel}}</a> </div> <div class="medium-2 column flow-create-button-container" ng-class="{\'medium-offset-2\': flowCtrl.isTesting() && !flowCtrl.showFlowRunActionButton() && !flowCtrl.isFlowRunnable}"> <a role="button" href="" class="c-action-trigger c-glyph glyph-checkmark flow-save" ng-class="{\'glyph-checkmark\': !flowCtrl.isTesting(), \'glyph-edit\': flowCtrl.isTesting()}" ng-disabled="flowCtrl.isSaving()" ng-if="flowCtrl.shouldShowSaveButton()" ng-click="flowCtrl.onSave()" ng-hide="flowCtrl.isMonitorEnabled() && !flowCtrl.isFlowRunCompleted">{{flowCtrl.toggleButtonLabel}}</a> </div> <div class="medium-2 column flow-run-now-button-container"> <a role="button" href="" class="c-action-trigger c-glyph glyph-resubmit flow-run-now" ng-if="flowCtrl.isFlowRunnable" ng-disabled="flowCtrl.isSaving()" ng-hide="flowCtrl.hideRunNowButton()" ng-click="flowCtrl.onRunNow()">{{flowCtrl.runNowButtonLabel}}</a> </div> <div class="column medium-2 flow-close-button-container" ng-hide="flowCtrl.isTesting()"> <a role="button" ng-click="flowCtrl.onFlowDesignerClose()" href="" class="c-action-trigger c-glyph glyph-close flow-close close-button">{{flowCtrl.clientResources.Flow.FlowCloseLabel}}</a> </div> <div class="column medium-4 small-6 small-screen-actions" ng-class="{\'medium-3 small-4\': !flowCtrl.isFlowRunnable || flowCtrl.isTesting()}"> <a role="button" ng-show="flowCtrl.isTesting() && flowCtrl.showFlowRunActionButton()" ng-click="flowCtrl.onFlowRunCancelClick()" href="" class="c-action-trigger c-glyph glyph-stop"></a> <a role="button" href="" class="c-action-trigger c-glyph flow-save" ng-class="{\'glyph-checkmark\': !flowCtrl.isTesting(), \'glyph-edit\': flowCtrl.isTesting()}" ng-if="flowCtrl.shouldShowSaveButton()" ng-disabled="flowCtrl.isSaving()" ng-click="flowCtrl.onSave()" ng-hide="flowCtrl.isMonitorEnabled() && !flowCtrl.isFlowRunCompleted"></a> <a role="button" href="" class="c-action-trigger c-glyph glyph-resubmit flow-run-now" ng-if="flowCtrl.isFlowRunnable" ng-disabled="flowCtrl.isSaving()" ng-click="flowCtrl.onRunNow()" ng-hide="flowCtrl.hideRunNowButton()"></a> <a role="button" ng-click="flowCtrl.onFlowDesignerClose()" href="" class="c-action-trigger c-glyph glyph-close flow-close" ng-hide="flowCtrl.isTesting()"></a> </div> </div> </form> </div> <div> <form id="officePortalSignup" method="post" action="{{flowCtrl.officePortalSignupAction}}" target="_blank"> <input type="hidden" name="StepsData.Email" value="{{flowCtrl.sessionService.getUserSession().userInfo.displayName}}"/> </form> </div> </div> <hr/> </div> <alert class="sticky-error" model="flowCtrl.statusAlert"></alert> <div class="flow-designer-container" ng-class="{\'flow-designer-container-shifted\': flowCtrl.statusAlert.type}"> <flow-designer ng-show="!flowCtrl.isMonitorEnabled()" context="flowCtrl.designerContext" on-init="flowCtrl.onInitDesigner()"></flow-designer> <flow-monitor ng-if="flowCtrl.isMonitorEnabled()" model="flowCtrl.monitorModel" context="flowCtrl.monitorContext" on-init="flowCtrl.onInitMonitor()" on-load-complete="flowCtrl.onMonitorLoadComplete()" on-load-error="flowCtrl.onMonitorLoadError()"></flow-monitor> </div> <spinner model="flowCtrl.spinner"></spinner> </div> <run-flow-dialog ng-if="flowCtrl.runFlowDialog.show" modal-dialog="flowCtrl.runFlowDialog" flow-id="flowCtrl.flowId"/> <full-page-error model="flowCtrl.fullPageErrorModel" ng-if="flowCtrl.fullPageErrorModel.isPageErrored"></full-page-error> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e,t){this.$q=e,this.loggingService=t}return e.$inject=[r.default.services.$q,r.default.services.logging],e}();t.FlowNewGettingStartedCtrl=n},function(e,t){},function(e,t){e.exports="<flow-new-getting-started-hero-section></flow-new-getting-started-hero-section> <popular-triggers></popular-triggers>"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(568);i(569);var o=function(){function e(){this.controller=n.FlowOwnersCtrl,this.template=i(570),this.controllerAs="flowOwners",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.FlowOwners}]}}return e}();t.FlowOwners=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowOwners,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(4),o=i(18),s=i(7),a=i(95),l=i(96),c=i(10),u=i(3),p=i(6),d=i(195),g=i(5),m=i(19),f=i(76),h=function(){function e(e,t,i,r,h,v,y,w,C,S,b,P,R,T,E,A,D,F,N){var I=this;this.$q=e,this.$routeParams=t,this.$scope=i,this.appSettings=r,this.clientResources=h,this.connectionsClient=v,this.environmentService=y,this.flowsConnectionsClient=w,this.flowRolesClient=C,this.flowsClient=S,this.graphService=b,this.loggingService=P,this.navigationService=R,this.policiesService=T,this.promiseHelperService=E,this.sessionService=A,this.telemetryService=D,this.trialDialog=F,this.urlService=N,this.contributors=[],this.connections=[],this.usingConnections=[],this.sharedConnections=[],this.connectionSpinner={size:s.SpinnerSize.Small,local:s.SpinnerPosition.LocalHorizontal},this.coauthorSpinner={size:s.SpinnerSize.Small,local:s.SpinnerPosition.LocalHorizontal},this.errorAlert={type:c.AlertType.None,message:"",options:{}},this.deleteActionButton={label:this.clientResources.Manage.Connections.DeleteToolTip,action:function(){I.deleteAction()},primary:!0},this.dialog={show:!1,buttons:[this.deleteActionButton,{label:this.clientResources.Dialogs.ConfirmDelete.Button.Cancel,action:function(){I.dialog.show=!1}}]},this.flowDisplayName="",this.fetchAllCoauthors=function(){I.fetchOwners().then(function(e){return I.getUserObjects(e)}).catch(function(e){}).finally(function(){return I.coauthorSpinner.show=!1})},this.fetchAndWatchFlowConnections=function(){I.connectionSpinner.show=!0;var e=I.loggingService.profileStart(n.ProfilingEventNames.flowConnectionsLoadStart,{flowName:I.flowName}),t=I.flowsClient.get(I.$scope,{id:I.flowId}).$promise,i=I.flowsConnectionsClient.query(I.$scope,{flowName:I.flowName}).$promise;I.$q.all([t,i]).then(function(t){var i=t[0],r=t[1];I.loggingService.profileEnd(e,n.ProfilingEventNames.flowConnectionsLoadEnd,{flowName:I.flowName,status:u.Status.Success});var o=i?angular.copy(i.properties.connectionReferences):{},s=[],a=[];r.map(function(e){f.findIndex(Object.keys(o||{}),function(t){return o[t].connectionName===e.name})>-1?s.push(e):a.push(e)}),I.usingConnections=I.connectionsToInfoCards(s,!0),I.connections=I.connectionsToInfoCards(a,!1)}).catch(function(t){I.loggingService.logError("FlowOwnersCtrl.getFlowConnections",t),I.errorAlert.type=c.AlertType.Error,I.errorAlert.message=u.parseErrorMessage(t,I.clientResources.Common.SomethingWentWrong),I.loggingService.profileEnd(e,n.ProfilingEventNames.flowConnectionsLoadEnd,{flowName:I.flowName,status:u.Status.Failure,error:I.errorAlert.message})}).finally(function(){return I.connectionSpinner.show=!1})},this.deleteConnection=function(e,t,i){var r=e.id;I.dialog.show=!0,I.deletingContributor=e,I.dialogTitle=i?I.clientResources.Dialogs.ConfirmDelete.DeleteUsingConnectionMessage:I.clientResources.Dialogs.ConfirmDelete.DeleteConnectionMessage,I.dialogMessage="",I.deleteActionButton.label=I.clientResources.Dialogs.ConfirmDelete.Button.DeleteConnection,I.dialog.buttons.forEach(function(e){return e.disabled=!1}),I.deleteAction=function(){I.dialog.buttons.forEach(function(e){return e.disabled=!0});var e=t.properties.apiId,i=e.split("/"),n=i.length>0?i[i.length-1]:"",o=d.getFlowConnectionsDeletionId(I.flowName,n,t.name);I.flowsConnectionsClient.delete({id:o}).then(function(){I.usingConnections=I.usingConnections.filter(function(e){return e.id!==r}),I.connections=I.connections.filter(function(e){return e.id!==r}),I.flowsConnectionsClient.refreshQuery()}).catch(function(e){I.loggingService.logError("FlowOwnersCtrl.DeleteConnection",e)}).finally(function(){return I.dialog.show=!1})}},this.convertGraphModelToContributorModel=function(e,t,i){var r=e.objectId,n={id:r,iconUrl:i.hasOwnProperty(r)?i[r]:"",click:function(){t[r]!==l.RoleName.Owner&&I.onDeleteCoauthor(n)},title:e.displayName,subTitle:e.mail,disabled:t[r]===l.RoleName.Owner,loading:!1,userPermission:null};return n},this.getUserObjects=function(e){var t=Object.keys(e),i={objectIds:t},r=I.loggingService.profileStart(n.ProfilingEventNames.getObjectsByObjectIdsStart,i);return I.graphService.getObjectsByObjectId(t).then(function(i){return I.loggingService.profileEnd(r,n.ProfilingEventNames.getObjectsByObjectIdsEnd,{status:u.Status.Success}),I.graphService.getThumbnailPhotos(t).then(function(t){i.map(function(i){I.contributors.push(I.convertGraphModelToContributorModel(i,e,t))})}).catch(function(e){I.loggingService.logError("FlowOwnersCtrl.getThumbnailPhotos",e)})}).catch(function(e){I.loggingService.logError("FlowOwnersCtrl.getUserObjects",e),I.errorAlert.type=c.AlertType.Error;var i=u.parseErrorMessage(e);return I.errorAlert.message=i,I.loggingService.profileEnd(r,n.ProfilingEventNames.getObjectsByObjectIdsEnd,{status:u.inferErrorStatus(e),error:i,objectIds:t}),I.$q.reject(e)})},this.fetchOwners=function(){var e=I.loggingService.profileStart(n.ProfilingEventNames.flowOwnersLoadStart);return I.flowRolesClient.query(I.$scope,{flowName:I.flowName,roleName:a.FlowRoles.owners}).$promise.then(function(t){I.loggingService.profileEnd(e,n.ProfilingEventNames.flowOwnersLoadEnd,{status:u.Status.Success});var i={};return t.map(function(e){e.properties.principal.id===I.creatorId?i[e.properties.principal.id]=l.RoleName.Owner:i[e.properties.principal.id]=l.RoleName.CanEdit}),i}).catch(function(t){I.loggingService.logError("FlowOwnersCtrl.getFlowPermissions",t),I.errorAlert.type=c.AlertType.Error;var i=u.parseErrorMessage(t);return I.errorAlert.message=i,I.loggingService.profileEnd(e,n.ProfilingEventNames.flowOwnersLoadEnd,{status:u.inferErrorStatus(t),error:i}),I.$q.reject(t)})},this.onDeleteCoauthor=function(e){var t=e.id;I.dialog.show=!0,I.deletingContributor=e,I.dialogTitle=I.clientResources.Dialogs.ConfirmDelete.DeleteOwnerTitle,I.dialogMessage=I.clientResources.Dialogs.ConfirmDelete.DeleteOwnerMessage,I.deleteActionButton.label=I.clientResources.Dialogs.ConfirmDelete.Button.DeleteOwner,I.dialog.buttons.forEach(function(e){return e.disabled=!1});var i=I.graphService.getCachedThumbnailPhotos([t]);i.hasOwnProperty(t)?I.deletingContributor.iconUrl=i[t]:I.graphService.getThumbnailPhotos([t]).then(function(e){I.deletingContributor.iconUrl=e.hasOwnProperty(t)?e[t]:g.default.userPlaceholder}).catch(function(e){I.loggingService.logError("FlowOwnersCtrl.getThumbnailPhotos",e)}),I.deleteAction=function(){I.dialog.buttons.forEach(function(e){return e.disabled=!0});var e=I.loggingService.profileStart(n.ProfilingEventNames.deleteFlowOwnerStart),i=a.getFlowRoleId(I.flowName,a.FlowRoles.owners,t);I.flowRolesClient.delete({id:i}).then(function(){I.loggingService.profileEnd(e,n.ProfilingEventNames.deleteFlowOwnerEnd,{status:u.Status.Success}),I.contributors=I.contributors.filter(function(e){return e.id!==t}),t===I.sessionService.getUserInfo().uniqueId&&(I.flowsClient.refreshQuery(o.getFlowsQueryParams({isPersonal:!1,isShared:!0})),I.navigationService.navigate(I.urlService.flowsRoute()))}).catch(function(t){I.loggingService.logError("FlowOwnersCtrl.onDeleteCoauthor",t),I.errorAlert.type=c.AlertType.Error;var i=u.parseErrorMessage(t);I.errorAlert.message=i,I.loggingService.profileEnd(e,n.ProfilingEventNames.deleteFlowOwnerEnd,{status:u.inferErrorStatus(t),error:i})}).finally(function(){return I.dialog.show=!1})}},this.onEditFlowClick=function(){I.telemetryService.tagEvent(p.TelemetryEventNames.UpdateFlowStarted,I.flow.id),I.appSettings.featureFlags.enableFlowCoauthoring&&(m.isCoauthoredFlow(I.flow)||I.contributors.length>=2)?I.navigationService.navigate(I.urlService.editSharedFlowRoute({flowName:I.flow.name})):I.navigationService.navigate(I.urlService.editFlowRoute({flowName:I.flow.name}))},this.flowName=t.flowName||null,this.flowName||this.navigationService.navigate("/"),this.flowId=o.getFlowId(this.flowName),this.backUrl=t.backUrl||null,this.coauthorSpinner.show=!0,this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(){return I.policiesService.checkUserCanShareFlows()}).then(function(e){e?I.fetchFlow andCoauthoringData():I.environmentService.isDevEnvironment()?I.trialDialog.showFeatureBlockedOnDeveloperEnvironment(function(e){I.backUrl||document.referrer;I.navigationService.navigate(I.urlService.flowsRoute())}):I.trialDialog.showBlockedFeatureStartTrialDialog(function(e){I.allowShowSharedFlows=e,e&&I.fetchFlow andCoauthoringData()})}),this.headingLinks=[{label:this.clientResources.Flow.Commands.Edit,action:function(){return I.onEditFlowClick()},disabled:""===this.flowDisplayName,svgId:"glyph-edit"}]}return e.prototype.fetchFlow andCoauthoringData=function(){var e=this,t=this.flowsClient.get(this.$scope,{id:this.flowId});t.$promise.then(function(){e.flow=t,e.flowDisplayName=e.flow&&e.flow.properties&&e.flow.properties.displayName||"",e.creatorId=e.flow&&e.flow.properties&&e.flow.properties.creator&&e.flow.properties.creator.objectId||"";var i=e.appSettings.featureFlags.enableFlowCoauthoring&&m.isCoauthoredFlow(e.flow)?e.urlService.sharedFlowsRoute():e.urlService.flowsRoute();e.backButton={url:e.backUrl?e.backUrl:i}}).then(function(){e.fetchFlowCoauthorsAndConnections()}).catch(function(t){e.loggingService.logError("FlowOwnersCtrl.getFlowDefinition",t),e.coauthorSpinner.show=!1})},e.prototype.fetchFlowCoauthorsAndConnections=function(){this.fetchAllCoauthors(),this.fetchAndWatchFlowConnections()},e.prototype.connectionsToInfoCards=function(e,t){var i=this;return e.map(function(e){var r={id:e.name,iconUrl:e.properties.iconUri,click:function(){i.deleteConnection(r,e,t)},title:e.properties.displayName,subTitle:e.properties.createdBy&&e.properties.createdBy.email||"",userPermission:null};return r})},e.prototype.onGraphAutocompleteSelect=function(e,t){var i=this;if(!(this.contributors.filter(function(t){return t.id===e.model.objectId}).length>0)){var r=this.loggingService.profileStart(n.ProfilingEventNames.addFlowOwnerStart),s=e.mail,l=e.displayName,p=e.model.objectId,d={name:p,properties:{principal:{id:e.model.objectId,displayName:l,email:s,type:e.type}}},g={put:[d]},m={id:p,iconUrl:"",click:function(){return i.onDeleteCoauthor(m)},title:l,subTitle:s,loading:!0,userPermission:null};this.contributors.push(m),this.flowRolesClient.modify({flowName:this.flowName,roleName:a.FlowRoles.owners},g).then(function(){i.contributors.forEach(function(e){e.id===p&&(e.loading=!1)}),2===i.contributors.length&&(i.flowsClient.refreshQuery(o.getFlowsQueryParams({isPersonal:!1,isShared:!0})),i.flowsClient.refreshQuery(o.getFlowsQueryParams({isPersonal:!0,isShared:!1})),i.backButton.url=-1===i.backButton.url.indexOf("shared")?i.backButton.url.replace("/flows","/flows/shared"):i.backButton.url),i.loggingService.profileEnd(r,n.ProfilingEventNames.addFlowOwnerEnd,{status:u.Status.Success})}).catch(function(e){i.contributors=i.contributors.filter(function(e){return e.id!==p}),i.loggingService.logError("FlowOwnersCtrl.onAddCoauthor",e),i.errorAlert.type=c.AlertType.Error;var t=u.parseErrorMessage(e);i.errorAlert.message=t,i.loggingService.profileEnd(r,n.ProfilingEventNames.addFlowOwnerEnd,{status:u.inferErrorStatus(e),error:t})})}},Object.defineProperty(e.prototype,"connectionsSectionHidden",{get:function(){return 0===this.connections.length&&0===this.usingConnections.length},enumerable:!0,configurable:!0}),e.prototype.hideModalDialog=function(){this.dialog.show=!1},e.$inject=[r.default.services.$q,r.default.services.$routeParams,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.connectionsClient,r.default.services.environment,r.default.services.flowConnectionsClient,r.default.services.flowRolesClient,r.default.services.flowsClient,r.default.services.graph,r.default.services.logging,r.default.services.navigation,r.default.services.policies,r.default.services.promiseHelperService,r.default.services.session,r.default.services.telemetry,r.default.services.trialDialog,r.default.services.url],e}();t.FlowOwnersCtrl=h},function(e,t){},function(e,t){e.exports='<div class="subsection-manage section-manage-flow-owners"> <heading label="flowOwners.flowDisplayName" back="flowOwners.backButton" links="flowOwners.headingLinks"></heading> <alert class="flow-owners-alert" model="flowOwners.errorAlert"></alert> <section class="row section-flow-owners"> <div class="column medium-3 left-pane"> <h1>{{flowOwners.clientResources.FlowOwners.Owners.Title}}</h1> <p>{{flowOwners.clientResources.FlowOwners.Owners.Description}}</p> <a class="c-hyperlink" target="_blank" href="https://go.microsoft.com/fwlink/?linkid=839912" data-event-name="FlowCoauthorsLearnMoreClicked">{{flowOwners.clientResources.Common.LearnMore}}</a> </div> <div class="column medium-8 medium-offset-1 right-pane"> <h6>{{flowOwners.clientResources.FlowOwners.AddOwner.Title}}</h6> <graph-autocomplete on-select="flowOwners.onGraphAutocompleteSelect(value, event)"></graph-autocomplete> <spinner model="flowOwners.coauthorSpinner"></spinner> <ps-list items="flowOwners.contributors"> <ps-list-item-template> <info-card model="$parent.item"> <info-card-icon-template> <avatar mail="$parent.model.subTitle" display-name="$parent.model.title" image-src="$parent.model.iconUrl" object-id="$parent.model.id"></avatar> </info-card-icon-template> <info-card-picker-template></info-card-picker-template> <info-card-option-template> <p ng-show="$parent.model.loading">{{flowOwners.clientResources.FlowOwners.Owner.Adding}}</p> <div class="option-block c-glyph glyph-delete" ng-disabled="$parent.model.disabled" ng-show="!$parent.model.loading"></div> </info-card-option-template> </info-card> </ps-list-item-template> </ps-list> </div> </section> <modal-dialog model="flowOwners.dialog"> <dialog-header-content-template> <h6>{{flowOwners.dialogTitle}}</h6> <a title="{{flowOwners.clientResources.Dialogs.ConfirmDelete.Button.Cancel}}" role="button" aria-label="{{flowOwners.clientResources.Dialogs.ConfirmDelete.Button.Cancel}}" ng-click="flowOwners.hideModalDialog()" href="" class="c-glyph glyph-close ng-modal-close"></a> </dialog-header-content-template> <dialog-body-content-template> <p ng-hide="!flowOwners.dialogMessage">{{flowOwners.dialogMessage}}</p> <div class="info-card-item"> <div class="info-card-icon"> <avatar mail="flowOwners.deletingContributor.subTitle" display-name="flowOwners.deletingContributor.title" image-src="flowOwners.deletingContributor.iconUrl" object-id="flowOwners.deletingContributor.id"></avatar> </div> <div class="info-card-text-section column medium-6 small-6"> <div class="info-card-title">{{flowOwners.deletingContributor.title}}</div> <div class="info-card-subtitle">{{flowOwners.deletingContributor.subTitle}}</div> </div> </div> </dialog-body-content-template> </modal-dialog> <hr ng-hide="flowOwners.connectionsSectionHidden"/> <section class="row section-flow-owners-connections" ng-hide="flowOwners.connectionsSectionHidden"> <div class="column medium-3 left-pane"> <h1>{{flowOwners.clientResources.FlowOwners.Connections.Title}}</h1> <p>{{flowOwners.clientResources.FlowOwners.Connections.Description}}</p> <a class="c-hyperlink" target="_blank" href="https://go.microsoft.com/fwlink/?linkid=839913" data-event-name="FlowConnectionsLearnMoreClicked">{{flowOwners.clientResources.Common.LearnMore}}</a> </div> <div class="column medium-8 medium-offset-1 right-pane"> <spinner model="flowOwners.connectionSpinner"></spinner> <h6 ng-hide="flowOwners.usingConnections.length === 0">{{flowOwners.clientResources.FlowOwners.OwnerConnections.Title}}</h6> <info-card-list model="flowOwners.usingConnections"></info-card-list> <h6 ng-hide="flowOwners.connections.length === 0">{{flowOwners.clientResources.FlowOwners.OwnerConnections.OtherConnections.Title}}</h6> <info-card-list model="flowOwners.connections"></info-card-list> </div> </section> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(23),n=i(19),o=i(0),s=i(5),a=i(1),l=i(197),c=i(1),u=i(3),p=i(35),d=i(10),g=i(107),m=i(106),f=i(44),h=i(121),v=i(198),y=i(18),w=i(4),C=i(7),S=i(6),b=i(199),P=function(){function e(e,t,i,r,n,o,a,c,u,g,m,v,y,w,S,P,R,T,E,A,D){var F=this;this.$q=e,this.$routeParams=t,this.$scope=i,this.$sce=r,this.$interval=n,this.alertService=o,this.appSettings=a,this.clientResources=c,this.connectionsClient=u,this.dateTime=g,this.runInstanceService=m,this.flowClient=v,this.flowRunsClient=y,this.flowTriggerHistoriesClient=w,this.flowRunService=S,this.loggingService=P,this.algorithms=R,this.poll=T,this.navigation=E,this.telemetry=A,this.urlService=D,this.hasDefinitionLoaded=!1,this.hasPageLoadCompleted=!1,this.title="",this.context={},this.errorAlert={type:d.AlertType.None,message:"",options:{}},this.flowDisplayName="",this.flowRunAction=h.FlowRunAction.None,this.showSummaryPane=!1,this.closeSummaryPaneOnClickOutsidePane=!1,this.summaryPaneAnimation=b.PaneAnimation.NoAnimation,this.failedOperations=[],this.paneSpinner={size:C.SpinnerSize.Large,show:!1,local:C.SpinnerPosition.Local},this.flowRunCompleted=function(){F.appSettings.featureFlags.enableFlowRunAction&&F.updateFlowRunActionButton(h.FlowRunAction.Resubmit)},this.flowName=t.flowName||null,this.flowRunName=t.flowRunName||null,this.runStatus=t.runStatus||null,this.backUrl=t.backUrl||null,this.isFlowCheck=this.urlService.isFlowCheckPage(),this.model={isFlowCheck:this.isFlowCheck,flowRunId:this.flowName+"/runs/"+this.flowRunName,monitorLoadError:""},this.fullPageErrorModel={image:s.default.fullPageErrorDebugFlow,isPageErrored:!1,pageTitle:this.clientResources.Flow.Run.PageTitle},this.spinner={size:C.SpinnerSize.Large,show:!0,local:C.SpinnerPosition.Local},this.supportMessage=this.$sce.trustAsHtml(l.getSupportMessage(this.clientResources,this.urlService.localeRoute(),!0)),this.backUrl?this.backButton={url:this.backUrl}:this.backButton=this.havePreviousPagePath()?{url:this.urlService.flowRunsRoute({flowName:this.flowName}),searchParameters:{filter:p.parseUri(this.navigation.getPreviousPagePath()).parameters.filter}}:{url:this.urlService.flowRunsRoute({flowName:this.flowName}),searchParameters:{filter:f.FilterNames.allRuns}},this.loadFlowRunView()}return e.prototype.loadFlowRunView=function(){var e=this;this.designerReadyDeferred=this.$q.defer(),this.eventCorrelationId=this.loggingService.profilePageStart(w.ProfilingEventNames.flowRunLoadStart),this.hasDefinitionLoaded=!1,this.hasPageLoadCompleted=!1,this.spinner.show=!0,this.headingLinks=[{label:this.clientResources.FlowRun.Cancel,hide:!this.showFlowRunActionButton()||this.isFlowCheck,disabled:!this.hasDefinitionLoaded,action:function(){return e.onFlowRunActionClick()},svgId:"glyph-close"},{label:this.clientResources.Flow.CreateButtonLabel.Edit,action:function(){return e.editFlow()},svgId:"glyph-edit"}],this.loadDefinition(),this.isFlowCheck?this.showSummaryPaneForFailedRun(this.runStatus):this.loadFlowRun();var t=this.connectionsClient.refreshQuery();this.$q.all([this.designerReadyDeferred.promise,this.flowRunsPromise,t]).catch(function(t){if(t&&404===t.status){var i=u.parseErrorCode(t);i===u.errorConstants.softDeletedFlowCode?(e.loggingService.profilePageEnd(e.eventCorrelationId,w.ProfilingEventNames.flowRunLoadEnd,{status:u.Status.Abort,flowName:e.flowName,flowRunName:e.flowRunName,error:u.parseErrorMessage(t),errorCode:i}),e.alertService.enqueueAlert({message:u.parseErrorMessage(t)}),e.navigation.navigate(e.urlService.flowsRoute())):e.showSummaryPaneForFailedRun()}else e.loggingService.logError("FlowRunCtrl.Constructor",t),e.errorAlert.type=d.AlertType.Error,e.errorAlert.message=u.parseErrorMessage(t,e.clientResources.Common.SomethingWentWrong),e.loggingService.profilePageEnd(e.eventCorrelationId,w.ProfilingEventNames.flowRunLoadEnd,{status:u.inferErrorStatus(t),flowName:e.flowName,flowRunName:e.flowRunName,error:u.parseErrorMessage(t)})}).finally(function(){e.spinner.show=!1})},e.prototype.onInitDesigner=function(){this.designerReadyDeferred.resolve()},e.prototype.onDesignerLoadComplete=function(){this.spinner.show=!1,this.hasPageLoadCompleted=!0,this.loggingService.profilePageEnd(this.eventCorrelationId,w.ProfilingEventNames.flowRunLoadEnd,{status:u.Status.Success,flowName:this.flowName,flowRunName:this.flowRunName})},e.prototype.onDesignerLoadError=function(){this.spinner.show=!1,u.showFullPageError(this.fullPageErrorModel,this.model.monitorLoadError),this.$scope.$digest()},e.prototype.onFlowRunActionClick=function(){var e=this;if(this.hasDefinitionLoaded)switch(this.errorAlert={type:d.AlertType.None,message:"",options:{}},this.flowRunAction){case h.FlowRunAction.Cancel:confirm(this.clientResources.Dialogs.ConfirmFlowRunCancelMessage)&&this.flowRunService.cancelFlowRun(this.flowName,this.flowRunName).then(function(){e.errorAlert.type=d.AlertType.Info,e.errorAlert.message=e.clientResources.FlowRun.CancelText,e.flowRunCompleted()}).catch(function(t){e.loggingService.logError("FlowRunCtrl.FlowRunCancel",t),e.errorAlert.type=d.AlertType.Error,e.errorAlert.message=u.parseErrorMessage(t,e.clientResources.Common.SomethingWentWrong)});break;case h.FlowRunAction.Resubmit:confirm(this.clientResources.Dialogs.ConfirmFlowRunResubmitMessage)&&this.flowRunService.resubmitFlowRun(this.$scope,this.flowName,this.flowTriggerName,this.flowRunName,this.backUrl).catch(function(t){e.loggingService.logError("FlowRunCtrl.FlowTriggerHistoryResubmit",t),e.errorAlert.type=d.AlertType.Error,e.errorAlert.message=u.parseErrorMessage(t,e.clientResources.Common.SomethingWentWrong)})}},e.prototype.updateFlowRunActionButton=function(e){switch(this.flowRunAction=e,this.flowRunAction){case h.FlowRunAction.Cancel:this.headingLinks[0].label=this.clientResources.FlowRun.Cancel,this.headingLinks[0].svgId="glyph-stop";break;case h.FlowRunAction.Resubmit:this.headingLinks[0].label=this.clientResources.FlowRun.Resubmit,this.headingLinks[0].svgId="glyph-resubmit"}},e.prototype.showFlowRunActionButton=function(){return this.appSettings.featureFlags.enableFlowRunAction},e.prototype.loadFlowRun=function(){var e=this,t=this.flowRunsClient.get(this.$scope,{id:v.getFlowRunId(this.flowName,this.flowRunName)});this.flowRunsPromise=t.$promise,this.flowRunsPromise.then(function(){if(!t)throw new g.ClientError(m.default.flowRunNotFound,e.clientResources.FlowRun.ExpectingArrayReceivedNull,null);var i=e.dateTime.getSimpleDateTimeString(c.getDate(t.properties.startTime));e.title=a.format(e.clientResources.FlowRun.TimeTitle,i)}).then(function(){n.isRunning(t)?(e.updateFlowRunActionButton(h.FlowRunAction.Cancel),e.flowRunService.waitForFlowRunToComplete(e.$scope,t,e.context,e.flowRunCompleted)):(e.updateFlowRunActionButton(h.FlowRunAction.Resubmit),e.isFailedRun(t)&&e.showSummaryPaneForFailedRun(t.properties.status))})},e.prototype.loadDefinition=function(){var e=this;this.designerReadyDeferred.promise.then(function(){return e.flowClient.get(e.$scope,{id:y.getFlowId(e.flowName)}).$promise}).then(function(t){if(!t)throw new g.ClientError(m.default.nullResponse,e.clientResources.FlowRun.ExpectingArrayReceivedNull,null);e.flowDisplayName=t.properties.displayName,e.flowId=t.id;var i=t.properties.definition,r=i.triggers,n=Object.keys(r);return n&&n.length>0&&(e.flowTriggerName=n[0]),{definition:t.properties.definition,connectionReferences:t.properties.connectionReferences}}).then(function(){e.hasDefinitionLoaded=!0})},e.prototype.shouldDisplayAlertComponent=function(){return!this.fullPageErrorModel.isPageErrored&&this.hasPageLoadCompleted},e.prototype.editFlow=function(){this.telemetry.tagEvent(S.TelemetryEventNames.UpdateFlowStarted,this.flowId),this.navigation.navigate(this.urlService.editFlowRoute({flowName:this.flowName}))},e.prototype.havePreviousPagePath=function(){if(this.navigation.getPreviousPagePath()){var e=this.navigation.getPreviousPagePath(),t=this.urlService.flowRunsRoute({flowName:this.flowName}),i=p.parseUri(e).parameters;if(e.indexOf(t)>-1&&e.indexOf(i.filter))return!0}return!1},e.prototype.showSummaryPaneForFailedRun=function(e){var t=this;if(this.appSettings.featureFlags.enableSummaryPaneOnDebugView){var i=!1,n={label:this.clientResources.FlowRun.Help,action:function(){return t.toggleSummaryPaneVisibility()},svgId:"glyph-info"};this.showSummaryPane=e===r.Status.failed,this.paneSpinner.show=!0,this.telemetry.tagEvent(S.TelemetryEventNames.DebugViewSummaryPaneOpened),this.summaryPaneEventCorrelationId=this.loggingService.profilePageStart(w.ProfilingEventNames.debugViewSummaryPaneLoadStart),this.showSummaryPane&&!i&&(this.headingLinks.push(n),i=!0);var o=this.flowName+"/runs/"+this.flowRunName;this.runInstanceService.createDesignerRunInstanceService(this.isFlowCheck).getRunInstance(o,!0).then(function(e){t.showSummaryPane=e.run&&e.run.properties&&e.run.properties.status===r.Status.failed,t.showSummaryPane&&!i&&(t.headingLinks.push(n),i=!0);var o=[];if(e){var s=e.run.properties.trigger;s.status===r.Status.failed&&o.push(t.toFlowOperationSummaryPromise(s,!0,e.workflowVersion)),e.runActions.forEach(function(i){i.properties&&i.properties.status===r.Status.failed&&"ActionFailed"!==i.properties.code&&(i.properties.name=i.name,o.push(t.toFlowOperationSummaryPromise(i.properties,!1,e.workflowVersion)))})}return t.$q.all(o).then(function(e){t.failedOperations=l.removeDuplicateFailedOperationSummary([].concat.apply([],e)),t.loggingService.profilePageEnd(t.summaryPaneEventCorrelationId,w.ProfilingEventNames.debugViewSummaryPaneLoadEnd,{status:u.Status.Success,flowName:t.flowName,flowRunName:t.flowRunName}),t.telemetry.tagEvent(S.TelemetryEventNames.DebugViewSummaryPaneDataLoadCompleted),t.paneSpinner.show=!1})}).catch(function(e){t.loggingService.logError("FlowRunCtrl.showSummaryPaneForFailedRun",e),t.errorAlert.type=d.AlertType.Error,t.errorAlert.message=u.parseErrorMessage(e,t.clientResources.Common.SomethingWentWrong),t.loggingService.profilePageEnd(t.summaryPaneEventCorrelationId,w.ProfilingEventNames.debugViewSummaryPaneLoadEnd,{status:u.inferErrorStatus(e),flowName:t.flowName,flowRunName:t.flowRunName,error:u.parseErrorMessage(e)}),t.paneSpinner.show=!1,t.showSummaryPane=!1})}},e.prototype.isFailedRun=function(e){return!(!e||!e.properties)&&e.properties.status===r.Status.failed},e.prototype.toFlowOperationSummaryPromise=function(e,t,i){var n=this;return this.runInstanceService.getOperationOutput(this.flowName,e).then(function(e){return e.length>1?e.filter(function(e){return e.status===r.Status.failed}):e}).then(function(r){return r.map(function(r){var o=r.outputs||r,s=l.getErrorType(o),c=l.getConnectionReference(e.name,i),u="",p="",d=n.connectionsClient.query(n.$scope),g={},m=t?n.clientResources.FlowRun.Operation.Type.Trigger:n.clientResources.FlowRun.Operation.Type.Action;return c&&(c.apiDefinition&&(u=c.apiDefinition.properties.displayName),p=c.connectionName),g.title=a.format(n.clientResources.FlowRun.Operation.Failed.Title,m,e.name.replace(/_/g," ")),g.fixDescription=l.getFixDescription(n.clientResources,s,u),g.errorDetails=l.getErrorDetails(o),g.errorDescription=l.getErrorDescription(n.clientResources,s,p,d),l.isServerError(s)&&(n.supportMessage=n.$sce.trustAsHtml(l.getSupportMessage(n.clientResources,n.urlService.localeRoute(),!1))),n.loggingService.logInfo("FlowRunCtrl.toFlowOperationSummaries","Computed error and fix descriptions for operation",{flowName:n.flowName,flowRunName:n.flowRunName,statusCode:o.statusCode,errorType:s,errorDescription:g.errorDescription,fixDescription:g.fixDescription,errorDetails:g.errorDetails}),g})})},e.prototype.toggleSummaryPaneVisibility=function(){this.showSummaryPane=!this.showSummaryPane},e.$inject=[o.default.services.$q,o.default.services.$routeParams,o.default.services.$scope,o.default.services.$sce,o.default.services.$interval,o.default.services.alertService,o.default.services.appSettings,o.default.services.clientResources,o.default.services.connectionsClient,o.default.services.dateTime,o.default.services.runInstanceService,o.default.services.flowsClient,o.default.services.flowRunsClient,o.default.services.flowTriggerHistoriesClient,o.default.services.flowRun,o.default.services.logging,o.default.services.algorithms,o.default.services.poll,o.default.services.navigation,o.default.services.telemetry,o.default.services.url],e}();t.FlowRunCtrl=P},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OperationErrorType={Conflict:"Conflict",ConnectionNotFound:"ConnectionNotFound",Default:"Default",InternalServerError:"InternalServerError",InvalidInput:"InvalidInput",InvalidTemplate:"InvalidTemplate",NoAccess:"NoAccess",NotAuthorized:"NotAuthorized",ObjectNotFound:"ObjectNotFound",RequestEntityTooLarge:"RequestEntityTooLarge"}},function(e,t){},function(e,t){e.exports='<div class="subsection-manage flow-run-component" ng-if="!flowRunCtrl.fullPageErrorModel.isPageErrored"> <heading label="flowRunCtrl.flowDisplayName" back="flowRunCtrl.backButton" links="flowRunCtrl.headingLinks"></heading> <div class="row"> <div class="second-title" ng-if="flowRunCtrl.title">{{flowRunCtrl.title}}</div> </div> <div class="row"> <div class="column"> <alert model="flowRunCtrl.errorAlert" ng-show="flowRunCtrl.shouldDisplayAlertComponent()"></alert> <flow-monitor model="flowRunCtrl.model" context="flowRunCtrl.context" on-init="flowRunCtrl.onInitDesigner()" on-load-complete="flowRunCtrl.onDesignerLoadComplete()" on-load-error="flowRunCtrl.onDesignerLoadError()" ng-hide="flowRunCtrl.errorModel.isPageErrored || flowRunCtrl.spinner.show"></flow-monitor> <info-pane class="debug-summary-pane" expanded="flowRunCtrl.showSummaryPane" close-on-click-outside-pane="flowRunCtrl.closeSummaryPaneOnClickOutsidePane" pane-title="flowRunCtrl.clientResources.FlowRun.FailureSummary.Title" pane-animation="flowRunCtrl.summaryPaneAnimation"> <spinner model="flowRunCtrl.paneSpinner"></spinner> <div class="row" ng-if="!flowRunCtrl.paneSpinner.show"> <div class="column small-1 icon-column"> <img svg-src="/content/images/common/support.svg" alt=""> </div> <div class="column small-11"> <p class="support-title">{{flowRunCtrl.clientResources.FlowRun.Support.Title}}</p> </div> </div> <div class="row support-message" ng-if="!flowRunCtrl.paneSpinner.show"> <div class="column"> <p ng-bind-html="flowRunCtrl.supportMessage"></p> </div> </div> <ps-list items="flowRunCtrl.failedOperations" ng-if="!flowRunCtrl.paneSpinner.show"> <ps-list-item-template> <run-operation-summary model="$parent.item"></run-operation-summary> </ps-list-item-template> </ps-list> </info-pane> </div> </div> <spinner model="flowRunCtrl.spinner"></spinner> </div> <full-page-error model="flowRunCtrl.fullPageErrorModel" ng-if="flowRunCtrl.fullPageErrorModel.isPageErrored"></full-page-error>'},function(e,t){},function(e,t){e.exports='<div class="subsection-manage section-manage-flow-runs"> <div ng-if="!flowRunsCtrl.fullPageErrorModel.isPageErrored" ng-init="flowRunsCtrl.refreshFlowRuns()"> <heading label="flowRunsCtrl.title" back="flowRunsCtrl.backButton" links="flowRunsCtrl.headingLinks" filter="flowRunsCtrl.filterModel"></heading> <div class="row top-align"> <div class="column"> <alert model="flowRunsCtrl.errorAlert"></alert> <flow-run-list model="flowRunsCtrl.flowRunList" ng-if="flowRunsCtrl.flowRunList"></flow-run-list> </div> </div> </div> <full-page-error model="flowRunsCtrl.fullPageErrorModel" ng-if="flowRunsCtrl.fullPageErrorModel.isPageErrored"></full-page-error> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(6),s=i(18),a=i(19),l=i(4),c=i(3),u=i(10),p=i(23),d=i(124),g=i(19),m=function(){function e(e,t,i,r,p,m,f,h,v,y,w,C,S,b,P,R){var T=this;this.$q=e,this.$routeParams=t,this.$scope=i,this.appSettings=r,this.clientResources=p,this.flowsClient=m,this.loggingService=f,this.logicAppTemplateExportService=h,this.navigationService=v,this.policiesService=y,this.telemetryService=w,this.trialDialog=C,this.urlService=S,this.userFlowAccountClient=b,this.isShared=P,this.populateRunOnlyUser=R,this.errorAlert={type:u.AlertType.None,message:"",options:{}},this.flowSaveAsDialog={show:!1,flowId:null},this.submitTemplatePane={flow:null,isShared:this.isShared,show:!1},this.context={},this.deleteFlowDialog={show:!1},this.feedbackCallTimes=0,this.runFlowDialog={show:!1,disableDefaultStyles:!0},this.displayRunOnlyManagement=!1,this.displayMobileBannerTile=!1,this.runNowCommand={text:this.clientResources.Flow.Commands.RunNow,iconUrl:"glyph-resubmit",click:function(){return T.showRunFlowDialog()},disabled:!1},this.onInitAll=function(){T.feedbackCallTimes++;var e=!T.displayRunOnlyManagement||T.context.fetchAllRunOnlyUsers;T.context.fetchAllCoauthors&&T.context.fetchFlowConnections&&T.context.flowRuns&&T.context.userAccountDefinition&&e&&T.feedbackCallTimes===(T.displayRunOnlyManagement?d.callbackFunctionsNumber:d.callbackFunctionsNumber-1)&&T.$q.all([T.context.fetchAllCoauthors,T.context.fetchFlowConnections,T.context.flowRuns]).then(function(){T.loggingService.profileEnd(T.flowPropertyPageCorrelationId,l.ProfilingEventNames.flowPropertyPageLoadEnd,{status:l.Status.Success}),T.appSettings.isWidgetPage&&(T.loadTemplates=!0)}).catch(function(e){var t=c.parseErrorMessage(e);T.loggingService.profileEnd(T.flowPropertyPageCorrelationId,l.ProfilingEventNames.flowPropertyPageLoadEnd,{status:c.inferErrorStatus(e),error:t})})},this.setupDropDownMenu=function(){T.commandsInDropDown=[],T.hasRunNowCommand=g.isRunnableFlow(T.flow),T.hasRunNowCommand&&(T.commandsInDropDown.push(T.runNowCommand),T.runNowCommand.disabled=!T.isFlowStarted(T.flow)),T.appSettings.featureFlags.enableFlowSaveAs&&T.commandsInDropDown.push({text:T.clientResources.Dialogs.FlowSaveAs.SaveAs,iconUrl:"glyph-saveas",click:function(){return T.showFlowSaveAsDialog(T.flow)}}),T.commandsInDropDown.push({text:T.clientResources.Manage.CustomApi.Tabs.share,iconUrl:"glyph-share",click:function(){return T.shareFlow()}}),T.appSettings.featureFlags.enableFlowSubmitTemplateDropDown&&T.commandsInDropDown.push({text:T.clientResources.TemplateSubmission.Action.Name,iconSrc:n.default.submitAsTemplate,click:function(){return T.submitToGallery(T.flow)}});var e=T.getExportCommand(T.flow);e&&T.commandsInDropDown.push(e),T.deleteCommand={text:T.clientResources.Flow.Commands.Delete,iconUrl:"glyph-delete",click:function(){return T.showDeleteFlowDialog()}},T.commandsInDropDown.push(T.deleteCommand)},this.editFlow=function(){T.telemetryService.tagEvent(o.TelemetryEventNames.UpdateFlowStarted,T.flowName);var e=T.isShared?T.urlService.editSharedFlowRoute({flowName:T.flowName}):T.urlService.editFlowRoute({flowName:T.flowName});T.navigationService.navigate(e,{backUrl:T.urlService.flowDetailsRoute({flowName:T.flowName,shared:T.isShared})})},this.shareFlow=function(){T.telemetryService.tagEvent(o.TelemetryEventNames.ListFlowOwners,T.flowName),T.navigationService.navigate(T.urlService.flowOwnersRoute({flowName:T.flowName}),{backUrl:T.urlService.flowDetailsRoute({flowName:T.flowName,shared:T.isShared})})},this.onBackButtonClick=function(){T.flowsClient.refreshQuery(s.getFlowsQueryParams({isPersonal:!T.isShared,isShared:T.isShared})).then(function(){return T.navigationService.navigate(T.backUrl)})},this.showRunFlowDialog=function(){T.runFlowId=T.flow.id,T.runFlowDialog.show=!0},this.showDeleteFlowDialog=function(){T.flowToDelete=T.flow,T.deleteFlowDialog.show=!0},this.flowName=this.$routeParams.flowName,this.backUrl=this.isShared?this.urlService.sharedFlowsRoute():this.urlService.flowsRoute(),this.backButton={url:this.backUrl,click:this.onBackButtonClick},this.context.onInit=this.onInitAll,this.flowPropertyPageCorrelationId=this.loggingService.profilePageStart(l.ProfilingEventNames.flowPropertyPageLoadStart,{flowName:this.flowName}),this.loadTemplates=!this.appSettings.isWidgetPage;var E=s.getFlowId(this.flowName);this.flowsClient.refresh({id:E}).then(function(){return T.flowResource=T.flowsClient.get(T.$scope,{id:E}),T.flowResource.$promise}).then(function(e){T.flow=e,T.displayRunOnlyManagement=a.isRunOnlyManagementSupported(T.flow),T.flowDisplayName=T.flow&&T.flow.properties&&T.flow.properties.displayName||"",T.headingToggle={offText:T.clientResources.Flow.State.off,onText:T.clientResources.Flow.State.on,isToggleOn:function(){return T.isFlowStarted()},action:function(){return T.changeFlowState()}},T.dropdown={label:T.clientResources.Manage.CustomApi.FlowPermissionsList.moreUsers,glyph:"glyph-ellipsis"},T.setupDropDownMenu(),T.context.userAccountDefinition=T.userFlowAccountClient.getCurrentUserDetails(),T.determineMobileBannerDisplay()}).catch(function(e){T.loggingService.logError("FlowOwnersCtrl.getFlowDefinition",e)}),this.headingLinks=[{label:this.clientResources.Flow.CreateButtonLabel.Edit,action:function(){return T.editFlow()},svgId:"glyph-edit"}]}return e.prototype.showErrorAlert=function(e,t){this.errorAlert.type=u.AlertType.Error,this.errorAlert.message=e,this.errorAlert.options.link=t},e.prototype.hideErrorAlert=function(){this.errorAlert.type=u.AlertType.None,this.errorAlert.message="",this.errorAlert.options.link=null},e.prototype.changeFlowState=function(){var e=this;this.hideErrorAlert();var t=this.isFlowStarted(this.flow);this.telemetryService.tagEvent(t?o.TelemetryEventNames.StopFlowClicked:o.TelemetryEventNames.StartFlowClicked,{flowName:this.flow.name});var i=this.flow.properties.state;this.flow.properties.state=t?p.FlowState.stopped:p.FlowState.started,(t?this.flowResource.$stop():this.flowResource.$start()).then(function(){e.flowsClient.refreshQuery(s.getFlowsQueryParams({isPersonal:!e.isShared,isShared:e.isShared})),e.hasRunNowCommand&&(e.isFlowStarted(e.flow)?e.runNowCommand.disabled=!1:e.runNowCommand.disabled=!0)}).catch(function(t){var r,n=null;c.isDLPViolationError(t)?(r=e.clientResources.Flow.Error.DLPViolation.Message,n=c.dlpViolationLink):r=c.parseErrorMessage(t,e.clientResources.Common.SomethingWentWrong),e.loggingService.logError("FlowPropertiesCtrl.ChangeFlowState",{name:"ChangeFlowStateError",message:r}),e.flow.properties.state=i,e.showErrorAlert(r,n)})},e.prototype.isFlowStarted=function(e){var t=e||this.flow;return a.isStarted(t)},e.prototype.getExportCommand=function(e){var t=this;if(!this.policiesService.shouldEnableFlowImportExport()&&!this.policiesService.shouldEnableLogicAppTemplateExport())return null;var i={text:this.clientResources.Common.Export,iconUrl:"glyph-export",click:_.noop,commands:[]};if(this.policiesService.shouldEnableFlowImportExport()&&i.commands.push({text:this.clientResources.Export.Package.MenuItem,click:function(){return t.tryNavigateToExportFlowPage()}}),this.policiesService.shouldEnableLogicAppTemplateExport()){var r={text:this.clientResources.Export.Logicapp.MenuItem,click:function(){r.text=t.clientResources.Export.Logicapp.Exporting,t.exportLogicAppTemplate().finally(function(){r.text=t.clientResources.Export.Logicapp.MenuItem})}};i.commands.push(r)}return i},e.prototype.exportLogicAppTemplate=function(){return this.telemetryService.tagEvent(o.TelemetryEventNames.FlowDetailsExportLogicAppTemplateClicked,null,{flowName:this.flow.name}),this.logicAppTemplateExportService.exportTemplate(this.flowResource)},e.prototype.showFlowSaveAsDialog=function(e){this.flowSaveAsDialog.flowId=e.id,this.flowSaveAsDialog.show=!0},e.prototype.submitToGallery=function(e){this.submitTemplatePane.flow=e,this.submitTemplatePane.show=!0},e.prototype.tryNavigateToExportFlowPage=function(){this.telemetryService.tagEvent(o.TelemetryEventNames.FlowDetailsExportBapPackagedClicked,null,{flowName:this.flow.name}),this.policiesService.shouldShowUpgradeToProDialog()?this.trialDialog.showUpgradeToProRequiredDialog():this.navigationService.navigate(this.urlService.exportFlowsRoute(this.flow.name))},e.prototype.determineMobileBannerDisplay=function(){var e=this,t=this.loggingService.profileStart(l.ProfilingEventNames.currentUserDetailsLoadStart);this.context.userAccountDefinition.then(function(i){e.loggingService.profileEnd(t,l.ProfilingEventNames.currentUserDetailsLoadEnd,{status:l.Status.Success}),i.data&&!a.userInstalledMobileApp(i.data.properties)&&(a.containsManualTriggerWithButtonKind(e.flow)||a.containsConnectionWithNotification(e.flow))&&(e.telemetryService.tagEvent(o.TelemetryEventNames.MobileBannerTileShown),e.displayMobileBannerTile=!0)}).catch(function(i){e.loggingService.profileEnd(t,l.ProfilingEventNames.currentUserDetailsLoadEnd,{status:c.inferErrorStatus(i),error:c.parseErrorMessage(i)}),e.loggingService.logError("determineMobileBannerDisplay.userAccountDefinition",i)})},e.$inject=[r.default.services.$q,r.default.services.$routeParams,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.flowsClient,r.default.services.logging,r.default.services.logicAppTemplateExport,r.default.services.navigation,r.default.services.policies,r.default.services.telemetry,r.default.services.trialDialog,r.default.services.url,r.default.services.userFlowAccountClient,p.isShared,p.populateRunOnlyUser],e}();t.FlowPropertiesCtrl=m},function(e,t){},function(e,t){e.exports='<section class="context-flow-properties"> <heading back="flowPropertiesCtrl.backButton" label="flowPropertiesCtrl.flowDisplayName" links="flowPropertiesCtrl.headingLinks" toggle="flowPropertiesCtrl.headingToggle" dropdown="flowPropertiesCtrl.dropdown" dropdown-commands="flowPropertiesCtrl.commandsInDropDown"> </heading> <alert class="flow-properties-alert" model="flowPropertiesCtrl.errorAlert"/> <run-flow-dialog ng-if="flowPropertiesCtrl.runFlowDialog.show" modal-dialog="flowPropertiesCtrl.runFlowDialog" flow-id="flowPropertiesCtrl.runFlowId"/> <delete-flow-dialog ng-if="flowPropertiesCtrl.deleteFlowDialog.show" modal-dialog="flowPropertiesCtrl.deleteFlowDialog" flow="flowPropertiesCtrl.flow"/> <div class="flow-properties-content"> <div class="row"> <div class="column"> <flow-mobile-banner-tile ng-if="flowPropertiesCtrl.displayMobileBannerTile" flow="flowPropertiesCtrl.flow" context="flowPropertiesCtrl.context"></flow-mobile-banner-tile> </div> </div> <div class="row"> <div class="column large-8 tiles-container"> <flow-details-tile flow="flowPropertiesCtrl.flow"></flow-details-tile> <flow-runs-tile flow="flowPropertiesCtrl.flow" context="flowPropertiesCtrl.context" is-shared="flowPropertiesCtrl.isShared"></flow-runs-tile> </div> <div class="column large-4 tiles-container"> <flow-connections-tile flow-name="flowPropertiesCtrl.flowName" flow="flowPropertiesCtrl.flow" context="flowPropertiesCtrl.context" is-shared="flowPropertiesCtrl.isShared"></flow-connections-tile> <flow-owners-tile flow-name="flowPropertiesCtrl.flowName" flow="flowPropertiesCtrl.flow" error-alert="flowPropertiesCtrl.errorAlert" context="flowPropertiesCtrl.context" is-shared="flowPropertiesCtrl.isShared"></flow-owners-tile> <flow-run-only-tile ng-if="flowPropertiesCtrl.displayRunOnlyManagement" flow-name="flowPropertiesCtrl.flowName" flow="flowPropertiesCtrl.flow" error-alert="flowPropertiesCtrl.errorAlert" context="flowPropertiesCtrl.context" populate-run-only-user="flowPropertiesCtrl.populateRunOnlyUser"></flow-run-only-tile> </div> </div> <div class="row ruler"> <div class="column"> <hr/> </div> </div> <recommend-templates flow-name="flowPropertiesCtrl.flowName" ng-if="flowPropertiesCtrl.loadTemplates"></recommend-templates> <flow-save-as-dialog modal-dialog="flowPropertiesCtrl.flowSaveAsDialog" ng-if="flowPropertiesCtrl.flowSaveAsDialog.show"></flow-save-as-dialog> <submit-template model="flowPropertiesCtrl.submitTemplatePane" ng-if="flowPropertiesCtrl.submitTemplatePane.show"></submit-template> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(10),o=i(18),s=i(7),a=i(6),l=i(4),c=i(36),u=i(50),p=i(3),d=i(5),g=i(23),m=i(31),f=i(49),h=i(14),v=i(32),y=function(){function e(e,t,i,r,o,a,c,p,m,f,v,y,w,C,S,b,P,R,T,E){var A=this;this.$scope=e,this.$locationService=t,this.$window=i,this.alertService=r,this.appSettings=o,this.clientResources=a,this.environmentsClient=c,this.environmentService=p,this.flowsClient=m,this.loggingService=f,this.navigationService=v,this.navigationHelperService=y,this.planService=w,this.policiesService=C,this.promiseHelperService=S,this.sessionService=b,this.telemetryService=P,this.trialDialog=R,this.urlService=T,this.isShared=E,this.spinner={size:s.SpinnerSize.Large,local:s.SpinnerPosition.Local},this.widgetCreateButtonsEnabled=!1,this.statusAlert={type:n.AlertType.None,message:"",options:{}},this.TabNames={personal:g.FlowType.personal,shared:g.FlowType.shared},this.hostCommunicationService=u.HostCommunicationService.instance,this.fullPageErrorModel={image:d.default.fullPageErrorListFlows,isPageErrored:!1,pageTitle:this.clientResources.Manage.Flows.MyFlows,customButtons:[{event:h.ScopeEmittedEvents.fullPageErrorCreateFromBlankClicked,buttonText:this.clientResources.Manage.Flows.CreateFlowFromBlank},{event:h.ScopeEmittedEvents.fullPageErrorCreateFromTemplateClicked,buttonText:this.clientResources.Manage.Flows.CreateFlowFromTemplate}]},this.alertService.hasAlerts()&&(this.statusAlert.type=n.AlertType.Error,this.statusAlert.message=this.alertService.dequeueAlert().message);var D=this.loggingService.profilePageStart(this.isShared?l.ProfilingEventNames.mySharedFlowsLoadStart:l.ProfilingEventNames.myFlowsLoadStart);E?(this.spinner.show=!0,this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(){return A.policiesService.checkUserCanShareFlows}).then(function(e){e?(A.allowSharedFlows=!0,A.initializeComponent(D)):(A.allowSharedFlows=!1,A.trialDialog.showBlockedFeatureStartTrialDialog(function(e){A.allowSharedFlows=e,e&&A.initializeComponent(D)}))}).finally(function(){A.spinner.show=!1})):(this.allowSharedFlows=!0,this.initializeComponent(D))}return e.prototype.initializeComponent=function(e){var t=this,i=!this.isOperationsFilter(),r=this.flowsClient.query(this.$scope,o.getFlowsQueryParams({isPersonal:i})),n=this.flowsClient.query(this.$scope,o.getFlowsQueryParams({isPersonal:!1,isShared:!0}));this.flowList={id:"flows",markedForDeletion:[],flows:this.isShared?n:r,statusAlert:this.statusAlert,isShared:this.isShared,loadingMoreSpinner:{size:s.SpinnerSize.Small,local:s.SpinnerPosition.LocalHorizontal},hasMore:function(){return t.flowList.flows&&t.flowList.flows.$hasNextPage()},isLoadingMore:!1,loadNextPage:function(){t.flowList.hasMore()&&(t.flowList.isLoadingMore=!0,t.flowList.loadingMoreSpinner.show=!0,t.flowList.flows.$getNextPage().finally(function(){t.flowList.isLoadingMore=!1,t.flowList.loadingMoreSpinner.show=!1}))}},this.$scope.$on(h.ScopeEmittedEvents.fullPageErrorCreateFromBlankClicked,function(){t.onCreateFromBlank()}),this.$scope.$on(h.ScopeEmittedEvents.fullPageErrorCreateFromTemplateClicked,function(){t.onCreateFromTemplate()}),this.spinner.show=!0,this.appSettings.isWidgetPage&&this.environmentsClient.checkEnvironmentAccess({environmentName:this.environmentService.getCurrentEnvironmentName()}).catch(function(e){e&&e.data&&e.data.error&&"EnvironmentAccessDenied"===e.data.error.code&&p.showFullPageError(t.fullPageErrorModel,e,t.clientResources.FullPageError.FriendlyError.Text.EnvironmentAccess,t.clientResources.FullPageError.FriendlyError.Subtext.EnvironmentAccess)}),this.headingLinks=[{label:this.clientResources.Manage.Flows.CreateFlowFromBlank,action:function(){return t.onCreateFromBlank()},disabled:this.shouldDisableCreateLinks(),svgId:"glyph-create"},{label:this.clientResources.Manage.Flows.CreateFlowFromTemplate,action:function(){return t.onCreateFromTemplate()},disabled:this.shouldDisableCreateLinks(),image:d.default.templateNew}],this.appSettings.featureFlags.enableFlowImportExport&&!this.appSettings.isWidgetPage&&this.headingLinks.push({label:this.clientResources.Manage.Flows.Import,action:function(){return t.onImportFromPackage()},disabled:this.shouldDisableCreateLinks(),image:d.default.import}),this.headingButtons=[{label:this.clientResources.Manage.Flows.CreateFlowFromBlank,action:function(){return t.onCreateFromBlank()},disabled:function(){return t.shouldDisableCreateLinks()},svgId:"glyph-create"},{label:this.clientResources.Manage.Flows.CreateFlowFromTemplate,action:function(){return t.onCreateFromTemplate()},disabled:function(){return t.shouldDisableCreateLinks()},image:d.default.templateNew}],this.tabs={tabSelected:this.selectedTab,tabsInfo:[{tabHeader:this.clientResources.Manage.Flows.Tabs.Personal,tabName:this.TabNames.personal,href:this.navigateUrl(this.TabNames.personal),eventName:"SwitchFlowsListClicked"},{tabHeader:this.clientResources.Manage.Flows.Tabs.Shared,tabName:this.TabNames.shared,href:this.navigateUrl(this.TabNames.shared),eventName:"SwitchFlowsListClicked"}]},this.flowList.flows.$promise.then(function(){return t.loggingService.profilePageEnd(e,t.isShared?l.ProfilingEventNames.mySharedFlowsLoadEnd:l.ProfilingEventNames.myFlowsLoadEnd,{status:p.Status.Success})}).catch(function(i){throw t.loggingService.profilePageEnd(e,t.isShared?l.ProfilingEventNames.mySharedFlowsLoadEnd:l.ProfilingEventNames.myFlowsLoadEnd,{status:p.inferErrorStatus(i),error:p.parseErrorMessage(i)}),t.loggingService.logError(t.isShared?"FlowCtrl.MySharedFlowsLoad":"FlowCtrl.MyFlowsLoad",i),0===t.flowList.flows.length&&p.showFullPageError(t.fullPageErrorModel,i),i}).finally(function(){t.appSettings.isWidgetPage&&t.hostCommunicationService.triggerHostEvent(g.WidgetHostAction.WIDGETREADY),t.spinner.show=!1}),this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).finally(function(){t.widgetCreateButtonsEnabled=!0,t.planService.isPlanExpired()&&(t.fullPageErrorModel.customButtons=[{buttonText:t.clientResources.Common.VisitFlowPortal,url:t.appSettings.siteOrigin}],p.showFullPageError(t.fullPageErrorModel,null,t.clientResources.FullPageError.FriendlyError.Text.WidgetPlanExpired,t.clientResources.FullPageError.FriendlyError.Subtext.WidgetPlanExpired))}),c.loadDesignerScripts(this.appSettings,this.loggingService)},e.prototype.shouldShowFlowsList=function(){return this.allowSharedFlows&&!this.fullPageErrorModel.isPageErrored&&!!this.flowList&&this.flowList.flows&&this.flowList.flows.length>0&&!angular.equals(this.flowList.flows.map(function(e){return e.id}),this.flowList.markedForDeletion.map(function(e){return e.id}))},e.prototype.shouldShowZeroFlowsPage=function(){return!this.isShared&&!(this.shouldShowFlowsList()||this.fullPageErrorModel.isPageErrored)&&!this.spinner.show},e.prototype.shouldShowZeroSharedFlowsPage=function(){return this.isShared&&!(this.shouldShowFlowsList()||this.fullPageErrorModel.isPageErrored)&&!this.spinner.show},e.prototype.shouldDisableCreateLinks=function(){return this.appSettings.isWidgetPage&&!this.widgetCreateButtonsEnabled},e.prototype.shouldShowFlowsFromApp=function(){return this.appSettings.isWidgetPage&&this.appSettings.widgetInfo&&this.appSettings.widgetInfo.flowsSettings&&(this.appSettings.widgetInfo.flowsSettings.flowsFilter||"").toLowerCase().indexOf("search('manual')")>=0},e.prototype.isOperationsFilter=function(){var e=this.appSettings.widgetInfo,t=new RegExp("operations\\s*\\/\\s*any\\(\\s*operation\\s*");return this.appSettings.isWidgetPage&&e&&e.flowsSettings&&e.flowsSettings.flowsFilter&&t.test(e.flowsSettings.flowsFilter.toLowerCase())},e.prototype.onCreateFromBlank=function(){this.telemetryService.tagEvent(a.TelemetryEventNames.CreateFlowStarted,{gettingStarted:this.appSettings.featureFlags.enableNewFlowGettingStarted}),this.appSettings.featureFlags.enableNewFlowGettingStarted?this.navigationHelperService.navigateToNewBlankFlowGettingStarted():this.navigationHelperService.navigateToNewBlankFlow()},e.prototype.onImportFromPackage=function(){this.telemetryService.tagEvent(a.TelemetryEventNames.ImportFromPackageClicked),this.policiesService.shouldShowUpgradeToProDialog()?this.trialDialog.showUpgradeToProRequiredDialog():this.navigationService.navigate(this.urlService.importFlowRoute())},e.prototype.onCreateFromTemplate=function(){this.telemetryService.tagEvent(a.TelemetryEventNames.BrowseTemplatesClicked),this.navigationHelperService.navigateToBrowseTemplates()},e.prototype.getFlowTemplateLink=function(){return this.urlService.newTemplateFlowRoute(this.getCurrentEnvironmentName())},e.prototype.getCurrentEnvironmentName=function(){return this.appSettings.featureFlags.enableEnvironments?this.environmentService.getCurrentEnvironmentName():null},e.prototype.getManageFlowsUrl=function(){var e="";return this.appSettings.featureFlags.enableEnvironments&&(e=this.environmentService.getCurrentEnvironmentName()),this.urlService.getFlowsFullPath(e)},e.prototype.getSharedFlowsUrl=function(){var e="";return this.appSettings.featureFlags.enableEnvironments&&(e=this.environmentService.getCurrentEnvironmentName()),this.urlService.getSharedFlowsFullPath(e)},Object.defineProperty(e.prototype,"title",{get:function(){return this.isShared?this.clientResources.Manage.Flows.MySharedFlows:this.clientResources.Manage.Flows.MyFlows},enumerable:!0,configurable:!0}),e.prototype.getQuickLink=function(){return this.isShared?this.getManageFlowsUrl():this.getSharedFlowsUrl()},Object.defineProperty(e.prototype,"quickLinkText",{get:function(){return this.isShared?this.clientResources.Manage.Flows.MyFlows:this.clientResources.Manage.Flows.MySharedFlows},enumerable:!0,configurable:!0}),e.prototype.navigateUrl=function(e){var t=this.urlService.manageRouteWithEnvironment(this.environmentService.getCurrentEnvironmentName()),i=e===this.TabNames.shared?""+m.getListSharedFlowsUrl():""+m.getListFlowsUrl();if(t=f.concatParts(t,i),this.appSettings.isWidgetPage){var r=this.urlService.getWidgetQueryStringParameters(this.environmentService.getCurrentEnvironmentName()),n="?"+v.createQueryString(r);t=f.concatParts(t,n)}return t},Object.defineProperty(e.prototype,"selectedTab",{get:function(){return this.isShared?this.TabNames.shared:this.TabNames.personal},enumerable:!0,configurable:!0}),e.prototype.showTabs=function(){var e=this.appSettings.isWidgetPage,t=this.appSettings.featureFlags.enableFlowCoauthoring,i=this.appSettings.featureFlags.enableWidgetTeamFlows&&!this.isOperationsFilter();return t&&(!e||e&&i)},e.$inject=[r.default.services.$scope,r.default.services.$location,r.default.services.$window,r.default.services.alertService,r.default.services.appSettings,r.default.services.clientResources,r.default.services.environmentsClient,r.default.services.environment,r.default.services.flowsClient,r.default.services.logging,r.default.services.navigation,r.default.services.navigationHelper,r.default.services.plan,r.default.services.policies,r.default.services.promiseHelperService,r.default.services.session,r.default.services.telemetry,r.default.services.trialDialog,r.default.services.url,g.isShared],e}();t.FlowsCtrl=y},function(e,t,i){"use strict";function r(e){return(e||"").replace(/\.js$/,"")}function n(e,t){return[t]}function o(e){var t;return t=e.featureFlags.minify?{next:i(582),previous:i(583),diet:i(584),default:i(585)}:{next:i(586),previous:i(587),diet:i(588),default:i(589)},Object.keys(t).forEach(function(e){t[e]=r(t[e])}),[t[e.featureFlags.designer]]}function s(e){var t=o(e),s={"core/main":t,flux:t,Draft:[i(590)],Immutable:[i(591)],SwaggerParser:[i(592)],fuse:[i(593)],glamor:[i(594)],localforage:[i(595)],"prop-types":[i(596)],react:[i(597)],"react-dom":[i(598)],"rtl-css-js":[i(599)],"office-ui-fabric-react":[i(600)],"vs/loader":[i(601)],"vs/editor/editor.main":[i(602)],"vs/editor/editor.main.nls":[i(603)]};return Object.keys(s).forEach(function(t){var i=r(s[t][0]);s[t]=n(e,i)}),s}function a(e){var t=e.featureFlags.minify?["core.all.min"]:["core.all"];return{"core/main":t,flux:t,Draft:["draft.min"],Immutable:["immutable.min"],SwaggerParser:["swagger-parser.min"],fuse:["fuse.min"],glamor:["glamor/index.min"],localforage:["localforage.min"],"prop-types":["prop-types/prop-types.min"],react:["react.min"],"react-dom":["react-dom.min"],"rtl-css-js":["rtl-css-js/index.umd.min"],"office-ui-fabric-react":["office-ui-fabric-react/office-ui-fabric-react.min"],"vs/loader":["monaco-editor/loader"],"vs/editor/editor.main":["monaco-editor/editor/editor.main"],"vs/editor/editor.main.nls":["monaco-editor/editor/editor.main.nls"]}}function l(e){return{"core/main":["core/main"],flux:["node_modules/flux/dist/flux.min"],Draft:["node_modules/draft-js/dist/Draft.min"],Immutable:["node_modules/immutable/dist/immutable.min"],SwaggerParser:["node_modules/swagger-parser/swagger-parser.min"],fuse:["node_modules/fuse.js/src/fuse.min"],glamor:["node_modules/glamor/umd/index.min"],localforage:["node_modules/localforage/dist/localforage.min"],"prop-types":["node_modules/prop-types/prop-types.min"],react:["node_modules/react/dist/react.min"],"react-dom":["node_modules/react-dom/dist/react-dom.min"],"rtl-css-js":["node_modules/rtl-css-js/dist/index.umd.min"],"office-ui-fabric-react":["node_modules/office-ui-fabric-react/dist/office-ui-fabric-react.min"],"vs/loader":["node_modules/monaco-editor/dev/vs/loader"],"vs/editor/editor.main":["node_modules/monaco-editor/dev/vs/editor/editor.main"],"vs/editor/editor.main.nls":["node_modules/monaco-editor/dev/vs/editor/editor.main.nls"]}}function c(e){var t,i=(u(e),{}),r=e.featureFlags.designer;d.equalsIgnoreCase(r,"dev")?(t="https://localhost:8080/",e.featureFlags.currentDesignerVersion="dev",i=p.__assign({},l(e),{"@microsoft/load-themed-styles":"node_modules/@microsoft/load-themed-styles/lib-amd/index","@uifabric/styling/lib":"node_modules/@uifabric/styling/lib-amd","@uifabric/utilities/lib":"node_modules/@uifabric/utilities/lib-amd"})):d.equalsIgnoreCase(r,"latip1")?(e.featureFlags.currentDesignerVersion=e.designer.versions.latip1,t=""+e.designer.logicAppPortalBasePath+e.designer.versions.latip1+"/Scripts/EMAExtension/Client/logicappdesigner/",i=a(e)):(t="/",e.featureFlags.currentDesignerVersion=e.designer.versions[r],i=s(e));var n={};e.designer.officeFabricModules.map(function(e){n["office-ui-fabric-react/lib/"+e]="office-ui-fabric-react"});var o=window.requirejs.config({context:"flowDesigner",waitSeconds:e.designer.scriptsDownloadTimeout,baseUrl:t,paths:p.__assign({resources:u(e)},i),shim:{"office-ui-fabric-react":{exports:"Fabric"}},map:{"*":n}});return(0,window.define)("tslib",[],function(){return g}),o}function u(e){var i=e.featureFlags.designer,r=e.designer.locale,n=[];if(d.equalsIgnoreCase(i,"latip1")){var o=""+e.designer.logicAppPortalBasePath+e.designer.versions.latip1+"/Scripts/EMAExtension/Client/logicappdesigner/";d.equalsIgnoreCase(r,"en")||!r?n.push(o+"resources.powerapps"+(e.featureFlags.minify?".min":"")):n.push(o+"loc_gen/"+r+"/resources.powerapps"+(e.featureFlags.minify?".min":""))}else if(d.equalsIgnoreCase(i,"dev"))n.push("resources/resources.powerapps");else{var s=".js?v="+e.designer.versions[i]+"-2";e.featureFlags.minify&&(s=".min"+s),d.equalsIgnoreCase(r,t.DesignerConstant.defaultDesignerLocale)||n.push(t.DesignerConstant.baseResourcePath+"/"+i+"/"+t.DesignerConstant.locGenFolder+"/"+r+"/"+t.DesignerConstant.resourceName+s),n.push(t.DesignerConstant.baseResourcePath+"/"+i+"/"+t.DesignerConstant.resourceName+s)}return n}Object.defineProperty(t,"__esModule",{value:!0});var p=i(13),d=i(8),g=i(13);t.DesignerConstant={baseResourcePath:"/Content/Scripts/designer",resourceName:"resources.powerapps",locGenFolder:"loc_gen",defaultDesignerLocale:"en"},t.removeTrailingJsExtension=r,t.appendCdnFallbackUrl=n,t.getFlowPortalDesignerCoreAllPaths=o,t.getFlowPortalDesignerPathMappings=s,t.getLogicAppTip1DesignerPathMappings=a,t.getDevDesignerPathMappings=l,t.requireJsConfig=c,t.getDesignerResourcePath=u},function(e,t,i){e.exports=i.p+"designer.next.core.all.ae533140aae9c9eff5ff39a8381874e2.2.min.js"},function(e,t,i){e.exports=i.p+"designer.previous.core.all.18a902cf0d9bd2004681f935098db6f4.2.min.js"},function(e,t,i){e.exports=i.p+"desginer.diet.core.all.5f8567cccc2e875fb423f4b749239db1.2.min.js"},function(e,t,i){e.exports=i.p+"designer.default.core.all.8d0e90f0d489849df7c7ef983abdc400.2.min.js"},function(e,t,i){e.exports=i.p+"designer.next.core.all.27de3c0d4bb646dc5533f23b5d92385f.2.js"},function(e,t,i){e.exports=i.p+"desginer.previous.core.all.9deb91e43821451dd16e3486151c3af9.2.js"},function(e,t,i){e.exports=i.p+"designer.diet.core.all.d28c7e89be7bfa7f96354cb5c79dd324.2.js"},function(e,t,i){e.exports=i.p+"designer.default.core.all.d228b198e022508528b1f4b893eb6498.2.js"},function(e,t,i){e.exports=i.p+"draft.8fcd6cc65d73636a9c2bd8be0cbb2174.2.min.js"},function(e,t,i){e.exports=i.p+"immutable.fb53c333cdd35f6cb10123dc2f20ebd5.2.min.js"},function(e,t,i){e.exports=i.p+"SwaggerParser.3263f84b18a9683cf48a8bcacedaff0c.2.min.js"},function(e,t,i){e.exports=i.p+"fuse.941291af93006873c2d9e7885decc181.2.min.js"},function(e,t,i){e.exports=i.p+"glamor.69e3f26d81f2c206b611f87bddc404eb.2.min.js"},function(e,t,i){e.exports=i.p+"localforage.04bbe882c627de0c0d294e1fa7d8ca8b.2.min.js"},function(e,t,i){e.exports=i.p+"prop-types.154ea6109046fe8cda334bdfcfefee81.2.min.js"},function(e,t,i){e.exports=i.p+"react.fe3e04b0a969e3722ae34c9a06ef8f32.2.min.js"},function(e,t,i){e.exports=i.p+"reactdom.f9265a487ab6e128d66c4e01a4b530d3.2.min.js"},function(e,t,i){e.exports=i.p+"rtlcssjs.03802addd1cb559e519ecd28ca8485e3.2.min.js"},function(e,t,i){e.exports=i.p+"office-ui-fabric-react.4e7f50d2da57c0a30645492eba85de04.2.min.js"},function(e,t,i){e.exports=i.p+"monaco-editor/loader.js"},function(e,t,i){e.exports=i.p+"monaco-editor/editor/editor.main.js"},function(e,t,i){e.exports=i.p+"monaco-editor/editor/editor.main.nls.js"},function(e,t){},function(e,t){e.exports='<div class="flows-list-page"> <div class="subsection-manage" ng-if="!flowsCtrl.fullPageErrorModel.isPageErrored"> <div class="heading" ng-class="{\'widget-heading\' : flowsCtrl.appSettings.isWidgetPage}" ng-show="!flowsCtrl.showTabs()"> <div class="row"> <div class="column medium-5"> <h1>{{::flowsCtrl.title}}</h1> </div> <div class="heading-buttons"> <button class="c-button text-ellipsis-button" ng-disabled="flowsCtrl.shouldDisableCreateLinks()" ng-click="flowsCtrl.onCreateFromBlank()">{{::flowsCtrl.clientResources.Manage.Flows.CreateFlowFromBlank}}</button> <button class="c-button text-ellipsis-button" ng-disabled="flowsCtrl.shouldDisableCreateLinks()" ng-click="flowsCtrl.onCreateFromTemplate()">{{::flowsCtrl.clientResources.Manage.Flows.CreateFlowFromTemplate}}</button> </div> </div> </div> <div ng-class="{\'heading widget-heading\' : flowsCtrl.appSettings.isWidgetPage}"> <heading tabs="flowsCtrl.tabs" buttons="flowsCtrl.appSettings.isWidgetPage ? flowsCtrl.headingButtons : undefined" links="!flowsCtrl.appSettings.isWidgetPage ? flowsCtrl.headingLinks : undefined" columns="flowsCtrl.headingColumns" ng-if="flowsCtrl.showTabs()"> </heading> </div> <div class="row top-align" ng-class="{\'row-isWidgetPage\' : flowsCtrl.appSettings.isWidgetPage, \'tab-content-container\': flowsCtrl.showTabs()}"> <div ng-if="flowsCtrl.shouldShowFlowsFromApp()"> <p class="c-paragraph-3"> {{::flowsCtrl.clientResources.ShowFlows.FromApp}} <a class="c-hyperlink" target="_blank" href="{{flowsCtrl.getManageFlowsUrl()}}">{{::flowsCtrl.clientResources.NavigateToFlows.FromApp}}</a> </p> </div> <alert model="flowsCtrl.statusAlert"></alert> <div class="column"> <spinner model="flowsCtrl.spinner" ng-class="{\'left: 35%\' : flowsCtrl.appSettings.isWidgetPage}"></spinner> <flow-list model="flowsCtrl.flowList" ng-if="flowsCtrl.shouldShowFlowsList()"></flow-list> </div> </div> </div> <div class="tab-content-container" ng-if="flowsCtrl.shouldShowZeroFlowsPage()"> <zero-flows></zero-flows> </div> <div class="row" ng-if="flowsCtrl.shouldShowZeroSharedFlowsPage()"> <p class="c-paragraph-3">{{::flowsCtrl.clientResources.Manage.Flows.ZeroSharedFlowText}}</p> </div> <full-page-error model="flowsCtrl.fullPageErrorModel" ng-if="flowsCtrl.fullPageErrorModel.isPageErrored"></full-page-error> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(607);i(608);var o=function(){function e(){this.template=i(609),this.controller=n.ImportFlowCtrl,this.controllerAs="importFlowCtrl"}return e}();t.ImportFlow=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.importFlow,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13);i(88);var n=i(4),o=i(116),s=i(0),a={cancelImportPackageClicked:"CANCEL_IMPORT_PACKAGE_CLICKED"},l=function(e){function t(t,i,r,o,s,l,c,u){var p=e.call(this,i,r,s,c,"import",{container:"powerapps-import"},{environmentName:o.getCurrentEnvironmentName()},n.ProfilingEventNames.importFlowPageLoadStart,n.ProfilingEventNames.importFlowPageLoadEnd)||this;return p.$routeParams=t,p.$scope=i,p.appSettings=r,p.environmentService=o,p.loggingService=s,p.navigationService=l,p.sessionService=c,p.urlService=u,p.widget.listen(a.cancelImportPackageClicked,function(){p.$scope.$apply(function(){p.navigationService.navigate(p.urlService.flowsRoute())})}),p}return r.__extends(t,e),t.$inject=[s.default.services.$routeParams,s.default.services.$scope,s.default.services.appSettings,s.default.services.environment,s.default.services.logging,s.default.services.navigation,s.default.services.session,s.default.services.url],t}(o.PowerAppsWidgetCtrl);t.ImportFlowCtrl=l},function(e,t){},function(e,t){e.exports='<spinner model="importFlowCtrl.spinner"></spinner> <div id="powerapps-import" class="powerapps-import" ng-show="importFlowCtrl.contentLoaded"></div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(15),s=i(3),a=i(19),l=i(1),c=i(18),u=i(7),p=i(4),d=function(){function e(e,t,i,r,o,s,l,p,d){var g=this;this.$scope=e,this.$routeParams=t,this.appSettings=i,this.clientResources=r,this.flowRolesClient=o,this.flowsClient=s,this.loggingService=l,this.navigationService=p,this.urlService=d,this.handleCancel=function(e){a.isCoauthoredFlow(e)?g.navigateToTeamFlowsPage():g.navigateToMyFlowsPage()},this.flowName=t.flowName||null,this.flowId=c.getFlowId(this.flowName),this.inputData={flowId:this.flowId},this.fullPageErrorModel={image:n.default.fullPageErrorDebugFlow,isPageErrored:!1,pageTitle:this.clientResources.ErrorPageTitle.RunFlow},this.spinner={size:u.SpinnerSize.Large,show:!0,local:u.SpinnerPosition.Local},this.requestRunOnlyAccessHeader=this.clientResources.RequestFlowAccess.RunPermissionMessage,this.requestRunOnlyAccessShowButton=!0,this.loadRunFlowPage()}return e.prototype.loadRunFlowPage=function(){var e=this,t=this.loggingService.profilePageStart(p.ProfilingEventNames.runFlowPageLoadStart,{flowName:this.flowName});this.spinner.show=!0;var i=this.flowsClient.get(this.$scope,{id:this.inputData.flowId});return i.$promise.then(function(){if(!a.isRunnableFlow(i))throw new o.ClientError(o.ErrorCodes.flowNotRunnable,l.format(e.clientResources.RunFlow.FlowNotRunnable,i.properties.displayName),null,{flowName:i.name});e.loggingService.profileEnd(t,p.ProfilingEventNames.runFlowPageLoadEnd,{status:s.Status.Success,flowName:i.name})}).catch(function(i){e.loggingService.logError("RunFlowCtrl.loadRunFlowPage",i),e.loggingService.profileEnd(t,p.ProfilingEventNames.runFlowPageLoadEnd,{status:s.inferErrorStatus(i),error:s.parseErrorMessage(i),flowName:e.flowName}),s.showFullPageError(e.fullPageErrorModel,i),e.getFlowErrorCode=i.status}).finally(function(){e.spinner.show=!1})},e.prototype.navigateToMyFlowsPage=function(){this.navigationService.navigate(this.urlService.flowsRoute())},e.prototype.navigateToTeamFlowsPage=function(){this.navigationService.navigate(this.urlService.sharedFlowsRoute())},e.prototype.showRequestAccessPage=function(){return this.appSettings.featureFlags.enableRequestRunOnlyAccessPage&&this.fullPageErrorModel.isPageErrored&&403===this.getFlowErrorCode&&this.fullPageErrorModel.error&&s.parseErrorCode(this.fullPageErrorModel.error)===s.errorConstants.connectionAuthorizationFailed},e.prototype.showErrorPage=function(){return!this.appSettings.featureFlags.enableRequestRunOnlyAccessPage&&this.fullPageErrorModel.isPageErrored||this.appSettings.featureFlags.enableRequestRunOnlyAccessPage&&!this.showRequestAccessPage()},e.prototype.requestRunOnlyAccess=function(){var e=this,t=this.loggingService.profileStart(p.ProfilingEventNames.requestRunOnlyAccessStart,{flowName:this.flowName});return this.flowRolesClient.requestAccess({flowName:this.flowName}).then(function(){e.loggingService.profileEnd(t,p.ProfilingEventNames.requestRunOnlyAccessEnd,{status:s.Status.Success,flowName:e.flowName}),e.requestRunOnlyAccessShowButton=!1,e.requestRunOnlyAccessHeader=e.clientResources.RequestFlowAccess.ConfirmationMessage}).catch(function(i){e.loggingService.profileEnd(t,p.ProfilingEventNames.requestRunOnlyAccessEnd,{status:s.Status.Failure,flowName:e.flowName}),e.requestRunOnlyAccessShowButton=!1,e.requestRunOnlyAccessHeader=e.clientResources.RequestFlowAccess.ErrorMessage,e.requestRunOnlyAccessSubHeader=s.parseErrorMessage(i)})},e.$inject=[r.default.services.$scope,r.default.services.$routeParams,r.default.services.appSettings,r.default.services.clientResources,r.default.services.flowRolesClient,r.default.services.flowsClient,r.default.services.logging,r.default.services.navigation,r.default.services.url],e}();t.RunFlowCtrl=d},function(e,t){},function(e,t){e.exports='<div class="run-flow"> <div class="row" ng-if="!runFlowCtrl.fullPageErrorModel.isPageErrored"> <run-flow-content input-data="runFlowCtrl.inputData" on-cancel="runFlowCtrl.handleCancel" on-done="runFlowCtrl.handleCancel"> </run-flow-content> </div> <full-page-single-action ng-if="runFlowCtrl.showRequestAccessPage()" header="runFlowCtrl.requestRunOnlyAccessHeader" sub-header="runFlowCtrl.requestRunOnlyAccessSubHeader" button-text="runFlowCtrl.clientResources.RequestFlowAccess.Button.Text" render-button="runFlowCtrl.requestRunOnlyAccessShowButton" on-click="runFlowCtrl.requestRunOnlyAccess()"></full-page-single-action> </div> <full-page-error model="runFlowCtrl.fullPageErrorModel" ng-if="runFlowCtrl.showErrorPage()"></full-page-error>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(1),o=i(18),s=i(50),a=i(15),l=i(3),c=i(4),u=i(23),p=i(5),d=function(){function e(e,t,i,r,n,d,g,m,f,h){var v=this;this.$q=e,this.$sce=t,this.$scope=i,this.$timeout=r,this.appSettings=n,this.clientResources=d,this.environmentService=g,this.flowsClient=m,this.loggingService=f,this.urlService=h,this.hostCommunicationService=s.HostCommunicationService.instance,this.environmentSafeHostCommunicationServiceCallback=function(e){return v.isEnvironmentNameAvailable?e:v.$q.reject({code:a.ErrorCodes.runFlowWidgetNotReady,message:"Widget not ready. Wait for WIDGET_READY event"})},this.handleCancel=function(){v.loggingService.logInfo(c.ProfilingEventNames.runFlowWidgetTriggerFlowCancelled,"TriggerFlow cancelled"),v.hostCommunicationService.triggerHostEvent(u.WidgetHostAction.RUNFLOWCANCELBUTTONCLICKED),v.runFlowDeferredPromise.reject({code:a.ErrorCodes.runFlowWidgetCancelled,message:"The flow was cancelled"})},this.handleDone=function(){v.loggingService.logInfo(c.ProfilingEventNames.runFlowWidgeRunFlowDoneButtonClicked,"RunFlow Done button clicked"),v.hostCommunicationService.triggerHostEvent(u.WidgetHostAction.RUNFLOWDONEBUTTONCLICKED)},this.handleRendered=function(){v.hostCommunicationService.triggerHostEvent(u.WidgetHostAction.WIDGETRENDERED)},this.handleFlowRunRequestCompletion=function(){v.loggingService.logInfo(c.ProfilingEventNames.runFlowWidgetTriggerFlowEnd,"TriggerFlow completed"),v.runFlowDeferredPromise&&v.runFlowDeferredPromise.resolve({data:"TriggerFlowCompleted"}),v.runFlowByTemplateDeferredPromise&&v.runFlowByTemplateDeferredPromise.resolve({data:"TriggerFlowCompleted"}),v.hostCommunicationService.triggerHostEvent(u.WidgetHostAction.RUNFLOWCOMPLETED)},this.handleFlowRunRequestStart=function(){v.hostCommunicationService.triggerHostEvent(u.WidgetHostAction.RUNFLOWSTARTED)},this.handleFlowRunRequestError=function(e){v.loggingService.logError(c.ProfilingEventNames.runFlowWidgetTriggerFlowError,e);var t=l.parseErrorMessage(e,v.clientResources.Common.SomethingWentWrong);l.showFullPageError(v.fullPageErrorModel,e,v.clientResources.Common.SomethingWentWrong),v.runFlowDeferredPromise.reject({code:a.ErrorCodes.runFlowWidgetError,message:t})},this.handleCreateFlowCompletion=function(e){v.showTemplateWidget=!1,v.flowPath=o.getFlowId(e),v.showFlowRunContentAndHideError(),v.inputData={flowId:v.flowPath,implicitData:v.implicitData}},this.handleCreateFlowError=function(e){v.loggingService.logError(c.ProfilingEventNames.runFlowWidgetTriggerFlowError,e);var t=l.parseErrorMessage(e,v.clientResources.Common.SomethingWentWrong);l.showFullPageError(v.fullPageErrorModel,e,v.clientResources.Common.SomethingWentWrong),v.runFlowByTemplateDeferredPromise.reject({code:a.ErrorCodes.runFlowWidgetError,message:t})},this.fullPageErrorModel={image:p.default.fullPageErrorListFlows,isPageErrored:!1,pageTitle:this.clientResources.Flow.Title,customButtons:[]},this.hostCommunicationService.onTriggerFlow(function(e){return v.environmentSafeHostCommunicationServiceCallback(v.handleTriggerFlow(e))}),this.hostCommunicationService.onTriggerFlowByTemplate(function(e){return v.environmentSafeHostCommunicationServiceCallback(v.handleTriggerFlowByTemplate(e))}),this.hostCommunicationService.onGetTriggerSchema(function(e){return v.environmentSafeHostCommunicationServiceCallback(v.handleGetTriggerSchema(e))}),this.isEnvironmentNameAvailable?this.hostCommunicationService.triggerHostEvent(u.WidgetHostAction.WIDGETREADY):this.$timeout(function(){var e=new Error(v.clientResources.Widget.RuntimeFlow.Error.NeverLoadedWithEnvironment);v.loggingService.logError(a.ErrorCodes.runFlowWidgetNeverLoadedWithEnvironment,e),l.showFullPageError(v.fullPageErrorModel,e,v.clientResources.Common.SomethingWentWrong)},1e4),this.installFlow=!0}return Object.defineProperty(e.prototype,"isEnvironmentNameAvailable",{get:function(){return!n.isNullOrWhitespace(this.environmentService.getCurrentEnvironmentName())},enumerable:!0,configurable:!0}),e.prototype.showFlowRunContentAndHideError=function(){this.fullPageErrorModel.isPageErrored=!1,this.showRunFlowContent=!0},e.prototype.showTemplateWidgetAndHideError=function(){this.fullPageErrorModel.isPageErrored=!1,this.showTemplateWidget=!0},e.prototype.handleTriggerFlow=function(e){var t=this;if(this.runFlowDeferredPromise=this.$q.defer(),this.loggingService.logInfo(c.ProfilingEventNames.runFlowWidgetTriggerFlowStart,"TriggerFlow started"),!e||!e.flowName){var i=this.clientResources.Widget.RuntimeFlow.Error.FlowNameMissing,r=new Error(i);return l.showFullPageError(this.fullPageErrorModel,r,this.clientResources.Common.SomethingWentWrong),this.loggingService.logError(c.ProfilingEventNames.runFlowWidgetTriggerFlowError,r),this.runFlowDeferredPromise.reject({code:a.ErrorCodes.runFlowWidgetInvalidTriggerFlowParams,message:i}),this.runFlowDeferredPromise.promise}if(this.flowPath=o.getFlowId(e.flowName),e&&e.implicitData&&!(e.implicitData instanceof Array)){var i=this.clientResources.Widget.RuntimeFlow.Error.ImplicitDataShouldBeArray,r=new Error(i);return l.showFullPageError(this.fullPageErrorModel,r,this.clientResources.Common.SomethingWentWrong),this.loggingService.logError(c.ProfilingEventNames.runFlowWidgetTriggerFlowError,r),this.runFlowDeferredPromise.reject({code:a.ErrorCodes.runFlowWidgetInvalidImplicitDataType,message:i}),this.runFlowDeferredPromise.promise}return this.showFlowRunContentAndHideError(),this.$scope.$apply(function(){t.inputData={flowId:t.flowPath},e&&e.implicitData&&(t.inputData.implicitData=e.implicitData)}),this.runFlowDeferredPromise.promise},e.prototype.handleTriggerFlowByTemplate=function(e){var t=this;if(this.showRunFlowContent=!1,this.runFlowByTemplateDeferredPromise=this.$q.defer(),e&&e.implicitData&&!(e.implicitData instanceof Array)){var i=this.clientResources.Widget.RuntimeFlow.Error.ImplicitDataShouldBeArray,r=new Error(i);return l.showFullPageError(this.fullPageErrorModel,r,this.clientResources.Common.SomethingWentWrong),this.loggingService.logError(c.ProfilingEventNames.runFlowWidgetTriggerFlowError,r),this.runFlowByTemplateDeferredPromise.reject({code:a.ErrorCodes.runFlowWidgetInvalidImplicitDataType,message:i}),this.runFlowByTemplateDeferredPromise.promise}if(e&&!e.templateId){var i=this.clientResources.Widget.RuntimeFlow.Error.TemplateIdMissing,r=new Error(i);return l.showFullPageError(this.fullPageErrorModel,r,this.clientResources.Common.SomethingWentWrong),this.loggingService.logError(c.ProfilingEventNames.runFlowWidgetTriggerFlowError,new Error(i)),this.runFlowByTemplateDeferredPromise.reject({code:a.ErrorCodes.runFlowWidgetInvalidTriggerFlowParams,message:i}),this.runFlowByTemplateDeferredPromise.promise}return this.loggingService.logInfo(c.ProfilingEventNames.runFlowWidgetTriggerFlowStart,"TriggerFlow started"),this.implicitData=e.implicitData,this.showTemplateWidgetAndHideError(),this.$scope.$apply(function(){t.createFromTemplateArgs={templateName:e.templateId,delegatedAuthorizationSource:e.delegatedAuthorizationSource}}),this.runFlowByTemplateDeferredPromise.promise},e.prototype.handleGetTriggerSchema=function(e){var t=this;this.getTriggerSchemaDeferredPromise=this.$q.defer(),this.loggingService.logInfo(c.ProfilingEventNames.runFlowWidgetGetTriggerSchemaStart,"GetTriggerSchema started");var i="";if(!e||!e.flowName){var r=this.clientResources.Widget.RuntimeFlow.Error.FlowNameMissing,n=new Error(r);return l.showFullPageError(this.fullPageErrorModel,n,this.clientResources.Common.SomethingWentWrong),this.loggingService.logError(c.ProfilingEventNames.runFlowWidgetGetTriggerSchemaError,n),this.getTriggerSchemaDeferredPromise.reject({code:a.ErrorCodes.runFlowWidgetInvalidTriggerSchemaParams,errorMsg:r}),this.getTriggerSchemaDeferredPromise.promise}i=o.getFlowId(e.flowName);var s=this.flowsClient.get(this.$scope,{id:i});return s.$promise.then(function(){if(s.properties&&s.properties.triggerSchema){var e=s.properties.triggerSchema,i={};if(e.properties)return i=e.properties.rows&&e.properties.rows.items&&e.properties.rows.items.properties&&e.properties.rows.items.properties.entity&&e.properties.rows.items.properties.entity.properties?e.properties.rows.items.properties.entity.properties:e.properties,t.loggingService.logInfo(c.ProfilingEventNames.runFlowWidgetGetTriggerSchemaEnd,"GetTriggerSchema ended"),t.getTriggerSchemaDeferredPromise.resolve({data:i}),t.getTriggerSchemaDeferredPromise.promise}var r=t.clientResources.Widget.RuntimeFlow.Error.TriggerSchemaCannotBeParsed,n=new Error(r);return l.showFullPageError(t.fullPageErrorModel,n,t.clientResources.Common.SomethingWentWrong),t.loggingService.logError(c.ProfilingEventNames.runFlowWidgetGetTriggerSchemaError,n),t.getTriggerSchemaDeferredPromise.reject({code:a.ErrorCodes.runFlowWidgetInvalidTriggerSchema,errorMsg:r}),t.getTriggerSchemaDeferredPromise.promise}).catch(function(e){t.loggingService.logError(c.ProfilingEventNames.runFlowWidgetGetTriggerSchemaError,e);var i=l.parseErrorMessage(e,t.clientResources.Common.SomethingWentWrong);return l.showFullPageError(t.fullPageErrorModel,e,t.clientResources.Common.SomethingWentWrong),t.getTriggerSchemaDeferredPromise.reject({code:a.ErrorCodes.runFlowWidgetFlowNotFound,message:i}),t.getTriggerSchemaDeferredPromise.promise})},e.$inject=[r.default.services.$q,r.default.services.$sce,r.default.services.$scope,r.default.services.$timeout,r.default.services.appSettings,r.default.services.clientResources,r.default.services.environment,r.default.services.flowsClient,r.default.services.logging,r.default.services.url],e}();t.RuntimeFlowWidgetCtrl=d},function(e,t){},function(e,t){e.exports='<div class="runtimeFlowWidget"> <div ng-if="!runtimeFlowWidgetCtrl.fullPageErrorModel.isPageErrored"> <run-flow-content ng-if="runtimeFlowWidgetCtrl.showRunFlowContent" input-data="runtimeFlowWidgetCtrl.inputData" on-cancel="runtimeFlowWidgetCtrl.handleCancel" on-done="runtimeFlowWidgetCtrl.handleDone" on-render="runtimeFlowWidgetCtrl.handleRendered" on-flow-run-request-completion="runtimeFlowWidgetCtrl.handleFlowRunRequestCompletion" on-flow-run-request-error="runtimeFlowWidgetCtrl.handleFlowRunRequestError" on-flow-run-request-start="runtimeFlowWidgetCtrl.handleFlowRunRequestStart"> </run-flow-content> <template-widget ng-if="runtimeFlowWidgetCtrl.showTemplateWidget" create-from-template-args="runtimeFlowWidgetCtrl.createFromTemplateArgs" install-flow="runtimeFlowWidgetCtrl.installFlow" on-create-flow-completion="runtimeFlowWidgetCtrl.handleCreateFlowCompletion" on-create-flow-error="runtimeFlowWidgetCtrl.handleCreateFlowError" on-render="runtimeFlowWidgetCtrl.handleRendered"> </template-widget> </div> <full-page-error model="runtimeFlowWidgetCtrl.fullPageErrorModel" ng-if="runtimeFlowWidgetCtrl.fullPageErrorModel.isPageErrored"></full-page-error> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(617);i(619);var o=function(){function e(){this.controller=n.SwaggerEditorCtrl,this.template=i(620),this.controllerAs="swaggerEditorCtrl",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.CustomApis}]}}return e}();t.SwaggerEditor=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.swaggerEditor,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(31),o=i(35),s=i(28),a=i(206),l=i(20),c=i(10),u=i(1),p=i(15),d=i(3),g=i(29),m=i(28),f=i(618),h=i(62),v=i(24),y=i(207),w=function(){function e(e,t,i,r,n,o,s,a,l,p,d,g,m,f,h,v,y,w,C,S,b,P,R){var T=this;this.$locationService=e,this.$q=t,this.$route=i,this.$routeParams=r,this.$scope=n,this.$timeout=o,this.apisClient=s,this.apisClientLA=a,this.appSettings=l,this.clientResources=p,this.connectionFormService=d,this.customApiHelperService=g,this.environmentService=m,this.fileReader=f,this.loggingService=h,this.navigationService=v,this.policiesService=y,this.promiseHelperService=w,this.sessionService=C,this.swaggerEditorDataService=S,this.swaggerValidationService=b,this.trialDialog=P,this.urlService=R,this.TabNames={general:"general",security:"security",actions:"actions",definition:"definition",test:"test"},this.saveCustomApiText="",this.closeCustomApiText="",this.tabs=[{tabHeader:this.clientResources.Manage.CustomApi.Tabs.general,tabName:this.TabNames.general},{tabHeader:this.clientResources.Manage.CustomApi.Tabs.security,tabName:this.TabNames.security},{tabHeader:this.clientResources.Manage.CustomApi.Tabs.definition,tabName:this.TabNames.definition}],this.trialDialog.tryBlockMSA(),this.swaggerEditorData=this.swaggerEditorDataService.SwaggerEditorData,this.swaggerEditorData.apiName=this.$routeParams.apiName,this.swaggerEditorData.editMode=!!this.isLogicApps||!!this.swaggerEditorData.apiName,this.selectedTab=this.$locationService.path().replace(this.getCustomApiBaseUrl()+"/","").split("/")[0],this.debug=l.featureFlags.enableDebug,this.isOperationInProgress=!1,this.apiCreatedNavigation=!1,this.saveCustomApiText=this.swaggerEditorData.editMode?p.Manage.CustomApi.updateApi:p.Manage.CustomApi.createApi,this.closeCustomApiText=this.swaggerEditorData.editMode?p.Manage.CustomApi.UpdateApi.Close:p.Manage.CustomApi.CreateApi.cancel,!this.isLogicApps&&l.featureFlags.enableTestPaneCustomApi&&this.tabs.push({tabHeader:this.clientResources.Manage.CustomApi.Tabs.test,tabName:this.TabNames.test}),this.$scope.$watch(function(){return T.swaggerEditorData.validatationError},function(){var e=T.swaggerEditorData.validatationError;u.isNullOrUndefined(e)&&T.swaggerEditorData.statusAlert.type!==c.AlertType.Error||(e?T.swaggerEditorData.statusAlert.options.show(c.AlertType.Error,e.message):T.swaggerEditorData.statusAlert.options.hide())}),this.swaggerEditorData.editMode?this.initializeForEditMode():this.initializeForCreateMode()}return Object.defineProperty(e.prototype,"isLogicApps",{get:function(){return y.isLogicApps(this.appSettings)},enumerable:!0,configurable:!0}),e.prototype.getSwagger=function(){if(this.swaggerEditorData.swagger)return JSON.parse(a.serialize(this.swaggerEditorData.swagger))},e.prototype.navigateToTab=function(e){this.navigationService.navigate(this.getCustomApiBaseUrl()+"/"+e)},e.prototype.getCustomApiBaseUrl=function(){return this.swaggerEditorData.editMode?n.getEditCustomConnectorUrl(this.swaggerEditorData.apiName):n.getNewCustomConnectorUrl()},e.prototype.initializeForEditMode=function(){this.registerConfirmNavigateAway(),this.isLogicApps?this.isNewOrDefaultSwagger(this.swaggerEditorData.swagger)&&(this.swaggerEditorData.securityTabDetails.isLocked=!0,this.initializeParametersAndGetApiAndParseSwaggerForLogicApps()):this.isNewOrDefaultSwagger(this.swaggerEditorData.swagger)?(this.swaggerEditorData.securityTabDetails.isLocked=!0,this.getApiAndPopulatePage(!0)):this.swaggerEditorDataService.swaggerEditorUIData.swaggerUpdatedFromList&&(this.swaggerEditorData.securityTabDetails.isLocked=!0,this.getApiAndPopulatePage(!1))},e.prototype.initializeParametersAndGetApiAndParseSwaggerForLogicApps=function(){var e=this.appSettings.widgetInfo.logicAppsSettings;this.getApiAndParseSwaggerForLogicApps(e)},e.prototype.isNewOrDefaultSwagger=function(e){return u.isEmpty(e)||angular.equals(e,v.DeserializedBaseSwagger)},e.prototype.initializeForCreateMode=function(){var e=this;this.policiesService.checkShouldShowFreePlanDialog().then(function(t){t?e.apisClient.query(e.$scope).$promise.then(function(t){(Array.isArray(t)?t.filter(function(e){return s.isApiCustom(e)}):[]).length>0?e.trialDialog.showStartFreeTrialDialog(function(t){t||e.navigationService.navigate(e.urlService.customApisRoute())}):e.registerConfirmNavigateAway()}).catch(function(t){e.loggingService.logError("SwaggerEditorCtrl.MyCustomApisLoad",t)}):e.registerConfirmNavigateAway(),u.isNullOrUndefined(e.swaggerEditorData.swaggerIconFile)&&e.setDefaultIcon()})},e.prototype.onCreateApiClicked=function(){this.isLogicApps?this.onCreateApiClickedForLogicApps():this.onCreateApiClickedForFlow()},e.prototype.validateSwagger=function(e){return this.swaggerValidationService.validate(e),this.swaggerValidationService.resultCollection.errorCount},e.prototype.createOrUpdateApiForLogicApps=function(e,t){this.swaggerEditorDataService.SwaggerEditorData.statusAlert.options.show(c.AlertType.Progress,this.clientResources.Manage.CustomApi.SavingCustomAPI);var i=this.getApiPutObjectForLogicApps(e);return this.apisClientLA.put(t,i)},e.prototype.getApiPutObjectForLogicApps=function(e){return{location:this.swaggerEditorData.apiLogicApps.location,properties:{displayName:this.swaggerEditorData.displayName,description:this.swaggerEditorData.swagger.info?this.swaggerEditorData.swagger.info.description:"",iconUri:this.swaggerEditorData.swaggerIconFileContentUrl,swagger:JSON.parse(a.serialize(this.swaggerEditorData.swagger)),backendService:{serviceUrl:this.getServiceUrl()},brandColor:this.swaggerEditorData.swaggerIconBrandColor,connectionParameters:e}}},e.prototype.onCreateApiClickedForLogicApps=function(){var e=this,t=this.loggingService.profileStart(g.ProfilingEventNames.LogicAppsCustomApiSaveEditStart),i=g.ProfilingEventNames.LogicAppsCustomApiSaveEditEnd,r=this.swaggerEditorDataService.SwaggerEditorData,n=this.validateSwagger(this.swaggerEditorDataService.swagger);if(n>0)return r.validatationError=new p.ClientError(p.ErrorCodes.customApiValidationError,u.format(this.clientResources.Manage.CustomApi.SwaggerValidationFailed,n),null),void this.loggingService.profileEnd(t,i,{status:d.Status.Failure,error:"Swagger validation service found this swagger invalid"});this.swaggerEditorData.spinner.show=!0;var o=this.appSettings.widgetInfo.logicAppsSettings,s=void 0;this.swaggerEditorDataService.validateFormDetailsLogicApps(this.$scope).then(function(){return e.promiseHelperService.toAngularPromise(e.sessionService.getToken(e.appSettings.authResource))}).then(function(t){return e.isOperationInProgress=!0,s=r.securityTabDetails.isLocked?void 0:e.swaggerEditorDataService.constructConnectionParameters(),e.createOrUpdateApiForLogicApps(s,o)}).then(function(n){e.swaggerEditorData.spinner.show=!1;var o,s=e.clientResources.Manage.CustomApi.Updated.Alert;o={type:c.AlertType.Success,message:s},e.appSettings.featureFlags.enableStayOnCustomApiAfterCreateOrUpdate?(e.reloadPageAndClearSwaggerEditorData(),r.statusAlert.options.show(o.type,o.message),e.loggingService.profileEnd(t,i,{status:d.Status.Success})):e.navigateToCustomConnections()}).catch(function(n){var o=e.getClientError(n);e.loggingService.profileEnd(t,i,{status:d.inferErrorStatus(o),error:o.message}),e.loggingService.logError(o.code,o),o.code===p.ErrorCodes.customApiRefreshApisClient?(r.spinner.show=!1,r.statusAlert.options.hide(),e.navigateToCustomConnections()):(r.spinner.show=!1,r.statusAlert.options.show(c.AlertType.Error,o.message))}).finally(function(){e.isOperationInProgress=!1})},e.prototype.getApiAndParseSwaggerForLogicApps=function(e){var t=this,i=this.swaggerEditorDataService.SwaggerEditorData;this.swaggerEditorData.spinner.show=!0,this.isOperationInProgress=!0;var r=this.loggingService.profileStart(g.ProfilingEventNames.LogicAppsCustomApiLoadStart),n=this.apisClientLA.get(e);n.then(function(e){return t.getAndAssignSwaggerIconForLogicApps(e),t.parseSwaggerDataForLogicApps(e)}).then(function(){t.loggingService.profileEnd(r,g.ProfilingEventNames.LogicAppsCustomApiLoadEnd,{status:d.Status.Success})}).catch(function(e){t.loggingService.profileEnd(r,g.ProfilingEventNames.LogicAppsCustomApiLoadEnd,{status:d.inferErrorStatus(e),error:d.parseErrorMessage(e)}),t.displayGetApiAndParseSwaggerErrorAlert(e),t.loggingService.logError("LogicAppsCustomApi.GetApiAndParseSwagger",e)}).finally(function(){t.validateSwagger(i.swagger),t.swaggerEditorDataService.setIconDisplay(),i.spinner.show=!1,t.isOperationInProgress=!1})},e.prototype.parseSwaggerDataForLogicApps=function(e){var t=this,i=this.swaggerEditorDataService.SwaggerEditorData;i.apiLogicApps=e;var r=f.getDisplayName(e),n=f.getIconBrandColor(e);return i.swaggerFileName=u.getSlug(r)+".swagger.json",i.displayName=r,n&&(i.swaggerIconBrandColor=n),i.securityTabDetails.initialConnectionParameters=e.properties.connectionParameters,f.isApiOauth(e)&&(i.securityTabDetails.redirectUrl=e.properties.connectionParameters[Object.keys(e.properties.connectionParameters)[0]].oAuthSettings.redirectUrl),this.getSwaggerFromUrlForLogicApps(e).then(function(e){e&&(i.swagger=h.deserialize(e),i.deployedSwagger=angular.copy(i.swagger),i.securityTabDetails.selectedAuthenticationType=v.getAuthenticationTypeFromSwagger(t.swaggerEditorData.swagger))})},e.prototype.getSwaggerFromUrlForLogicApps=function(e){var t=f.getOriginalSwaggerUrl(e);return t?this.customApiHelperService.getSwaggerFromUrl(t):(this.loggingService.logInfo("LogicAppsCustomApi.getSwaggerFromUrlForLogicApps","No original swagger URL"),this.$q.resolve())},e.prototype.getAndAssignSwaggerIconForLogicApps=function(e){this.swaggerEditorDataService.SwaggerEditorData.swaggerIconFileContentUrl=f.getIconFileContentUrl(e)},e.prototype.onCreateApiClickedForFlow=function(){var e=this,t=this.swaggerEditorData.editMode?this.loggingService.profileStart(g.ProfilingEventNames.myCustomApiSaveEditStart):this.loggingService.profileStart(g.ProfilingEventNames.myCustomApiCreateStart),i=this.swaggerEditorData.editMode?g.ProfilingEventNames.myCustomApiSaveEditEnd:g.ProfilingEventNames.myCustomApiCreateEnd;if(this.swaggerValidationService.validate(this.swaggerEditorDataService.swagger),this.swaggerValidationService.resultCollection.errorCount>0)return this.swaggerEditorDataService.SwaggerEditorData.validatationError=new p.ClientError(p.ErrorCodes.customApiValidationError,u.format(this.clientResources.Manage.CustomApi.SwaggerValidationFailed,this.swaggerValidationService.resultCollection.errorCount),null),void this.loggingService.profileEnd(t,i,{status:d.Status.Failure,error:"Swagger validation service found this swagger invalid"});this.swaggerEditorData.spinner.show=!0;var r,n=void 0;this.swaggerEditorDataService.validateFormDetails(this.$scope).then(function(){return e.promiseHelperService.toAngularPromise(e.sessionService.getUserSessionAsync())}).then(function(e){n=e}).then(function(){return e.isOperationInProgress=!0,r=e.swaggerEditorData.securityTabDetails.isLocked?void 0:e.swaggerEditorDataService.constructConnectionParameters(),e.customApiHelperService.generateResourceStorage(n.userInfo.uniqueId,e.environmentService.getCurrentEnvironmentName())}).then(function(t){return e.uploadFilesToStorage(t)}).then(function(t){return e.createOrUpdateApi(t,r)}).then(function(r){return e.loggingService.profileEnd(t,i,{status:d.Status.Success}),e.swaggerEditorData.apiName=e.swaggerEditorData.editMode?e.swaggerEditorData.apiName:r.data.name,e.refreshApis()}).then(function(){if(!e.appSettings.isWidgetPage)return e.$q.resolve();try{var t=JSON.parse(a.serialize(e.swaggerEditorData.swagger));return e.customApiHelperService.validateWadl(n.userInfo.uniqueId,t)}catch(t){return e.loggingService.logError("SwaggerEditorCtrl.OnCreateApiClicked.ParseJsonForWadl",t),e.$q.resolve()}}).then(function(t){e.swaggerEditorData.spinner.show=!1;var i;if(t){var r=e.getClientError(t),n=e.swaggerEditorData.editMode?e.clientResources.Manage.CustomApi.Updated.WadlAlert:e.clientResources.Manage.CustomApi.Created.WadlAlert;n=u.format(n,r.message),i={type:c.AlertType.Warning,message:n}}else{var o=e.swaggerEditorData.editMode?e.clientResources.Manage.CustomApi.Updated.Alert:e.clientResources.Manage.CustomApi.Created.Alert;i={type:c.AlertType.Success,message:o}}e.appSettings.featureFlags.enableStayOnCustomApiAfterCreateOrUpdate?(e.swaggerEditorData.editMode?e.reloadPageAndClearSwaggerEditorData():e.navigateToEditApi(e.swaggerEditorData.apiName),e.swaggerEditorData.statusAlert.options.show(i.type,i.message)):e.navigateToCustomConnections()}).catch(function(r){var n=e.getClientError(r);e.loggingService.profileEnd(t,i,{status:d.inferErrorStatus(n),error:n.message}),e.loggingService.logError(n.code,n),n.code===p.ErrorCodes.customApiRefreshApisClient?(e.swaggerEditorData.spinner.show=!1,e.swaggerEditorData.statusAlert.options.hide(),e.navigateToCustomConnections()):(e.swaggerEditorData.spinner.show=!1,e.swaggerEditorData.statusAlert.options.show(c.AlertType.Error,n.message))}).finally(function(){e.isOperationInProgress=!1})},e.prototype.getApiAndPopulatePage=function(e){var t=this;this.swaggerEditorDataService.swaggerEditorUIData.swaggerUpdatedFromList=!1,this.swaggerEditorData.spinner.show=!0,this.isOperationInProgress=!0,this.swaggerEditorData.apiId=m.getApiId(this.swaggerEditorData.apiName);var i=this.loggingService.profileStart(g.ProfilingEventNames.myCustomApiLoadStart),r=this.apisClient.get(this.$scope,{id:this.swaggerEditorData.apiId}).$promise,n=r.then(function(i){return t.parseSwaggerData(i,e)}).then(function(){t.loggingService.profileEnd(i,g.ProfilingEventNames.myCustomApiLoadEnd,{status:d.Status.Success})}).catch(function(e){t.loggingService.profileEnd(i,g.ProfilingEventNames.myCustomApiLoadEnd,{status:d.inferErrorStatus(e),error:d.parseErrorMessage(e)}),t.displayGetApiAndParseSwaggerErrorAlert(e),t.loggingService.logError("CustomApi.GetApiAndParseSwagger",e)}).finally(function(){t.swaggerValidationService.validate(t.swaggerEditorData.swagger),t.swaggerEditorData.spinner.show=!1,t.isOperationInProgress=!1}),o=r.then(function(e){return t.getAndAssignSwaggerIcon(e)});this.$q.all([n,o]).then(function(){return t.swaggerEditorDataService.setIconDisplay()})},e.prototype.parseSwaggerData=function(e,t){var i=this;this.swaggerEditorData.api=e;var r=m.getDisplayName(e),n=m.getIconBrandColor(e);return this.swaggerEditorData.swaggerFileName=u.getSlug(r)+".swagger.json",this.swaggerEditorData.displayName=r,this.swaggerEditorData.swaggerIconBrandColor=n,this.swaggerEditorData.securityTabDetails.initialConnectionParameters=e.properties.connectionParameters,m.isApiOauth(e)&&(this.swaggerEditorData.securityTabDetails.redirectUrl=e.properties.connectionParameters[Object.keys(e.properties.connectionParameters)[0]].oAuthSettings.redirectUrl),this.getSwaggerFromUrl(e).then(function(e){t&&(i.swaggerEditorData.swagger=h.deserialize(e)),i.swaggerEditorData.deployedSwagger=angular.copy(i.swaggerEditorData.swagger),i.swaggerEditorData.securityTabDetails.selectedAuthenticationType=v.getAuthenticationTypeFromSwagger(i.swaggerEditorData.swagger)})},e.prototype.getAndAssignSwaggerIcon=function(e){var t=this;return this.acquireIconBlobWithRetry(e,1).then(function(e){return t.convertIconBlobToFile(e)}).then(function(e){return t.swaggerEditorData.swaggerIconFile=e,t.fileReader(e).asDataURL()}).then(function(e){t.swaggerEditorData.swaggerIconFileContentUrl=e}).catch(function(e){var i=t.setDefaultIcon();return t.displayGetApiAndParseSwaggerErrorAlert(e),t.loggingService.logError("CustomApi.GetAndAssignSwaggerIcon",e),i})},e.prototype.acquireIconBlobWithRetry=function(e,t){var i=this;return this.customApiHelperService.getSwaggerIconData(e.properties.iconUri).catch(function(r){var n=r.data&&r.data.responseStatusCode?r.data.responseStatusCode:-1;return t<5&&(-1===n||400<=n&&n<500)?(i.swaggerEditorDataService.setIconDisplayNotFound(),i.$timeout(function(){return i.refreshApi(e)},1e3).then(function(e){return e}).then(function(e){return i.acquireIconBlobWithRetry(e,t+1)})):i.$q.reject(r)})},e.prototype.convertIconBlobToFile=function(e){var t=u.convertBlobToFile(e,"customconnectoricon");return t?this.$q.resolve(t):this.$q.reject(new p.ClientError(p.ErrorCodes.customApiOriginalDataError,this.clientResources.Manage.CustomApi.OriginalIcon.DownloadError,void 0))},e.prototype.displayGetApiAndParseSwaggerErrorAlert=function(e){var t,i=e&&e.code?e.code:-1;switch(i){case p.ErrorCodes.customApiOriginalDataError:t=e&&e.message?e.message:null;break;case p.ErrorCodes.customApiGetSwaggerIcon:t=this.clientResources.Manage.CustomApi.OriginalIcon.DownloadError;break;default:t=this.clientResources.Manage.CustomApi.OriginalSwagger.DownloadError}this.swaggerEditorData.statusAlert.options.show(c.AlertType.Error,t)},e.prototype.setDefaultIcon=function(){var e=this;return this.customApiHelperService.getSwaggerIconData(this.swaggerEditorData.swaggerIconFileContentUrl).then(function(t){e.swaggerEditorData.swaggerIconFile=u.convertBlobToFile(t,"customconnectoricon.png")}).catch(function(t){e.loggingService.logError(t.code,t)})},e.prototype.uploadFilesToStorage=function(e){this.swaggerEditorData.statusAlert.options.show(c.AlertType.Progress,this.clientResources.Manage.CustomApi.UploadingSwagger);var t={},i=e.data.sharedAccessSignature;return t.swagger={file:u.convertBlobToFile(new Blob([a.serialize(this.swaggerEditorData.swagger)]),this.swaggerEditorData.swaggerFileName),sasUri:o.appendToUriPath(i,u.getFileNameSlug(this.swaggerEditorData.swaggerFileName))},t.icon={file:this.swaggerEditorData.swaggerIconFile,sasUri:o.appendToUriPath(i,"customconnectoricon."+this.swaggerEditorData.swaggerIconFile.name.split(".").pop())},this.customApiHelperService.uploadFilesToStorage(this.$scope,t)},e.prototype.createOrUpdateApi=function(e,t){this.swaggerEditorData.statusAlert.options.show(c.AlertType.Progress,this.clientResources.Manage.CustomApi.SavingCustomAPI);var i=l.extendPropsWithEnvironment({properties:this.swaggerEditorData.editMode?this.getApiPatchObject(e,t):this.getApiPostObject(e,t)},this.appSettings.featureFlags.enableEnvironments,this.environmentService.getCurrentEnvironmentName());return this.swaggerEditorData.editMode?this.apisClient.patch({id:s.ApisConstant.urlPath+"/"+this.swaggerEditorData.apiName},i):this.apisClient.post({id:s.ApisConstant.urlPath},i)},e.prototype.getApiPostObject=function(e,t){var i=this.getApiPatchObject(e,t);return i.displayName=this.swaggerEditorData.displayName,i},e.prototype.getApiPatchObject=function(e,t){var i={apiDefinitionUrl:e.swagger.sasUri,iconUri:e.icon.sasUri,iconBrandColor:this.swaggerEditorData.swaggerIconBrandColor,description:this.swaggerEditorData.swagger.info?this.swaggerEditorData.swagger.info.description:"",backendService:{serviceUrl:this.getServiceUrl()},connectionParameters:t};return u.isNullOrUndefined(i.connectionParameters)&&delete i.connectionParameters,i},e.prototype.refreshApis=function(){var e=this,t=[this.apisClient.refreshQuery()];return this.swaggerEditorData.editMode&&t.push(this.apisClient.refresh({id:this.swaggerEditorData.apiId})),this.$q.all(t).then(function(){return e.$q.resolve()}).catch(function(t){var i=d.parseErrorMessage(t,e.clientResources.Manage.CustomApi.ListRefreshError);return e.$q.reject(new p.ClientError(p.ErrorCodes.customApiRefreshApisClient,i,void 0))})},e.prototype.refreshApi=function(e){var t=this;return this.apisClient.refresh({id:e.id}).then(function(){return t.apisClient.get(t.$scope,{id:e.id})})},e.prototype.getSwaggerFromUrl=function(e){var t=m.getOriginalSwaggerUrl(e);return t?this.customApiHelperService.getSwaggerFromUrl(t):this.$q.reject(new p.ClientError(p.ErrorCodes.customApiOriginalDataError,this.clientResources.Manage.CustomApi.OriginalSwagger.NotFound,void 0))},e.prototype.registerConfirmNavigateAway=function(){var e=this;this.navigationService.confirmNavigateAway(this.$scope,{message:this.clientResources.Flow.Discard.Changes.Message,confirmation:this.clientResources.Flow.Discard.Changes.Confirmation,condition:function(){return-1===e.$locationService.url().indexOf("/connections/available/custom/")&&!e.apiCreatedNavigation},onConfirmResult:function(t){t&&e.swaggerEditorDataService.clear()}})},e.prototype.navigateToCustomConnections=function(){this.swaggerEditorDataService.clear(),this.apiCreatedNavigation=!0,this.navigationService.navigate(n.getCustomConnectionsUrl())},e.prototype.reloadPageAndClearSwaggerEditorData=function(){this.swaggerEditorDataService.clear(),this.$route.reload()},e.prototype.navigateToEditApi=function(e){this.swaggerEditorDataService.clear(),this.navigationService.navigate(n.getEditCustomConnectorUrl(e)+"/"+this.selectedTab+"/")},e.prototype.getServiceUrl=function(){var e="",t="https",i=this.swaggerEditorData.swagger;return i.schemes&&i.schemes.some(function(e){return"http"===e})&&!i.schemes.some(function(e){return"https"===e})&&(t="http"),e=t+"://",i.basePath?e+=o.concatParts(i.host,i.basePath):e+=i.host,e},e.prototype.getClientError=function(e){var t=this.swaggerEditorData.editMode?"CustomApi.EditApi":"CustomApi.CreateApi";if("string"==typeof e)return new p.ClientError(t,e,void 0);var i=e;return i.message=d.parseErrorMessage(e,this.clientResources.Common.SomethingWentWrong),i.code=i.code||t,i},e.$inject=[r.default.services.$location,r.default.services.$q,r.default.services.$route,r.default.services.$routeParams,r.default.services.$scope,r.default.services.$timeout,r.default.services.apisClient,r.default.services.apisClientLA,r.default.services.appSettings,r.default.services.clientResources,r.default.services.connectionForm,r.default.services.customApiHelper,r.default.services.environment,r.default.services.fileReaderHelperService,r.default.services.logging,r.default.services.navigation,r.default.services.policies,r.default.services.promiseHelperService,r.default.services.session,r.default.services.swaggerEditorData,r.default.services.swaggerValidationService,r.default.services.trialDialog,r.default.services.url],e}();t.SwaggerEditorCtrl=w},function(e,t,i){"use strict";function r(e){return!!e.properties.connectionParameters&&Object.keys(e.properties.connectionParameters).some(function(t){return c.equalsIgnoreCase(e.properties.connectionParameters[t].type,"oauthSetting")})}function n(e){return e.properties.displayName||e.name}function o(e){return e.properties.brandColor}function s(e){return e.properties.iconUri||u.default.defaultConnection}function a(e){return e&&e.properties&&e.properties.apiDefinitions&&e.properties.apiDefinitions.originalSwaggerUrl}Object.defineProperty(t,"__esModule",{value:!0});var l=i(0),c=i(8),u=i(5);t.isApiOauth=r,t.getDisplayName=n,t.getIconBrandColor=o,t.getIconFileContentUrl=s,t.getOriginalSwaggerUrl=a;var p=function(){function e(e,t){this.$q=e,this.$http=t}return e.prototype.get=function(e){var t=this,i="https://management.azure.com/subscriptions/"+e.subscriptionId+"/resourceGroups/"+e.resourceGroupName+"/providers/Microsoft.Web/customApis/"+e.customApiName+"?api-version="+e.apiVersion;return this.$http.get(i).then(function(e){return e.data}).catch(function(e){return t.$q.reject(e)})},e.prototype.put=function(e,t){var i=this,r="https://management.azure.com/subscriptions/"+e.subscriptionId+"/resourceGroups/"+e.resourceGroupName+"/providers/Microsoft.Web/customApis/"+e.customApiName+"?api-version="+e.apiVersion;return this.$http.put(r,t).then(function(e){return e.data}).catch(function(e){return i.$q.reject(e)})},e.$inject=[l.default.services.$q,l.default.services.$http],e}();t.ApiClientLA=p,angular.module(l.default.modules.processSimpleData).factory(l.default.services.apisClientLA,[l.default.services.$q,l.default.services.$http,function(e,t){return new p(e,t)}])},function(e,t){},function(e,t){e.exports='<div class="subsection-manage subsection-manage-customapi"> <div class="sticky-save" ng-class="{\'sticky-save-shifted\': swaggerEditorCtrl.swaggerEditorData.statusAlert.type}"> <hr/> <div class="sticky-container"> <div class="form-row save-form"> <form ng-submit="swaggerEditorCtrl.onCreateApiClicked()"> <div class="row"> <div class="large-2 column api-name-label-container"> <label for="apiNameInput" class="c-label api-name-label">{{swaggerEditorCtrl.clientResources.Manage.CustomApi.apiName}}</label> </div> <div class="large-6 medium-8 small-9 column"> <input type="text" class="c-text-field" ng-model="swaggerEditorCtrl.swaggerEditorData.displayName" ng-readonly="swaggerEditorCtrl.isOperationInProgress || swaggerEditorCtrl.swaggerEditorData.editMode" id="apiNameInput" placeholder="Untitled"> </div> <div class="medium-2 column api-create-button-container"> <a role="button" href="" class="c-action-trigger c-glyph glyph-checkmark api-save" ng-disabled="swaggerEditorCtrl.isOperationInProgress" ng-click="swaggerEditorCtrl.onCreateApiClicked()">{{swaggerEditorCtrl.saveCustomApiText}}</a> </div> <div class="column medium-2 api-close-button-container" ng-hide="swaggerEditorCtrl.swaggerEditorData.spinner.show" ng-if="!swaggerEditorCtrl.isLogicApps"> <a role="button" ng-click="swaggerEditorCtrl.navigateToCustomConnections()" href="" ng-hide="swaggerEditorCtrl.isOperationInProgress || swaggerEditorCtrl.isLogicApps" class="c-action-trigger c-glyph glyph-close api-close close-button">{{swaggerEditorCtrl.closeCustomApiText}}</a> </div> <div class="column medium-3 medium-offset-1 small-3 small-screen-actions"> <div class="row"> <div class="column small-4"> <a role="button" href="" class="c-action-trigger c-glyph glyph-checkmark api-save" ng-disabled="swaggerEditorCtrl.isOperationInProgress" ng-click="swaggerEditorCtrl.onCreateApiClicked()"></a> </div> <div class="column small-4"> <a role="button" ng-click="swaggerEditorCtrl.navigateToCustomConnections()" href="" ng-hide="swaggerEditorCtrl.isOperationInProgress" class="c-action-trigger c-glyph glyph-close api-close"></a> </div> </div> </div> </div> </form> </div> </div> <hr/> </div> <div class="tabs" ng-class="{\'tabs-shifted\': swaggerEditorCtrl.swaggerEditorData.statusAlert.type}" ng-hide="swaggerEditorCtrl.swaggerEditorData.spinner.show"> <div class="row"> <span ng-repeat="tab in swaggerEditorCtrl.tabs"> <a href="#" role="tab" ng-class="{\'tab-active\': swaggerEditorCtrl.selectedTab === tab.tabName}" ng-click="swaggerEditorCtrl.navigateToTab(tab.tabName)"> {{tab.tabHeader}} </a> <span class="c-glyph glyph-arrow" ng-if="!$last"></span> </span> </div> </div> <alert class="sticky-error" model="swaggerEditorCtrl.swaggerEditorData.statusAlert"></alert> <div class="row swagger-editor-container" ng-class="{\'swagger-editor-container-shifted\': swaggerEditorCtrl.swaggerEditorData.statusAlert.type}" ng-hide="swaggerEditorCtrl.swaggerEditorData.spinner.show"> <div ng-if="swaggerEditorCtrl.selectedTab === swaggerEditorCtrl.TabNames.general"> <custom-api-general-tab></custom-api-general-tab> </div> <div ng-if="swaggerEditorCtrl.selectedTab === swaggerEditorCtrl.TabNames.security"> <custom-api-security-tab></custom-api-security-tab> </div> <div ng-if="swaggerEditorCtrl.selectedTab === swaggerEditorCtrl.TabNames.definition"> <custom-api-definition-tab></custom-api-definition-tab> </div> <div ng-if="swaggerEditorCtrl.appSettings.featureFlags.enableTestPaneCustomApi && swaggerEditorCtrl.selectedTab === swaggerEditorCtrl.TabNames.test"> <div ng-if="!swaggerEditorCtrl.swaggerEditorData.api"> <div class="m-alert f-error no-close" role="alert"> <div> <div class="c-glyph glyph-incident-triangle"></div> <p class="c-paragraph"> {{::swaggerEditorCtrl.clientResources.Manage.CustomApi.MustCreateApi.Label}} </p> </div> </div> </div> <div ng-if="swaggerEditorCtrl.swaggerEditorData.api"> <custom-api-test-tab></custom-api-test-tab> </div> </div> </div> <div class="row debug-pane" ng-if="swaggerEditorCtrl.debug"> <pre>{{swaggerEditorCtrl.swaggerEditorData | json}}</pre> <pre>{{swaggerEditorCtrl.getSwagger() | json}}</pre> </div> <spinner model="swaggerEditorCtrl.swaggerEditorData.spinner"></spinner> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(622);i(623);var o=function(){function e(){this.controller=n.CustomApiPropertiesPaneCtrl,this.template=i(624),this.controllerAs="customApiPropertiesPaneCtrl",this.resolve={setPageTitle:[r.default.services.$document,r.default.services.clientResources,function(e,t){e[0].title=t.PageTitle.CustomApis}]}}return e}();t.CustomApiPropertiesPane=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.propertiesPane,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(31),o=i(28),s=i(10),a=i(3),l=i(29),c=i(7),u=i(20),p=function(){function e(e,t,i,r,o,a,l,p,d,g,m){var f=this;this.$locationService=e,this.$q=t,this.$routeParams=i,this.$scope=r,this.apisClient=o,this.appSettings=a,this.clientResources=l,this.environmentService=p,this.navigationService=d,this.loggingService=g,this.permissionsClient=m,this.TabNames={details:"details",share:"share"},this.tabs=[{tabHeader:this.clientResources.Manage.CustomApi.Tabs.details,tabName:this.TabNames.details},{tabHeader:this.clientResources.Manage.CustomApi.Tabs.share,tabName:this.TabNames.share}],this.spinner={size:c.SpinnerSize.Large,local:c.SpinnerPosition.Local},this.statusAlert={message:"",type:s.AlertType.None,options:{title:null,show:function(e,t){f.statusAlert.type=e,f.statusAlert.message=t},hide:function(){return f.statusAlert.options.show(s.AlertType.None,"")}}},this.customApiProperties={permissions:{},api:{},apiName:this.$routeParams.apiName,apiDisplayName:"",spinner:this.spinner,statusAlert:this.statusAlert},this.selectedTab=this.$locationService.path().replace(n.getCustomApiUrl(this.customApiProperties.apiName)+"/",""),this.customApiProperties.permissions=this.permissionsClient.query(this.$scope,u.extendQueryParamsWithEnvironment({apiName:i.apiName},!0,this.environmentService.getCurrentEnvironmentName())),this.getApi(this.customApiProperties.apiName)}return e.prototype.navigateToCustomConnections=function(){this.navigationService.navigate(n.getCustomConnectionsUrl())},e.prototype.navigateToTab=function(e){this.navigationService.navigate(n.getCustomApiUrl(this.customApiProperties.apiName)+"/"+e)},e.prototype.getApi=function(e){var t=this,i=o.getApiId(e);this.spinner.show=!0;var r=this.loggingService.profileStart(l.ProfilingEventNames.myCustomApiPropertiesLoadStart);this.apisClient.get(this.$scope,{id:i}).$promise.then(function(e){t.loggingService.profileEnd(r,l.ProfilingEventNames.myCustomApiPropertiesLoadEnd,{status:a.Status.Success}),t.customApiProperties.api=e,t.customApiProperties.apiDisplayName=o.getDisplayName(e)}).catch(function(e){t.loggingService.profileEnd(r,l.ProfilingEventNames.myCustomApiPropertiesLoadEnd,{status:a.inferErrorStatus(e),error:a.parseErrorMessage(e)}),t.statusAlert.options.show(s.AlertType.Error,t.clientResources.Manage.CustomApi.GetApi.Error)}).finally(function(){t.spinner.show=!1})},e.$inject=[r.default.services.$location,r.default.services.$q,r.default.services.$routeParams,r.default.services.$scope,r.default.services.apisClient,r.default.services.appSettings,r.default.services.clientResources,r.default.services.environment,r.default.services.navigation,r.default.services.logging,r.default.services.permissionsClient],e}();t.CustomApiPropertiesPaneCtrl=p},function(e,t){},function(e,t){e.exports='<div class="subsection-manage subsection-manage-customapi-properties"> <div class="sticky-save" ng-class="{\'sticky-save-shifted\': customApiPropertiesPaneCtrl.statusAlert.type}"> <hr/> <div class="sticky-container"> <div class="form-row properties-pane"> <form ng-submit="customApiPropertiesPaneCtrl.onCreateApiClicked()"> <div class="row"> <div class="large-2 column api-name-label-container"> <label for="apiNameInput" class="c-label api-name-label">{{customApiPropertiesPaneCtrl.clientResources.Manage.CustomApi.apiName}}</label> </div> <div class="large-8 medium-8 small-9 column"> <input type="text" class="c-text-field" ng-model="customApiPropertiesPaneCtrl.customApiProperties.apiDisplayName" ng-readonly="true" id="apiNameInput" placeholder="Untitled"> </div> <div class="column medium-2 api-close-button-container"> <a role="button" ng-class="{\'disabled\': customApiPropertiesPaneCtrl.spinner.show}" ng-click="customApiPropertiesPaneCtrl.navigateToCustomConnections()" ng-hide="customApiPropertiesPaneCtrl.isCreatingApi" href="" class="c-action-trigger c-glyph glyph-close api-close close-button"> {{customApiPropertiesPaneCtrl.clientResources.Manage.CustomApi.CreateApi.cancel}} </a> </div> <div class="column medium-3 medium-offset-1 small-3 small-screen-actions"> <div class="row"> <div class="column small-4"> <a role="button" ng-click="customApiPropertiesPaneCtrl.navigateToCustomConnections()" href="" ng-hide="customApiPropertiesPaneCtrl.isCreatingApi" class="c-action-trigger c-glyph glyph-close api-close"> </a> </div> </div> </div> </div> </form> </div> </div> <hr/> </div> <div class="tabs" ng-class="{\'tabs-shifted\': customApiPropertiesPaneCtrl.statusAlert.type}"> <div class="row"> <a href="#" id="{{tab.tabHeader}}-Tab" ng-repeat="tab in customApiPropertiesPaneCtrl.tabs" ng-class="{\'tab-active\': customApiPropertiesPaneCtrl.selectedTab === tab.tabName}" ng-click="customApiPropertiesPaneCtrl.navigateToTab(tab.tabName)"> {{tab.tabHeader}} </a> </div> </div> <alert class="sticky-error" model="customApiPropertiesPaneCtrl.statusAlert"></alert> <div class="row swagger-editor-container" ng-class="{\'swagger-editor-container-shifted\': customApiPropertiesPaneCtrl.statusAlert.type}" ng-hide="customApiPropertiesPaneCtrl.spinner.show"> <div ng-if="customApiPropertiesPaneCtrl.selectedTab === customApiPropertiesPaneCtrl.TabNames.details"> <custom-api-details-tab model="customApiPropertiesPaneCtrl.customApiProperties"></custom-api-details-tab> </div> <div ng-if="customApiPropertiesPaneCtrl.selectedTab === customApiPropertiesPaneCtrl.TabNames.share"> <custom-api-share-tab model="customApiPropertiesPaneCtrl.customApiProperties"></custom-api-share-tab> </div> </div> <spinner model="customApiPropertiesPaneCtrl.spinner"></spinner> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(626),i(627),i(628),i(632)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(151)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(152)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(629)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(153);i(630);var o=function(){function e(){this.restrict="E",this.template=i(631),this.scope={model:"="},this.controller=n.ActivityFeedListDirectiveCtrl,this.controllerAs="controller"}return e}();t.ActivityFeedListDirective=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.actvityFeedList,[function(){return new o}])},function(e,t){},function(e,t){e.exports='<div class="c-table context-activity-feed"> <div ng-hide="controller.activityFeedPresent() || model.spinner.show"> <zero-activities></zero-activities> </div> <div ng-show="controller.activityFeedPresent()"> <div ng-repeat="table in model.tables"> <div class="activityfeed-timeheading"> <span>{{table.heading}}</span> </div> <table> <tbody> <tr ng-repeat="row in table.rows | filter: {type: model.options.selectedOption.name} | filter: model.searchFilter" ng-click="controller.rowDefaultAction(row)" ng-hide="controller.spinner.show" class="row"> <td class="column medium-10"> <div class="activityfeed-item-imageholder" ng-bind-html-compile="{{row.imageRenderHtml}}"></div> <div class="activityfeed-item-description"> <p class="c-paragraph-4">{{row.title}}</p> <p class="type-c1 c-caption-1 sd-truncateText">{{row.description}}</p> </div> </td> <td class="column medium-2"> <div class="activityfeed-item-timesince type-c1 c-caption-1"> <span>{{row.timeSince}}</span> </div> </td> </tr> </tbody> </table> </div> <div class="activityfeed-showmore"> <a ng-show="model.hasMore() && !model.loadingMore" ng-click="model.loadMore()" data-event-name="ActivityFeedShowMoreClicked" href="">{{controller.clientResources.List.ShowMore}}</a> <spinner model="model.loadingMoreSpinner"></spinner> <div> </div> </div></div></div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(55)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(634),i(636)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(635)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(21);var r=i(0),n=i(9);t.ApisConstant={resourceType:n.getAppSettings().processSimpleResourceProviderPath+"/apiOperations"},t.ApiOperationsPollFrequency={listApiOperatsion:9e5,getApiOperatsion:9e5,evictionDelay:3e5},angular.module(r.default.modules.processSimpleData).factory(r.default.services.apiOperationsClient,[r.default.services.appSettings,r.default.services.azureResourceClientFactory,r.default.services.environment,function(e,i,r){return i({urlBase:e.processSimpleResourceProviderManagementEndpoint,urlPath:n.getAppSettings().processSimpleResourceProviderPath+"/environments/"+r.getCurrentEnvironmentName()+"/apiOperations",apiVersion:e.processSimpleResourceProviderApiVersionWithEnvironments,resourceType:t.ApisConstant.resourceType,rest:{query:{lazyPaging:!0}},options:{atomize:!1,queryPollInterval:t.ApiOperationsPollFrequency.listApiOperatsion,getPollInterval:t.ApiOperationsPollFrequency.getApiOperatsion,evictionDelay:t.ApiOperationsPollFrequency.evictionDelay}})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(637)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=["/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_OFFICE365/APIOPERATIONS/ONNEWEMAIL","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_SHAREPOINTONLINE/APIOPERATIONS/GETONNEWITEMS","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_SHAREPOINTONLINE/APIOPERATIONS/GETONNEWFILE","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_RSS/APIOPERATIONS/ONNEWFEED","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_ONEDRIVEFORBUSINESS/APIOPERATIONS/ONNEWFILE","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_OUTLOOK/APIOPERATIONS/ONNEWEMAIL","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_TWITTER/APIOPERATIONS/ONNEWTWEET","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_ONEDRIVE/APIOPERATIONS/ONNEWFILE","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_DROPBOX/APIOPERATIONS/ONNEWFILE","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_GOOGLECALENDAR/APIOPERATIONS/ONNEWEVENTINCALENDAR","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_DYNAMICSCRMONLINE/APIOPERATIONS/GETONNEWITEMS","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_OUTLOOK/APIOPERATIONS/ONNEWEMAIL","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_GMAIL/APIOPERATIONS/ONNEWEMAIL","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_OFFICE365/APIOPERATIONS/ONFLAGGEDEMAIL","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_RUNTIMESERVICE/APIOPERATIONS/GETONNEWITEMS","/PROVIDERS/MICROSOFT.POWERAPPS/APIS/SHARED_GOOGLECALENDAR/APIOPERATIONS/ONNEWEVENTINCALENDAR"],o={};n.forEach(function(e,t){o[e]=t});var s=function(){function e(e){this.apisClient=e}return e.prototype.getPopularTriggers=function(e){var t=this.apisClient.query(e,{$filter:"properties/trigger neq null and properties/visibility eq 'important'"});return t.$promise.then(function(){return t.filter(function(e){return e&&e.id&&o[e.id.toUpperCase()]>=0}).sort(function(e,t){return o[e.id.toUpperCase()]-o[t.id.toUpperCase()]}).slice(0,8)})},e.$inject=[r.default.services.apiOperationsClient],e}();t.ApiOperationsService=s,angular.module(r.default.modules.processSimpleServices).service(r.default.services.apiOperationsService,s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(639),i(644),i(645)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(640)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(641);i(642);var o=function(){function e(){this.template=i(643),this.controller=n.ZeroCustomApisCtrl,this.controllerAs="zeroCustomApisCtrl"}return e}();t.ZeroCustomApis=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.zeroCustomApis,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=function(){function e(e){this.clientResources=e,this.zeroCustomApisImage=n.default.customApiZero}return e.$inject=[r.default.services.clientResources],e}();t.ZeroCustomApisCtrl=o},function(e,t){},function(e,t){e.exports='<div class="context-zero-custom-apis"> <div class="row top-align"> <div class="x-type-center"> <img class="zero-custom-api-image" cdn-src="{{zeroCustomApisCtrl.zeroCustomApisImage}}" alt="{{zeroCustomApisCtrl.clientResources.Manage.CustomConnections.ZeroCustomApis.Image.Alt}}"/> </div> </div> <div class="row"> <div class="column x-type-center"> <h4>{{zeroCustomApisCtrl.clientResources.Manage.CustomConnections.ZeroCustomApis.header}}</h4> <div class="column medium-8 medium-offset-2 custom-api-text custom-api-text-inline"> <p> {{zeroCustomApisCtrl.clientResources.Manage.CustomConnections.ZeroCustomApis.text}} <learn-more resource="\'Manage.CustomConnections.ZeroCustomApis.hyperlink\'" text="zeroCustomApisCtrl.clientResources.Manage.CustomConnections.ZeroCustomApis.learnMore"/> </p> </div> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(28),i(97)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(646)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(114);i(647);var o=function(){function e(){this.restrict="E",this.template=i(648),this.scope={model:"=",onAddConnection:"&",onClickUpdate:"&"},this.controller=n.ApiListDirectiveCtrl,this.controllerAs="controller"}return e}();t.ApiListDirective=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.apiList,[function(){return new o}])},function(e,t){},function(e,t){e.exports='<div class="c-table"> <table ng-show="model.rows.length > 0"> <thead> <tr> <th></th> <th>{{controller.headerNameField}}</th> <th></th> </tr> </thead> <tbody class="api-list-tbody"> <tr ng-repeat="row in model.rows"> <td class="table-cell-image" ng-click="controller.onClickRow(row)" role="presentation" aria-label="{{::controller.clientResources.Manage.CustomConnection.Create.Api.icon}}: {{controller.getRowAriaLabel(row)}}"> <img ng-attr-src="{{row.imageUrl}}" onerror=\'this.onerror=null,this.src="/Content/Images/Common/connection.svg"\' alt=""/> </td> <td class="text-ellipse" ng-click="controller.onClickRow(row)" role="link" aria-label="{{::controller.clientResources.Manage.CustomConnection.Create.Api.name}}: {{controller.getRowAriaLabel(row)}}"> <div class="table-cell-name-multiline"> <div class="apiName" aria-hidden="true">{{row.name}}</div> <div class="name connection-name-text" aria-hidden="true">{{row.publisher}}</div> </div> </td> <td class="hide-for-small-only pull-right"> <div class="context-glyph-tile"> <button ng-repeat="command in row.commands" class="img-button c-glyph" aria-label="{{controller.getCommandText(command)}}" ng-disabled="controller.isCommandDisabled(command)" ng-class="command.iconUrl" ng-attr-title="{{controller.getCommandText(command)}}" ng-click="controller.clickCommand($event, command)"> </button> <list-commands model="row.commandsInDropDown" class="command-item" ng-if="!controller.hideCommandsInDropDown"></list-commands> </div> </td> <td class="column small-1 show-for-small-only"> <list-commands model="row.allCommands" ng-if="!controller.hideCommandsInDropDown"></list-commands> <button ng-repeat="command in row.commands" ng-if="controller.hideCommandsInDropDown" class="img-button c-glyph" ng-disabled="controller.isCommandDisabled(command)" ng-class="command.iconUrl" ng-attr-title="{{controller.getCommandText(command)}}" ng-click="controller.clickCommand($event, command)" tabindex="-1"></button> </td> </tr> </tbody> </table> <confirm-dialog title="{{::controller.clientResources.Dialogs.DeleteApi.Title}}" message="{{::controller.clientResources.Dialogs.DeleteApi.Message}}" show="controller.showConfirmDelete" on-confirm="controller.onConfirmDelete"></confirm-dialog> <zero-custom-apis ng-show="model.rows.length === 0 && model.loaded === true"></zero-custom-apis> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(650),i(673),i(675)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(651),i(170),i(655),i(659),i(662),i(665),i(669)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(652);i(653);var o=function(){function e(){this.template=i(654),this.bindings={approval:"<",isRequest:"<",isSelected:"<",isDisabled:"<",onClick:"&"},this.controller=n.ApprovalCardCtrl,this.controllerAs="approvalCardCtrl"}return e}();t.ApprovalCard=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.approvals.approvalCard,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(6),s=i(1),a=i(200),l=function(){function e(e,t,i){var r=this;this.$scope=e,this.clientResources=t,this.telemetryService=i,this.clockIconUrl=n.default.clock,this.timerWhiteIconUrl=n.default.timerWhite,this.approvalCardId=String(this.$scope.$id),this.dropDownCommands=[{text:this.isRequest?this.clientResources.Approvals.Actions.EmailRequester:this.clientResources.Approvals.Actions.EmailApprovers,iconUrl:"glyph-mail",click:function(){r.telemetryService.tagEvent(o.TelemetryEventNames.ApprovalCardEmailRequesterClicked),window.location.href="mailto:"+r.mailToAddresses}}]}return Object.defineProperty(e.prototype,"mailToAddresses",{get:function(){if(!this.isRequest){return this.approval.properties.requestSummary.approvers.map(function(e){return e.email}).join(";")}return this.approval.properties.owner.email},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasOtherApprovers",{get:function(){var e=this.approval.properties.requestSummary;return e.totalRequests>e.approvers.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"otherApproversCount",{get:function(){var e=this.approval.properties.requestSummary;return e.totalRequests-e.approvers.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"principalNames",{get:function(){if(!this.isRequest){var e=this.approval.properties.requestSummary.approvers.map(function(e){return e.displayName});return s.format(this.clientResources.Approvals.Owner.To,e.join(", "))}return s.format(this.clientResources.Approvals.Owner.From,this.approval.properties.owner.displayName)},enumerable:!0,configurable:!0}),e.prototype.onCardClicked=function(e){this.telemetryService.tagEvent(o.TelemetryEventNames.ApprovalCardClicked),a.isParentOrElement(document.getElementById("approval-list-commands-"+this.approvalCardId),e.target)?e.stopPropagation():this.onClick({event:e,approvalName:this.approval.name,response:"NotSpecified"})},e.$inject=[r.default.services.$scope,r.default.services.clientResources,r.default.services.telemetry],e}();t.ApprovalCardCtrl=l},function(e,t){},function(e,t){e.exports='<div class="disable-card-overlay" ng-if="approvalCardCtrl.isSelected || approvalCardCtrl.isDisabled" ng-class="{\'selected\': approvalCardCtrl.isSelected}"> </div> <div class="approval-card" ng-class="{\'card-selected\' : approvalCardCtrl.isSelected}" ng-click="approvalCardCtrl.onCardClicked($event)"> <div class="due-date"> <img ng-src="{{ approvalCardCtrl.clockIconUrl }}"/> <span class="c-paragraph-3 c-glyph">{{ approvalCardCtrl.approval.properties.creationDate | date : "MMM d" }}</span> </div> <div class="thumbnail-photos"> <avatar ng-if="approvalCardCtrl.isRequest" mail="approvalCardCtrl.approval.properties.owner.email" display-name="approvalCardCtrl.approval.properties.owner.displayName" image-src="approvalCardCtrl.approval.properties.owner.thumbnailPhoto" object-id="approvalCardCtrl.approval.properties.owner.id"></avatar> <ul ng-if="!approvalCardCtrl.isRequest"> <li class="avatars-list-item" ng-repeat="approver in approvalCardCtrl.approval.properties.requestSummary.approvers"> <avatar mail="approver.email" display-name="approver.displayName" image-src="approver.thumbnailPhoto" object-id="approver.id"></avatar> </li> <li class="avatars-list-item" ng-if="approvalCardCtrl.hasOtherApprovers"> <div class="grey-circle-count"> +{{ approvalCardCtrl.otherApproversCount }} </div> </li> </ul> </div> <p class="approver-names">{{ approvalCardCtrl.principalNames }}</p> <p class="title sd-truncateText">{{ approvalCardCtrl.approval.properties.title }}</p> <div> <div class="actions" ng-if="approvalCardCtrl.isRequest"> <button class="approve-button c-action-trigger c-glyph glyph-checkmark" ng-click="approvalCardCtrl.onClick({event: $event, approvalName: approvalCardCtrl.approval.name, response: \'Approve\'})" data-event-name="ApprovalCardApproveClicked"> {{ approvalCardCtrl.clientResources.Approvals.Actions.Approve }} </button> <button class="reject-button c-action-trigger c-glyph glyph-close" ng-click="approvalCardCtrl.onClick({event: $event, approvalName: approvalCardCtrl.approval.name, response: \'Reject\'})" data-event-name="ApprovalCardRejectClicked"> {{ approvalCardCtrl.clientResources.Approvals.Actions.Reject }} </button> <list-commands model="approvalCardCtrl.dropDownCommands" id="approval-list-commands-{{::approvalCardCtrl.approvalCardId}}"></list-commands> </div> <div class="actions" ng-if="!approvalCardCtrl.isRequest"> <img class="blue-circle" ng-src="{{ approvalCardCtrl.timerWhiteIconUrl }}"/> <span class="status-text">{{ approvalCardCtrl.clientResources.Approvals.Status.AwaitingResponse }}</span> <list-commands model="approvalCardCtrl.dropDownCommands" id="approval-list-commands-{{::approvalCardCtrl.approvalCardId}}"></list-commands> </div> </div></div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(656);i(657);var o=function(){function e(){this.template=i(658),this.controller=n.HistoryTabCtrl,this.controllerAs="historyTabCtrl"}return e}();t.HistoryTab=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.approvals.historyTab,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e,t,i,r,n,o,s){this.$window=e,this.$locationService=t,this.appSettings=i,this.clientResources=r,this.environmentService=n,this.navigationService=o,this.urlService=s}return e.$inject=[r.default.services.$window,r.default.services.$location,r.default.services.appSettings,r.default.services.clientResources,r.default.services.environment,r.default.services.navigation,r.default.services.url],e}();t.HistoryTabCtrl=n},function(e,t){},function(e,t){e.exports=""},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(660);i(209);var o=function(){function e(){this.template=i(661),this.controller=n.ReceivedTabCtrl,this.controllerAs="receivedTabCtrl"}return e}();t.ReceivedTab=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.approvals.receivedTab,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(0),o=i(3),s=i(125),a=i(208),l=i(5),c=i(7),u=i(1),p=i(67),d=i(4),g=i(37),m=i(8),f=i(32);!function(e){e[e.NotSpecified=0]="NotSpecified",e[e.Approving=1]="Approving",e[e.Rejecting=2]="Rejecting"}(r||(r={}));var h={storageCacheId:"usersessioninfo"},v=function(){function e(e,t,i,n,o,s,a,u,p,v,y,w,C,S,b,P,R,T){var E=this;if(this.$http=e,this.$location=t,this.$routeParams=i,this.$scope=n,this.$timeout=o,this.approvalRequestsClient=s,this.appSettings=a,this.clientResources=u,this.environmentService=p,this.graphService=v,this.loggingService=y,this.navigationService=w,this.promiseHelperService=C,this.sessionService=S,this.storageCacheFactory=b,this.telemetryService=P,this.trialDialog=R,this.urlService=T,this.showInfoPane=!1,this.paneStates=r,this.listSpinner={size:c.SpinnerSize.Large,show:!1,local:c.SpinnerPosition.Local},this.paneSpinner={size:c.SpinnerSize.Large,show:!1,local:c.SpinnerPosition.Local},this.showZeroApprovals=!1,this.clockWhiteImage=l.default.clockWhite,this.linkWhiteImage=l.default.linkWhite,this.changeActionCommands=[{text:this.clientResources.Approvals.Actions.Approve,iconUrl:"glyph-checkmark",click:function(){E.setPaneState(r.Approving)}},{text:this.clientResources.Approvals.Actions.Reject,iconUrl:"glyph-close",click:function(){E.setPaneState(r.Rejecting)}}],this.fullPageErrorModel={image:l.default.fullPageErrorDebugFlow,isPageErrored:!1,pageTitle:null},document.referrer&&m.equalsIgnoreCase(f.parseUri(document.referrer).hostname,f.parseUri(this.appSettings.signUpRedirectUrl).hostname)&&this.$location.search().response&&this.telemetryService.tagEvent(g.TelemetryEventNames.TrialDialogOfficePortalSignupCompleted,{response:this.$location.search().response}),this.sessionService.isConsumerDomain)return void this.trialDialog.showUpgradeToProRequiredDialog(function(){window.location.assign("/")});this.listSpinner.show=!0;var A=this.loggingService.profilePageStart(d.ProfilingEventNames.approvalsReceivedTabStart),D=this.storageCacheFactory.Create(h.storageCacheId);this.cachedUserSessionInfo=D.get(h.storageCacheId),this.cachedUserSessionInfo?this.listApprovalRequests(A,this.cachedUserSessionInfo):this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(e){D.set(h.storageCacheId,e),E.listApprovalRequests(A,e)})}return e.prototype.listApprovalRequests=function(e,t){var i=this;this.assignedToFilter=u.format(s.approvalAssignedToFilterFormatting,t.userInfo.uniqueId),this.approvalRequests=this.approvalRequestsClient.query(this.$scope,{$filter:this.assignedToFilter}),this.approvalRequests.$promise.then(function(){i.setStateFromParams(i.paramApprovalName,i.paramApprovalRequestName,i.paramResponse),i.listSpinner.show=!1,i.loggingService.profilePageEnd(e,d.ProfilingEventNames.approvalsReceivedTabEnd,{status:o.Status.Success})}).catch(function(t){i.listSpinner.show=!1,o.showFullPageError(i.fullPageErrorModel,t,null),i.loggingService.logError("ApprovalsReceivedTabCtrl.listApprovalRequests",t),i.loggingService.profilePageEnd(e,d.ProfilingEventNames.approvalsReceivedTabEnd,{status:o.inferErrorStatus(t),error:o.parseErrorMessage(t)})}),this.approvalRequests.$watch(this.$scope,function(){0!==i.approvalRequests.length?i.$timeout(function(){$(window).trigger("resize")},1):i.showZeroApprovals=!0})},e.prototype.setStateFromParams=function(e,t,i){var n=this;if(!u.isEmpty(t)){var o=this.approvalRequests.map(function(e){return e.name}),s=o.indexOf(t);-1!==s&&e===this.approvalRequests[s].properties.approval.name?(this.selectedRequest=this.approvalRequests[s],u.isEmpty(i)||(i=i.toLowerCase(),"approve"===i||"'approve'"===i?this.setPaneState(r.Approving):"reject"===i||"'reject'"===i?this.setPaneState(r.Rejecting):this.setPaneState(r.NotSpecified)),this.$timeout(function(){n.showInfoPane=!0},1)):this.navigationService.navigate(this.urlService.approvalsReceivedRoute())}},e.prototype.navigateUrlToOpenInfoPane=function(e,t,i){e.stopPropagation();var r=this.approvalRequests.map(function(e){return e.properties.approval.name}),n=r.indexOf(t);this.selectedRequest=this.approvalRequests[n];var o=this.selectedRequest.name;this.navigationService.navigate(this.urlService.selectedApprovalRequestRoute(t,o),{response:i})},e.prototype.navigateUrlToCloseInfoPane=function(){var e=this;this.$timeout(function(){e.navigationService.navigate(e.urlService.approvalsReceivedRoute())},250)},Object.defineProperty(e.prototype,"isUserResponding",{get:function(){return this.paneState===r.Approving||this.paneState===r.Rejecting},enumerable:!0,configurable:!0}),e.prototype.isCardSelected=function(e){return!u.isEmpty(this.selectedRequest)&&e.name===this.selectedRequest.name},e.prototype.isCardDisabled=function(e){return!u.isEmpty(this.selectedRequest)&&!this.isCardSelected(e)},e.prototype.setPaneState=function(e){this.paneSpinner.show=!u.isEmpty(this.selectedRequest.properties.userResponse)&&this.selectedRequest.properties.userResponse.properties.status===a.ApprovalResponseStatus.Reviewing,this.selectedAction=e===r.Approving?this.clientResources.Approvals.Actions.Approve:this.clientResources.Approvals.Actions.Reject,this.paneState=e},e.prototype.confirmResponse=function(){var e=this;this.paneSpinner.show=!0;var t={properties:{response:this.paneState===r.Approving?"Approve":"Reject",comments:this.comments}};this.selectedRequest.properties.userResponse=t,this.selectedRequest.properties.userResponse.properties.status=a.ApprovalResponseStatus.Reviewing,this.approvalRequestsClient.postResponse({id:this.selectedRequest.properties.approval.name},t).then(function(){e.paneSpinner.show=!1,e.selectedRequest.properties.userResponse.properties.status=a.ApprovalResponseStatus.Saved,e.comments="",e.approvalRequestsClient.refreshQuery({$filter:e.assignedToFilter})}).catch(function(t){e.selectedRequest.properties.userResponse=null,e.loggingService.logError("ReceivedTabCtrl.confirmResponse",t)})},e.prototype.hasContent=function(e){return!u.isEmpty(e)},Object.defineProperty(e.prototype,"itemLinkDescription",{get:function(){var e=this.selectedRequest.properties.approval.properties.itemLinkDescription,t=this.itemLink;return u.isEmpty(e)?t:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemLink",{get:function(){var e=this.selectedRequest.properties.approval.properties.itemLink;return p.isAbsoluteUrl(e)?e:"https://"+e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDoneLoading",{get:function(){return!this.showZeroApprovals&&!this.listSpinner.show},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramApprovalRequestName",{get:function(){return this.$routeParams.approvalRequestName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramApprovalName",{get:function(){return this.$routeParams.approvalName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramResponse",{get:function(){return this.$routeParams.response},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showConfirmation",{get:function(){return!u.isEmpty(this.selectedRequest)&&!u.isEmpty(this.selectedRequest.properties.userResponse)&&this.selectedRequest.properties.userResponse.properties.status===a.ApprovalResponseStatus.Saved},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"confirmationMessage",{get:function(){var e=this.clientResources.Approvals.Confirmation;return u.isEmpty(this.selectedRequest)||u.isEmpty(this.selectedRequest.properties.userResponse)?null:"Approve"===this.selectedRequest.properties.userResponse.properties.response?e.Approved:e.Rejected},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasApproved",{get:function(){return!u.isEmpty(this.selectedRequest)&&!u.isEmpty(this.selectedRequest.properties.userResponse)&&"Approve"===this.selectedRequest.properties.userResponse.properties.response},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"statusMessage",{get:function(){var e='<span class="bold-label">'+this.selectedAction+"</span>";return u.format(this.clientResources.Approvals.Status.Message,e)},enumerable:!0,configurable:!0}),e.$inject=[n.default.services.$http,n.default.services.$location,n.default.services.$routeParams,n.default.services.$scope,n.default.services.$timeout,n.default.services.approvalRequestsClient,n.default.services.appSettings,n.default.services.clientResources,n.default.services.environment,n.default.services.graph,n.default.services.logging,n.default.services.navigation,n.default.services.promiseHelperService,n.default.services.session,n.default.services.storageCacheFactory,n.default.services.telemetry,n.default.services.trialDialog,n.default.services.url],e}();t.ReceivedTabCtrl=v},function(e,t){e.exports='<spinner model="receivedTabCtrl.listSpinner"></spinner> <section class="list-section" ng-if="receivedTabCtrl.isDoneLoading && !receivedTabCtrl.fullPageErrorModel.isPageErrored"> <div class="list-container"> <ul class="row"> <li class="card-list-item" ng-repeat="approvalRequest in receivedTabCtrl.approvalRequests"> <approval-card approval="approvalRequest.properties.approval" is-request="true" is-disabled="receivedTabCtrl.isCardDisabled(approvalRequest)" is-selected="receivedTabCtrl.isCardSelected(approvalRequest)" on-click="receivedTabCtrl.navigateUrlToOpenInfoPane(event, approvalName, response)"></approval-card> </li> </ul> </div> <info-pane pane-title="receivedTabCtrl.selectedRequest.properties.approval.properties.title" expanded="receivedTabCtrl.showInfoPane" on-close="receivedTabCtrl.navigateUrlToCloseInfoPane()"> <spinner model="receivedTabCtrl.paneSpinner"></spinner> <div class="approval-content" ng-show="!receivedTabCtrl.paneSpinner.show && !receivedTabCtrl.showConfirmation"> <section class="container from"> <h1 class="c-subheading-4">{{ receivedTabCtrl.clientResources.Approvals.Headers.From }}</h1> <avatar mail="receivedTabCtrl.selectedRequest.properties.approval.properties.owner.email" display-name="receivedTabCtrl.selectedRequest.properties.approval.properties.owner.displayName" image-src="receivedTabCtrl.selectedRequest.properties.approval.properties.owner.thumbnailPhoto" object-id="receivedTabCtrl.selectedRequest.properties.approval.properties.owner.id"></avatar> <div class="from-user-info"> <p class="c-paragraph-2">{{ receivedTabCtrl.selectedRequest.properties.approval.properties.owner.displayName }}</p> <p class="c-paragraph-3">{{ receivedTabCtrl.selectedRequest.properties.approval.properties.owner.email }}</p> </div> </section> <section class="container due-date"> <h1 class="c-subheading-4">{{ receivedTabCtrl.clientResources.Approvals.Headers.Requested }}</h1> <img class="black-circle" ng-src="{{ receivedTabCtrl.clockWhiteImage }}"> <span class="c-paragraph-3">{{ receivedTabCtrl.selectedRequest.properties.creationDate | date : "MMM d, y \'at\' h:mm a" }}</span> </section> <section class="container details" ng-if="receivedTabCtrl.hasContent(receivedTabCtrl.selectedRequest.properties.approval.properties.details)"> <h1 class="c-subheading-4">{{ receivedTabCtrl.clientResources.Approvals.Headers.Details }}</h1> <p class="c-paragraph-3">{{ receivedTabCtrl.selectedRequest.properties.approval.properties.details }}</p> </section> <section class="container link" ng-if="receivedTabCtrl.hasContent(receivedTabCtrl.selectedRequest.properties.approval.properties.itemLink)"> <h1 class="c-subheading-4">{{ receivedTabCtrl.clientResources.Approvals.Headers.Link }}</h1> <img class="black-circle" ng-src="{{ receivedTabCtrl.linkWhiteImage }}"/> <a target="_blank" class="c-hyperlink" ng-href="{{ receivedTabCtrl.itemLink }}">{{ receivedTabCtrl.itemLinkDescription }}</a> </section> <section class="actions" ng-show="!receivedTabCtrl.isUserResponding"> <button type="submit" class="c-button c-glyph glyph-checkmark" ng-click="receivedTabCtrl.setPaneState(receivedTabCtrl.paneStates.Approving)">{{ receivedTabCtrl.clientResources.Approvals.Actions.Approve }}</button> <button type="button" class="c-button c-glyph glyph-close" ng-click="receivedTabCtrl.setPaneState(receivedTabCtrl.paneStates.Rejecting)">{{ receivedTabCtrl.clientResources.Approvals.Actions.Reject }}</button> </section> <section ng-if="receivedTabCtrl.isUserResponding"> <div class="container status"> <h1 class="c-subheading-4">{{ receivedTabCtrl.clientResources.Approvals.Headers.Status }}</h1> <p class="c-paragraph-3" ng-bind-html="receivedTabCtrl.statusMessage"></p> <list-commands button-text="change" model="receivedTabCtrl.changeActionCommands"></list-commands> </div> <label class="c-label">{{ receivedTabCtrl.clientResources.Approvals.Labels.AddComments }} <span class="optional-label">({{ receivedTabCtrl.clientResources.Approvals.Labels.Optional }})</span></label> <div class="c-textarea"> <textarea ng-model="receivedTabCtrl.comments" max-length="2048" ng-attr-placeholder="{{ receivedTabCtrl.clientResources.Approvals.Placeholders.LeaveOpinion }}"></textarea> </div> <button type="submit" class="c-button confirm-button" ng-click="receivedTabCtrl.confirmResponse()">{{ receivedTabCtrl.clientResources.Approvals.Actions.Confirm }}</button> </section> </div> <div class="confirmation-content" ng-if="!receivedTabCtrl.paneSpinner.show && receivedTabCtrl.showConfirmation"> <section class="response-message"> <a class="green-circle-border c-glyph glyph-checkmark" ng-if="receivedTabCtrl.hasApproved"></a> <a class="red-circle-border c-glyph glyph-close" ng-if="!receivedTabCtrl.hasApproved"></a> <p class="message">{{ receivedTabCtrl.confirmationMessage }}</p> </section> </div> </info-pane> </section> <zero-approvals ng-if="receivedTabCtrl.showZeroApprovals && !receivedTabCtrl.fullPageErrorModel.isPageErrored"></zero-approvals> <full-page-error model="receivedTabCtrl.fullPageErrorModel" ng-if="receivedTabCtrl.fullPageErrorModel.isPageErrored"></full-page-error>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(663);i(209);var o=function(){function e(){this.template=i(664),this.controller=n.SentTabCtrl,this.controllerAs="sentTabCtrl"}return e}();t.SentTab=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.approvals.sentTab,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(3),o=i(5),s=i(7),a=i(1),l=i(67),c=i(4),u={storageCacheId:"usersessioninfo"},p=function(){function e(e,t,i,r,n,a,l,p,d,g,m,f,h,v,y){var w=this;if(this.$location=e,this.$routeParams=t,this.$scope=i,this.$timeout=r,this.approvalsClient=n,this.clientResources=a,this.environmentService=l,this.graphService=p,this.loggingService=d,this.navigationService=g,this.promiseHelperService=m,this.sessionService=f,this.storageCacheFactory=h,this.trialDialog=v,this.urlService=y,this.showInfoPane=!1,this.listSpinner={size:s.SpinnerSize.Large,show:!1,local:s.SpinnerPosition.Local},this.showZeroApprovals=!1,this.clockWhiteImage=o.default.clockWhite,this.linkWhiteImage=o.default.linkWhite,this.showConfirmation=!1,this.fullPageErrorModel={image:o.default.fullPageErrorDebugFlow,isPageErrored:!1,pageTitle:null},this.sessionService.isConsumerDomain)return void this.trialDialog.showUpgradeToProRequiredDialog(function(){window.location.assign("/")});this.listSpinner.show=!0;var C=this.loggingService.profilePageStart(c.ProfilingEventNames.approvalsSentTabStart),S=this.storageCacheFactory.Create(u.storageCacheId),b=S.get(u.storageCacheId);b?this.listApprovals(C,b):this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(e){S.set(u.storageCacheId,e),w.listApprovals(C,e)})}return e.prototype.listApprovals=function(e,t){var i=this;this.approvalList=this.approvalsClient.query(this.$scope,{$filter:"properties/owner/id eq '"+t.userInfo.uniqueId+"' and properties/status eq 'Pending'"}),this.approvalList.$promise.then(function(){i.setStateFromParams(i.paramApprovalName),i.listSpinner.show=!1,i.loggingService.profilePageEnd(e,c.ProfilingEventNames.approvalsSentTabEnd,{status:n.Status.Success})}).catch(function(t){i.listSpinner.show=!1,n.showFullPageError(i.fullPageErrorModel,t,null),i.loggingService.logError("ApprovalsSentTabCtrl.listApprovals",t),i.loggingService.profilePageEnd(e,c.ProfilingEventNames.approvalsSentTabEnd,{status:n.inferErrorStatus(t),error:n.parseErrorMessage(t)})}),this.approvalList.$watch(this.$scope,function(){0!==i.approvalList.length?i.$timeout(function(){$(window).trigger("resize")},1):i.showZeroApprovals=!0})},e.prototype.setStateFromParams=function(e){var t=this;if(!a.isEmpty(e)){var i=this.approvalList.map(function(e){return e.name}),r=i.indexOf(e);-1!==r&&e===this.approvalList[r].name?(this.selectedApproval=this.approvalList[r],this.$timeout(function(){t.showInfoPane=!0},1)):this.navigationService.navigate(this.urlService.approvalsSentRoute())}},e.prototype.navigateUrlToOpenInfoPane=function(e,t,i){e.stopPropagation();var r=this.approvalList.map(function(e){return e.name}),n=r.indexOf(t);this.selectedApproval=this.approvalList[n],this.navigationService.navigate(this.urlService.selectedApprovalRoute(t))},e.prototype.navigateUrlToCloseInfoPane=function(){var e=this;this.$timeout(function(){e.navigationService.navigate(e.urlService.approvalsSentRoute())},250)},e.prototype.isCardSelected=function(e){return!a.isEmpty(this.selectedApproval)&&e.name===this.selectedApproval.name},e.prototype.isCardDisabled=function(e){return!a.isEmpty(this.selectedApproval)&&!this.isCardSelected(e)},e.prototype.hasContent=function(e){return!a.isEmpty(e)},Object.defineProperty(e.prototype,"itemLinkDescription",{get:function(){var e=this.selectedApproval.properties.itemLinkDescription,t=this.itemLink;return a.isEmpty(e)?t:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemLink",{get:function(){var e=this.selectedApproval.properties.itemLink;return l.isAbsoluteUrl(e)?e:"https://"+e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDoneLoading",{get:function(){return!this.showZeroApprovals&&!this.listSpinner.show},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramApprovalName",{get:function(){return this.$routeParams.approvalName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasOtherApprovers",{get:function(){if(!a.isEmpty(this.selectedApproval)){var e=this.selectedApproval.properties.requestSummary;return e.totalRequests>e.approvers.length}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"otherApproversCount",{get:function(){var e=this.selectedApproval.properties.requestSummary;return e.totalRequests-e.approvers.length},enumerable:!0,configurable:!0}),e.$inject=[r.default.services.$location,r.default.services.$routeParams,r.default.services.$scope,r.default.services.$timeout,r.default.services.approvalsClient,r.default.services.clientResources,r.default.services.environment,r.default.services.graph,r.default.services.logging,r.default.services.navigation,r.default.services.promiseHelperService,r.default.services.session,r.default.services.storageCacheFactory,r.default.services.trialDialog,r.default.services.url],e}();t.SentTabCtrl=p},function(e,t){e.exports='<spinner model="sentTabCtrl.listSpinner"></spinner> <section class="list-section" ng-if="sentTabCtrl.isDoneLoading && !sentTabCtrl.fullPageErrorModel.isPageErrored"> <div class="list-container"> <ul class="row"> <li class="card-list-item" ng-repeat="approval in sentTabCtrl.approvalList"> <approval-card approval="approval" is-request="false" is-disabled="sentTabCtrl.isCardDisabled(approval)" is-selected="sentTabCtrl.isCardSelected(approval)" on-click="sentTabCtrl.navigateUrlToOpenInfoPane(event, approvalName, response)"></approval-card> </li> </ul> </div> <info-pane pane-title="sentTabCtrl.selectedApproval.properties.title" expanded="sentTabCtrl.showInfoPane" on-close="sentTabCtrl.navigateUrlToCloseInfoPane()"> <div class="approval-content"> <section class="container due-date"> <h1 class="c-subheading-4">{{ sentTabCtrl.clientResources.Approvals.Headers.Created }}</h1> <img class="black-circle" ng-src="{{ sentTabCtrl.clockWhiteImage }}"/> <span class="c-paragraph-3">{{ sentTabCtrl.selectedApproval.properties.creationDate | date : "MMM d, y \'at\' h:mm a" }}</span> </section> <section class="container details" ng-if="sentTabCtrl.hasContent(sentTabCtrl.selectedApproval.properties.details)"> <h1 class="c-subheading-4">{{ sentTabCtrl.clientResources.Approvals.Headers.Details }}</h1> <p class="c-paragraph-3">{{ sentTabCtrl.selectedApproval.properties.details }}</p> </section> <section class="container link" ng-if="sentTabCtrl.hasContent(sentTabCtrl.selectedApproval.properties.itemLink)"> <h1 class="c-subheading-4">{{ sentTabCtrl.clientResources.Approvals.Headers.Link }}</h1> <img class="black-circle" ng-src="{{ sentTabCtrl.linkWhiteImage }}"/> <a target="_blank" class="c-hyperlink" ng-href="{{ sentTabCtrl.itemLink }}">{{ sentTabCtrl.itemLinkDescription }}</a> </section> <section class="container status"> <h1 class="c-subheading-4">{{ sentTabCtrl.clientResources.Approvals.Headers.Status }}</h1> <p class="c-paragraph-3">{{ sentTabCtrl.clientResources.Approvals.Status.WaitingForResponse }}</p> </section> <section class="container from"> <h1 class="c-subheading-4">{{ sentTabCtrl.clientResources.Approvals.Headers.SentTo }}</h1> <ul> <li class="avatars-list-item" ng-repeat="approver in sentTabCtrl.selectedApproval.properties.requestSummary.approvers"> <avatar mail="approver.email" display-name="approver.displayName" image-src="approver.thumbnailPhoto" object-id="approver.id"></avatar> <div class="from-user-info"> <p class="c-paragraph-2">{{ approver.displayName }}</p> <p class="c-paragraph-3">{{ approver.email }}</p> </div> </li> <li class="avatars-list-item" ng-if="sentTabCtrl.hasOtherApprovers"> <div class="grey-circle-count"> +{{ sentTabCtrl.otherApproversCount }} </div> </li> </ul> </section> </div> </info-pane> </section> <zero-approvals ng-if="sentTabCtrl.showZeroApprovals && !sentTabCtrl.fullPageErrorModel.isPageErrored"></zero-approvals> <full-page-error model="sentTabCtrl.fullPageErrorModel" ng-if="sentTabCtrl.fullPageErrorModel.isPageErrored"></full-page-error>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(666);i(667);var o=function(){function e(){this.template=i(668),this.controller=n.ZeroApprovalsCtrl,this.controllerAs="zeroApprovalsCtrl"}return e}();t.ZeroApprovals=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.approvals.zeroApprovals,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(10),s=i(7),a=i(47),l=function(){function e(e,t,i,r){this.$scope=e,this.clientResources=t,this.logging=i,this.$sce=r,this.zeroApprovalsImage=n.default.zeroApprovals,this.oneClickApprovalFlowTemplatesSpinner={size:s.SpinnerSize.Large,show:!1,local:s.SpinnerPosition.LocalHorizontal},this.errorAlert={type:o.AlertType.None,message:"",options:{}},this.renderOneClickHeroTemplates()}return e.prototype.renderOneClickHeroTemplates=function(){var e=this;this.oneClickApprovalFlowTemplatesSpinner.show=!0,a.getOneClickApprovalFlowTemplatesView(function(t){e.oneClickApprovalFlowTemplatesHtml=e.$sce.trustAsHtml(t+"<script>$(window).trigger('resize');<\/script>")}).fail(function(t){e.logging.logError("ZeroApprovalsCtrl.Constructor.GetTemplates",t)}).always(function(){e.oneClickApprovalFlowTemplatesSpinner.show=!1,e.$scope.$digest()})},e.$inject=[r.default.services.$scope,r.default.services.clientResources,r.default.services.logging,r.default.services.$sce],e}();t.ZeroApprovalsCtrl=l},function(e,t){},function(e,t){e.exports='<section class="zero-approvals section"> <div class="zero-approvals-content"> <div class="row"> <div class="column c-content medium-offset-2 medium-8 large-offset-1 large-4"> <h1 class="c-heading-6">{{zeroApprovalsCtrl.clientResources.Approvals.Zero.CreateFirstFlow}}</h1> <p class="c-paragraph-1">{{zeroApprovalsCtrl.clientResources.Approvals.Zero.AddFlowOrTemplate}}</p> <a class="c-button f-video-button c-action-trigger c-glyph glyph-play sd-playinsection" role="button" href="#" data-src="https://www.youtube.com/embed/GATWcWulvgE?autoplay=1" data-player="default" aria-label="Play how it works video">{{zeroApprovalsCtrl.clientResources.Approvals.Zero.VideoButtonText}}</a> </div> <div class="column img-column medium-offset-2 medium-8 large-offset-0 large-7"> <img src="{{ zeroApprovalsCtrl.zeroApprovalsImage }}"> </div> </div> </div> <div class="zero-approvals-template"> <div class="one-click-approval-flow-templates" ng-bind-html="zeroApprovalsCtrl.oneClickApprovalFlowTemplatesHtml"></div> <div class="x-type-center one-click-spinner" ng-show="zeroFlowsCtrl.oneClickApprovalFlowTemplatesSpinner.show"> <spinner model="zeroApprovalsCtrl.oneClickApprovalFlowTemplatesSpinner"></spinner> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(670);i(671);var o=function(){function e(){this.template=i(672),this.controller=n.ApprovalCarouselCtrl,this.controllerAs="approvalCarouselCtrl"}return e}();t.ApprovalCarousel=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.approvals.approvalCarousel,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(125),o=i(132),s=i(1),a=function(){function e(e,t,i,r,n,o){this.$scope=e,this.approvalRequestsClient=t,this.clientResources=i,this.environmentService=r,this.sessionService=n,this.urlService=o,this.approvals=[],this.getApprovals()}return e.prototype.onClickApproval=function(e,t,i){e.stopPropagation();var r=this.getApprovalRequestName(t),n=""+this.urlService.manageRouteWithEnvironment(this.environmentService.getCurrentEnvironmentName())+this.urlService.selectedApprovalRequestRoute(t,r)+"?response="+i;this.navigateTo(n)},Object.defineProperty(e.prototype,"headerText",{get:function(){return this.approvals.length>1?s.format(this.clientResources.Approvals.HomeCarousel.HeaderFormatting.multiple,this.approvals.length):this.clientResources.Approvals.HomeCarousel.HeaderFormatting.singular},enumerable:!0,configurable:!0}),e.prototype.navigateTo=function(e){window.location.assign(e)},e.prototype.getApprovalRequestName=function(e){return this.approvalRequests.filter(function(t){return t.properties.approval.name===e})[0].name},e.prototype.getApprovals=function(){var e=this,t=s.format(n.approvalAssignedToFilterFormatting,this.sessionService.getUserInfo().uniqueId);this.approvalRequests=this.approvalRequestsClient.query(this.$scope,{$filter:t}),this.approvalRequests.$watch(this.$scope,function(){e.approvals=e.approvalRequests.map(function(e){return e.properties.approval}),e.$scope.$applyAsync(function(){e.initializeCarouselScrolling()})})},e.prototype.initializeCarouselScrolling=function(){var e=document.getElementById("approval-carousel");new o.default(e)},e.$inject=[r.default.services.$scope,r.default.services.approvalRequestsClient,r.default.services.clientResources,r.default.services.environment,r.default.services.session,r.default.services.url],e}();t.ApprovalCarouselCtrl=a},function(e,t){},function(e,t){e.exports='<section class="approval-carousel" ng-if="approvalCarouselCtrl.approvals.length > 0"> <div class="row"> <div class="column"> <h2 class="c-paragraph-2 subsection-heading">{{approvalCarouselCtrl.headerText}}</h2> <div class="c-carousel f-single-slide overflow-carousel" role="region" aria-label="" id="approval-carousel"> <button class="c-flipper f-previous home-carousel-button" aria-hidden="true" tabindex="-1" data-event-name="ApprovalCarouselPreviousFlipperClicked"></button> <button class="c-flipper f-next home-carousel-button" aria-hidden="true" tabindex="-1" data-event-name="ApprovalCarouselNextFlipperClicked"></button> <div itemscope itemtype="http://schema.org/ItemList"> <ul class="c-group"> <li ng-repeat="approval in approvalCarouselCtrl.approvals"> <div> <approval-card approval="approval" is-request="true" is-selected="false" is-disabled="false" on-click="approvalCarouselCtrl.onClickApproval(event, approvalName, response)"> </approval-card> </div> </li> </ul> </div> </div> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(125),i(674)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(21);var r=i(0),n=i(9),o=i(20),s=i(14),a={query:42e4,get:48e4,evictionDelay:3e5};t.ApprovalsConstant={urlPath:n.getAppSettings().processSimpleResourceProviderPath+"/environments/"+o.getCurrentEnvironmentName()+"/approvals",resourceType:n.getAppSettings().processSimpleResourceProviderPath+"/approvals/approval",expandParams:"properties/requestSummary,properties.principals.thumbnailphoto"},angular.module(r.default.modules.processSimpleData).factory(r.default.services.approvalsClient,[r.default.services.appSettings,r.default.services.azureResourceClientFactory,r.default.services.environment,function(e,i,r){var n=t.ApprovalsConstant.urlPath;return i({urlBase:s.ProcessSimpleResourceProviderManagementEndpoint,urlPath:n,apiVersion:e.processSimpleResourceProviderApiVersionWithEnvironments,resourceType:t.ApprovalsConstant.resourceType,rest:{query:{params:{$filter:"@filter",$expand:t.ApprovalsConstant.expandParams}}},options:{atomize:!1,queryPollInterval:a.query,getPollInterval:a.get,evictionDelay:a.evictionDelay}})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(208)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(677),i(792),i(799),i(803),i(804),i(830)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(678),i(682),i(686),i(690),i(693),i(698),i(702),i(706),i(710),i(714),i(718),i(722),i(726),i(730),i(210),i(737),i(741),i(745),i(748),i(751),i(755),i(759),i(763),i(767),i(771),i(775),i(779),i(783),i(788)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(679);i(680);var o=function(){function e(){this.template=i(681),this.bindings={model:"="},this.controller=n.AlertCtrl}return e}();t.Alert=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.alert,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(10),s=i(7),a=function(){function e(e,t){var i=this;this.$scope=e,this.clientResources=t,this.spinner={size:s.SpinnerSize.Small,local:s.SpinnerPosition.LocalStatic,show:!0},this.controlText=this.clientResources.Alert.AlertCloseLabel,e.$watch(function(){return i.model&&i.model.type},function(){switch(i.inProgress=!1,i.model.type){case o.AlertType.Warning:i.iconUrl=n.default.statusWarning,i.isVisible=!0;break;case o.AlertType.Error:i.iconUrl=n.default.statusError,i.isVisible=!0;break;case o.AlertType.Info:i.iconUrl=n.default.statusInfo,i.isVisible=!0;break;case o.AlertType.Progress:i.iconUrl=n.default.statusProgress,i.inProgress=!0,i.isVisible=!0;break;case o.AlertType.Success:i.iconUrl=n.default.statusSuccess,i.isVisible=!0;break;case o.AlertType.None:default:i.iconUrl="",i.isVisible=!1}i.controlText=i.model.options.control&&i.model.options.control.text?i.model.options.control.text:i.clientResources.Alert.AlertCloseLabel,i.controlClass=i.model.options.control&&i.model.options.control.className?i.model.options.control.className:""})}return e.prototype.controlAction=function(e){e.stopPropagation(),this.model.options.control&&this.model.options.control.action?(this.model.options.control.action(),this.dismiss()):this.dismiss()},e.prototype.dismiss=function(){this.model.type=o.AlertType.None},e.$inject=[r.default.services.$scope,r.default.services.clientResources],e}();t.AlertCtrl=a},function(e,t){},function(e,t){e.exports='<div class="alert-container" role="alertdialog" aria-live="assertive" tabindex="0" ng-if="$ctrl.isVisible"> <div class="alert"> <div class="row"> <div class="column"> <div class="alert-content-container"> <div class="alert-content" aria-labelledby="alert-title" aria-describedby="alert-message" tabindex="0"> <div class="alert-image-container" aria-hidden="true" ng-class="{\'image-container-alert-has-title\': $ctrl.model.options.title}"> <spinner model="$ctrl.spinner" ng-show="$ctrl.inProgress"></spinner> <svg svg-src="{{$ctrl.iconUrl}}" ng-hide="$ctrl.inProgress"></svg> </div> <span id="alert-title" class="alert-title" ng-attr-title="{{$ctrl.model.options.title}}">{{$ctrl.model.options.title}}</span> <span id="alert-message" class="alert-message" ng-attr-title="{{$ctrl.model.message}}"> {{$ctrl.model.message}} <a class="c-hyperlink" ng-if="$ctrl.model.options.link" ng-href="{{$ctrl.model.options.link.url}}" target="_blank">{{$ctrl.model.options.link.text}}</a> </span> </div> <div class="alert-close-container"> <a role="button" ng-click="$ctrl.controlAction($event)" class="c-action-trigger alert-close-button c-glyph" href="" ng-class="[$ctrl.controlClass, {\'glyph-close\': !$ctrl.controlClass}]">{{$ctrl.controlText}}</a> </div> </div> </div> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(683);i(684);var o=function(){function e(){this.template=i(685),this.bindings={icons:"="},this.controller=n.ApiIconColumnCtrl,this.controllerAs="apiIconColumnCtrl"}return e}();t.ApiIconColumn=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.apiIconColumn,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(46),n=function(){function e(){}return Object.defineProperty(e.prototype,"iconsToRender",{get:function(){return this._icons.length<=r.MaximiumIconsToRender?this._icons:this._icons.slice(0,r.IconsToRenderWhenExcess)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"omittedApiCount",{get:function(){return this._icons.length-this.iconsToRender.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasOmittedApis",{get:function(){return this.omittedApiCount>0},enumerable:!0,configurable:!0}),e.prototype.getOnErrorImgPath=function(e){return msflowportal.cdnUrlHelper.getCdnUrl(e.onErrorImagePath)},Object.defineProperty(e.prototype,"_icons",{get:function(){return this.icons||[]},enumerable:!0,configurable:!0}),e}();t.ApiIconColumnCtrl=n},function(e,t){},function(e,t){e.exports='<div class="api-icon-column" ng-class="{\r\n        \'one-icon-set\': apiIconColumnCtrl.icons.length === 1,\r\n        \'two-icon-set\': apiIconColumnCtrl.icons.length === 2,\r\n        \'three-icon-set\': apiIconColumnCtrl.icons.length === 3,\r\n        \'four-icon-set\': apiIconColumnCtrl.icons.length > 3,\r\n    }"> <div class="api-icon" ng-repeat="icon in apiIconColumnCtrl.iconsToRender" ng-style="{background: icon.brandColor}"> <img cdn-src="{{icon.iconUri}}" class="template-fallback-icon" alt="{{icon.DisplayName}}" onerror=\'this.onerror=null,this.src="/Content/Images/Common/connection.svg"\'/> </div> <div class="api-icon additional-api-placeholder" ng-if="apiIconColumnCtrl.hasOmittedApis"> <p>+{{apiIconColumnCtrl.omittedApiCount}}</p> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(687);i(688);var o=function(){function e(){this.template=i(689),this.bindings={apiCardType:"@",apiOperationId:"@",apiOperationType:"@",iconUri:"@",title:"@"},this.controller=n.ApiOperationCardCtrl,this.controllerAs="apiOperationCardCtrl"}return e}();t.ApiOperationCard=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.apiOperationCard,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return Object.defineProperty(e.prototype,"link",{get:function(){return"/manage/flows/new?"+this.apiOperationType+"="+encodeURIComponent(this.apiOperationId)},enumerable:!0,configurable:!0}),e}();t.ApiOperationCardCtrl=r},function(e,t){},function(e,t){e.exports='<div class="api-operation-card" ng-class="apiOperationCardCtrl.apiCardType"> <a class="api-operation-list-item" ng-href="{{apiOperationCardCtrl.link}}" data-event-name="ApiOperationCardClicked" data-event-operation-id="{{apiOperationCardCtrl.apiOperationId}}"> <div class="api-operation-card-icon"> <img src="{{apiOperationCardCtrl.iconUri}}" alt="{{apiOperationCardCtrl.title}}"/> </div> <div class="api-operation-card-text" ng-title="{{apiOperationCardCtrl.title}}"> {{apiOperationCardCtrl.title}} </div> </a> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(691),o=function(){function e(){this.controller=n.ApiOperationCardListCtrl,this.template=i(692),this.bindings={cards:"<",cardSizeType:"<"},this.controllerAs="apiOperationCardListCtrl"}return e}();t.ApiOperationCardList=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.apiOperationCardList,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e}();t.ApiOperationCardListCtrl=r},function(e,t){e.exports='<div class="api-operation-card-list-component"> <api-operation-card ng-repeat="apiOperation in apiOperationCardListCtrl.cards" ng-class="apiOpercationCardListCtrl.cardSizeType" title="{{apiOperation.properties.summary}}" icon-uri="{{apiOperation.properties.api.iconUri}}" api-operation-id="{{apiOperation.id}}" api-operation-type="trigger"> </api-operation-card> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(694);i(696);var o=function(){function e(){this.template=i(697),this.bindings={debounce:"<",error:"=",inputId:"=",inputPlaceholder:"=",inputValue:"=",items:"=",selectedIndex:"=",loading:"=",onChange:"<",onSelect:"<",isDisabled:"<"},this.transclude={itemTemplate:"autocompleteItemTemplate",errorTemplate:"?autocompleteErrorTemplate"},this.controller=n.AutocompleteCtrl,this.controllerAs="autocompleteCtrl"}return e}();t.Autocomplete=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.autocomplete,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(79),o=i(695),s=i(136),a=function(){function e(e,t,i){var r=this;this.$element=e,this.$q=t,this.$scope=i,this._lastOnChangeText=null,this._lastOnChangeText=this.inputValue,i.$on("destroy",function(){r._cancelDeferred&&(r._cancelDeferred.resolve(),r._cancelDeferred=null)})}return e.prototype.handleChange=function(){var e=this;this._debouncedOnChange||(this._debouncedOnChange=n(function(){e._lastOnChangeText!==e.inputValue&&(e._cancelDeferred&&e._cancelDeferred.resolve(),e._cancelDeferred=e.$q.defer(),e.$scope.$apply(function(){e._lastOnChangeText=e.inputValue,e.onChange(e.inputValue,e._cancelDeferred.promise)}))},this.debounce||350)),this._debouncedOnChange()},e.prototype.handleSelect=function(e,t){this.onSelect&&this.onSelect(e,t)},e.prototype.handleMouseEnter=function(e){e<this.getItems().length?this.selectedIndex=e:this.selectedIndex=-1},e.prototype.handleKeyDown=function(e){switch(o.normalizeKeyCode(e)){case o.KeyCodes.enter:e.preventDefault(),this.selectedIndex>=0&&this.selectedIndex<this.getItems().length&&this.handleSelect(this.getItems()[this.selectedIndex],e);break;case o.KeyCodes.arrowUp:e.preventDefault(),this.selectedIndex>0&&(this.selectedIndex-=1),this.scrollSelectedItemIntoViewIfNeeded();break;case o.KeyCodes.arrowDown:e.preventDefault(),this.selectedIndex<this.getItems().length-1&&(this.selectedIndex+=1),this.scrollSelectedItemIntoViewIfNeeded()}},e.prototype.scrollSelectedItemIntoViewIfNeeded=function(){var e=$("ul.autocomplete-list li.autocomplete-list-item:eq("+this.selectedIndex+")",this.$element);e&&1===e.length&&s(e[0],$("ul.autocomplete-list",this.$element)[0],{onlyScrollIfNeeded:!0})},e.prototype.getItems=function(){return this.items||[]},e.$inject=[r.default.services.$element,r.default.services.$q,r.default.services.$scope],e}();t.AutocompleteCtrl=a},function(e,t,i){"use strict";function r(e){return e.which?e.which:e.keyCode}Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeKeyCode=r,t.KeyCodes={tab:9,enter:13,arrowUp:38,arrowDown:40}},function(e,t){},function(e,t){e.exports='<div class="autocomplete-container"> <form class="autocomplete-form"> <input id="{{autocompleteCtrl.inputId}}" placeholder="{{autocompleteCtrl.inputPlaceholder}}" ng-model="autocompleteCtrl.inputValue" ng-change="autocompleteCtrl.handleChange($event)" ng-keydown="autocompleteCtrl.handleKeyDown($event)" ng-disabled="autocompleteCtrl.isDisabled" type="text" class="c-text-field autocomplete-input" autocomplete="off"/> </form> <ul class="autocomplete-list" ng-if="autocompleteCtrl.getItems().length > 0" ng-keydown="autocompleteCtrl.handleKeyDown($event)"> <li class="autocomplete-list-item" ng-class="{\'autocomplete-selected-row\': $index === autocompleteCtrl.selectedIndex}" ng-repeat="item in autocompleteCtrl.items" ng-transclude="itemTemplate" ng-click="autocompleteCtrl.handleSelect(item,$event)" ng-mouseenter="autocompleteCtrl.handleMouseEnter($index)"> </li> </ul> <div ng-transclude="errorTemplate" ng-if="!!autocompleteCtrl.error" class="autocomplete-error"></div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(699);i(700);var o=function(){function e(){this.template=i(701),this.bindings={displayName:"<",mail:"<",imageSrc:"<",objectId:"<"},this.controller=n.AvatarCtrl,this.controllerAs="avatarCtrl"}return e}();t.Avatar=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.avatar,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(0),o=function(){function e(e,t,i){var n=this;this.$scope=e,this.graphService=t,this.loggingService=i,this.defaultPlaceholderImage=r.default.userPlaceholder,this.imageSrc||this.objectId&&this.graphService.getThumbnailPhotos([this.objectId]).then(function(e){n.imageSrc=e.hasOwnProperty(n.objectId)?e[n.objectId]:r.default.userPlaceholder}).catch(function(e){n.loggingService.logError("AvatarCtrl.getThumbnailPhotos",e)})}return Object.defineProperty(e.prototype,"alt",{get:function(){return this.mail&&this.displayName?this.displayName+" ("+this.mail+")":this.mail?this.mail:this.displayName?this.displayName:""},enumerable:!0,configurable:!0}),e.$inject=[n.default.services.$scope,n.default.services.graph,n.default.services.logging],e}();t.AvatarCtrl=o},function(e,t){},function(e,t){e.exports='<img class="avatar img-circle" alt="{{avatarCtrl.alt}}" ng-src="{{avatarCtrl.imageSrc || avatarCtrl.defaultPlaceholderImage}}"/>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(703);i(704);var o=function(){function e(){this.template=i(705),this.controller=n.BackButtonCtrl,this.controllerAs="backbuttonCtrl",this.bindings={model:"="}}return e}();t.BackButton=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.backbutton,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e,t,i,r){this.$scope=e,this.$window=t,this.clientResources=i,this.navigation=r}return e.prototype.onGoBack=function(){this.model.click?this.model.click():this.navigation.navigate(this.model.url,this.model.searchParameters)},e.$inject=[r.default.services.$scope,r.default.services.$window,r.default.services.clientResources,r.default.services.navigation],e}();t.BackButtonCtrl=n},function(e,t){},function(e,t){e.exports='<div class="context-glyph-tile back-button-container"> <button class="c-glyph glyph-arrowback" ng-click="backbuttonCtrl.onGoBack()" aria-label="{{(backbuttonCtrl.model && backbuttonCtrl.model.ariaLabel) || backbuttonCtrl.clientResources.GoBackButtonDefaultAriaLabel}}"> <label ng-if="backbuttonCtrl.model.showLabel">{{backbuttonCtrl.clientResources.GoBackButtonLabel}}</label> </button> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(707);i(708);var o=function(){function e(){this.template=i(709),this.controller=n.ConfirmDialogCtrl,this.controllerAs="confirmDialogCtrl",this.bindings={title:"@",message:"@",show:"=",onConfirm:"<"}}return e}();t.ConfirmDialog=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.confirmDialog,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e,t,i,r){var n=this;this.$q=e,this.$scope=t,this.loggingService=i,this.clientResources=r,this.innerDialog={show:!1,buttons:[{label:this.clientResources.Common.Ok,action:function(){return n.onOk()},primary:!0},{label:this.clientResources.Common.Cancel,action:function(){return n.onCancel()}}]},this.$scope.$watch(function(){return n.show},function(){return n.innerDialog.show=n.show})}return e.prototype.onOk=function(){this.onConfirm&&this.onConfirm(),this.hide()},e.prototype.onCancel=function(){this.hide()},e.prototype.hide=function(){this.show=!1},e.$inject=[r.default.services.$q,r.default.services.$scope,r.default.services.logging,r.default.services.clientResources],e}();t.ConfirmDialogCtrl=n},function(e,t){},function(e,t){e.exports='<div class="confirm-dialog-component"> <modal-dialog model="confirmDialogCtrl.innerDialog"> <dialog-header-content-template> <h1 class="c-heading-3">{{confirmDialogCtrl.title}}</h1> </dialog-header-content-template> <dialog-body-content-template> <p class="c-paragraph-3">{{confirmDialogCtrl.message}}</p> </dialog-body-content-template> </modal-dialog> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(711);i(712);var o=function(){function e(){this.template=i(713),this.bindings={buttons:"=",showSpinner:"="},this.controller=n.DialogButtonsCtrl,this.controllerAs="dialogButtonsCtrl"}return e}();t.DialogButtons=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.dialogButtons,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(7),n=function(){function e(){this.spinner={size:r.SpinnerSize.Small,local:r.SpinnerPosition.LocalStatic,show:!0}}return e}();t.DialogButtonsCtrl=n},function(e,t){},function(e,t){e.exports='<div class="dialog-buttons" ng-if="!!dialogButtonsCtrl.buttons"> <spinner model="dialogButtonsCtrl.spinner" ng-if="dialogButtonsCtrl.showSpinner"></spinner> <div class="button-container"> <button class="c-button btn-primary" ng-repeat="button in dialogButtonsCtrl.buttons" ng-click="button.action($event)" title="{{button.label}}" type="{{!!button.primary ? \'submit\' : \'\'}}" ng-disabled="!!button.disabled">{{button.label}}</button> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(715);i(716);var o=function(){function e(){this.controller=n.EmailDisplayCtrl,this.controllerAs="emailDisplayCtrl",this.template=i(717),this.bindings={items:"<",onEmailDelete:"&"}}return e}();t.EmailDisplay=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.emailDisplay,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.onDelete=function(e){this.onEmailDelete&&this.onEmailDelete({item:e})},e}();t.EmailDisplayCtrl=r},function(e,t){},function(e,t){e.exports='<div class="email-display-component"> <div class="email-block" ng-repeat="email in emailDisplayCtrl.items"> <div class="email-text" title="{{email.model.displayName}}<{{email.model.mail}}>">{{email.model.displayName}}</div> <button class="c-glyph glyph-close email-delete" ng-click="emailDisplayCtrl.onDelete(email)"/> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(719);i(720);var o=function(){function e(){this.template=i(721),this.bindings={model:"="},this.controller=n.FilePickerCtrl,this.controllerAs="filePickerCtrl"}return e}();t.FilePicker=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.filePicker,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(1),o=function(){function e(){var e=this;this.selectedFileId=n.generateGuid(),this.uploadFileIcon=r.default.contentUpload,this.handleFileSelection=function(t){var i=t.target.files[0];i&&(e.selectedFileName=i.name,e.model&&e.model.onFileSelection&&e.model.onFileSelection(i,e.model.inputData))}}return e}();t.FilePickerCtrl=o},function(e,t){},function(e,t){e.exports='<div class="component-file-picker"> <div class="file-name-text-field"> <input class="c-text-field" type="text" ng-model="filePickerCtrl.selectedFileName" placeholder="{{filePickerCtrl.model.textFieldPlaceHolder}}" readonly="readonly"/> <input type="file" id="{{filePickerCtrl.selectedFileId}}" on-input-file-change="filePickerCtrl.handleFileSelection" ngf-select ngf-pattern="{{filePickerCtrl.model.ngInputPattern}}" ngf-accept="{{filePickerCtrl.model.ngInputAccept}}" ngf-max-size="{{filePickerCtrl.model.ngInputMaxSize}}"/> </div> <div class="upload-file-glyph"> <label for="{{filePickerCtrl.selectedFileId}}"> <img cdn-src="{{filePickerCtrl.uploadFileIcon}}"/> </label> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(723);i(724);var o=function(){function e(){this.template=i(725),this.bindings={model:"<"},this.controller=n.FlowPermissionsListCtrl,this.controllerAs="flowPermissionsListCtrl"}return e}();t.FlowPermissionsList=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowPermissionsList,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(97),s={howMany:4},a=function(){function e(e,t,i){this.$scope=e,this.graphService=t,this.clientResources=i,this.userPlaceholderImage=n.default.userPlaceholder;var r=o.getOidsFromPermissions(this.model.permissions),s=t.getThumbnailPhotos(r);this.permissions=this.model.permissions.map(function(e){var t,i;t=e.properties.principal.displayName,i=e.properties.principal.email;var r={primaryText:t,secondaryText:i};return s.then(function(t){var i=t[e.properties.principal.id];r.thumbnailUri=i}).catch(angular.noop),r})}return Object.defineProperty(e.prototype,"showLink",{get:function(){return this.model.permissions.length>s.howMany&&this.permissions&&0!==this.permissions.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"howMany",{get:function(){return s.howMany},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkText",{get:function(){return this.expanded?this.clientResources.Manage.CustomApi.FlowPermissionsList.lessUsers:this.clientResources.Manage.CustomApi.FlowPermissionsList.moreUsers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emptyMessage",{get:function(){return this.clientResources.Manage.CustomApi.FlowPermissionsList.defaultEmptyMessage},enumerable:!0,configurable:!0}),e.prototype.linkClicked=function(){this.expanded=!this.expanded},e.$inject=[r.default.services.$scope,r.default.services.graph,r.default.services.clientResources],e}();t.FlowPermissionsListCtrl=a},function(e,t){},function(e,t){e.exports='<div> <div ng-if="flowPermissionsListCtrl.permissions.length == 0"> {{flowPermissionsListCtrl.emptyMessage}} </div> <div ng-repeat="permission in flowPermissionsListCtrl.permissions | limitTo: flowPermissionsListCtrl.howMany" class="permission-entry"> <div class="permission-photo"> <img ng-if="permission.thumbnailUri" src="{{permission.thumbnailUri}}"/> <img ng-if="!permission.thumbnailUri" cdn-src="{{flowPermissionsListCtrl.userPlaceholderImage}}"/> </div> <div class="permission-info"> <div class="permission-primary-text"> {{permission.primaryText}} </div> <div class="permission-secondary-text"> {{permission.secondaryText}} </div> </div> </div> <div class="more-link" ng-if="flowPermissionsListCtrl.showLink"> <a ng-click="flowPermissionsListCtrl.linkClicked()">{{flowPermissionsListCtrl.linkText}}</a> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(727);i(728);var o=function(){function e(){this.bindings={model:"="},this.controller=n.FullPageErrorCtrl,this.controllerAs="fullPageErrorCtrl",this.template=i(729)}return e}();t.FullPageError=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.fullPageError,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(3),o=i(5),s=i(80),a=function(){function e(e,t,i,r,n){this.$scope=e,this.appSettings=t,this.clientResources=i,this.sessionService=r,this.urlService=n}return e.prototype.getTime=function(){return this.model.time?this.model.time:new Date},e.prototype.getImage=function(){return this.model.image||o.default.fullPageErrorGeneric},e.prototype.getFriendlyErrorText=function(){return this.model.friendlyErrorText?this.model.friendlyErrorText:this.clientResources.FullPageError.FriendlyError.Text.Default},e.prototype.getFriendlyErrorSubtext=function(){return this.model.friendlyErrorSubtext?this.model.friendlyErrorSubtext:this.clientResources.FullPageError.FriendlyError.Subtext.Default},e.prototype.getErrorDetail=function(){return n.parseErrorMessage(this.model.error,this.clientResources.Common.SomethingWentWrong)},e.prototype.getXMsClientRequestId=function(){return this.model.error&&this.model.error.config&&this.model.error.config.headers&&this.model.error.config.headers["x-ms-client-request-id"]},e.prototype.getXMsCorrelationRequestId=function(){return this.model.error&&s(this.model.error.headers)&&this.model.error.headers()&&this.model.error.headers()["x-ms-correlation-request-id"]},e.prototype.hasCustomButtons=function(){return this.model.customButtons&&this.model.customButtons.length>0},e.prototype.emitCustomButtonEvent=function(e){e&&e.event&&this.$scope.$emit(e.event)},e.$inject=[r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.session,r.default.services.url],e}();t.FullPageErrorCtrl=a},function(e,t){},function(e,t){e.exports='<div class="full-page-error sd-toggle" ng-if="fullPageErrorCtrl.model.isPageErrored" data-animation="slide"> <div class="full-page-error-title-container"> <span class="c-heading-3 full-page-error-title">{{fullPageErrorCtrl.model.pageTitle}}</span> </div> <div class="full-page-error-image-container"> <img cdn-src="{{fullPageErrorCtrl.getImage()}}"/> </div> <div class="row full-page-error-message"> <h1 class="c-heading-3">{{fullPageErrorCtrl.getFriendlyErrorText()}}</h1> <div class="column medium-6 medium-offset-3"> <p class="c-paragraph-3" ng-bind-html="fullPageErrorCtrl.getFriendlyErrorSubtext()"></p> <p> <a href="" class="c-hyperlink subtle toggler">{{fullPageErrorCtrl.clientResources.FullPageError.Links.SeeMoreDetails}}</a> <a ng-if="fullPageErrorCtrl.hasCustomButtons()" ng-attr-target="{{fullPageErrorCtrl.appSettings.isWidgetPage ? \'_blank\' : undefined}}" ng-href="{{fullPageErrorCtrl.urlService.supportUrl()}}" class="c-hyperlink subtle">{{fullPageErrorCtrl.clientResources.FullPageError.Buttons.ContactSupport}}</a> </p> </div> </div> <div class="toggled"> <div class="arrow_box"> <div class="full-page-error-details"> <div class="row"> <p class="c-paragraph-3">{{fullPageErrorCtrl.clientResources.FullPageError.Details.SupportInstructions}}</p> <div class="error-info-container"> <div class="error-info">Time: {{fullPageErrorCtrl.model.getTime()}}</div> <div class="error-info" ng-if="fullPageErrorCtrl.appSettings.correlationId">Server/Client Correlation ID: {{fullPageErrorCtrl.appSettings.correlationId}}</div> <div class="error-info" ng-if="fullPageErrorCtrl.getXMsClientRequestId()">x-ms-client-request-id (Client->Backend Request Header): {{fullPageErrorCtrl.getXMsClientRequestId()}}</div> <div class="error-info" ng-if="fullPageErrorCtrl.getXMsCorrelationRequestId()">x-ms-correlation-request-id (Backend Response Header): {{fullPageErrorCtrl.getXMsCorrelationRequestId()}}</div> <div class="error-info">Error: {{fullPageErrorCtrl.getErrorDetail()}}</div> </div> </div> <div class="close-button small-screen-close-button-container"> <a role="button" class="c-action-trigger error-detail-close-button c-glyph glyph-close toggler" href=""></a> </div> </div> </div> </div> <div class="full-page-error-button-container"> <a ng-if="!fullPageErrorCtrl.hasCustomButtons()" ng-attr-target="{{fullPageErrorCtrl.appSettings.isWidgetPage ? \'_blank\' : undefined}}" ng-href="{{fullPageErrorCtrl.urlService.supportUrl()}}" role="button" class="c-button full-page-error-button text-ellipsis-button">{{fullPageErrorCtrl.clientResources.FullPageError.Buttons.ContactSupport}}</a> <a ng-if="fullPageErrorCtrl.hasCustomButtons()" ng-repeat="button in fullPageErrorCtrl.model.customButtons" ng-attr-target="{{fullPageErrorCtrl.appSettings.isWidgetPage && button.url ? \'_blank\' : undefined}}" ng-click="fullPageErrorCtrl.emitCustomButtonEvent(button)" ng-href="{{button.url}}" role="button" class="c-button full-page-error-button text-ellipsis-button">{{button.buttonText}}</a> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(731);i(732);var o=function(){function e(){this.template=i(733),this.bindings={header:"<",subHeader:"<",buttonText:"<",renderButton:"<",onClick:"&"},this.controller=n.FullPageSingleActionCtrl,this.controllerAs="fullPageSingleActionCtrl"}return e}();t.FullPageSingleAction=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.fullPageSingleAction,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=function(){function e(e){this.clientResources=e,this.flowLogo=n.default.flowLogoBlue}return e.$inject=[r.default.services.clientResources],e}();t.FullPageSingleActionCtrl=o},function(e,t){},function(e,t){e.exports='<div class="full-page-single-action x-type-center"> <img class="flow-logo-image" cdn-src="{{fullPageSingleActionCtrl.flowLogo}}" alt="{{fullPageSingleActionCtrl.clientResources.FullPageSingleAction.Image.Alt}}"/> <h1 class="full-page-single-action-header c-heading-3">{{fullPageSingleActionCtrl.header}}</h1> <h2 class="full-page-single-action-header c-heading-4" ng-if="fullPageSingleActionCtrl.subHeader">{{fullPageSingleActionCtrl.subHeader}}</h2> <button class="full-page-single-action-button c-button btn-primary" ng-if="fullPageSingleActionCtrl.renderButton" ng-click="fullPageSingleActionCtrl.onClick()" type="submit">{{fullPageSingleActionCtrl.buttonText}} </button> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(210),o=i(1),s=i(3),a=20,l=function(){function e(e,t,i,r){var l=this;this.$q=e,this.clientResources=t,this.loggingService=i,this.graphService=r,this.selectedIndex=-1,this.inputValue="",this.inputPlaceholder="",this.loading=!1,this.limit=void 0,this.searchErrorText="",this.handleChange=function(e,t){if(l.selectedIndex=-1,l.searchErrorText="",e.trim().length<2)return l.items=[],void(l.loading=!1);l.loading=!0,l.$q.all([l.graphService.queryUsers({searchText:e,cancel:t}),l.graphService.queryGroups({searchText:e,cancel:t})]).then(function(t){var i=t[0],r=t[1];l.items=[].concat(i.map(function(e){return new n.GraphAutocompleteModel(e,"user")}),r.map(function(e){return new n.GraphAutocompleteModel(e,"group")})),l.items.length>0&&void 0!==l.limit&&(l.items=l.items.slice(0,l.limit>20?a:l.limit)),l.items.length>0?l.selectedIndex=0:e&&(l.searchErrorText=o.format(l.clientResources.GraphAutocomplete.NoResultText,e))}).catch(function(e){l.loggingService.logError("GraphAutocompleteCtrl.handleChange",e),s.isAngularHttpErrorObject(e)&&-1===e.status||(l.searchErrorText=s.parseErrorMessage(e))}).finally(function(){l.loading=!1})},this.handleSelect=function(e,t){l.selectedIndex=-1,l.items=[],l.inputValue="",l.onSelect&&l.onSelect({value:e,event:t})},this.inputPlaceholder=t.GraphAutocomplete.DefaultPlaceholder}return e.$inject=[r.default.services.$q,r.default.services.clientResources,r.default.services.logging,r.default.services.graph],e}();t.GraphAutocompleteCtrl=l},function(e,t){},function(e,t){e.exports='<div class="graph-autocomplete"> <autocomplete input-value="graphAutocompleteCtrl.inputValue" input-placeholder="graphAutocompleteCtrl.inputPlaceholder" items="graphAutocompleteCtrl.items" selected-index="graphAutocompleteCtrl.selectedIndex" loading="graphAutcompleteCtrl.loading" on-change="graphAutocompleteCtrl.handleChange" on-select="graphAutocompleteCtrl.handleSelect" is-disabled="graphAutocompleteCtrl.isDisabled" error="graphAutocompleteCtrl.searchErrorText"> <autocomplete-item-template> <div title="{{$parent.item.displayName}}">{{$parent.item.displayName}}</div> <div title="{{$parent.item.displayName}}">{{$parent.item.mail}}</div> </autocomplete-item-template> <autocomplete-error-template> <p>{{graphAutocompleteCtrl.searchErrorText}}</p> </autocomplete-error-template> </autocomplete> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(738);i(739);var o=function(){function e(){this.template=i(740),this.bindings={label:"=",buttons:"=",links:"=",back:"=",filter:"=",tabs:"=",toggle:"=",dropdown:"<?",dropdownCommands:"=",showSpinner:"<"},this.controller=n.HeadingCtrl,this.controllerAs="headingCtrl"}return e}();t.Heading=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.heading,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(7),o=function(){function e(e){this.clientResources=e,this.spinner={size:n.SpinnerSize.Small,show:!0,local:n.SpinnerPosition.LocalStatic}}return e.$inject=[r.default.services.clientResources],e}();t.HeadingCtrl=o},function(e,t){},function(e,t){e.exports='<header class="heading-container"> <div class="row"> <div class="column medium-6 small-8"> <backbutton model="headingCtrl.back" ng-if="headingCtrl.back"></backbutton> <h1 ng-if="headingCtrl.label">{{headingCtrl.label}}</h1> <div class="heading-tabs" ng-if="headingCtrl.tabs" role="tablist"> <a ng-repeat="tab in headingCtrl.tabs.tabsInfo" role="tab" aria-selected="{{headingCtrl.tabs.tabSelected === tab.tabName}}" ng-class="{\'tab-active\': headingCtrl.tabs.tabSelected === tab.tabName}" data-event-name="{{tab.eventName}}" ng-href="{{tab.href}}"> {{tab.tabHeader}} </a> </div> </div> <div class="column medium-6 small-4"> <div class="heading-right"> <spinner model="headingCtrl.spinner" ng-if="headingCtrl.showSpinner"></spinner> <a ng-repeat="link in headingCtrl.links" ng-href="{{link.href}}" class="heading-button text-ellipsis-button" role="button" ng-click="link.action()" data-event-name="{{link.eventName}}" ng-hide="{{link.hide}}" title="{{::link.label}}" ng-attr-download="{{!!link.download}}"> <div class="c-glyph" ng-class="link.svgId"> <img ng-if="link.image" cdn-src="{{link.image}}" alt="{{::link.label}}"/> </div> <span class="heading-link-label">{{link.label}}</span> </a> <button ng-repeat="button in headingCtrl.buttons" class="heading-button" ng-click="button.action()" ng-disabled="button.disabled()"> <div class="c-glyph" ng-class="button.svgId"> <img ng-if="button.image" cdn-src="{{button.image}}" alt="{{button.label}}"/> </div> <span class="heading-button-label">{{button.label}}</span> </button> <select ng-if="headingCtrl.filter" type="text" ng-model="headingCtrl.filter.filterSelected" ng-change="headingCtrl.filter.action()"> <option ng-repeat="filter in headingCtrl.filter.availableFilters" value="{{filter.value}}" ng-disabled="filter.value === \'invalid\'">{{filter.displayName}}</option> </select> <list-commands ng-if="headingCtrl.dropdownCommands" model="headingCtrl.dropdownCommands" button-text="headingCtrl.dropdown.label" class="command-item" dropdown-glyph="headingCtrl.dropdown.glyph"> </list-commands> <div class="header-divider" ng-if="headingCtrl.toggle"></div> <div ng-if="headingCtrl.toggle" class="c-toggle heading-toggle-button" ng-click="headingCtrl.toggle.action()"> <span class="toggle-pretext">{{headingCtrl.clientResources.Manage.Flow.Properties.Heading.Toggle.Pretext}}</span> <button role="checkbox" aria-checked="{{headingCtrl.toggle.isToggleOn()}}"></button> <span>{{headingCtrl.toggle.isToggleOn() ? headingCtrl.toggle.onText : headingCtrl.toggle.offText}}</span> </div> </div> </div> </div> </header> <section class="heading-spacer"></section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(742);i(743);var o=function(){function e(){this.template=i(744),this.bindings={model:"="},this.transclude={iconTemplate:"?infoCardIconTemplate",optionTemplate:"?infoCardOptionTemplate",pickerTemplate:"?infoCardPickerTemplate"},this.controller=n.InfoCardCtrl}return e}();t.InfoCard=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.infoCard,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e){this.$scope=e,this.$scope.model=this.model}return e.$inject=[r.default.services.$scope],e}();t.InfoCardCtrl=n},function(e,t){},function(e,t){e.exports='<div class="info-card-item row"> <div class="info-card-icon" ng-transclude="iconTemplate"></div> <div class="info-card-text-section column medium-6 small-6"> <div class="info-card-title">{{$ctrl.model.title}}</div> <div class="info-card-subtitle">{{$ctrl.model.subTitle}}</div> </div> <div class="info-card-options"> <div ng-transclude="pickerTemplate" class="dropdown-card-option"></div> <div ng-transclude="optionTemplate" ng-click="$ctrl.model.click()" class="card-option"></div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(746),o=function(){function e(){this.template=i(747),this.bindings={model:"="},this.controller=n.InfoCardListCtrl}return e}();t.InfoCardList=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.infoCardList,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e){this.$scope=e,this.$scope.model=this.model}return e.$inject=[r.default.services.$scope],e}();t.InfoCardListCtrl=n},function(e,t){e.exports='<ps-list items="$ctrl.model"> <ps-list-item-template> <info-card model="$parent.item"> <info-card-icon-template> <img ng-attr-src="{{$parent.model.iconUrl}}" onerror=\'this.onerror=null,this.src="/Content/Images/Common/connection.svg"\'/> </info-card-icon-template> <info-card-picker-template></info-card-picker-template> <info-card-option-template> <div class="c-glyph glyph-close option-block"></div> </info-card-option-template> </info-card> </ps-list-item-template> </ps-list>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(199);i(749);var o=function(){function e(){this.template=i(750),this.bindings={closeOnClickOutsidePane:"<?",paneAnimation:"<?",paneTitle:"<",expanded:"=",onClose:"&",toggleButtonId:"<?"},this.controller=n.InfoPaneCtrl,this.controllerAs="infoPaneCtrl",this.transclude=!0}return e}();t.InfoPane=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.infoPane,new o)},function(e,t){},function(e,t){e.exports='<section class="info-pane" ng-class="{\r\n        \'slide-in-pane\': infoPaneCtrl.isSlideInAnimation,\r\n        \'static-pane\': !infoPaneCtrl.isSlideInAnimation,\r\n        \'expanded\': infoPaneCtrl.expanded,\r\n        \'isWidget\': infoPaneCtrl.appSettings.isWidgetPage,\r\n    }"> <div class="info-pane-content"> <header> <h1>{{infoPaneCtrl.paneTitle}}</h1> <button type="button" class="c-action-trigger c-glyph glyph-close" ng-click="infoPaneCtrl.close()" alt="{{infoPaneCtrl.Resources.Common.close}"></button> </header> <section class="pane-content"> <div ng-transclude></div> </section> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(752);i(753);var o=function(){function e(){this.template=i(754),this.bindings={resource:"<",text:"<?"},this.controller=n.LearnMoreCtrl,this.controllerAs="learnMoreCtrl"}return e}();t.LearnMore=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.learnMore,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(1),o=i(64),s=function(){function e(e,t){this.appSettings=e,this.clientResources=t}return Object.defineProperty(e.prototype,"href",{get:function(){var e=void 0;return this.appSettings.isWidgetPage&&(e=o.get(this.clientResources,"Widget."+this.resource)),!n.isEmpty(e)&&this.appSettings.isWidgetPage||(e=o.get(this.clientResources,""+this.resource)),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkText",{get:function(){return n.isEmpty(this.text)?this.clientResources.Common.LearnMore:this.text},enumerable:!0,configurable:!0}),e.$inject=[r.default.services.appSettings,r.default.services.clientResources],e}();t.LearnMoreCtrl=s},function(e,t){},function(e,t){e.exports='<div class="learn-more-component"> <a href="{{learnMoreCtrl.href}}" target="_blank" data-event-name="LearnMoreClicked">{{learnMoreCtrl.linkText}}</a> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(756);i(757);var o=function(){function e(){this.template=i(758),this.bindings={actions:"<?",ariaLabel:"@",dismissButtonAriaLabel:"<?",isMultiline:"<?",messageBarType:"<?",onDismiss:"<?"},this.transclude=!0,this.controller=n.MessageBarCtrl,this.controllerAs="messageBarCtrl"}return e}();t.MessageBar=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.messageBar,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e){this.$scope=e}return e.$inject=[r.default.services.$scope],e}();t.MessageBarCtrl=n},function(e,t){},function(e,t){e.exports='<div class="message-bar-component" aria-label="{{messageBarCtrl.ariaLabel}}"> <div ng-transclude/> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(760);i(761);var o=function(){function e(){this.template=i(762),this.bindings={model:"="},this.transclude={customDialogContentTemplate:"?customDialogContentTemplate",dialogHeaderContentTemplate:"?dialogHeaderContentTemplate",dialogBodyContentTemplate:"?dialogBodyContentTemplate"},this.controller=n.ModalDialogCtrl}return e}();t.ModalDialog=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.modalDialog,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e){var t=this;this.$scope=e,this.$scope.$watch(function(){return t.model.show},function(){return t.hookTabPressAtModalDialog()})}return e.prototype.hookTabPressAtModalDialog=function(){var e=this;if(this.model.show){var t=this.$scope.$id;this.enterModalDialogOnKeypress=function(i){var r=document.getElementById("modal-dialog-"+String(t));if(r){e.$modalDialog=angular.element(r);e.$modalDialog[0].contains(i.target)||e.$modalDialog[0].focus()}},document.addEventListener("focusin",this.enterModalDialogOnKeypress)}else this.enterModalDialogOnKeypress&&(document.removeEventListener("focusin",this.enterModalDialogOnKeypress),this.enterModalDialogOnKeypress=null)},e.prototype.hide=function(){this.model.show=!1},e.prototype.show=function(){this.model.show=!0},e.$inject=[r.default.services.$scope],e}();t.ModalDialogCtrl=n},function(e,t){},function(e,t){e.exports='<div class="ng-modal" ng-if="$ctrl.model.show"> <div class="ng-modal-overlay"></div> <div class="ng-modal-dialog" id="modal-dialog-{{::$ctrl.$scope.$id}}" tabindex="0" role="dialog"> <div class="ng-modal-dialog-content"> <div ng-transclude="customDialogContentTemplate" ng-if="!!$ctrl.model.disableDefaultStyles"></div> <div class="ng-modal-dialog-header-content" ng-transclude="dialogHeaderContentTemplate" ng-if="!$ctrl.model.disableDefaultStyles"></div> <div class="ng-modal-dialog-body-content" ng-transclude="dialogBodyContentTemplate" ng-if="!$ctrl.model.disableDefaultStyles"></div> <div class="ng-modal-dialog-footer-content" ng-if="!$ctrl.model.disableDefaultStyles"> <dialog-buttons buttons="$ctrl.model.buttons" show-spinner="$ctrl.model.showProgressSpinner"/> </div> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(764);i(765);var o=function(){function e(){this.controller=n.OptionsCtrl,this.controllerAs="optionsCtrl",this.template=i(766),this.bindings={model:"="}}return e}();t.Options=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.options,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e){this.$scope=e}return e.prototype.selectOption=function(e){this.model.selectedOption=e},e.$inject=[r.default.services.$scope],e}();t.OptionsCtrl=n},function(e,t){},function(e,t){e.exports='<div class="context-option-items"> <div class="option-item" ng-repeat="option in optionsCtrl.model.options"> <button style="width:{{100/optionsCtrl.model.options.length}}%" class="c-select-button" aria-pressed="{{option.displayName === optionsCtrl.model.selectedOption.displayName}}" name="{{option.displayName}}" ng-click="optionsCtrl.selectOption(option)">{{option.displayName}}</button> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(768);i(769);var o=function(){function e(){this.controller=n.PaneSectionCtrl,this.controllerAs="paneSectionCtrl",this.template=i(770),this.bindings={title:"=",description:"="},this.transclude={paneContentTemplate:"?paneContentTemplate"}}return e}();t.PaneSection=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.paneSection,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e}();t.PaneSectionCtrl=r},function(e,t){},function(e,t){e.exports='<div class="pane-section-component"> <div class="pane-section-heading"> <h1 class="pane-section-title">{{paneSectionCtrl.title}}</h1> <p class="pane-section-description" ng-if="paneSectionCtrl.description">{{paneSectionCtrl.description}}</p> </div> <div ng-transclude="paneContentTemplate" class="pane-content-template"></div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(772);i(773);var o=function(){function e(){this.template=i(774),this.bindings={items:"="},this.transclude={itemTemplate:"psListItemTemplate"},this.controller=n.PsListCtrl,this.controllerAs="psListCtrl"}return e}();t.PsList=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.psList,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e}();t.PsListCtrl=r},function(e,t){},function(e,t){e.exports='<ul class="ps-list"> <li class="ps-list-item" ng-repeat="item in psListCtrl.items" ng-transclude="itemTemplate"> </li> </ul>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(776);i(777);var o=function(){function e(){this.template=i(778),this.controller=n.SchemaPropertyCtrl,this.bindings={items:"=",index:"=",baseViolator:"<",referencingOperationItems:"<",inRequest:"<"},this.controllerAs="schemaPropertyCtrl"}return e}();t.SchemaProperty=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.schemaProperty,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(27),o=i(16),s=i(11),a=function(){function e(e,t,i,r,a){var l=this;this.$scope=e,this.appSettings=t,this.clientResources=i,this.swaggerEditorDataService=r,this.swaggerValidationService=a,this.validationFilters={title:new s.FilteredResults(new s.Violator(this.baseViolator?this.baseViolator.swaggerItem:void 0,{schemaProperty:this.item,subPath:s.Paths.Title})),description:new s.FilteredResults(new s.Violator(this.baseViolator?this.baseViolator.swaggerItem:void 0,{schemaProperty:this.item,subPath:s.Paths.Description})),default:new s.FilteredResults(new s.Violator(this.baseViolator?this.baseViolator.swaggerItem:void 0,{schemaProperty:this.item,subPath:s.Paths.Default}))},this.requiredOptions=[{displayName:this.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Required.Yes,value:!0},{displayName:this.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Required.No,value:!1}],this.availableTypes=[n.Types.string,n.Types.integer,n.Types.number,n.Types.boolean],this.availableFormats={string:["","byte","binary","date","date-time","password"],integer:["int32","int64"],number:["float","double"],boolean:null},this.visibilityItems=Object.keys(o.Visibility).map(function(e){return o.Visibility[e]}).map(function(e){return{visibility:e,displayName:e}}),this.uiItemVisibility=this.item.visibility||o.Visibility.none,this.$scope.$watch(function(){return l.swaggerValidationService.resultCollection.results},function(){Object.keys(l.validationFilters).map(function(e){return l.validationFilters[e]}).forEach(function(e){return e.updateFilteredResults(l.swaggerValidationService.resultCollection)})})}return Object.defineProperty(e.prototype,"item",{get:function(){return this.items[this.index]},enumerable:!0,configurable:!0}),e.prototype.visibilityChanged=function(){this.item.visibility=this.uiItemVisibility},e.$inject=[r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.swaggerEditorData,r.default.services.swaggerValidationService],e}();t.SchemaPropertyCtrl=a},function(e,t){},function(e,t){e.exports='<div class="subsection-manage schema-property"> <div class="pane-title"> <span>{{schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Heading}}</span> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label">{{schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Title.Label}}</label> <validated-input input-model="schemaPropertyCtrl.item.leafTitle" validation-result-collection="schemaPropertyCtrl.validationFilters.title.resultCollection"/> </div> <div class="pane-field"> <label class="pane-field-label"> {{schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Description.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Description.Hyperlink\'"/> </label> <validated-input input-model="schemaPropertyCtrl.item.description" validation-result-collection="schemaPropertyCtrl.validationFilters.description.resultCollection"/> </div> <div class="pane-field" ng-if="schemaPropertyCtrl.inRequest"> <label class="pane-field-label">{{schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.DefaultValue.Label}}</label> <validated-input input-model="schemaPropertyCtrl.item.default" validation-result-collection="schemaPropertyCtrl.validationFilters.default.resultCollection"/> </div> <div class="pane-field" ng-if="schemaPropertyCtrl.inRequest"> <fieldset class="c-radio f-inline"> <label class="pane-field-label">{{schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Required.Label}}</label> <div class="c-group"> <div ng-repeat="option in schemaPropertyCtrl.requiredOptions track by option.displayName"> <label class="c-label"> <input type="radio" aria-label="{{option.displayName}}" ng-value="option.value" ng-checked="option.value === schemaPropertyCtrl.item.required" ng-model="schemaPropertyCtrl.item.required"/> <span>{{option.displayName}}</span> </label> </div> </div> </fieldset> </div> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"> {{schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Visibility.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Visibility.Hyperlink\'"/> </legend> <div> <div ng-repeat="visibilityItem in schemaPropertyCtrl.visibilityItems"> <label class="c-label"> <input type="radio" aria-label="{{visibilityItem.visibility}}" ng-value="visibilityItem.displayName" ng-change="schemaPropertyCtrl.visibilityChanged()" ng-model="schemaPropertyCtrl.uiItemVisibility"/> <span>{{visibilityItem.displayName}}</span> </label> </div> </div> </fieldset> </div> <div class="pane-field"> <div class="select-option-container"> <label class="pane-field-label">{{schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Type.Label}}</label> <select ng-model="schemaPropertyCtrl.item.type" type="text" class="select-option"> <option ng-repeat="type in schemaPropertyCtrl.availableTypes" value="{{type}}">{{type}}</option> </select> </div><div class="select-option-container"> <label class="pane-field-label">{{schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Format.Label}}</label> <select ng-model="schemaPropertyCtrl.item.format" type="text" ng-disabled="schemaPropertyCtrl.item.type == null || schemaPropertyCtrl.availableFormats[schemaPropertyCtrl.item.type] === null" class="select-option"> <option ng-repeat="format in schemaPropertyCtrl.availableFormats[schemaPropertyCtrl.item.type]" value="{{format}}">{{format}}</option> </select> </div> </div> <parameter-dropdown-editor ng-if="schemaPropertyCtrl.appSettings.featureFlags.enableSwaggerEditorDynamicValues && schemaPropertyCtrl.inRequest" schema-property="schemaPropertyCtrl.item" operation-items="schemaPropertyCtrl.referencingOperationItems"> </parameter-dropdown-editor> </div> <section> <validation-results heading-above-pane="schemaPropertyCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading" sub-heading-above-pane="schemaPropertyCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.SchemaProperty" base-violator="schemaPropertyCtrl.baseViolator"/> </section> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(780);i(781);var o=function(){function e(){this.template=i(782),this.bindings={model:"="},this.controller=n.SpinnerCtrl,this.controllerAs="spinnerCtrl"}return e}();t.Spinner=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.spinner,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(7),n=function(){function e(e){var t=this;this.$scope=e,e.$watch(function(){return t.model&&t.model.show},function(){t.model&&t.model.show?(t.isVisible=!0,t.message=t.model.message):(t.isVisible=!1,t.message="")}),e.$watch(function(){return t.model&&t.model.local},function(){if(t.model&&t.model.local)switch(t.model.local){case r.SpinnerPosition.Global:t.spinnerScopeCssClass=r.SpinnerScopeCssClasses.global;break;case r.SpinnerPosition.LocalHorizontal:t.spinnerScopeCssClass=r.SpinnerScopeCssClasses.localHorizontal;break;case r.SpinnerPosition.LocalStatic:t.spinnerScopeCssClass=r.SpinnerScopeCssClasses.localStatic;break;case r.SpinnerPosition.Local:default:t.spinnerScopeCssClass=r.SpinnerScopeCssClasses.local}else t.spinnerScopeCssClass=r.SpinnerScopeCssClasses.global}),e.$watch(function(){return t.model&&t.model.size},function(){if(t.model)switch(t.model.size){case r.SpinnerSize.Small:t.spinnerSizeCssClass=r.SpinnerSizeCssClasses.small;break;case r.SpinnerSize.Medium:t.spinnerSizeCssClass=r.SpinnerSizeCssClasses.medium;break;case r.SpinnerSize.Large:default:t.spinnerSizeCssClass=r.SpinnerSizeCssClasses.large}})}return e.$inject=["$scope"],e}();t.SpinnerCtrl=n},function(e,t){},function(e,t){e.exports='<div ng-class="spinnerCtrl.spinnerScopeCssClass" ng-if="spinnerCtrl.isVisible"> <div class="spinner-content c-progress" ng-class="spinnerCtrl.spinnerSizeCssClass" role="progressbar" aria-valuetext="{{spinnerCtrl.message}}" tabindex="0"> <span></span> <span></span> <span></span> <span></span> <span></span> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(784);i(786);var o=function(){function e(){this.template=i(787),this.bindings={templateName:"@"},this.controller=n.TemplateTileCtrl,this.controllerAs="templateTileCtrl"}return e}();t.TemplateTile=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.templateTile,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(0),o=i(5),s=i(1),a=i(98),l=i(7),c=i(6),u=i(4),p=i(785),d=i(211);!function(e){e[e.Ready=0]="Ready",e[e.Creating=1]="Creating",e[e.Succeed=2]="Succeed",e[e.Failed=3]="Failed"}(r||(r={}));var g=function(){function e(e,t,i,n,s,a,u,d,g,m){this.$scope=e,this.$window=t,this.appSettings=i,this.clientResources=n,this.loggingService=s,this.sessionService=a,this.templateCreationHelper=u,this.telemetryService=d,this.urlService=g,this.userConsentService=m,this.showFlowCreationSucceedUI=!1,this.flowCreationSucceedImage=o.default.templateTileSucceed,this.flowCreationSucceedMobileImage=o.default.templateTileSucceedMobile,this.flowCreationFailedImage=o.default.templateTileFailed,this.state=r.Ready,this.spinner={size:l.SpinnerSize.Small,show:!0,local:l.SpinnerPosition.LocalStatic},this.template=i.cache.templates[this.templateName],this.manageButtonLink=this.urlService.flowsFullPath(),this.browseTemplatesLink=this.urlService.templatesFullPath(),this.mobileAppDownloadPageLink=this.appSettings.portalMobileLearnMoreLink,this.template?(this.allIcons=p.getIconInfoFromTemplateDefinition(this.template),this.retryLink=this.urlService.templateFullPath(this.template.properties.galleryName,this.template.name),this.telemetryService.tagEvent(c.TelemetryEventNames.TemplateTileTemplateShown,null,{templateName:this.template.name})):(this.state=r.Failed,this.telemetryService.tagEvent(c.TelemetryEventNames.TemplateTileInitFailed,null,{templateName:this.template.name}))}return e.prototype.onAdd=function(){var e=this;this.telemetryService.tagEvent(c.TelemetryEventNames.TemplateTileAddButtonClicked,null,{templateName:this.template.name}),this.sessionService.hasUserConsented()?this.createFlowFromTemplate():this.userConsentService.consent().then(function(){e.createFlowFromTemplate()})},e.prototype.hasStatistic=function(){return!!(this.template&&this.template.properties&&this.template.properties.statistics)},e.prototype.emailLinkAction=function(){this.$window.location.href=d.getEmailLink(this.clientResources,this.appSettings)},Object.defineProperty(e.prototype,"runCountText",{get:function(){return this.hasStatistic()?s.format(this.clientResources.Template.RunCount,this.template.properties.statistics.instantiations):""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showMobileDownloadLink",{get:function(){return this.appSettings.featureFlags.enableTemplateTileMobileDownload&&(p.containPushNotification(this.template)||p.isManualTriggeredTemplate(this.template))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInReadyState",{get:function(){return this.state===r.Ready},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInCreatingState",{get:function(){return this.state===r.Creating},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInSucceedState",{get:function(){return this.state===r.Succeed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInFailedState",{get:function(){return this.state===r.Failed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disableAddButton",{get:function(){return this.isInCreatingState||this.userConsentService.consentInProgress},enumerable:!0,configurable:!0}),e.prototype.createFlowFromTemplate=function(){var e=this;a.isOneClickTemplate(this.template)||!this.sessionService.isConsumerDomain&&a.isSkipDesignerTemplate(this.template)?(this.state=r.Creating,this.templateCreationHelper.autoCreateFlow(this.$scope,this.template.name).then(function(){e.state=r.Succeed}).catch(function(t){e.state=r.Failed,e.loggingService.logError(u.ProfilingEventNames.autoCreateFlowFailed,t)})):this.$window.location.assign(this.urlService.templateFullPath(this.template.properties.galleryName,this.template.name))},e.$inject=[n.default.services.$scope,n.default.services.$window,n.default.services.appSettings,n.default.services.clientResources,n.default.services.logging,n.default.services.session,n.default.services.templateCreationHelper,n.default.services.telemetry,n.default.services.url,n.default.services.userConsent],e}();t.TemplateTileCtrl=g},function(e,t,i){"use strict";function r(e){return e&&e.properties&&e.properties.definitionSummary&&e.properties.connectionReferences&&l.getIconInfoForFlowDefinitionSummary(e.properties.definitionSummary,e.properties.connectionReferences)||[]}function n(e,t){var i=e&&e.properties&&e.properties.connectionReferences;return Object.keys(i||{}).some(function(e){return i[e]&&i[e].api&&i[e].api.id&&i[e].api.id.indexOf(t)>-1})}function o(e){return n(e,c.PushNotificationConnectionReferenceKeyWord)}function s(e){return e&&e.properties&&e.properties.definitionSummary&&e.properties.definitionSummary.triggers}function a(e){var t=s(e);return t&&u.isManualTrigger(t[0])}Object.defineProperty(t,"__esModule",{value:!0});var l=i(46),c=i(14),u=i(19);t.getIconInfoFromTemplateDefinition=r,t.containConnection=n,t.containPushNotification=o,t.getTriggersFromTemplate=s,t.isManualTriggeredTemplate=a},function(e,t){},function(e,t){e.exports='<div class="template-tile template-item"> <div class="ready-and-creating-state-content" ng-if="templateTileCtrl.isInReadyState || templateTileCtrl.isInCreatingState"> <api-icon-column icons="templateTileCtrl.allIcons"></api-icon-column> <div class="template-tile-content"> <h6 class="template-display-name c-heading sd-truncateText"> {{templateTileCtrl.template.properties.displayName}} </h6> <p class="template-description sd-truncateText"> {{templateTileCtrl.template.properties.description}} </p> <div class="template-tile-content-metadata"> <spinner model="templateTileCtrl.spinner" ng-if="templateTileCtrl.isInCreatingState"></spinner> <button class="c-button add-button" id="template-add-button-template.Name" ng-click="templateTileCtrl.onAdd()" ng-disabled="templateTileCtrl.disableAddButton" type="submit" title="{{templateTileCtrl.clientResources.TemplateTile.AddButton.Label}}"> {{templateTileCtrl.clientResources.TemplateTile.AddButton.Label}} </button> <p class="template-tile-statistic" ng-if="templateTileCtrl.hasStatistic()"> {{templateTileCtrl.runCountText}} </p> </div> </div> </div> <div class="success-state-content" ng-if="templateTileCtrl.isInSucceedState"> <div class="succeed-column"> <img cdn-src="{{templateTileCtrl.flowCreationSucceedImage}}" alt="{{templateTileCtrl.clientResources.TemplateTile.Success.AriaLabel}}"/> </div> <div class="template-tile-content default-success-content" ng-if="!templateTileCtrl.showMobileDownloadLink"> <h6 class="template-creation-success-heading c-heading sd-truncateText"> {{templateTileCtrl.clientResources.TemplateTile.Success.DefaultTitle}} </h6> <p class="template-description sd-truncateText"> {{templateTileCtrl.template.properties.description}} </p> <div class="template-tile-content-metadata"> <a class="c-button manage-button" ng-href="{{templateTileCtrl.manageButtonLink}}" role="button" data-event-name="TemplateTileManageButtonClicked" data-event-templatename="{{templateTileCtrl.template.name}}" title="{{templateTileCtrl.clientResources.TemplateTile.ManageButton.Label}}"> {{templateTileCtrl.clientResources.TemplateTile.ManageButton.Label}} </a> </div> </div> <div class="template-tile-content mobile-success-content" ng-if="templateTileCtrl.showMobileDownloadLink"> <h6 class="template-creation-success-heading c-heading sd-truncateText"> {{templateTileCtrl.clientResources.TemplateTile.Success.Mobile.Title}} </h6> <div class="mobile-description"> <img class="mobile-icon" cdn-src="{{templateTileCtrl.flowCreationSucceedMobileImage}}" tabindex="-1"/> <p class="template-description"> {{templateTileCtrl.clientResources.TemplateTile.Success.Mobile.Description}} <a ng-href="{{templateTileCtrl.mobileAppDownloadPageLink}}" data-event-name="TemplateTileLearnMoreLinkClicked" data-event-templatename="{{templateTileCtrl.template.name}}" title="{{templateTileCtrl.clientResources.TemplateTile.Success.Mobile.LearnMoreLink.Label}}"> {{templateTileCtrl.clientResources.TemplateTile.Success.Mobile.LearnMoreLink.Label}} </a> </p> </div> <div class="template-tile-content-metadata"> <a class="c-button email-link-button" href="" ng-click="templateTileCtrl.emailLinkAction()" role="button" data-event-name="TemplateTileEmailLinkButtonClicked" data-event-templatename="{{templateTileCtrl.template.name}}" title="{{templateTileCtrl.clientResources.TemplateTile.Success.Mobile.EmailLinkButton.Label}}"> {{templateTileCtrl.clientResources.TemplateTile.Success.Mobile.EmailLinkButton.Label}} </a> <a class="c-button manage-button" ng-href="{{templateTileCtrl.manageButtonLink}}" role="button" data-event-name="TemplateTileManageButtonClicked" data-event-templatename="{{templateTileCtrl.template.name}}" title="{{templateTileCtrl.clientResources.TemplateTile.ManageButton.Label}}"> {{templateTileCtrl.clientResources.TemplateTile.ManageButton.Label}} </a> </div> </div> </div> <div class="failed-state-content" ng-if="templateTileCtrl.isInFailedState"> <div class="failed-column"> <img cdn-src="{{templateTileCtrl.flowCreationFailedImage}}" alt="{{templateTileCtrl.clientResources.TemplateTile.Failed.AriaLabel}}"/> </div> <div class="template-tile-content"> <h6 class="template-creation-failure-heading c-heading sd-truncateText"> {{templateTileCtrl.clientResources.TemplateTile.Failure.Title}} </h6> <p class="template-creation-failure-description sd-truncateText"> {{templateTileCtrl.clientResources.TemplateTile.Failure.Description}} </p> <div class="template-tile-content-metadata"> <a class="c-button retry-button" ng-if="templateTileCtrl.isInFailedState" ng-href="{{templateTileCtrl.retryLink}}" role="button" data-event-name="TemplateTileRetryButtonClicked" data-event-templatename="{{templateTileCtrl.template.name}}" title="{{templateTileCtrl.clientResources.TemplateTile.RetryButton.Label}}"> {{templateTileCtrl.clientResources.TemplateTile.RetryButton.Label}} </a> <a class="c-button browse-templates-button" ng-if="templateTileCtrl.isInFailedState" ng-href="{{templateTileCtrl.browseTemplatesLink}}" role="button" data-event-name="TemplateTileBrowseButtonClicked" data-event-templatename="{{templateTileCtrl.template.name}}" title="{{templateTileCtrl.clientResources.TemplateTile.BrowseButton.Label}}"> {{templateTileCtrl.clientResources.TemplateTile.BrowseButton.Label}} </a> </div> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(789);i(790);var o=function(){function e(){this.template=i(791),this.controller=n.TokenBlockCtrl,this.bindings={commands:"<",token:"<",required:"<?",title:"<",iconUrl:"<?"},this.controllerAs="tokenBlockCtrl"}return e}();t.TokenBlock=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.tokenBlock,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(212),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.clickCommandWithToken=function(e,t,i){e.stopPropagation(),this.isCommandDisabled(t)||(t.click(i),this.dismissDropDown())},t}(n.ListCommandDirectiveController);t.TokenBlockCtrl=o},function(e,t){},function(e,t){e.exports='<span class="token-block"> <a href="#" role="button" ng-click="tokenBlockCtrl.toggleDropDown($event)" ng-attr-title="{{tokenBlockCtrl.title}}"> <img ng-if="tokenBlockCtrl.iconUrl" src="{{tokenBlockCtrl.iconUrl}}"/> <span class="context-required-text block-element" ng-if="tokenBlockCtrl.required">*</span> <span class="block-element title">{{tokenBlockCtrl.title}}</span> <span class="token-menu block-element c-glyph glyph-ellipsis"/> </a> <div class="dropdown-content" ng-class="{ \'show\': tokenBlockCtrl.isDropdownOpen }"> <a class="img-button dropdown-item c-glyph" ng-repeat="command in tokenBlockCtrl.commands" ng-class="[command.iconUrl, { \'disabled\': tokenBlockCtrl.isCommandDisabled(command) }]" ng-click="tokenBlockCtrl.clickCommandWithToken($event, command, tokenBlockCtrl.token)" ng-attr-title="{{tokenBlockCtrl.getCommandText(command)}}" role="button">{{tokenBlockCtrl.getCommandText(command)}} </a> </div> </span>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(793),i(794),i(795),i(796)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0);angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.cdnSrc,[function(){return{restrict:"A",priority:99,link:function(e,t,i){var n=angular.noop;i.$observe(r.default.directives.cdnSrc,function(e){if(e){var r=msflowportal.cdnUrlHelper.getCdnUrl(e);e!==r&&(t.off("error",n),n=function(){t.off("error",n),i.$set("src",e)},t.on("error",n)),i.$set("src",r)}}),e.$on("$destroy",function(){t.off("error",n)})}}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0);angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.ngBindHtmlCompile,[r.default.services.$compile,function(e){return{restrict:"A",link:function(t,i,n){n.$observe(r.default.directives.ngBindHtmlCompile,function(r){i.html(r),e(i.contents())(t)})}}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0);angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.onInputFileChange,[function(){return{restrict:"A",link:function(e,t,i){var n=e.$eval(i[r.default.directives.onInputFileChange]);t.bind("change",function(e){n(e)})}}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0);i(797);var n=i(212);angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.listCommands,function(){return{restrict:"E",template:i(798),scope:{model:"=",title:"=",disabled:"=",showTextDropdown:"=",dropdownGlyph:"<?",buttonText:"="},controller:n.ListCommandDirectiveController,controllerAs:"controller"}})},function(e,t){},function(e,t){e.exports='<div class="dropdown-block" ng-if="!showTextDropdown"> <button ng-click="controller.toggleDropDown($event)" class="dropbtn" ng-disabled="disabled" id="command-list-menu-button-{{::controller.$scope.$id}}" aria-haspopup="true" aria-expanded="{{controller.isDropdownOpen}}" aria-controls="command-list-menu-{{::controller.$scope.$id}}" role="button" aria-label="{{::controller.getButtonLabel()}}"> <span class="c-glyph ng-class: dropdownGlyph"></span> <span class="toggle-button-text" ng-if="buttonText">{{::controller.getButtonText()}}</span> </button> <ul class="dropdown-content ms-u-slideDownIn20" ng-class="{ \'show\': controller.isDropdownOpen }" role="menu" id="command-list-menu-{{::controller.$scope.$id}}" aria-labelledby="command-list-menu-button-{{::controller.$scope.$id}}" tabindex="0"> <div class="command-container" ng-repeat="command in model"> <li class="img-button dropdown-item c-glyph" ng-class="[command.iconUrl, { \'disabled\': controller.isCommandDisabled(command), \'child-dropdown-toggle\': command.commands, \'toggled\': dropdownToggled }]" ng-click="controller.clickCommand($event, command); dropdownToggled = !dropdownToggled;" role="menuitem" ng-mouseover="hoveringInChildCommandToggle = true" ng-mouseleave="hoveringInChildCommandToggle = false"> <img ng-if="command.iconSrc" cdn-src="{{command.iconSrc}}" alt="{{controller.getCommandText(command)}}"/> &nbsp;{{controller.getCommandText(command)}} </li> <ul class="dropdown-content hover-menu" role="menu" ng-if="command.commands" ng-show="hoveringInChildCommandToggle || hoveringInChildCommands || dropdownToggled" ng-mouseover="hoveringInChildCommands = true" ng-mouseleave="hoveringInChildCommands = false"> <li ng-repeat="childCommand in command.commands" class="img-button dropdown-item" ng-class="{ \'disabled\': controller.isCommandDisabled(childCommand) }" ng-click="controller.clickCommand($event, childCommand)" ng-attr-title="{{controller.getCommandText(childCommand)}}" role="menuitem">&nbsp;{{controller.getCommandText(childCommand)}}</li> </ul> <ul class="dropdown-content click-menu" role="menu" ng-if="command.commands" ng-show="dropdownToggled"> <li ng-repeat="childCommand in command.commands" class="img-button dropdown-item" ng-class="{ \'disabled\': controller.isCommandDisabled(childCommand) }" ng-click="controller.clickCommand($event, childCommand)" ng-attr-title="{{controller.getCommandText(childCommand)}}" role="menuitem">&nbsp;{{controller.getCommandText(childCommand)}}</li> </ul> </div> </ul> </div> <div class="dropdown-block-wide" ng-if="showTextDropdown"> <button ng-click="controller.toggleDropDown($event)" class="dropbtn-text" ng-disabled="disabled" ng-class="{ \'disabled\': disabled }" id="command-list-wide-menu-button-{{::controller.$scope.$id}}" aria-haspopup="true" aria-expanded="{{controller.isDropdownOpen}}" aria-controls="command-list-wide-menu-{{::controller.$scope.$id}}"> {{title}} <span class="c-glyph glyph-arrowdown"></span> </button> <ul class="dropdown-content wide ms-u-slideDownIn20" ng-class="{ \'show\': controller.isDropdownOpen }" role="menu" id="command-list-wide-menu-{{::controller.$scope.$id}}" aria-labelledby="command-list-wide-menu-button-{{::controller.$scope.$id}}" tabindex="0"> <div ng-repeat="command in model" class="command-container"> <li class="img-button dropdown-item c-glyph" ng-class="[command.iconUrl, { \'disabled\': controller.isCommandDisabled(command) }]" ng-click="controller.clickCommand($event, command)" role="menuitem" ng-mouseover="hoveringInChildCommandToggle = true" ng-mouseleave="hoveringInChildCommandToggle = false"> <img ng-if="command.iconSrc" cdn-src="{{command.iconSrc}}" alt="{{controller.getCommandText(command)}}"/> &nbsp;{{controller.getCommandText(command)}} </li> <ul class="dropdown-content hover-menu" role="menu" ng-if="command.commands" ng-show="hoveringInChildCommandToggle || hoveringInChildCommands" ng-mouseover="hoveringInChildCommands = true" ng-mouseleave="hoveringInChildCommands = false"> <li ng-repeat="childCommand in command.commands" class="img-button dropdown-item" ng-class="{ \'disabled\': controller.isCommandDisabled(childCommand) }" ng-click="controller.clickCommand($event, childCommand)" ng-attr-title="{{controller.getCommandText(childCommand)}}" role="menuitem">&nbsp;{{controller.getCommandText(childCommand)}}</li> </ul> <ul class="dropdown-content click-menu" role="menu" ng-if="command.commands" ng-show="dropdownToggled"> <li ng-repeat="childCommand in command.commands" class="img-button dropdown-item" ng-class="{ \'disabled\': controller.isCommandDisabled(childCommand) }" ng-click="controller.clickCommand($event, childCommand)" ng-attr-title="{{controller.getCommandText(childCommand)}}" role="menuitem">&nbsp;{{controller.getCommandText(childCommand)}}</li> </ul> </div> </ul> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(800),i(801),i(802),i(213)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(99);var r=i(0);angular.module(r.default.modules.processSimpleInterceptors).factory(r.default.interceptors.consentInterceptor,[r.default.services.appSettings,r.default.services.session,r.default.services.url,r.default.services.$q,function(e,t,i,r){return{request:function(n){return e.isWidgetPage||!t||!t.isAuthenticated||t.hasUserConsented()||!n||i.isRefreshSessionUrl(n.url)||i.isRefreshAudienceTokenUrl(n.url)||i.isTelemetryServiceUrl(n.url)||i.isConsentUserUrl(n.url)||i.isEmailTypeCheckUrl(n.url)?r.resolve(n):r.defer().promise}}}])},function(e,t,i){"use strict";function r(e){var t=e.url;if(s.endsWith(t,u)){return t.substr(0,t.length-u.length)+e.headers["x-ms-path-query"]}return t}function n(e){return{correlationId:e.headers(c.correlationId),serviceRequestId:e.headers(c.serviceRequestId),routingRequestId:e.headers(c.routingRequestId)}}function o(e){if(!e)return{status:-1};var t={status:e.status};return e.headers(c.contentLength)&&(t.contentLength=parseInt(e.headers(c.contentLength),10)),e.headers(c.serviceRequestId)&&(t.serviceRequestId=e.headers(c.serviceRequestId)),t}Object.defineProperty(t,"__esModule",{value:!0}),i(99);var s=i(1),a=i(38),l=i(0),c={clientRequestId:"x-ms-client-request-id",sessionId:"x-ms-client-session-id",correlationId:"x-ms-correlation-request-id",serviceRequestId:"x-ms-request-id",routingRequestId:"x-ms-routing-request-id",contentLength:"Content-Length"},u="/api/invoke";angular.module(l.default.modules.processSimpleInterceptors).factory(l.default.interceptors.loggingInterceptor,[l.default.services.appSettings,l.default.services.logging,l.default.services.$q,function(e,t,i){return{request:function(e){if(e&&e.url){e.requestTimestamp=t.performanceNow();var i=a.uuid();e.headers=e.headers||{},e.headers[c.clientRequestId]=i,e.headers[c.sessionId]=sessionInfo.sessionId;var n=r(e),o=(e.method||"").toUpperCase();t.logHttpRequestStart("OUTGOING_REQUEST_START",o,n,i)}return e},response:function(e){var i=e&&e.config;if(i&&i.url){var s=i.requestTimestamp,a=r(i),l=t.performanceNow()-s,u=n(e),p=(i.method||"").toUpperCase(),d=i.headers[c.clientRequestId];t.logHttpRequestEnd("OUTGOING_REQUEST_END",p,a,o(e),l,d,null,u.correlationId)}return e},responseError:function(e){var s=e&&e.config;if(s&&s.url){var a=s.requestTimestamp,l=r(s),u=t.performanceNow()-a,p=n(e),d=(s.method||"").toUpperCase();t.logHttpRequestEnd("OUTGOING_REQUEST_END",d,l,o(e),u,s.headers[c.clientRequestId],e.data,p.correlationId)}return i.reject(e)}}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(99);var r=i(0),n=i(77);angular.module(r.default.modules.processSimpleInterceptors).factory(r.default.interceptors.localeInterceptor,[r.default.services.appSettings,function(e){return{request:function(t){return t&&n.needLocaleHeader(t.url)&&(t.headers=t.headers||{},t.headers["Accept-Language"]=e.locale),t}}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(69)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(805),i(66),i(806),i(807),i(142),i(57),i(808),i(809),i(20),i(214),i(121),i(810),i(811),i(50),i(813),i(814),i(144),i(815),i(4),i(816),i(817),i(818),i(819),i(820),i(108),i(821),i(203),i(822),i(823),i(824),i(825),i(43),i(826),i(827),i(54),i(6),i(828),i(98),i(829),i(77)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(e,t,i){this.$q=e,this.$timeout=t,this.loggingService=i}return e.prototype.asyncRetry=function(e,t,i){var r=this,n=0,o=this.$q.defer(),s=function(){i().then(function(e){o.resolve(e)}).catch(function(i){if(r.loggingService.logError("AlgorithmsService.AsyncRetry",i),++n>=e)o.reject(i);else{var a=r.$timeout(s,t);o.notify({failureReason:i,executionCount:n,timeoutPromise:a})}})};return s(),o.promise},e.$inject=[r.default.services.$q,r.default.services.$timeout,r.default.services.logging],e}();t.AlgorithmsService=n,angular.module(r.default.modules.processSimpleServices).service(r.default.services.algorithms,n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(){var e=this;this.$get=[r.default.services.session,r.default.services.$q,function(t,i){return e.$q=i,e.loggingService=msflowportal.loggingService,e.sessionService=t,e.authenticationService=new o(e.$q,e.options,e.sessionService),e.authenticationService}]}return e.prototype.init=function(e,t){this.options=e,this.options.endpoints=this.options.endpoints||{},t&&t.interceptors&&t.interceptors.push(this.getHttpInterceptor())},e.prototype.getHttpInterceptor=function(){var e=this;return function(){return{request:function(t){if(!e.authenticationService.shouldAddAuthHeaderToEndpoint(t.url))return t;if(t){t.headers=t.headers||{};var i=e.authenticationService.getResourceForEndpoint(t.url),r=!1,n=e.authenticationService.getEndpoints();if(n)for(var o in n)t.url.indexOf(o)>-1&&(r=!0);if(r){var s=e.$q.defer();return e.authenticationService.getToken(i).then(function(e){t.headers.Authorization="Bearer "+e,s.resolve(t)}).catch(function(t){e.loggingService.logError("AuthenticationProvider.GetHttpInterceptor",t),s.reject(t)}),s.promise}}return t}}}},e.$inject=[r.default.services.logging],e}();t.AuthenticationProvider=n;var o=function(){function e(e,t,i){this.$q=e,this.options=t,this.sessionService=i}return e.prototype.getEndpoints=function(){return this.options.endpoints},e.prototype.getResourceForEndpoint=function(e){if(this.options&&this.options.endpoints&&e)for(var t in this.options.endpoints)if(e.toLowerCase().indexOf(t.toLowerCase())>-1)return this.options.endpoints[t];return this.options.clientId},e.prototype.shouldAddAuthHeaderToEndpoint=function(e){if(this.options&&this.options.anonymousEndpoints&&e)for(var t=0;t<this.options.anonymousEndpoints.length;t++);return!0},e.prototype.getToken=function(e){var t=this;return this.$q(function(i,r){t.sessionService.getToken(e).then(function(e){return i(e)}).catch(function(e){return r(e)})})},e}();t.AuthenticationService=o,angular.module(r.default.modules.processSimpleServices).provider(r.default.services.authentication,[n])},function(e,t,i){"use strict";function r(e){for(var t=""+e;t.length<u;)t="0"+t;return t=p+t}Object.defineProperty(t,"__esModule",{value:!0});var n,o=i(214),s=i(15),a=i(0),l=i(3),c=i(1),u=8,p="block-";!function(e){e[e.Invalid=0]="Invalid",e[e.Pending=1]="Pending",e[e.Uploading=2]="Uploading",e[e.Paused=3]="Paused",e[e.Complete=4]="Complete",e[e.Canceled=5]="Canceled"}(n=t.UploadStatus||(t.UploadStatus={}));var d=function(){function e(){}return e}();t.UploadInfo=d;var g=function(){function e(e,t,i,r,o,s,a,l,c){void 0===l&&(l="application/octet-stream");var u=this;this.$q=e,this.$http=t,this.resources=i,this.file=s,this.sasUrl=a,this.contentType=l,this.loggingService=c,this._blockIds=[],this._canceled=!1,this._disposed=!1,this.uploadInfo=new d,this.uploadInfo.status=n.Pending,this.uploadInfo.progressPercent=0,this.uploadInfo.name=s.name,this.uploadInfo.mimetype=s.type,this.uploadInfo.size=s.size,this._fileReaderHelper=r(s),o.$on("$destroy",function(){u.dispose()})}return e.prototype.startUploadToAzureBlob=function(){var e=this;return this.defer=this.$q.defer(),this.uploadInfo.status=n.Uploading,this._readChunkAndUpload(),this.defer.promise.catch(function(t){return e.loggingService.logError(s.ErrorCodes.blobUploadFailure,new s.ClientError(s.ErrorCodes.blobUploadFailure,l.parseErrorMessage(t,e.resources.Common.SomethingWentWrong),null)),e.$q.reject(t)})},e.prototype.cancelUpload=function(){if(!this._canceled)switch(this._canceled=!0,this.uploadInfo.status){case n.Pending:case n.Uploading:case n.Paused:this.uploadInfo.status=n.Canceled;break;case n.Invalid:case n.Canceled:case n.Complete:}this.defer.reject()},e.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._fileReaderHelper&&(this._fileReaderHelper.dispose(),this._fileReaderHelper=null))},e.prototype._readChunkAndUpload=function(){var e=this;this._fileReaderHelper.readNextChunk().then(function(t){e._isCanceledOrDisposed()||e._processFileReadResult(t)})},e.prototype._processFileReadResult=function(e){var t=this;switch(e.status){case o.FileReadStatus.Invalid:this._handleUploadRuntimeError(e.errorMessage?e.errorMessage:this.resources.Services.AzureBlobUploader.failedMessage);break;case o.FileReadStatus.Reading:case o.FileReadStatus.Complete:this._uploadBlockBlobToTargetSasUri(e.content).then(function(){if(!t._isCanceledOrDisposed())if(e.endByte!==t.uploadInfo.size){var i=Math.round(100*e.progressPercent);t.uploadInfo.progressPercent=i,t.defer.notify(i),t._readChunkAndUpload()}else t._commitBlockBlobUpload().then(function(){t._isCanceledOrDisposed()||t._handleUploadCompletion()},function(e){t._handleUploadRuntimeError(e)})},function(e){t._handleUploadRuntimeError(e)});break;case o.FileReadStatus.Canceled:}},e.prototype._isCanceledOrDisposed=function(){return this._canceled||this._disposed},e.prototype._handleUploadCompletion=function(){this.uploadInfo.progressPercent=100,this.uploadInfo.status=n.Complete,this.defer.resolve()},e.prototype._handleUploadRuntimeError=function(e){this.uploadInfo.status=n.Invalid,this.defer.reject(e)},e.prototype.deleteHeaderAuthorization=function(e){for(var t in e)if(c.equals(t,"Authorization")){delete e[t];break}return e},e.prototype._uploadBlockBlobToTargetSasUri=function(e){var t=this,i=r(this._blockIds.length);try{this._blockIds.push(btoa(i))}catch(e){this.defer.reject(e)}var n=this.sasUrl+"&comp=block&blockid="+this._blockIds[this._blockIds.length-1],o=function(){var i={headers:{"x-ms-blob-type":"BlockBlob"},transformRequest:function(e,t){return delete t().Authorization,e}};return t.$http.put(n,e,i)};return this._retryPromise(o)},e.prototype._commitBlockBlobUpload=function(){var e=this,t=this.sasUrl+"&comp=blocklist",i=function(){var i={headers:{"x-ms-blob-content-type":e.contentType},transformRequest:function(t,i){var r=i();return r=e.deleteHeaderAuthorization(r),t}};return e.$http.put(t,e._createCommitRequest(),i)};return this._retryPromise(i)},e.prototype._createCommitRequest=function(){for(var e="<?xml version='1.0' encoding='utf-8'?><BlockList>",t=0;t<this._blockIds.length;t++)e+="<Latest>"+this._blockIds[t]+"</Latest>";return e+="</BlockList>"},e.prototype._retryPromise=function(e,t,i,r){void 0===t&&(t=3),void 0===i&&(i=1e3),void 0===r&&(r=1);var n=this.$q.defer();return this._retryPromiseWorker(e,n,t,1,r,i),n.promise},e.prototype._retryPromiseWorker=function(e,t,i,r,n,o){var s=this;r>i?t.reject(this.resources.Services.AzureBlobUploader.failedMessage):e().then(t.resolve,function(a){s._isTransientHttpError(a.status)?setTimeout(function(){s._retryPromiseWorker(e,t,i,r+1,n,o*(1+n))},o):t.reject(s.resources.Services.AzureBlobUploader.failedMessage)})},e.prototype._isTransientHttpError=function(e){switch(e){case 408:case 504:case 502:case 500:case 503:return!0;default:return!1}},e}();t.AzureBlobUploader=g,angular.module(a.default.modules.processSimpleServices).factory(a.default.services.azureBlobUploaderService,[a.default.services.$q,a.default.services.$http,a.default.services.clientResources,a.default.services.fileReaderHelperService,a.default.services.logging,function(e,t,i,r,n){return function(o,s,a,l){return new g(e,t,i,r,o,s,a,l,n)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(58),o=i(36),s=function(){function e(e,t,i,r,n,o,s,a,l,c,u,p,d){this.$q=e,this.apisClient=t,this.appSettings=i,this.authenticationService=r,this.connectionsClient=n,this.designerAzureADService=o,this.environmentService=s,this.loggingService=a,this.oAuthService=l,this.policiesService=c,this.promiseHelperService=u,this.sessionService=p,this.telemetryService=d}return e.prototype.createDesignerConfig=function(e){var t=this;return this.$q.all([e.downloadDesignerScriptsPromise,e.connectionsPromise||this.$q.resolve(void 0),this.promiseHelperService.toAngularPromise(n.getVisibleHideKeys(this.apisClient,this.sessionService))]).then(function(i){var r=i[0],n=i[1],o=i[2];return t.createConfig(e.designerConfig,r,n,o.join(","))})},e.prototype.createConfig=function(e,t,i,r){var n=this,s={appSettings:this.appSettings,defaultRecurrence:this.policiesService.getDefaultRecurrence(),designercore:t.designercore,designerElement:null,environment:{name:this.environmentService.getCurrentEnvironmentName()},getArmAccessToken:function(){return o.toDesignerPromise(n.authenticationService.getToken(n.appSettings.authResource))},getRuntimeAccessToken:function(){return o.toDesignerPromise(n.authenticationService.getToken(n.appSettings.authResource))},getConsentServerAccessToken:function(){return o.toDesignerPromise(n.authenticationService.getToken(n.appSettings.consentServerAadResourceUri))},oAuthService:this.oAuthService,prefetchedData:{connections:i},telemetryService:this.telemetryService,visibleHideKeys:r};return s.azureADServiceFactory=this.designerAzureADService.create(s.designercore),this.updateDefaultDesignerConfig(s,e)},e.prototype.updateDefaultDesignerConfig=function(e,t){return e.allowCoauthoring=t.allowCoauthoring,e.canAddOperation=t.canAddOperation,e.connectionWizardUIConfig=t.connectionWizardUIConfig,e.designerElement=t.designerElement,e.dietViewServiceFactory=t.dietViewServiceFactory,e.enableDietDesigner=t.enableDietDesigner,e.flowName=t.flowName||"",e.prefetchedData.connectionProviders=t.prefetchedData&&t.prefetchedData.connectionProviders||void 0,e.runInstanceServiceFactory=t.runInstanceServiceFactory,e.showCalloutHints=t.showCalloutHints,e.showViewPermissionsDialog=t.showViewPermissionsDialog,e},e.$inject=[r.default.services.$q,r.default.services.apisClient,r.default.services.appSettings,r.default.services.authentication,r.default.services.connectionsClient,r.default.services.designerAzureADService,r.default.services.environment,r.default.services.logging,r.default.services.oAuth,r.default.services.policies,r.default.services.promiseHelperService,r.default.services.session,r.default.services.telemetry],e}();t.DesignerConfigService=s,angular.module(r.default.modules.processSimpleServices).service(r.default.services.designerConfig,s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(65),o=function(){function e(e){this.$document=e,this.body=this.$document.find("body")}return e.prototype.registerOpenOnClick=function(e,t,i,r,o){var s=this,a="#"+i;e.toggleButtonOnClick=function(i){i.preventDefault(),t.$apply(function(){e.expanded=!e.expanded;var i=s.body.find(a);i.attr({"aria-expanded":e.expanded}),e.expanded?(e.documentOnClick=function(e){var o=n.isParentOrElement(r[0],e.target),s=n.isParentOrElement(i[0],e.target);o||s||t.$apply(function(){l()})},s.$document.on("click",e.documentOnClick)):l()})},this.body.on("click",a,e.toggleButtonOnClick),o&&(e.toggleButtonOnKeyPress=function(e){13===e.keyCode&&o()},this.body.on("keypress",a,e.toggleButtonOnKeyPress)),t.$on("$destroy",function(){s.body.off("click",e.toggleButtonOnClick),e.toggleButtonOnClick=null,s.body.off("keypress",e.toggleButtonOnKeyPress),e.toggleButtonOnKeyPress=null,l()});var l=function(){if(e.documentOnClick){e.expanded=!1;s.body.find(a).attr({"aria-expanded":!1}),document.removeEventListener("click",e.documentOnClick),e.documentOnClick=null}}},e.$inject=[r.default.services.$document],e}();t.DomHelperService=o,angular.module(r.default.modules.processSimpleServices).service(r.default.services.domHelper,o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(4),o=i(15),s=i(49),a=i(3),l=function(){function e(e,t,i,r,n,o){this.$q=e,this.$window=t,this.$http=i,this.appSettings=r,this.clientResources=n,this.loggingService=o}return e.prototype.get=function(){var e=this,t=this.$q.defer(),i=this.loggingService.profileStart(n.ProfilingEventNames.geocodeGetStart);return this.$window.navigator.geolocation?this.$window.navigator.geolocation.getCurrentPosition(function(r){e.loggingService.profileEnd(i,n.ProfilingEventNames.geocodeGetEnd,{status:a.Status.Success}),t.resolve(r)},function(r){e.loggingService.profileEnd(i,n.ProfilingEventNames.geocodeGetEnd,{status:a.inferErrorStatus(r),message:a.parseErrorMessage(r)}),t.reject(new o.ClientError(o.ErrorCodes.geocodeServiceGeolocationDisabled,e.clientResources.Geolocation.Disabled,null))},{timeout:5e3}):(this.loggingService.profileEnd(i,n.ProfilingEventNames.geocodeGetEnd,{status:a.Status.Failure}),t.reject(new o.ClientError(o.ErrorCodes.geocodeServiceGeolocationUnsupported,this.clientResources.Geolocation.Unsupported.Message,null))),t.promise},e.prototype.getCoordinates=function(){return this.get().then(function(e){return{latitude:e.coords.latitude,longitude:e.coords.longitude}})},e.prototype.reverse=function(e){var t=this,i=this.$q.defer(),r=s.concatParts(this.appSettings.bingMapsApiUrl,"Locations/"),l=e.latitude+","+e.longitude,c=this.loggingService.profileStart(n.ProfilingEventNames.geocodeReverseStart,{coordinates:l});return this.$http.jsonp(r+l,{params:{jsonp:"JSON_CALLBACK",key:this.appSettings.bingMapsApiAccessCode}}).then(function(e){t.loggingService.profileEnd(c,n.ProfilingEventNames.geocodeReverseEnd,{status:a.Status.Success});var r=t.mapLocation(e.data);r?i.resolve(r):i.reject(new o.ClientError(o.ErrorCodes.geocodeServiceInvalidResult,t.clientResources.Geolocation.Reverse.Failed,null))}).catch(function(e){t.loggingService.profileEnd(c,n.ProfilingEventNames.geocodeReverseEnd,{status:a.inferErrorStatus(e),message:a.parseErrorMessage(e)}),t.loggingService.logError("GeoCodeService.ReverseGeocodeFailed",e),i.reject(new o.ClientError(o.ErrorCodes.geocodeServiceInvalidResult,t.clientResources.Location.Get.Failed,null))}),i.promise},e.prototype.mapLocation=function(e){return 200===e.statusCode&&e.resourceSets&&e.resourceSets[0]&&e.resourceSets[0].resources&&e.resourceSets[0].resources[0]&&e.resourceSets[0].resources[0].address&&e.resourceSets[0].resources[0].geocodePoints&&e.resourceSets[0].resources[0].geocodePoints[0]&&e.resourceSets[0].resources[0].geocodePoints[0].coordinates&&e.resourceSets[0].resources[0].geocodePoints[0].coordinates.length>0?{latitude:e.resourceSets[0].resources[0].geocodePoints[0].coordinates[0],longitude:e.resourceSets[0].resources[0].geocodePoints[0].coordinates[1],address:e.resourceSets[0].resources[0].address}:null},e.$inject=[r.default.services.$q,r.default.services.$window,r.default.services.$http,r.default.services.appSettings,r.default.services.clientResources,r.default.services.logging],e}();t.GeocodeService=l,angular.module(r.default.modules.processSimpleServices).service(r.default.services.geocode,l)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(4),o=i(43),s=i(1),a=i(29),l=i(812),c=i(15),u=i(3),p=i(8),d=i(1),g=i(5),m=function(){function e(e,t,i,r,o,s,l){var c=this;this.$http=e,this.$q=t,this.appSettings=i,this.clientResources=r,this.loggingService=o,this.promiseHelperService=s,this.sessionService=l,this.performActionAfterGettingGraphDetails=function(e,t,i){if(e&&e.length>0){var r=c.loggingService.profileStart(a.ProfilingEventNames.getGraphDetailsStart),o=c.getObjectsByObjectId(e),s=c.getThumbnailPhotos(e);return c.$q.all([o,s]).then(function(e){var i=e[0],o=e[1];c.loggingService.profileEnd(r,a.ProfilingEventNames.getGraphDetailsEnd,{status:n.Status.Success}),t(i,o)}).catch(function(t){return c.loggingService.profileEnd(r,a.ProfilingEventNames.getGraphDetailsEnd,{status:u.inferErrorStatus(t),error:u.parseErrorMessage(t),objectIds:e}),i(t),c.$q.resolve(null)})}return c.$q.resolve(null)},this.oidToThumbnailPhotoCache={}}return e.prototype.escapeSearchText=function(e){return(e||"").replace(/'/g,"")},e.prototype.getUserRoles=function(){var e=this,t=this.$q.defer();return this.userRoles?t.resolve(this.userRoles):this.$http({method:"GET",url:this.appSettings.aadGraphUrl+"/me/memberOf?api-version="+this.appSettings.aadGraphApiVersion,headers:{"Content-Type":"application/json"}}).then(function(i){e.userRoles=i&&i.data?i.data.value:{},t.resolve(e.userRoles)},function(i){e.loggingService.logError("GraphService.GetUserRolesFailed",i),t.reject(i)}),t.promise},e.prototype.getThumbnailPhotos=function(e){var t=this,i=[],r={},n=e.filter(function(e){return!t.oidToThumbnailPhotoCache[e.toLowerCase()]||(r[e]=t.oidToThumbnailPhotoCache[e.toLowerCase()],!1)}),o=this.$q.defer();if(n.length){var l=this.loggingService.profileStart(a.ProfilingEventNames.graphServiceGetThumbnailsStart);this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(e){n.forEach(function(n){if(e&&e.userInfo&&e.userInfo.tenantId){var o=t.appSettings.aadGraphUrl+"/"+e.userInfo.tenantId+"/users/"+n+"/thumbnailPhoto?api-version="+t.appSettings.aadGraphApiVersion,a=t.$http.get(o,{responseType:"arraybuffer"}).then(function(e){r[n.toLowerCase()]="data:image/JPEG;base64,"+s.arrayBufferToBase64(e.data),t.oidToThumbnailPhotoCache[n.toLowerCase()]=r[n.toLowerCase()]}).catch(function(e){t.loggingService.logWarning("GraphService.GetThumbnailPhotos","Failed to get thumbnail photo",e)});i.push(a)}else i.push(t.$q.resolve(function(){r[n.toLowerCase()]=g.default.userPlaceholder}))}),t.$q.all(i).finally(function(){t.loggingService.profileEnd(l,a.ProfilingEventNames.graphServiceGetThumbnailsEnd),o.resolve(r)})})}else o.resolve(r);return o.promise},e.prototype.getCachedThumbnailPhotos=function(e){var t=this,i={};return e.forEach(function(e){t.oidToThumbnailPhotoCache[e.toLowerCase()]&&(i[e.toLowerCase()]=t.oidToThumbnailPhotoCache[e.toLowerCase()])}),i},e.prototype.getTenantIdFromUserSession=function(e){var t=this;return e?this.$q.resolve(e):this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(e){return!e.isAuthenticated||p.equalsIgnoreCase(e.userInfo.userType,o.UserType.MicrosoftAccount)?t.$q.resolve(""):t.$q.resolve(e.userInfo.tenantId)})},e.prototype.getObjectsByObjectId=function(e,t){var i=this;return this.getTenantIdFromUserSession(t).then(function(t){return i.$http({method:"POST",url:i.appSettings.aadGraphUrl+"/"+t+"/getObjectsByObjectIds?api-version="+i.appSettings.aadGraphApiVersion,data:{objectIds:e,types:[l.Constants.DirectoryObjectTypes.group,l.Constants.DirectoryObjectTypes.user]}})}).then(function(r){return i.parseGraphValueArrayResponse(r,{tenantId:t,objectIds:e,method:"GraphService.getObjectsByObjectId"})})},e.prototype.queryUsers=function(e){var t=this,i=e.tenantId,r=e.pageSize||10,n=this.getStartsWithQueryValue(e.searchText,{key:"userPrincipalName",value:e.searchUserPrincipalName},{key:"displayName",value:e.searchDisplayName},{key:"mail",value:e.searchMail});return this.getTenantIdFromUserSession(i).then(function(i){return t.$http({method:"GET",url:t.appSettings.aadGraphUrl+"/"+i+"/users?$filter="+n+"&$top="+r+"&api-version="+t.appSettings.aadGraphApiVersion,timeout:e.cancel}).then(function(e){return t.parseGraphValueArrayResponse(e,{sessionTenantId:i,method:"GraphService.queryUsers"})})})},e.prototype.queryGroups=function(e){var t=this,i=e.tenantId,r=e.pageSize||10,n=!!d.isNullOrUndefined(e.securityEnabled)||e.securityEnabled,o=this.getStartsWithQueryValue(e.searchText,{key:"displayName",value:e.searchDisplayName},{key:"mail",value:e.searchMail}),s="securityEnabled eq "+n+" and ("+o+")";return this.getTenantIdFromUserSession(i).then(function(i){return t.$http({method:"GET",url:t.appSettings.aadGraphUrl+"/"+i+"/groups?$filter="+s+"&$top="+r+"&api-version="+t.appSettings.aadGraphApiVersion,timeout:e.cancel}).then(function(e){return t.parseGraphValueArrayResponse(e,{sessionTenantId:i,method:"GraphService.queryGroups"})})})},e.prototype.queryTenantDetails=function(e){var t=this;return this.getTenantIdFromUserSession(e).then(function(e){return t.$http({method:"GET",url:t.appSettings.aadGraphUrl+"/"+e+"/tenantDetails?api-version="+t.appSettings.aadGraphApiVersion}).then(function(i){return t.parseGraphValueArrayResponse(i,{sessionTenantId:e,method:"GraphService.queryTenantDetails"})})})},e.prototype.getMemberGroups=function(e,t){var i=this;return this.getTenantIdFromUserSession(t).then(function(t){var r={method:"POST",url:i.appSettings.aadGraphUrl+"/"+t+"/users/"+e+"/getMemberGroups?api-version="+i.appSettings.aadGraphApiVersion,data:{securityEnabledOnly:!0}};return i.$http(r).then(function(e){return i.parseGraphValueArrayResponse(e,{sessionTenantId:t,method:"GraphService.queryTenantDetails"})})})},e.prototype.getInvalidTenantIdError=function(){return this.getClientError(c.ErrorCodes.graphServiceInvalidTenantId,this.clientResources.GraphService.InvalidTenantId)},e.prototype.getClientError=function(e,t){return new c.ClientError(e,t,null,{isAuthenticated:this.sessionService.isAuthenticated,isConsumerDomain:this.sessionService.isConsumerDomain})},e.prototype.getStartsWithQueryValue=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e=this.escapeSearchText(e),encodeURIComponent(t.filter(function(e){return e&&!1!==e.value}).map(function(t){return"startswith("+t.key+", '"+e+"')"}).join(" or "))},e.prototype.parseGraphValueArrayResponse=function(e,t){if(e&&200===e.status&&e.data&&e.data.value&&e.data.value.length>=0)return e.data.value;throw new c.ClientError(c.ErrorCodes.graphServiceQueryBadResponse,this.clientResources.GraphService.Query.BadResponse,null,{errorInfo:t,responseStatusCode:e&&e.status,responseData:e&&e.data})},e.$inject=[r.default.services.$http,r.default.services.$q,r.default.services.appSettings,r.default.services.clientResources,r.default.services.logging,r.default.services.promiseHelperService,r.default.services.session],e}();t.GraphService=m,angular.module(r.default.modules.processSimpleServices).service(r.default.services.graph,m)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants={Uris:{users:"/users",groups:"/groups",domains:"/domains",objectsByObjectIds:"/getObjectsByObjectIds",thumbnailPhoto:"GetThumbnailPhoto"},UserTypes:{guest:"Guest",member:"Member"},DirectoryObjectTypes:{user:"user",group:"group"}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(){this.$get=[function(){return msflowportal.hostCommunicationService}]}return e}();t.HostCommunicationServiceProvider=n,angular.module(r.default.modules.processSimpleServices).provider(r.default.services.logging,[n])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(49),o=i(19),s=i(1),a=i(3),l=i(15),c=i(18),u=i(14),p=i(29),d=function(){function e(e,t,i,r,n,o,s){this.$http=e,this.$q=t,this.appSettings=i,this.clientResources=r,this.loggingService=n,this.propmiseHelper=o,this.sessionService=s}return e.prototype.installFlow=function(e,t){var i=this,r=this.loggingService.profileStart(p.ProfilingEventNames.installFlowStart,{flowName:o.getFlowName(e),flowUserType:o.getFlowUserType(e)});return this.propmiseHelper.toAngularPromise(this.sessionService.getToken(this.appSettings.authResource)).then(function(r){return i.$http({method:"POST",url:i.getInstallFlowResourceProviderEndpoint(o.getFlowName(e)),data:i.getInstallFlowRequestBody(t),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}})}).then(function(t){if(t&&200===t.status)return i.loggingService.profileEnd(r,p.ProfilingEventNames.installFlowEnd,{flowName:o.getFlowName(e),flowUserType:o.getFlowUserType(e)}),i.$q.resolve();throw new l.ClientError(l.ErrorCodes.installFlowFailed,s.format(i.clientResources.RunFlow.BadRequest,o.getFlowName(e)),null,{flowName:o.getFlowName(e),flowUserType:o.getFlowUserType(e),method:"InstallFlowService.installFlow",responseStatusCode:t&&t.status,responseData:t&&t.data})}).catch(function(t){return i.loggingService.profileEnd(r,p.ProfilingEventNames.installFlowEnd,{status:a.inferErrorStatus(t),error:a.parseErrorMessage(t),flowName:o.getFlowName(e),flowUserType:o.getFlowUserType(e)}),i.loggingService.logError("InstallFlowService.installFlow",t),i.$q.reject(t)})},e.prototype.getInstallFlowResourceProviderEndpoint=function(e){var t=u.ProcessSimpleResourceProviderManagementEndpoint,i=n.concatParts(c.FlowsConstant.urlPathWithEnvironments,n.concatParts(e,"install")),r=this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments;return n.concatParts(t,i)+"?api-version="+r},e.prototype.getInstallFlowRequestBody=function(e){return{connectionReferences:e}},e.$inject=[r.default.services.$http,r.default.services.$q,r.default.services.appSettings,r.default.services.clientResources,r.default.services.logging,r.default.services.promiseHelperService,r.default.services.session],e}();t.InstallFlowService=d,angular.module(r.default.modules.processSimpleServices).service(r.default.services.installFlowService,d)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(4),o=i(3),s=function(){function e(e,t,i,r){this.appSettings=e,this.clientResources=t,this.geocodeService=i,this.loggingService=r}return e.prototype.getLocationInfo=function(){var e=this,t=this.loggingService.profileStart(n.ProfilingEventNames.locationInfoGetStart);return this.geocodeService.get().then(function(t){return e.geocodeService.reverse({latitude:t.coords.latitude,longitude:t.coords.longitude})}).then(function(i){return e.loggingService.profileEnd(t,n.ProfilingEventNames.locationInfoGetEnd,{status:o.Status.Success}),i}).catch(function(i){throw e.loggingService.profileEnd(t,n.ProfilingEventNames.locationInfoGetEnd,{status:o.inferErrorStatus(i),message:o.parseErrorMessage(i)}),i})},e.prototype.getCity=function(e){return e&&e.address&&e.address.locality||""},e.prototype.getCountryOrRegion=function(e){return e&&e.address&&e.address.countryRegion||""},e.prototype.getFullAddress=function(e){return e&&e.address&&e.address.formattedAddress||""},e.prototype.getLatitude=function(e){return e&&e.latitude||void 0},e.prototype.getLongitude=function(e){return e&&e.longitude||void 0},e.prototype.getPostalCode=function(e){return e&&e.address&&e.address.postalCode||""},e.prototype.getState=function(e){return e&&e.address&&e.address.adminDistrict||""},e.prototype.getStreet=function(e){return e&&e.address&&e.address.addressLine||""},e.$inject=[r.default.services.appSettings,r.default.services.clientResources,r.default.services.geocode,r.default.services.logging],e}();t.LocationService=s,angular.module(r.default.modules.processSimpleServices).service(r.default.services.locationService,s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(){this.$get=[function(){return msflowportal.loggingService}]}return e}();t.LoggingServiceProvider=n,angular.module(r.default.modules.processSimpleServices).provider(r.default.services.logging,[n])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(4),o=i(3),s=function(){function e(e,t){this.appSettings=e,this.loggingService=t,this.flowsBeingExported={}}return e.prototype.exportTemplate=function(e){var t=this;if(this.flowsBeingExported[e.name])return this.flowsBeingExported[e.name];var i=this.loggingService.profileStart(n.ProfilingEventNames.LogicAppTemplateExportStart),r=e.$exportToARMTemplate().then(function(e){return t.loggingService.profileEnd(i,n.ProfilingEventNames.LogicAppTemplateExportEnd,{status:n.Status.Success}),e.data.template}).then(function(i){t.initiateDownload(e.properties.displayName+".json",JSON.stringify(i))}).catch(function(e){t.loggingService.profileEnd(i,n.ProfilingEventNames.LogicAppTemplateExportEnd,{status:o.inferErrorStatus(e),error:o.parseErrorMessage(e)}),t.loggingService.logError("logicAppTemplateExportService.exportTemplate: Failed to export template.",e)}).finally(function(){delete t.flowsBeingExported[e.name]});return this.flowsBeingExported[e.name]=r,r},e.prototype.initiateDownload=function(e,t){var i=navigator.userAgent.match(/MSIE\s([\d.]+)/),r=navigator.userAgent.match(/Trident\/7.0/)&&navigator.userAgent.match(/rv:11/),n=navigator.userAgent.match(/Edge/g),o=i?i[1]:r?11:n?12:-1;if(!(i&&o<10)){var s=new Blob([t],{type:"text/plain"});if(o>-1)window.navigator.msSaveBlob(s,e);else{var a=document.createElement("a");a.download=e,a.href=window.URL.createObjectURL(s),a.onclick=function(e){document.body.removeChild(e.target)},a.style.display="none",document.body.appendChild(a),a.click()}}},e.$inject=[r.default.services.appSettings,r.default.services.logging],e}();t.LogicAppTemplateExportService=s,angular.module(r.default.modules.processSimpleServices).service(r.default.services.logicAppTemplateExport,s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(){this.alerts=[]}return e.prototype.dequeueAlert=function(){var e=this.alerts.shift();return this.emptyAlerts(),e},e.prototype.enqueueAlert=function(e){this.alerts.push(e)},e.prototype.hasAlerts=function(){return this.alerts.length>0},e.prototype.emptyAlerts=function(){this.alerts=[]},e.$inject=[],e}();t.AlertService=n,angular.module(r.default.modules.processSimpleServices).service(r.default.services.alertService,n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e,t,i,r,n,o,s){this.$rootScope=e,this.$window=t,this.appSettings=i,this.environmentService=r,this.navigationService=n,this.sessionService=o,this.urlService=s}return e.prototype.navigateToNewBlankFlow=function(){this.appSettings.isWidgetPage?this.sessionService.hasUserConsented()&&this.appSettings.featureFlags.enableWidgetEdit?this.navigationService.navigate(this.urlService.newFlowsRoute(),this.urlService.getCreateFromBlankTemplateArgs()):this.$window.open(this.getBlankFlowLink(),"_blank"):this.navigationService.navigate(this.urlService.newFlowsRoute())},e.prototype.navigateToNewBlankFlowGettingStarted=function(){this.appSettings.isWidgetPage?this.sessionService.hasUserConsented()&&this.appSettings.featureFlags.enableWidgetEdit?this.navigationService.navigate(this.urlService.newFlowsRoute(),this.urlService.getCreateFromBlankTemplateArgs()):this.$window.open(this.getBlankFlowLink(),"_blank"):this.navigationService.navigate(this.urlService.newFlowsGettingStartedRoute())},e.prototype.navigateToBrowseTemplates=function(){!this.appSettings.isWidgetPage||this.sessionService.hasUserConsented()&&this.appSettings.featureFlags.enableWidgetCreateFromTemplate?this.$window.open(this.getFlowTemplateLink(),"_self"):this.$window.open(this.getFlowTemplateLink(),"_blank")},e.prototype.getBlankFlowLink=function(){return this.urlService.newBlankFlowRoute(this.getCurrentEnvironmentName())},e.prototype.getFlowTemplateLink=function(){return this.urlService.newTemplateFlowRoute(this.getCurrentEnvironmentName())},e.prototype.getCurrentEnvironmentName=function(){return this.appSettings.featureFlags.enableEnvironments?this.environmentService.getCurrentEnvironmentName():null},e.$inject=[r.default.services.$rootScope,r.default.services.$window,r.default.services.appSettings,r.default.services.environment,r.default.services.navigation,r.default.services.session,r.default.services.url],e}();t.NavigationHelperService=n,angular.module(r.default.modules.processSimpleServices).service(r.default.services.navigationHelper,n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(35),o=function(){function e(e,t,i,r,n,o){this.$window=e,this.$location=t,this.appSettings=i,this.environmentService=r,this.loggingService=n,this.urlService=o}return e.prototype.navigate=function(e,t){void 0===t&&(t={});var i=n.parseUri(this.$location.url()).parameters;(-1===this.$location.url().indexOf(e)||t&&Object.keys(t).some(function(e){return!i[e]}))&&(this.previousPath=this.$location.url());var r=this.$location.path(e);if(this.appSettings.isWidgetPage){var o=this.urlService.getWidgetQueryStringParameters(this.environmentService.getCurrentEnvironmentName());t=$.extend({},o,t)}return t&&(r=r.search(t)),r},e.prototype.getPreviousPagePath=function(){return this.previousPath},e.prototype.confirmNavigateAway=function(e,t){var i=this;t=$.extend({confirmOnNavigate:!0,confirmOnUnload:!0},t);var r=angular.noop;if(t.confirmOnUnload){var n=function(){if(t.condition())return t.message};$(window).on("beforeunload",n),r=function(){$(window).off("beforeunload",n)}}var o=angular.noop;t.confirmOnNavigate&&(o=e.$on("$locationChangeStart",function(e){if(t.condition()){var r=confirm(t.message+"\n\n"+t.confirmation);if(t.onConfirmResult)try{t.onConfirmResult(r)}catch(e){i.loggingService.logError("NavigationService.onConfirmresult",e)}r||e.preventDefault()}})),e.$on("$destroy",function(){r(),o()})},e.$inject=[r.default.services.$window,r.default.services.$location,r.default.services.appSettings,r.default.services.environment,r.default.services.logging,r.default.services.url],e}();t.NavigationService=o,angular.module(r.default.modules.processSimpleServices).service(r.default.services.navigation,o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(){this.$get=[function(){return msflowportal.optimizelyService}]}return e}();t.OptimizelyServiceProvider=n,angular.module(r.default.modules.processSimpleServices).provider(r.default.services.optimizely,[n])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(39),o=function(){function e(e,t,i,r,n,o){this.$q=e,this.appSettings=t,this.environmentService=i,this.loggingService=r,this.planService=n,this.sessionService=o}return e.prototype.getDefaultRecurrence=function(){return n.getPlanDefaultRecurrence(this.planService.getUserPlan())},e.prototype.getMaxFlowFrequencyInSeconds=function(){return n.getMaxFlowFrequencyInSeconds(this.planService.getUserPlan())},e.prototype.getMonthlyFlowRunAllotment=function(){return n.monthlyFlowRunAllotment(this.planService.getUserPlan())},e.prototype.checkUserCanShareFlows=function(e){var t=this;void 0===e&&(e=!0);var i=function(){return!t.sessionService.isConsumerDomain&&!t.planService.isPlanFreeAndNotSeeded()&&!t.environmentService.isDevEnvironment()};if(e)return this.safeCheckTrue(i);var r=this.$q.defer();return r.resolve(i()),r.promise},e.prototype.checkUserCanCreateGateways=function(){var e=this;return this.safeCheckTrue(function(){return!e.sessionService.isConsumerDomain&&!e.planService.isPlanFreeAndNotSeeded()})},e.prototype.checkFlowFrequencyIsAllowed=function(e){var t=this;return this.safeCheckTrue(function(){return n.isValidRecurrence(t.planService.getUserPlan(),e)})},e.prototype.checkShouldShowFreePlanDialog=function(){var e=this;return this.safeCheckFalse(function(){return e.isBillingEnabled&&e.planService.isPlanFree()&&!e.environmentService.isDevEnvironment()})},e.prototype.shouldShowUpgradeToProDialog=function(){return this.isBillingEnabled&&this.sessionService.isConsumerDomain},e.prototype.shouldEnableFlowImportExport=function(){return this.appSettings.featureFlags.enableFlowImportExport&&!this.appSettings.isWidgetPage},e.prototype.shouldEnableLogicAppTemplateExport=function(){return this.appSettings.featureFlags.enableLogicAppTemplateExport&&!this.appSettings.isWidgetPage},e.prototype.safeCheckTrue=function(e){var t=this,i=this.$q.defer();return e()?i.resolve(!0):this.planService.refreshUserPlans().catch(function(e){t.loggingService.logError("policiesService.safeCheck: Failed to update service plans",e)}).finally(function(){i.resolve(e())}),i.promise},e.prototype.safeCheckFalse=function(e){return this.safeCheckTrue(function(){return!e()}).then(function(e){return!e})},Object.defineProperty(e.prototype,"isBillingEnabled",{get:function(){return!this.appSettings.isWidgetPage},enumerable:!0,configurable:!0}),e.$inject=[r.default.services.$q,r.default.services.appSettings,r.default.services.environment,r.default.services.logging,r.default.services.plan,r.default.services.session],e}();t.PoliciesService=o,angular.module(r.default.modules.processSimpleServices).service(r.default.services.policies,o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(21);var r=i(0);t.PollInterval={Never:31536e6};var n=function(){function e(e,t){var i=this;this.$interval=e,this.options=t,this.pollRefCount=0,this.getPollInterval=function(){var e=i.options.interval;return angular.isFunction(e)?e():e}}return e.prototype.destroy=function(){this.pollRefCount=0,this.clearScheduledPoll(),this.isPolling=!1,this.isDestroyed=!0},e.prototype.start=function(e){var t=this;this.isDestroyed||(this.pollRefCount++,e.$on("$destroy",function(){--t.pollRefCount<=0&&(t.pollRefCount=0,t.clearScheduledPoll(),t.isPolling=!1)}),this.isPolling||(this.schedulePoll(),this.isPolling=!0))},e.prototype.reset=function(){this.isPolling&&(this.clearScheduledPoll(),this.schedulePoll())},e.prototype.schedulePoll=function(){var e=this;this.isDestroyed||(this.intervalPromise=this.$interval(function(){e.options.poll().finally(function(){return e.schedulePoll()})},this.getPollInterval(),1))},e.prototype.clearScheduledPoll=function(){this.intervalPromise&&(this.$interval.cancel(this.intervalPromise),this.intervalPromise=null)},e}();angular.module(r.default.modules.processSimpleServices).factory(r.default.services.poll,[r.default.services.$interval,function(e){return function(t){return new n(e,t)}}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(e){this.$q=e}return e.prototype.toAngularPromise=function(e){return this.$q(function(t,i){e.then(function(e){return t(e)}).catch(function(e){return i(e)})})},e.$inject=[r.default.services.$q],e}();t.PromiseHelperService=n,angular.module(r.default.modules.processSimpleServices).service(r.default.services.promiseHelperService,n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(e){this.$routeProvider=e}return Object.defineProperty(e.prototype,"$get",{get:function(){return this.$routeProvider.$get},enumerable:!0,configurable:!0}),e.prototype.otherwise=function(e){return this.$routeProvider.otherwise(e),this},e.prototype.when=function(e,t){return this.$routeProvider.when(e,t),this},e.$inject=["$routeProvider"],e}();t.RouteProvider=n,angular.module(r.default.modules.processSimpleServices).provider(r.default.providers.route,n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(43),o=function(){function e(){this.$get=[function(){return n.SessionService.instance}]}return e}();t.SessionServiceProvider=o,angular.module(r.default.modules.processSimpleServices).provider(r.default.services.session,[o])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(42),o=i(54);t.StorageCacheConstant={cacheVersion:"v0",itemBundleStorageKey:"msflowportal.storageCache"};var s=function(){function e(e,t,i,r,n){this.loggingService=e,this.storageService=t,this.cacheClearInterval=i,this.cacheId=r,this.storageType=n}return e.prototype.get=function(e){var t=this.getItem(e);return t?t.value:void 0},e.prototype.set=function(e,t){var i=this.fetchItemBundle();i=this.cleanupItemBundle(i),i.itemsByKey[e]={lastSavedTime:Date.now(),value:t},this.storeItemBundle(i)},e.prototype.trySet=function(e,t){try{return void this.set(e,t)}catch(t){return this.loggingService.logError("StorageCache.trySet encountered exception saving to storage for cache "+this.cacheId+" and item "+e,t),t}},e.prototype.remove=function(e){var t=this.fetchItemBundle();t=this.cleanupItemBundle(t,[e]),this.storeItemBundle(t)},e.prototype.getItem=function(e){var t=this.fetchItemBundle();t=this.cleanupItemBundle(t);var i=t.itemsByKey[e];return i||void 0},e.prototype.isStorageAvailable=function(){return!(this.storageType===o.StorageType.LocalStorage&&!this.storageService.isLocalStorageAvailable||this.storageType===o.StorageType.SessionStorage&&!this.storageService.isSessionStorageAvailable)},e.prototype.getStorageKey=function(){return t.StorageCacheConstant.itemBundleStorageKey+"."+this.cacheId},e.prototype.fetchItemBundle=function(){if(this.isStorageAvailable()){var e,t=this.storageService.getItem(this.getStorageKey(),this.storageType);try{e=JSON.parse(t)}catch(e){this.loggingService.logError("StorageCache.fetchItemBundle encountered invalid JSON in storage for cache "+this.cacheId,e)}return e}},e.prototype.storeItemBundle=function(e){if(this.isStorageAvailable()){var t=JSON.stringify(e);this.storageService.saveItem(this.getStorageKey(),t,this.storageType)}},e.prototype.cleanupItemBundle=function(e,i){var r=this;void 0===i&&(i=[]),e&&e.version===t.StorageCacheConstant.cacheVersion||(e={version:t.StorageCacheConstant.cacheVersion,itemsByKey:{}}),n.forEach(e.itemsByKey,function(e){var t=e.value;(!t||t.lastSavedTime+r.cacheClearInterval<=r.getCurrentTime())&&i.push(e.key)});for(var o=0;o<i.length;o++)delete e.itemsByKey[i[o]];return e},e.prototype.getCurrentTime=function(){return Date.now()},e}();t.StorageCache=s;var a=function(){function e(e,t,i){this.appSettings=e,this.loggingService=t,this.storageService=i}return e.prototype.Create=function(e,t,i){return void 0===t&&(t=o.StorageType.SessionStorage),void 0===i&&(i=this.appSettings.featureFlags.storageCacheClearInterval),new s(this.loggingService,this.storageService,i,e,t)},e.$inject=[r.default.services.appSettings,r.default.services.logging,r.default.services.storage],e}();t.StorageCacheFactoryService=a,angular.module(r.default.modules.processSimpleServices).service(r.default.services.storageCacheFactory,a)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(){this.$get=[function(){return msflowportal.telemetryService}]}return e}();t.TelemetryServiceProvider=n,angular.module(r.default.modules.processSimpleServices).provider(r.default.services.telemetry,[n])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(215),n=i(0),o=i(6),s=function(){function e(e,t,i,r,n){this.appSettings=e,this.planService=t,this.policiesService=i,this.sessionService=r,this.telemetryService=n}return e.prototype.showStartFreeTrialDialog=function(e){this.showDialog(r.TrialDialogType.startFreeTrial,e)},e.prototype.showRecurrenceStartTrialDialog=function(e){this.showDialog(r.TrialDialogType.recurrenceStartTrial,e)},e.prototype.showUpgradeToProRequiredDialog=function(e){this.showDialog(r.TrialDialogType.upgradeToPro,e)},e.prototype.showRecurrenceUpgradeToProRequiredDialog=function(e){this.showDialog(r.TrialDialogType.recurrenceUpgradeToPro,e)},e.prototype.showBlockedFeatureStartTrialDialog=function(e){this.showDialog(r.TrialDialogType.blockedFeatureStartTrial,e,!0)},e.prototype.showBillingAdminPurchaseDialog=function(e){this.showDialog(r.TrialDialogType.billingAdmin,e)},e.prototype.showIndividualPurchaseNotSupportedDialog=function(e){this.showDialog(r.TrialDialogType.individualPurchaseNotSupported,e)},e.prototype.showFeatureBlockedOnDeveloperEnvironment=function(e){this.showDialog(r.TrialDialogType.featureBlockedOnDeveloperEnvironment,e)},e.prototype.showOfficePortalSignupDialog=function(e){this.showDialog(r.TrialDialogType.officePortalSignup,e)},e.prototype.tryBlockMSA=function(){this.policiesService.shouldShowUpgradeToProDialog()&&this.showUpgradeToProRequiredDialog(function(){window.location.assign("/")})},e.prototype.showDialog=function(e,t,i){this.hide(),this.sessionService.isConsumerDomain&&e!==r.TrialDialogType.recurrenceUpgradeToPro?this.dialogType=i?r.TrialDialogType.blockedFeatureUpgradeToPro:r.TrialDialogType.upgradeToPro:this.dialogType=e,this.telemetryService.tagEvent(o.TelemetryEventNames.BillingDialogShown,{dialogType:e}),this.callback=t,this.show=!0},e.prototype.hide=function(){this.show=!1},e.$inject=[n.default.services.appSettings,n.default.services.plan,n.default.services.policies,n.default.services.session,n.default.services.telemetry],e}();t.TrialDialogService=s,angular.module(n.default.modules.processSimpleServices).service(n.default.services.trialDialog,s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(87),i(146),i(831),i(832)},function(e,t,i){"use strict";function r(e){var t=n.getAppSettings();$.each($("img[cdn-src]",e),function(e,i){var r=$(i),n=r.attr("cdn-src");if(t.featureFlags.enableCdn){var o=function(){r.attr("src",n)},s=msflowportal.cdnUrlHelper.getCdnUrl(n);r.attr("src",s),i.onerror=o}else r.attr("src",n);r.removeAttr("cdn-src")})}Object.defineProperty(t,"__esModule",{value:!0});var n=i(9);t.normalizeCdnImageUrl=r},function(e,t){$(function(){-1!==window.location.search.indexOf("mobileclient=ios")&&sessionStorage.setItem("hidePricing","true"),"true"===sessionStorage.getItem("hidePricing")&&$(".pricing-info").hide()})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(834),i(835),i(836),i(845)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(171),i(172),i(175)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(33),i(195)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(837),i(841)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(838);i(839);var o=function(){function e(){this.restrict="E",this.template=i(840),this.scope={model:"="},this.controller=n.ConnectionListDirectiveCtrl,this.controllerAs="controller"}return e}();t.ConnectionListDirective=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.connectionList,[function(){return new o}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(7),o=i(6),s=i(57),a=i(8),l=i(33),c=i(28),u=i(4),p=i(3),d=function(){function e(e,t,i,r,o,s,a,l,c){var u=this;this.$scope=e,this.appSettings=t,this.clientResources=i,this.connectionsClient=r,this.dateTimeService=o,this.navigationService=s,this.telemetryService=a,this.connectionHelperService=l,this.loggingService=c,this.spinner={size:n.SpinnerSize.Large,local:n.SpinnerPosition.Local},this.$scope.model.connections.$watch(this.$scope,[this.$scope.model.apis],function(){u.onLoadComplete()}),this.headerNameField=this.clientResources.Manage.Connection.Header.Name,this.headerModifiedField=this.clientResources.Manage.Connection.Header.ModifiedDate,this.updatePasswordWarning=this.clientResources.Manage.Connection.UpdatePasswordWarning}return e.prototype.rowDefaultAction=function(e){this.showConnectionInfo(e.connection)},e.prototype.onLoadComplete=function(){var e=this;this.$scope.model.rows=this.$scope.model.connections.filter(function(t){return l.shouldShowConnection(t,e.appSettings.filteredConnections)}).filter(function(t){return!e.$scope.model.markedForDeletion.some(function(e){return e.id===t.id})}).map(function(t){return e.convertConnectionToRow(t,e.$scope.model.apis)})},e.prototype.convertConnectionToRow=function(e,t){var i=this,r=l.getDateModified(e),n=t.filter(function(t){return a.equalsIgnoreCase(t.id,l.getConnectionApiId(e))})[0];return{apiName:n?c.getDisplayName(n):l.getConnectionApiName(e),name:l.getDisplayName(e),id:e.id,dateModified:r,dateModifiedString:this.dateTimeService.getFriendlyTimeSinceString(s.DefaultDateTimeOptions,r),imageUrl:l.getIcon(e),statusError:l.isConnectionInError(e),statusMessage:l.getStatusMessage(e,this.clientResources),isAuthError:l.isConnectionInAuthError(e),connection:e,commands:[{text:this.clientResources.Manage.Connections.DeleteToolTip,iconUrl:"glyph-delete",click:function(){return i.deleteConnection(e)}},{text:this.clientResources.Manage.Connections.InfoToolTip,iconUrl:"glyph-info",click:function(){return i.showConnectionInfo(e)}}]}},e.prototype.deleteConnection=function(e){var t=this;if(confirm(this.clientResources.Dialogs.ConfirmDelete.DeleteConnectionMessage)){var i=this.loggingService.profileStart(u.ProfilingEventNames.deleteConnectionStart);this.telemetryService.tagEvent(o.TelemetryEventNames.DeleteConnectionFromList,{connectionName:e.name}),this.$scope.model.markedForDeletion.push(e),this.$scope.model.connections.$remove(e),this.connectionsClient.delete({id:e.id}).then(function(){t.$scope.model.connections.$remove(e),t.removeFromMarkedForDeletion(e),t.loggingService.profileEnd(i,u.ProfilingEventNames.deleteConnectionEnd,{status:p.Status.Success,connectionId:e.id})}).catch(function(r){t.removeFromMarkedForDeletion(e),t.onLoadComplete(),t.loggingService.profileEnd(i,u.ProfilingEventNames.deleteConnectionEnd,{status:p.inferErrorStatus(r),connectionId:e.id,error:p.parseErrorMessage(r)}),t.loggingService.logError("ConnectionListDirectiveCtrl.DeleteConnection",r)}),this.$scope.model.rows=this.$scope.model.rows.filter(function(t){return t.id!==e.id})}},e.prototype.removeFromMarkedForDeletion=function(e){this.$scope.model.markedForDeletion.filter(function(t){return t.id!==e.id})},e.prototype.showConnectionInfo=function(e){var t=l.getConnectionApiName(e);this.telemetryService.tagEvent(o.TelemetryEventNames.ShowConnectionInfo,{apiName:t,connectionName:e.name}),this.navigationService.navigate("/connections/"+t+"/"+e.name)},e.prototype.getCommandText=function(e){return e.inProgress&&e.inProgressText?e.inProgressText:e.text},e.prototype.isCommandDisabled=function(e){return e.disabled||e.inProgress},e.prototype.clickCommand=function(e,t){if(e.stopPropagation(),!this.isCommandDisabled(t)){var i=t.click();i&&i.finally&&(t.inProgress=!0,i.finally(function(){return t.inProgress=!1}))}},e.prototype.reauthorizeConnection=function(e,t){this.connectionHelperService.consent(e),this.telemetryService.tagEvent(o.TelemetryEventNames.UpdateConnectionPasswordClicked,{connection:e}),t&&t.stopPropagation()},e.$inject=[r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.connectionsClient,r.default.services.dateTime,r.default.services.navigation,r.default.services.telemetry,r.default.services.connectionHelper,r.default.services.logging],e}();t.ConnectionListDirectiveCtrl=d},function(e,t){},function(e,t){e.exports='<div class="c-table"> <table class="connections"> <thead> <tr> <th class="column medium-1 small-1"></th> <th class="column medium-3 small-5">{{controller.headerNameField}}</th> <th class="column medium-3 hide-for-small-only"></th> <th class="column medium-1 small-2">{{controller.headerModifiedField}}</th> <th class="column medium-3 hide-for-small-only"></th> </tr> </thead> <tbody> <spinner model="controller.spinner"></spinner> <tr ng-repeat="row in model.rows" ng-hide="controller.spinner.show"> <td class="column medium-1 small-1 table-cell-image" ng-click="controller.rowDefaultAction(row)"> <img ng-attr-src="{{row.imageUrl}}" onerror=\'this.onerror=null,this.src="/Content/Images/Common/connection.svg"\'/> </td> <td class="column medium-3 small-5 text-ellipse" ng-click="controller.rowDefaultAction(row)"> <div class="table-cell-name-multiline"> <div class="apiName">{{row.apiName}}</div> <div class="name connection-name-text">{{row.name}}</div> </div> </td> <td class="column medium-3 hide-for-small"> <div class="table-cell-status"> <span class="c-glyph glyph-warning" ng-show="row.statusError"></span> {{row.statusMessage}} <a ng-show="row.isAuthError" ng-click="controller.reauthorizeConnection(row.connection, $event)" class="text-ellipse c-hyperlink" tabindex="0" aria-label="{{row.statusMessage + \' \' + controller.updatePasswordWarning}}">{{controller.updatePasswordWarning}}</a> </div> </td> <td class="column medium-1 small-2" ng-click="controller.rowDefaultAction(row)"> {{row.dateModifiedString}} </td> <td class="column medium-3 hide-for-small-only pull-right"> <div class="context-glyph-tile"> <button class="img-button c-glyph" ng-repeat="command in row.commands" ng-class="[command.iconUrl, { \'disabled\': controller.isCommandDisabled(command) }]" ng-click="controller.clickCommand($event, command)" ng-attr-title="{{controller.getCommandText(command)}}" role="button"> <span class="x-screen-reader">{{controller.getCommandText(command)}}</span> </button> </div> </td> <td class="column small-1 show-for-small-only pull-right"> <list-commands model="row.commands"></list-commands> </td> </tr> </tbody> </table> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(842);i(843);var o=function(){function e(){this.restrict="E",this.template=i(844),this.scope={model:"="},this.controller=n.ConnectionFormDirectiveCtrl,this.controllerAs="controller"}return e}();t.ConnectionFormDirective=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.connectionForm,[function(){return new o}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(38),o=function(){function e(e,t){this.$scope=e,this.connectionFormService=t,this.formId=n.uuid()}return e.prototype.isSupportedType=function(e){return this.connectionFormService.isSupportedType(e)},e.prototype.getControlId=function(e){return e.replace(/\s/g,"-")+this.formId},e.prototype.getOptionDisplayName=function(e){return e.text||e.value},e.$inject=[r.default.services.$scope,r.default.services.connectionForm],e}();t.ConnectionFormDirectiveCtrl=o},function(e,t){},function(e,t){e.exports='<div ng-repeat="(key, formItem) in model.formItems"> <ng-switch on="formItem.type"> <label class="c-label" for="{{controller.getControlId(key)}}">{{formItem.displayName}} <span ng-show="formItem.required" class="context-required-text">*</span></label> <input ng-switch-when="securestring" ng-model="formItem.value" type="password" class="c-password" id="{{controller.getControlId(key)}}" ng-required="formItem.required"/> <select ng-switch-when="options" ng-model="formItem.value" class="c-input-select-field" ng-options="controller.getOptionDisplayName(option) for option in formItem.options" ng-required="formItem.required"></select> <input ng-switch-default="string" ng-model="formItem.value" type="text" class="c-text-field" id="{{controller.getControlId(key)}}" ng-required="formItem.required"/> </ng-switch> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(117),i(846),i(848)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(28),o=i(33),s=i(216),a=i(20),l=i(87),c=i(6),u=i(847),p=i(76),d=function(){function e(e,t,i,r,n,o,s,a,l,c,u){this.appSettings=e,this.$q=t,this.$http=i,this.oauth=r,this.authenticationService=n,this.telemetryService=o,this.flowsClient=s,this.connectionClient=a,this.resources=l,this.loggingService=c,this.environmentService=u}return e.prototype.consent=function(e){var t=this,i=this.startConsent(e.id);return this.finishConsent(i).then(function(){t.connectionClient.refresh({id:e.id})})},e.prototype.startConsent=function(e){var t=this.oauth.openLoginPopup();return t.connectionId=e,t},e.prototype.finishConsent=function(e){var t=this,i={id:e.connectionId},r={redirectUrl:e.getRedirectUrl()};return this.connectionClient.getConsentLink(i,r).then(function(t){return e.url=t.data.consentLink,e.loginPromise}).then(function(e){var r;if(e.code&&(r=t.connectionClient.confirmConsentCode(i,{code:e.code})),e.error){var n=atob(e.error);r=t.$q.reject({type:s.OAuthErrorType.InvalidLogin,message:n})}return r}).catch(function(e){e&&e.type?t.loggingService.logError("ConnectionHelperService.FinishConsent",{name:e.type.toString(),message:e.message}):t.loggingService.logError("ConnectionHelperService.FinishConsent",{name:"ConsentError",message:"Finish consent failed"});return e&&e.type===s.OAuthErrorType.PopupClosed?t.$q.resolve():t.$q.reject(e)})},e.prototype.addConnection=function(e,t,i,r){var n=this;void 0===r&&(r=!0);var o;return i=a.extendPropsWithEnvironment(i,this.appSettings.featureFlags.enableEnvironments,this.environmentService.getCurrentEnvironmentName()),o=this._canAutoCreateSimpleConnection(e)&&!r?this._addSimpleConnection(e,t,i):this._canAutoCreateFirstPartyConnection(e)&&!r?this._tryAddFirstPartyConnectionAutomatically(e,t,i).catch(function(){return n._addConnectionByPopup(e,t,i)}):this._addConnectionByPopup(e,t,i),o.finally(function(){n.refreshConnectionClient()})},e.prototype.testConnection=function(e){var t=this,i=e.properties.testLinks&&e.properties.testLinks.length>0&&e.properties.testLinks[0];return e.id&&i&&i.requestUri&&p.validateUrl(i.requestUri)?this.authenticationService.getToken(this.appSettings.authResource).then(function(e){return t.$http({method:i.method,url:i.requestUri,headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},responseType:"text"})}).then(function(e){var i=e.data;if(i.status>=400){var r=i.message?i.message:t.resources.Error.TestConnectionFailed;throw new Error(r)}}).catch(function(i){throw t.loggingService.logError("ConnectionHelperService.testConnection",i),t._deleteConnection(e),i.data?i.data:i}):this.$q.resolve()},e.prototype.refreshConnectionClient=function(){this.connectionClient.refreshQuery().catch(angular.noop)},e.prototype.getUsageResources=function(e,t){return this.connectionClient.usages({id:t.id}).then(function(e){var t={flows:[]};return e.data.forEach(function(e){if(o.getUsageType(e)===l.ResourceType.Flow){var i=e.properties.resource;i&&t.flows.push(i)}}),t})},e.prototype._deleteConnection=function(e){var t=this;this.connectionClient.delete({id:e.id}).then(function(){t.connectionClient.refreshQuery(),t.telemetryService.tagEvent(c.TelemetryEventNames.DeleteConnectionFromList,{status:c.TelemetryEventStatus.succeeded,connectionId:e.id})}).catch(function(e){t.loggingService.logError("ConnectionHelperService._deleteConnection",e),t.telemetryService.tagEvent(c.TelemetryEventNames.DeleteConnectionFromList,{status:c.TelemetryEventStatus.failed},{error:e})})},e.prototype._addSimpleConnection=function(e,t,i){var r=this;return this.connectionClient.put({id:t},i).then(function(e){return r.telemetryService.tagEvent(c.TelemetryEventNames.CreateSimpleConnectionComplete,{status:c.TelemetryEventStatus.succeeded,connectionId:e&&e.data&&e.data.id}),e&&e.data}).catch(function(t){return r.loggingService.logError("ConnectionHelperService._addSimpleConnection",t),r.telemetryService.tagEvent(c.TelemetryEventNames.CreateSimpleConnectionComplete,{status:c.TelemetryEventStatus.failed,api:e},{error:t}),r.$q.reject(t)})},e.prototype._tryAddFirstPartyConnectionAutomatically=function(e,t,i){var r,n=this;return this.connectionClient.put({id:t},i).then(function(e){return r=e.data,n._getFirstPartyConnectionConsentUri(r.id)}).then(function(e){return n._consentFirstPartyConnection(e)}).then(function(){return n.telemetryService.tagEvent(c.TelemetryEventNames.CreateFirstPartyConnectionComplete,{status:c.TelemetryEventStatus.succeeded,connectionId:r.id}),r}).catch(function(i){throw n.loggingService.logError("ConnectionHelperService._tryAddFirstPartyConnectionAutomatically",i),n.telemetryService.tagEvent(c.TelemetryEventNames.CreateFirstPartyConnectionComplete,{status:c.TelemetryEventStatus.failed,api:e},{error:i}),n.connectionClient.delete({id:t}).then(function(){n.telemetryService.tagEvent(c.TelemetryEventNames.DeleteFirstPartyConnectionComplete,{status:c.TelemetryEventStatus.succeeded,connectionId:r.id})}).catch(function(t){n.loggingService.logError("ConnectionHelperService._tryAddFirstPartyConnectionAutomatically",t),n.telemetryService.tagEvent(c.TelemetryEventNames.DeleteFirstPartyConnectionComplete,{status:c.TelemetryEventStatus.failed,api:e},{error:t})}),i})},e.prototype._addConnectionByPopup=function(e,t,i){var r,s,a=this;return n.isApiOauth(e)&&!o.isConnectionUsingGateway(i)&&(r=this.startConsent(t)),this.connectionClient.put({id:t},i).then(function(e){s=e.data,a.telemetryService.tagEvent(c.TelemetryEventNames.CreateConnectionByPopupCompleted,{status:c.TelemetryEventStatus.succeeded,connectionId:s.id})}).catch(function(t){return r&&r.close(),a.loggingService.logError("ConnectionHelperService._addConnectionByPopup",t),a.telemetryService.tagEvent(c.TelemetryEventNames.CreateConnectionByPopupCompleted,{status:c.TelemetryEventStatus.failed,api:e},{error:t}),a.$q.reject(t)}).then(function(){var e=[];if(r){var i=a.finishConsent(r).catch(function(e){return a.loggingService.logError("ConnectionHelperService._addConnectionByPopup.Consent",e),r.close(),a.connectionClient.delete({id:t}),a.$q.reject(e)});e.push(i)}return a.$q.all(e)}).then(function(){return s})},e.prototype._getFirstPartyConnectionConsentUri=function(e){var t=this;return this.connectionClient.getConsentLink({id:e},{redirectUrl:window.location.origin}).then(function(i){return t.telemetryService.tagEvent(c.TelemetryEventNames.GetFirstPartyConnectionConsentUriComplete,{status:c.TelemetryEventStatus.succeeded,connectionId:e}),i.data.firstPartyLoginUri}).catch(function(i){return t.loggingService.logError("ConnectionHelperService._getFirstPartyConnectionConsentUri",i),t.telemetryService.tagEvent(c.TelemetryEventNames.GetFirstPartyConnectionConsentUriComplete,{status:c.TelemetryEventStatus.failed,connectionId:e},{error:i}),t.$q.reject(i)})},e.prototype._consentFirstPartyConnection=function(e){var t=this;return this.authenticationService.getToken(this.appSettings.consentServerAadResourceUri).then(function(i){return t.$http({method:"POST",url:e,headers:{"Content-Type":"application/json"},data:{accessToken:""+i},responseType:"text"}).then(function(e){return t.telemetryService.tagEvent(c.TelemetryEventNames.ConsentFirstPartyConnectionComplete,{status:c.TelemetryEventStatus.succeeded}),e},function(e){return t.telemetryService.tagEvent(c.TelemetryEventNames.ConsentFirstPartyConnectionComplete,{status:c.TelemetryEventStatus.failed},{error:e}),t.$q.reject(e)})})},e.prototype._canAutoCreateFirstPartyConnection=function(e){return e&&!u.hasPrerequisiteConnection(e)&&u.isFirstPartyApi(e)},e.prototype._canAutoCreateSimpleConnection=function(e){return e&&!u.hasPrerequisiteConnection(e)&&u.isSimpleApi(e)},e.$inject=[r.default.services.appSettings,r.default.services.$q,r.default.services.$http,r.default.services.oAuth,r.default.services.authentication,r.default.services.telemetry,r.default.services.flowsClient,r.default.services.connectionsClient,r.default.services.clientResources,r.default.services.logging,r.default.services.environment],e}();t.ConnectionHelperService=d,angular.module(r.default.modules.processSimpleServices).service(r.default.services.connectionHelper,d)},function(e,t,i){"use strict";function r(e){return!!e&&(!!e.properties&&(!e.properties.connectionParameters||0===Object.keys(e.properties.connectionParameters).length))}function n(e){if(!e)return!1;var t=s(e,a[a.oauthSetting]);return!!(t&&t[0]&&t[0].oAuthSettings&&t[0].oAuthSettings.properties&&l.equalsIgnoreCase(t[0].oAuthSettings.properties.IsFirstParty,"true"))}function o(e){return s(e,a[a.connection]).length>0}function s(e,t){return e&&e.properties&&e.properties.connectionParameters?Object.keys(e.properties.connectionParameters).map(function(t){return e.properties.connectionParameters[t]}).filter(function(e){return l.equalsIgnoreCase(e.type,t)}):[]}Object.defineProperty(t,"__esModule",{value:!0});var a,l=i(8);!function(e){e[e.array=0]="array",e[e.bool=1]="bool",e[e.connection=2]="connection",e[e.gatewaySetting=3]="gatewaySetting",e[e.int=4]="int",e[e.oauthSetting=5]="oauthSetting",e[e.object=6]="object",e[e.secureObject=7]="secureObject",e[e.secureString=8]="secureString",e[e.string=9]="string"}(a=t.ConnectionParameterTypes||(t.ConnectionParameterTypes={})),t.isSimpleApi=r,t.isFirstPartyApi=n,t.hasPrerequisiteConnection=o,t.getConnectionParametersWithType=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(115),o=i(1),s=i(149),a=i(35),l=i(1),c=i(15),u=i(3),p=i(213),d=function(){function e(e,t,i,r,n,o,s,a,l,c,u){this.$http=e,this.$q=t,this.appSettings=i,this.apiClient=r,this.azureBlobUploaderService=n,this.clientResources=o,this.connectionClient=s,this.fileReader=a,this.loggingService=l,this.sessionService=c,this.telemetryService=u,this.providersApiUri=i.consentServerUri+"/api/providers",this.parametersApiUri=this.providersApiUri+"/{0}/parameters"}return e.prototype.validateWadl=function(e,t){var i=this;return this.apiClient.validateApiSwaggerToWadl({objectId:e},t).then(function(){return i.$q.resolve(null)}).catch(function(e){return i.$q.resolve(e)})},e.prototype.getIdentityProviders=function(){return this.$http.get(this.providersApiUri).then(function(e){return e.data.Providers})},e.prototype.getMatchingIdentityProvider=function(e,t){var i=e.filter(function(e){return e.AuthorizationEndPoints.some(function(e){var i=a.parseUri(e).host;return l.equals(i,t)})});return i.length>0?i[0]:e.filter(function(e){return"oauth2"===e.Id})[0]},e.prototype.getMatchingIdentityProviderById=function(e,t){var i=e.filter(function(e){return l.equals(e.Id,t)});return i.length>0?i[0]:e.filter(function(e){return"oauth2"===e.Id})[0]},e.prototype.getIdentityProviderParameters=function(e){return this.$http.get(o.format(this.parametersApiUri,e)).then(function(e){return e.data.Parameters})},e.prototype.convertConnectionParametersToParameterValues=function(e){var t=this.filterConnectionParametersByType(e,"oauthSetting")[0],i=t?t.oAuthSettings||t.oAuthSettings:null;return i?{clientId:i.clientId,identityProvider:i.identityProvider,redirectUrl:i.redirectUrl,loginUri:i.customParameters.LoginUri.value,resourceUri:i.customParameters.ResourceUri.value}:{}},e.prototype.filterConnectionParametersByType=function(e,t){if(e){var i=[];return Object.keys(e).forEach(function(r){var n=e[r];n&&s.equalsIgnoreCase(n.type,t)&&i.push(n)}),i}return[]},e.prototype.createApiConnectionParameters=function(e,t){var i={};if(e.authenticationType===n.ApiAuthenticationType.Oauth2){if(i={token:{type:"oAuthSetting",oAuthSettings:{identityProvider:e.selectedProvider.Id||e.selectedProvider.id,scopes:e.scopes,customParameters:{}},uiDefinition:null}},t)for(var r in t){var o=t[r];switch(r.toUpperCase()){case"CLIENTID":i.token.oAuthSettings.clientId=o;break;case"CLIENTSECRET":i.token.oAuthSettings.clientSecret=o;break;default:i.token.oAuthSettings.customParameters[r]={value:o}}}}else"basic"===e.authenticationType&&(i={username:{type:"string",uiDefinition:{displayName:"Username",description:"The username for this api",tooltip:"Provide your username",constraints:{required:"true"}}},password:{type:"securestring",uiDefinition:{displayName:"Password",description:"The password for this api",tooltip:"Provide your password",constraints:{required:"true"}}}});return i},e.prototype.deleteApi=function(e){var t=this;return this.apiClient.delete({id:e.id}).then(function(){return t.refreshApis()}).catch(function(){t.loggingService.logError("Connections.CustomApis.Delete.Failed",new Error("Connections.CustomApis.Delete.Failed"))})},e.prototype.refreshApis=function(){return this.$q.all([this.apiClient.refreshQuery().catch(angular.noop),this.connectionClient.refreshQuery().catch(angular.noop)])},e.prototype.generateResourceStorage=function(e,t){var i=o.format("{0}/objectIds/{1}/generateResourceStorage?api-version={2}",this.appSettings.powerAppsManagementUri,e,this.appSettings.powerAppsResourceProviderApiVersionWithEnvironments),r={environment:{name:t,id:"/providers/environments/"+t}};return this.$http.post(i,r)},e.prototype.uploadFilesToStorage=function(e,t){var i=this;if(!t)return this.$q.reject(this.clientResources.Manage.CustomConnection.Error.noFilesForUpload);var r=Object.keys(t).map(function(e){return t[e]}).map(function(t){return i.azureBlobUploaderService(e,t.file,t.sasUri,t.file.type).startUploadToAzureBlob()});return this.$q.all(r).then(function(){return t})},e.prototype.getSwaggerFromUrl=function(e,t){var i=this,r={headers:{}};return t&&(r.headers[p.swaggerUrlOverrideHeader]=p.swaggerUrlOverrideHeader),this.$http.get(e,r).then(function(e){if(l.isEmpty(e)||l.isEmpty(e.data)||200!==e.status){var t=new c.ClientError(c.ErrorCodes.customApiGetSwaggerFromUrl,i.clientResources.Manage.CustomApi.NoSwaggerData.Error,null,{responseStatusCode:e&&e.status,responseData:e&&e.data});return i.$q.reject(t)}return e.data}).catch(function(e){var t=u.parseErrorMessage(e,i.clientResources.Manage.CustomApi.NoSwaggerData.Error),r=new c.ClientError(c.ErrorCodes.customApiGetSwaggerFromUrl,t,null);return i.$q.reject(r)})},e.prototype.getSwaggerIconData=function(e){var t=this;return this.$http.get(e,{responseType:"blob"}).then(function(e){return e.data}).catch(function(e){return t.$q.reject(new c.ClientError(c.ErrorCodes.customApiGetSwaggerIcon,u.parseErrorMessage(e,t.clientResources.Manage.CustomApi.NoSwaggerIcon.Error),null,{responseStatusCode:e&&e.status}))})},e.$inject=[r.default.services.$http,r.default.services.$q,r.default.services.appSettings,r.default.services.apisClient,r.default.services.azureBlobUploaderService,r.default.services.clientResources,r.default.services.connectionsClient,r.default.services.fileReaderHelperService,r.default.services.logging,r.default.services.session,r.default.services.telemetry],e}();t.CustomApiHelperService=d,angular.module(r.default.modules.processSimpleServices).service(r.default.services.customApiHelper,d)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(850),i(858)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(851),i(854)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(852),o=function(){function e(){this.template=i(853),this.bindings={connectionReferences:"<",designerCreateConfigParameters:"<",onConnectionReferencesResolved:"<",onConnectionDisambiguationLoaded:"<"},this.controller=n.ConnectionDisambiguationCtrl,this.controllerAs="connectionDisambiguationCtrl"}return e}();t.ConnectionDisambiguation=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.connectionDisambiguation,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(36),o=i(3),s=i(4),a=i(7),l=function(){function e(e,t,i,r,n,o,s,l){var c=this;this.$element=e,this.$q=t,this.$scope=i,this.appSettings=r,this.clientResources=n,this.designerConfigService=o,this.loggingService=s,this.promiseHelperService=l,this.isConnectionDisambiguationRendered=!1,this.connectionDisambiguationLoadingSpinner={size:a.SpinnerSize.Large,local:a.SpinnerPosition.LocalHorizontal,show:!1},this.viewPermissionsDialog={show:!1,buttons:[{label:this.clientResources.Dialogs.ViewPermissions.Button.Close,action:function(){c.viewPermissionsDialog.show=!1},primary:!0}]},this.handleOnConnectionReferencesResolved=function(e){c.$scope.$apply(function(){c.onConnectionReferencesResolved&&c.onConnectionReferencesResolved(e)})},this.loadConnectionDisambiguation()}return e.prototype.loadConnectionDisambiguation=function(){var e=this;this.connectionDisambiguationLoadingSpinner.show=!0;var t=this.loggingService.profileStart(s.ProfilingEventNames.loadConnectionDisambiguationStart);this.$q.resolve(this.updateDesignerConfigParameters(this.designerCreateConfigParameters)).then(function(t){return e.designerConfigService.createDesignerConfig(t)}).then(function(t){return e.renderConnectionDisambiguation(t)}).then(function(){e.loggingService.profileEnd(t,s.ProfilingEventNames.loadConnectionDisambiguationEnd,{status:o.Status.Success}),e.handleOnConnectionDisambiguationLoaded()}).catch(function(i){e.loggingService.logError("connectionDisambiguationCtrl.loadConnectionDisambiguation",i),e.loggingService.profileEnd(t,s.ProfilingEventNames.loadConnectionDisambiguationEnd,{status:o.inferErrorStatus(i),error:o.parseErrorMessage(i)}),e.handleOnConnectionDisambiguationLoaded(i)}).finally(function(){e.connectionDisambiguationLoadingSpinner.show=!1})},e.prototype.updateDesignerConfigParameters=function(e){var t=this;return e.designerConfig.designerElement=this.$element.find(".msla-container")[0],e.designerConfig.showViewPermissionsDialog=function(e){t.$scope.$apply(function(){t.connectionProvider=e,t.viewPermissionsDialog.show=!0})},e},e.prototype.renderConnectionDisambiguation=function(e){var t=this,i=this.loggingService.profileStart(s.ProfilingEventNames.renderConnectionWizardStart),r={collapsePopulatedParameters:!0},a=n.createDesignerConnectionWizard(e,r),l=a.initializeConnectionReferences(this.connectionReferences,this.appSettings.designer.definitionSchemaUri).then(function(){return a.render(t.handleOnConnectionReferencesResolved)}),c=this.$q.defer();return this.promiseHelperService.toAngularPromise(l).then(function(){t.isConnectionDisambiguationRendered=!0,t.loggingService.profileEnd(i,s.ProfilingEventNames.renderConnectionWizardEnd,{status:o.Status.Success}),c.resolve()}).catch(function(e){t.loggingService.logError("connectionDisambiguationCtrl.renderConnectionDisambiguation",e),t.loggingService.profileEnd(i,s.ProfilingEventNames.renderConnectionWizardEnd,{status:o.inferErrorStatus(e),error:o.parseErrorMessage(e)}),c.reject(e)}),c.promise},e.prototype.handleOnConnectionDisambiguationLoaded=function(e){this.onConnectionDisambiguationLoaded&&this.onConnectionDisambiguationLoaded(e)},e.$inject=[r.default.services.$element,r.default.services.$q,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.designerConfig,r.default.services.logging,r.default.services.promiseHelperService],e}();t.ConnectionDisambiguationCtrl=l},function(e,t){e.exports='<div> <div ng-show="connectionDisambiguationCtrl.isConnectionDisambiguationRendered"> <div class="msla-container msla-host-processsimple msla-host-flow-template"></div> <view-permissions-dialog connection-provider="connectionDisambiguationCtrl.connectionProvider" modal-dialog="connectionDisambiguationCtrl.viewPermissionsDialog"> </view-permissions-dialog> </div> <spinner model="connectionDisambiguationCtrl.connectionDisambiguationLoadingSpinner"></spinner> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(855);i(856);var o=function(){function e(){this.template=i(857),this.bindings={connectionProvider:"=",modalDialog:"="},this.controller=n.ViewPermissionsDialogCtrl,this.controllerAs="viewPermissionsDialogCtrl"}return e}();t.ViewPermissionsDialog=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.viewPermissionsDialog,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e){this.clientResources=e}return e.$inject=[r.default.services.clientResources],e}();t.ViewPermissionsDialogCtrl=n},function(e,t){},function(e,t){e.exports='<div class="section-view-permissions-dialog"> <modal-dialog model="viewPermissionsDialogCtrl.modalDialog" aria-label="{{viewPermissionsDialogCtrl.connectionProvider.properties.description}}"> <dialog-header-content-template> <img class="connection-icon" src="{{viewPermissionsDialogCtrl.connectionProvider.properties.iconUri}}"/> <span class="connection-display-name">{{viewPermissionsDialogCtrl.connectionProvider.properties.displayName}}</span> </dialog-header-content-template> <dialog-body-content-template> <div>{{viewPermissionsDialogCtrl.connectionProvider.properties.description}}</div> <div class="permission-info"> <div class="permission-header">{{viewPermissionsDialogCtrl.clientResources.Dialogs.ViewPermissions.ConnectionScopeWill}}</div> <ul ng-repeat="item in viewPermissionsDialogCtrl.connectionProvider.properties.scopes.will"> <li class="permission-list-item">{{item}}</li> </ul> </div> <div class="permission-info" ng-if="viewPermissionsDialogCtrl.connectionProvider.properties.scopes.wont.length > 0"> <div class="permission-header">{{viewPermissionsDialogCtrl.clientResources.Dialogs.ViewPermissions.ConnectionScopeWont}}</div> <ul ng-repeat="item in viewPermissionsDialogCtrl.connectionProvider.properties.scopes.wont"> <li class="permission-list-item">{{item}}</li> </ul> </div> </dialog-body-content-template> </modal-dialog> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(859)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(860);i(861);var o=function(){function e(){this.controller=n.ConnectionWizardCtrl,this.template=i(862),this.controllerAs="connectionWizardCtrl",this.bindings={redirectUrl:"@"}}return e}();t.ConnectionWizard=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.connectionWizard,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(10),o=i(36),s=i(39),a=i(33),l=i(20),c=i(18),u=i(119),p=i(118),d=i(4),g=i(6),m=i(3),f=i(87),h=i(19),v=i(119),y=i(98),w=i(76),C=i(68),S=i(1),b=i(8),P=i(41),R=i(58),T=i(7),E=function(){function e(e,t,i,r,s,a,l,c,u,d,g,m,f,v,w,S,b,R,E,A,D){var F=this;this.$element=e,this.$q=t,this.$scope=i,this.$window=r,this.apisClient=s,this.appSettings=a,this.authenticationService=l,this.clientResources=c,this.connectionsClient=u,this.environmentService=d,this.flowsClient=g,this.loggingService=m,this.oAuthService=f,this.policiesService=v,this.promiseHelperService=w,this.sessionService=S,this.storageCacheFactory=b,this.telemetryService=R,this.templateCreationHelper=E,this.trialDialogService=A,this.urlService=D,this.useThisTemplateButtonId="template-use-flow-button",this.enableCallBack=!0,this.viewPermissionsDialog={show:!1,buttons:[{label:this.clientResources.Dialogs.ViewPermissions.Button.Close,action:function(){F.viewPermissionsDialog.show=!1},primary:!0}]},this.spinner={size:T.SpinnerSize.Large,local:T.SpinnerPosition.LocalHorizontal,show:!1},this.expanded=!1,this.showDesigner=!1,this.isDietView=!1,this.errorAlert={type:n.AlertType.None,message:"",options:{}},this.onConnectionReferencesResolved=function(e){F.enableCallBack&&(F.enableCallBack=!1,F.appSettings.featureFlags.enableImprovedFlowCreationFromTemplate&&(y.isOneClickTemplate(F.template)||y.isSkipDesignerTemplate(F.template))?(F.spinner.show=!0,F.expanded=!1,F.templateCreationHelper.autoCreateFlow(F.$scope,F.template.name,e).then(function(e){F.redirectToPublishPage(e)}).catch(function(e){F.redirectToDesingerPage()}).finally(function(){F.spinner.show=!1,F.enableCallBack=!0})):(F.navigateToFlowDesigner(e),F.enableCallBack=!0))},this.designerDeferred=this.$q.defer(),a.featureFlags.enableImprovedFlowCreationFromTemplate||(this.$useThisTemplateButton=angular.element("."+this.useThisTemplateButtonId));var N=Object.keys(C.parseQueryString(r.location.search)).filter(function(e){return P.startsWithIgnoreCase(e,p.ParametersPrefix)}).length>0;this.template=a.cache.template,this.isDietView=!(!this.template||!this.appSettings.featureFlags.enableDietDesigner||N||y.isSkipDesignerTemplate(this.template)||y.isOneClickTemplate(this.template)||!this.appSettings.featureFlags.forceDietDesigner&&!y.isDietTemplate(this.template)),a.featureFlags.showInlineTemplateConnectionWizard&&this.sessionService.isAuthenticated&&this.sessionService.hasUserConsented()&&this.template&&(this.$designerElement=angular.element(".msla-container")[0],this.designerScriptsPromise=o.loadDesignerScripts(this.appSettings,this.loggingService),this.connectionsPromise=this.connectionsClient.query(this.$scope).$promise,a.featureFlags.enableImprovedFlowCreationFromTemplate?h.requiresConnections(this.template)?this.showTrialDialogIfRequired(function(){F.expandConnectionWizard()}):(this.expanded=!0,this.spinner.show=!0,this.$window.location.assign(this.redirectUrl)):this.$useThisTemplateButton&&this.$useThisTemplateButton.length&&h.requiresConnections(this.template)&&this.registerButtonClickHandler())}return e.prototype.registerButtonClickHandler=function(){var e=this;this.useThisTemplateOnClickHandler=function(t){t&&t.preventDefault(),e.$scope.$apply(function(){e.showTrialDialogIfRequired(function(){e.onExpandWizard()})})},-1!==this.$window.location.href.toLowerCase().indexOf("expandconnectionwizard=true")&&this.onExpandWizard(),this.$useThisTemplateButton.on("click",this.useThisTemplateOnClickHandler),this.$scope.$on("$destroy",function(){e.$useThisTemplateButton.off("click",e.useThisTemplateOnClickHandler)})},e.prototype.onExpandWizard=function(){var e=this;y.isOneClickTemplate(this.template)?(this.spinner.show=!0,this.templateCreationHelper.autoCreateFlow(this.$scope,this.template.name).then(function(t){e.redirectToPublishPage(t)}).catch(function(t){return e.showErrorMessage(t)}).finally(function(){return e.spinner.show=!1})):this.expandConnectionWizard()},e.prototype.showErrorMessage=function(e){this.loggingService.logError("connectionWizardCtrl.useThisTemplateOnclickHandler",e),this.errorAlert.type=n.AlertType.Error,this.errorAlert.message=m.parseErrorMessage(e,this.clientResources.Common.SomethingWentWrong)},e.prototype.expandConnectionWizard=function(){var e=this,t=this.loggingService.profileStart(d.ProfilingEventNames.expandConnectionWizardStart,{isDietView:this.isDietView});this.appSettings.featureFlags.enableImprovedFlowCreationFromTemplate||(this.$useThisTemplateButton.hide(),$(".context-template-addendum").hide(),$(".context-template-recommended").hide()),$(".context-footer").hide(),this.expanded=!0,this.spinner.show=!0,this.showDesigner=!1,(this.isDietView?this.renderDietDesigner():this.renderConnectionWizard()).then(function(){e.spinner.show=!1,e.showDesigner=!0,e.loggingService.profileEnd(t,d.ProfilingEventNames.expandConnectionWizardEnd,{status:m.Status.Success,isDietView:e.isDietView})}).catch(function(i){e.loggingService.logError("ConnectionWizard.expandConnectionWizard",i,{isDietView:e.isDietView}),e.loggingService.profileEnd(t,d.ProfilingEventNames.expandConnectionWizardEnd,{status:m.inferErrorStatus(i),error:m.parseErrorMessage(i),isDietView:e.isDietView}),e.$window.location.assign(e.redirectUrl)})},e.prototype.createDesignerConfig=function(e,t){var i=this;return this.promiseHelperService.toAngularPromise(R.getVisibleHideKeys(this.apisClient,this.sessionService)).then(function(r){var n=i.template.properties.connectionReferences,s={designercore:e.designercore,designerElement:i.$designerElement,appSettings:i.appSettings,telemetryService:i.telemetryService,oAuthService:i.oAuthService,getArmAccessToken:function(){return o.toDesignerPromise(i.authenticationService.getToken(i.appSettings.authResource))},getRuntimeAccessToken:function(){return o.toDesignerPromise(i.authenticationService.getToken(i.appSettings.authResource))},getConsentServerAccessToken:function(){return o.toDesignerPromise(i.authenticationService.getToken(i.appSettings.consentServerAadResourceUri))},azureADServiceFactory:function(t){return new e.designercore.AzureADService(t,i.appSettings.microsoftGraphUrl,function(){return i.authenticationService.getToken(i.appSettings.microsoftGraphResource)})},prefetchedData:{connections:t,connectionProviders:Object.keys(n).map(function(e){return n[e].api})},canAddOperation:function(e){return new Promise(function(t){i.$scope.$apply(function(){if(!h.isPremiumConnection(e))return void t(!0);i.policiesService.checkShouldShowFreePlanDialog().then(function(e){t(e)})})})},showViewPermissionsDialog:function(e){i.$scope.$apply(function(){i.connectionProvider=e,i.viewPermissionsDialog.show=!0})},defaultRecurrence:i.policiesService.getDefaultRecurrence(),visibleHideKeys:r.join(",")};return i.appSettings.featureFlags.enableEnvironments&&(s.environment={name:i.environmentService.getCurrentEnvironmentName()}),i.appSettings.featureFlags.enableImprovedFlowCreationFromTemplate&&(s.connectionWizardUIConfig={defaultAccountDisplayName:i.sessionService.getUserInfo().displayName,initButtonText:(y.isOneClickTemplate(i.template)||y.isSkipDesignerTemplate(i.template))&&i.clientResources.ConnectionWizard.CreateFlow}),s.enableDietDesigner=i.isDietView,i.isDietView&&(s.dietViewServiceFactory=function(e){return{save:function(){return o.toDesignerPromise(i.saveDietTemplate())},onEditInAdvancedMode:function(e){var t=i.getEditInAdvancedModeLink(v.designerConnectionReferencesDataListToConnectionReferences(e));i.telemetryService.tagEvent(g.TelemetryEventNames.DietDesignerEditInAdvancedModeClicked,{fromTemplate:i.template.name,isDietView:i.isDietView}),i.$window.location.assign(t)}}}),s})},e.prototype.renderDietDesigner=function(){var e=this;return this.$q.all([this.toAngularPromise(this.designerScriptsPromise),this.connectionsPromise]).then(function(t){var i=t[0],r=t[1];return e.createDesignerConfig(i,r)}).then(function(t){var i=o.createDesigner(t);e.designer=i;var r={};Object.keys(e.template.properties.definition&&e.template.properties.definition.parameters||{}).forEach(function(e){P.startsWithIgnoreCase(e,"$")||(r[p.ParametersPrefix+e]="")});var n={definition:p.replaceParameterValues(e.template.properties.definition,r),references:e.template.properties.connectionReferences,properties:{sku:{name:"Standard"}}},s={collapsePopulatedParameters:e.appSettings.featureFlags.designerCollapsePopulatedParameters,skipValidation:!0};return e.$q.all([e.$q.resolve(i),e.toAngularPromise(i.loadWorkflow(n,s))])}).then(function(t){var i=t[0];e.designerConnectionReferenceSubscription=i.Data.ConnectionReferences.onChanged(function(){var t=i.Data.ConnectionReferences.getData();t&&t.map(function(e){return e&&e.connection&&!!e.connection.id}).every(function(e){return!0===e})&&(i.setEditInAdvancedModeLink(e.getEditInAdvancedModeLink(v.designerConnectionReferencesDataListToConnectionReferences(t))),e.telemetryService.tagEvent(g.TelemetryEventNames.DietDesignerConnectionSelectionComplete,{},{fromTemplate:e.template.name}),e.designerConnectionReferenceSubscription.unsubscribe())}),i.render()})},e.prototype.saveDietTemplate=function(){var e=this,t=this.loggingService.profileStart(d.ProfilingEventNames.saveFlowStart,{fromTemplate:this.template.name,isDietView:this.isDietView}),i=!1;return this.getFlowFromDesigner().then(function(t){return t=l.extendPropsWithEnvironment(t),t.properties.displayName="",t.properties.templateName=e.template.name,i=!0,e.flowsClient.post({id:c.getNewFlowId()},t)}).then(function(i){var r=i.data;e.telemetryService.tagEvent(g.TelemetryEventNames.CreateFlowCompleted,{status:g.TelemetryEventStatus.succeeded,fromTemplate:e.template.name,flowName:r.name,isDietView:e.isDietView}),e.loggingService.profileEnd(t,d.ProfilingEventNames.saveFlowEnd,{flowName:r.name,status:m.Status.Success,fromTemplate:e.template.name,isDietView:e.isDietView}),e.redirectToPublishPage(r.name)}).catch(function(r){var o=m.parseErrorMessage(r,e.clientResources.Common.SomethingWentWrong);throw e.loggingService.profileEnd(t,d.ProfilingEventNames.saveFlowEnd,{fromTemplate:e.template.name,status:m.Status.Failure,error:r,isDietView:e.isDietView}),e.telemetryService.tagEvent(g.TelemetryEventNames.CreateFlowCompleted,{status:g.TelemetryEventStatus.failed,error:r,fromTemplate:e.template.name,isDietView:e.isDietView}),i?(e.loggingService.logWarning("ConnectionWizardCtrl.saveDietTemplate","redirecting to designer page",{fromTemplate:e.template.name,isDietView:e.isDietView}),e.$window.location.assign(e.redirectUrl)):(e.errorAlert.type=n.AlertType.Error,e.errorAlert.message=o),r})},e.prototype.getRawWorkflowFromDesigner=function(){var e=this.$q.defer();try{e.resolve(this.designer.getWorkflow())}catch(t){e.reject(t)}return e.promise},e.prototype.getFlowFromDesigner=function(e){var t=this,i=this.$q.defer();return this.getRawWorkflowFromDesigner().then(function(e){var r={};return e.displayName=t.template.properties.displayName,e.connectionReferences=t.getConnectionReferences(e.connectionReferences),e.definition=u.toPortalFlowDefinition(e.definition),r.properties=e,i.resolve(r),i.promise}).catch(function(r){return b.equalsIgnoreCase(r.code,s.DESIGNER_INVALID_SKU_ERROR_CODE)?i.reject(r):(t.loggingService.logError("ConnectionWizardCtrl.GetFlowFromDesigner",r),e?i.reject(new Error(S.format(e,r.message))):i.reject(new Error(r.message))),i.promise})},e.prototype.getConnectionReferences=function(e){return Object.keys(e).forEach(function(t){delete e[t].connectionId}),e},e.prototype.renderConnectionWizard=function(){var e=this,t=this.template.properties.connectionReferences,i={collapsePopulatedParameters:!0};return this.$q.all([this.toAngularPromise(this.designerScriptsPromise),this.connectionsPromise]).then(function(t){var i=t[0],r=t[1];return e.createDesignerConfig(i,r)}).then(function(t){e.connectionWizard=o.createDesignerConnectionWizard(t,i)}).then(function(){return e.connectionWizard.initializeConnectionReferences(t,e.appSettings.designer.definitionSchemaUri)}).then(function(){return e.connectionWizard.render(e.onConnectionReferencesResolved)})},e.prototype.getEditInAdvancedModeLink=function(e){var t=""+window.location.origin+this.redirectUrl;if(Object.keys(e||{}).map(function(i){var r=e[i],n=f.parseIdFromString(r.connection.id),o=n.connections,s="connection."+i;t=t.concat("&"+s+"="+o)}),this.appSettings.featureFlags.enableConnectionCaching){var i=(this.connectionWizard||this.designer).Data.Connections.getData();this.storageCacheFactory.Create(a.ConnectionsConstant.storageCacheId).trySet(a.ConnectionsConstant.urlPath,i)}return t},e.prototype.navigateToFlowDesigner=function(e){this.$window.location.assign(this.getEditInAdvancedModeLink(e))},e.prototype.toAngularPromise=function(e){var t=this;return this.$q(function(i,r){e.then(function(e){return i(e)}).catch(function(e){t.loggingService.logError("ConnectionWizard.LoadDesignerScript",e),r(e)})})},e.prototype.showTrialDialogIfRequired=function(e){var t=this;h.hasPremiumConnection(this.template.properties.connectionReferences)?this.policiesService.checkShouldShowFreePlanDialog().then(function(i){i?t.trialDialogService.showStartFreeTrialDialog(function(t){t&&e&&e()}):e()}):e&&e()},e.prototype.redirectToPublishPage=function(e){this.$window.location.assign(this.urlService.redirectRouteAfterSavingFlow({flowName:e,isSharedFlow:!1,isConnectionWizardPage:!0}))},e.prototype.redirectToDesingerPage=function(){var e=this.urlService.newFlowFullPath();this.template.properties.galleryName&&this.template.name?this.$window.location.assign(w.appendQueryString(e,{gallery:this.template.properties.galleryName,template:this.template.name})):this.$window.location.assign(e)},e.$inject=[r.default.services.$element,r.default.services.$q,r.default.services.$scope,r.default.services.$window,r.default.services.apisClient,r.default.services.appSettings,r.default.services.authentication,r.default.services.clientResources,r.default.services.connectionsClient,r.default.services.environment,r.default.services.flowsClient,r.default.services.logging,r.default.services.oAuth,r.default.services.policies,r.default.services.promiseHelperService,r.default.services.session,r.default.services.storageCacheFactory,r.default.services.telemetry,r.default.services.templateCreationHelper,r.default.services.trialDialog,r.default.services.url],e}();t.ConnectionWizardCtrl=E},function(e,t){},function(e,t){e.exports='<alert model="connectionWizardCtrl.errorAlert"></alert> <section class="connection-wizard" ng-show="connectionWizardCtrl.expanded"> <spinner model="connectionWizardCtrl.spinner"></spinner> <div class="connection-wizard-container msla-container msla-host-flow-template"></div> <view-permissions-dialog connection-provider="connectionWizardCtrl.connectionProvider" modal-dialog="connectionWizardCtrl.viewPermissionsDialog"/> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(864),i(866)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(865)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(21);var r=i(0),n=i(14);angular.module(r.default.modules.processSimpleData).factory(r.default.services.environmentsClient,[r.default.services.azureResourceClientFactory,r.default.services.appSettings,function(e,t){var i={environmentRoute:t.processSimpleResourceProviderPath+"/environments"},r={name:"getEnvironments",method:"GET",urlPath:i.environmentRoute,params:{}},o={name:"createEnvironment",method:"POST",urlPath:i.environmentRoute,params:{}},s={name:"checkEnvironmentAccess",method:"GET",urlPath:i.environmentRoute+"/:environmentName/checkaccess",params:{environmentName:"@environmentName"}};return e({urlBase:n.ProcessSimpleResourceProviderManagementEndpoint,urlPath:i.environmentRoute,apiVersion:t.processSimpleResourceProviderApiVersionWithEnvironments,actions:[r,o,s]})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(867)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(868);i(869);var o=function(){function e(){this.controller=n.EnvironmentPickerCtrl,this.template=i(870),this.controllerAs="environmentPickerCtrl"}return e}();t.EnvironmentPicker=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.environmentPicker,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(6),o=function(){function e(e,t,i,r,n,o,s,a,l){this.$element=e,this.$scope=t,this.appSettings=i,this.clientResources=r,this.domHelperService=n,this.environmentService=o,this.sessionService=s,this.telemetryService=a,this.urlService=l,this.expanded=!1,this.registerEnvironmentPickerComponent(),this.localizedUserDisplayName=this.appSettings.localizedDisplayName||"",this.environments=this.environmentService.getUserEnvironments(),this.environmentService.syncEnvironments()}return e.prototype.isSelectedEnvironment=function(e){return this.environmentService.getCurrentEnvironmentName()===e.name},e.prototype.registerEnvironmentPickerComponent=function(){var e=document.getElementById("header-user-menu"),t=angular.element(e);this.domHelperService.registerOpenOnClick(this,this.$scope,"header-user-menu",this.$element,function(){return t.click()})},e.prototype.close=function(){this.expanded=!1},e.prototype.changeEnvironment=function(e,t){e.stopPropagation(),this.isSelectedEnvironment(t)||(this.close(),this.telemetryService.tagEvent(n.TelemetryEventNames.EnvironmentPickerEnvironmentClicked,{to:t.name}),this.environmentService.setEnvironment(t))},Object.defineProperty(e.prototype,"shouldShowUserName",{get:function(){return this.sessionService.hasUserConsented&&(this.sessionService.getUserSession().userInfo.givenName||this.sessionService.getUserSession().userInfo.familyName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowUserEmail",{get:function(){return this.sessionService.hasUserConsented},enumerable:!0,configurable:!0}),e.$inject=[r.default.services.$element,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.domHelper,r.default.services.environment,r.default.services.session,r.default.services.telemetry,r.default.services.url],e}();t.EnvironmentPickerCtrl=o},function(e,t){},function(e,t){e.exports='<div class="context-header-popup context-header-popup-environment" ng-if="environmentPickerCtrl.expanded"> <div class="bound-dimensions"> <section class="user-info environment-picker-content"> <p class="user-name c-paragraph-3" ng-if="environmentPickerCtrl.shouldShowUserName">{{environmentPickerCtrl.localizedUserDisplayName}}</p> <p class="user-email" ng-if="environmentPickerCtrl.shouldShowUserEmail">{{environmentPickerCtrl.sessionService.getUserSession().userInfo.displayName}}</p> <a class="signout" ng-href="{{environmentPickerCtrl.urlService.signoutRoute()}}" data-event-name="HeaderSignOutClicked"> <p class="c-paragraph-3">{{environmentPickerCtrl.clientResources.SignoutButtonLabel}}</p> </a> </section> <section class="environment-select"> <h1 class="c-paragraph-3 environment-select-title environment-picker-content">{{environmentPickerCtrl.clientResources.Environments.Environment.Label}}</h1> <ul> <a href="" ng-repeat="environment in environmentPickerCtrl.environments.data | orderBy:\'properties.displayName\'" ng-click="environmentPickerCtrl.changeEnvironment($event, environment)"> <li class="environment-picker-content"> <p class="environment c-paragraph-3" ng-class="{\'selected-environment\': environmentPickerCtrl.isSelectedEnvironment(environment)}">{{environment.properties.displayName}}</p> </li> </a> </ul> </section> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(872),i(873),i(874)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(173),i(174)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(89)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(875)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(876);i(877);var o=function(){function e(){this.restrict="E",this.template=i(878),this.scope={model:"="},this.controller=n.GatewayListDirectiveCtrl,this.controllerAs="controller"}return e}();t.GatewayListDirective=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.gatewayList,[function(){return new o}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(7),o=i(6),s=i(89),a=function(){function e(e,t,i,r,o,s,a){var l=this;this.$scope=e,this.appSettings=t,this.clientResources=i,this.gatewaysClient=r,this.navigationService=o,this.telemetryService=s,this.loggingService=a,this.spinner={size:n.SpinnerSize.Large,local:n.SpinnerPosition.Local},this.loadCompleted=!1,this.$scope.model.gateways.$watch(this.$scope,[this.$scope.model.apis],function(){l.onLoadComplete(),l.loadCompleted=!0})}return e.prototype.rowDefaultAction=function(e){this.showDetailInfo(e.gateway)},e.prototype.onLoadComplete=function(){var e=this;this.$scope.model.rows=this.$scope.model.gateways.filter(function(t){return!e.$scope.model.markedForDeletion.some(function(e){return e.id===t.id})}).map(function(t){return e.convertGatewayToRow(t,e.$scope.model.apis)})},e.prototype.convertGatewayToRow=function(e,t){var i=this,r=s.getContactInfo(e),n="";return r&&r.length>0&&(n=r[0]),{name:s.getDisplayName(e),id:e.id,contactInformation:n,gateway:e,commands:[{text:this.clientResources.Manage.Gateways.List.ToolTip.Info,iconUrl:"glyph-info",click:function(){return i.showDetailInfo(e)}}]}},e.prototype.showDetailInfo=function(e){this.telemetryService.tagEvent(o.TelemetryEventNames.ShowConnectionInfo,{gatewayName:e.name}),this.navigationService.navigate("/gateways/"+e.name)},e.prototype.getCommandText=function(e){return e.inProgress&&e.inProgressText?e.inProgressText:e.text},e.prototype.isCommandDisabled=function(e){return e.disabled||e.inProgress},e.prototype.clickCommand=function(e,t){if(e.stopPropagation(),!this.isCommandDisabled(t)){var i=t.click();i&&i.finally&&(t.inProgress=!0,i.finally(function(){return t.inProgress=!1}))}},e.$inject=[r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.gatewaysClient,r.default.services.navigation,r.default.services.telemetry,r.default.services.logging],e}();t.GatewayListDirectiveCtrl=a},function(e,t){},function(e,t){e.exports='<div class="c-table" ng-if="controller.loadCompleted"> <table class="gateways" ng-if="model.rows.length"> <thead> <tr> <th>{{controller.clientResources.Manage.Gateways.List.Header.Name}}</th> <th>{{controller.clientResources.Manage.Gateways.List.Header.ContactInfo}}</th> <th></th> </tr> </thead> <tbody> <spinner model="controller.spinner"></spinner> <tr ng-repeat="row in model.rows" ng-click="controller.rowDefaultAction(row)" ng-hide="controller.spinner.show"> <td class="text-ellipse"> {{row.name}} </td> <td> {{row.contactInformation}} </td> <td class="hide-for-small-only pull-right"> <div class="context-glyph-tile"> <button class="img-button c-glyph" ng-repeat="command in row.commands" ng-class="[command.iconUrl, { \'disabled\': controller.isCommandDisabled(command) }]" ng-click="controller.clickCommand($event, command)" ng-attr-title="{{controller.getCommandText(command)}}" role="button"> <span class="x-screen-reader">{{controller.getCommandText(command)}}</span> </button> </div> </td> </tr> </tbody> </table> <div class="empty-list" ng-if="!model.rows.length"> <div>{{controller.clientResources.Manage.Gateways.List.Empty.Message}}<div> <a ng-href="{{controller.appSettings.gatewayInstallerUrl}}" class="c-action-trigger" data-event-name="AddGatewayButtonClicked">{{controller.clientResources.Manage.Gateways.List.Empty.InstallLinkText}}</a> </div> </div></div></div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(880)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(881)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(882);i(883);var o=function(){function e(){this.controller=n.FeedbackCtrl,this.template=i(884),this.controllerAs="feedbackCtrl"}return e}();t.Feedback=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.feedback,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(6),s=i(65),a=function(){function e(e,t,i,r,o){this.$element=e,this.$scope=t,this.$window=i,this.clientResources=r,this.telemetryService=o,this.headerFeedbackButtonOnClick=null,this.documentOnClick=null,this.expanded=!1,this.headerFeedbackButtonId="header-feedback-button",this.headerFeedbackButtonClass="header-feedback",this.images=n.default,this.feedbackDescription="",this.feedbackType="",this.userConsentToEmailBack=!0,this.$feedbackButtons=angular.element("."+this.headerFeedbackButtonClass),this.$feedbackButtons&&this.$feedbackButtons.length>0&&this.registerFeedbackComponent()}return e.prototype.registerFeedbackComponent=function(){var e=this;this.headerFeedbackButtonOnClick=function(t){t.preventDefault(),e.$scope.$apply(function(){e.expanded=!e.expanded,e.$feedbackButtons.attr({"aria-expanded":e.expanded}),e.expanded?(e.resetFeedbackFormState(),e.documentOnClick=function(t){var i=e.$element[0].contains(t.target),r=Array.prototype.some.call(e.$feedbackButtons,function(e){return s.isParentOrElement(e,t.target)});i||r||e.$scope.$apply(function(){e.close()})},document.addEventListener("click",e.documentOnClick)):e.close()})},this.$feedbackButtons.on("click",this.headerFeedbackButtonOnClick),this.$scope.$on("$destroy",function(){e.$feedbackButtons.forEach(function(t){t.off("click",e.headerFeedbackButtonOnClick)}),e.headerFeedbackButtonOnClick=null,e.close()})},e.prototype.submitFeedback=function(e){var t={feedbackType:this.feedbackType,currentPage:this.$window.location.pathname},i={userConsentToEmailBack:this.userConsentToEmailBack,description:this.feedbackDescription};(t.feedbackType||i.description)&&(this.telemetryService.tagEvent(o.TelemetryEventNames.UserFeedbackReceived,t,i),this.telemetryService.flush(),this.close(!0))},e.prototype.smileClicked=function(e){e.preventDefault(),this.feedbackType="smile"},e.prototype.frownClicked=function(e){e.preventDefault(),this.feedbackType="frown"},e.prototype.close=function(e){void 0===e&&(e=!1),this.documentOnClick&&(e||this.telemetryService.tagEvent(o.TelemetryEventNames.FeedbackFormClosed),this.expanded=!1,this.$feedbackButtons.attr({"aria-expanded":!1}),document.removeEventListener("click",this.documentOnClick),this.documentOnClick=null)},e.prototype.resetFeedbackFormState=function(){this.feedbackType="",this.feedbackDescription="",this.userConsentToEmailBack=!0},e.$inject=[r.default.services.$element,r.default.services.$scope,r.default.services.$window,r.default.services.clientResources,r.default.services.telemetry],e}();t.FeedbackCtrl=a},function(e,t){},function(e,t){e.exports='<div class="context-header-popup context-header-popup-feedback" ng-if="feedbackCtrl.expanded" aria-labelby="{{::feedbackCtrl.headerFeedbackButtonId}}" aria-label="{{::feedbackCtrl.clientResources.feedback.form.title}}" role="dialog" tabindex="0"> <h2 class="c-heading-4">{{::feedbackCtrl.clientResources.feedback.form.title}}</h2> <p class="c-paragraph-4">{{::feedbackCtrl.clientResources.feedback.form.question1}}</p> <form ng-submit="feedbackCtrl.submitFeedback()"> <div class="feedback-smiley-buttons"> <button title="{{::feedbackCtrl.clientResources.feedback.form.happy.text}}" aria-pressed="{{feedbackCtrl.feedbackType === \'smile\'}}" ng-click="feedbackCtrl.smileClicked($event)"> <img ng-show="feedbackCtrl.feedbackType !== \'smile\'" cdn-src="{{::feedbackCtrl.images.smileyHappy}}" alt="{{::feedbackCtrl.clientResources.feedback.form.happy.text}}"/> <img ng-show="feedbackCtrl.feedbackType === \'smile\'" cdn-src="{{::feedbackCtrl.images.smileyHappyFill}}" alt="{{::feedbackCtrl.clientResources.feedback.form.happy.text}}"/> </button> <button title="{{::feedbackCtrl.clientResources.feedback.form.sad.text}}" aria-pressed="{{feedbackCtrl.feedbackType === \'frown\'}}" ng-click="feedbackCtrl.frownClicked($event)"> <img ng-show="feedbackCtrl.feedbackType !== \'frown\'" cdn-src="{{::feedbackCtrl.images.smileySad}}" alt="{{::feedbackCtrl.clientResources.feedback.form.sad.text}}"/> <img ng-show="feedbackCtrl.feedbackType === \'frown\'" cdn-src="{{::feedbackCtrl.images.smileySadFill}}" alt="{{::feedbackCtrl.clientResources.feedback.form.sad.text}}"/> </button> </div> <div class="c-textarea"> <label class="c-label" for="feedback-description">{{::feedbackCtrl.clientResources.feedback.form.question2}}</label> <textarea id="feedback-description" class="f-no-resize" name="description" ng-model="feedbackCtrl.feedbackDescription"></textarea> </div> <div class="c-checkbox"> <label class="c-label"> <input type="checkbox" name="user-consent-to-email-back" ng-model="feedbackCtrl.userConsentToEmailBack"/> <span>{{::feedbackCtrl.clientResources.feedback.form.confirmation}}</span> </label> </div> <button class="c-button" type="submit">{{::feedbackCtrl.clientResources.feedback.form.submit.text}}</button> </form> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(886),i(981),i(982),i(984),i(1e3)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(887),i(891),i(194),i(895),i(899),i(903),i(907),i(911),i(915),i(920),i(924),i(928),i(932),i(936),i(204),i(940),i(945),i(949),i(205),i(953),i(957),i(961),i(965),i(969),i(973),i(977)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(888);i(889);var o=function(){function e(){this.template=i(890),this.bindings={modalDialog:"=",flow:"="},this.controller=n.DeleteFlowDialogCtrl,this.controllerAs="deleteFlowDialogCtrl"}return e}();t.DeleteFlowDialog=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.deleteFlowDialog,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(18),o=i(4),s=i(3),a=i(19),l=i(1),c=i(7),u=i(6),p=i(22),d=function(){function e(e,t,i,r,n,o,s,l,u){var p=this;this.$scope=e,this.appSettings=t,this.clientResources=i,this.flowRunsClient=r,this.flowsClient=n,this.loggingService=o,this.navigationService=s,this.telemetryService=l,this.urlService=u,this.deleteFlowActionButton={label:this.clientResources.Dialogs.DeleteFlow.Button.Delete,action:function(){return p.onDeleteFlow()},primary:!0},this.cancelActionButton={label:this.clientResources.Dialogs.DeleteFlow.Button.Cancel,action:function(){return p.handleCancel()}},this.deleteFlowContentButtons=[this.deleteFlowActionButton,this.cancelActionButton],this.flowDetailsLoadingSpinner={size:c.SpinnerSize.Large,local:c.SpinnerPosition.Global,show:!1},this.showFlowRunList=!1,this.isTeamFlow=a.isCoauthoredFlow(this.flow),this.deleteDialogHeader=this.getDialogContentHeader(),this.initializeFlowRunsRunningList()}return e.prototype.initializeFlowRunsRunningList=function(){var e=this,t=this.loggingService.profileStart(o.ProfilingEventNames.deleteFlowCurrentRunsLoadStart);this.flowRunList={id:"flowActiveRuns",filter:"Status eq 'running'",flowName:this.flow.name,flowTriggerHistoriesWithRun:void 0,flowRuns:void 0,flowTriggerHistoryFilter:function(e){return!0},flowRunFilter:function(e){return!0},spinner:{size:c.SpinnerSize.Small,show:!0,local:c.SpinnerPosition.LocalHorizontal},loadingMoreSpinner:{size:c.SpinnerSize.Small,local:c.SpinnerPosition.LocalHorizontal},hasMore:function(){return!1},isLoadingMore:!1,loadNextPage:function(){return p.noop()},showInTile:!1,showInDialog:!0},this.flowRunList.flowRuns=this.flowRunsClient.query(this.$scope,{flowName:this.flow.name,$filter:"Status eq 'running'"}),this.flowRunList.flowRuns.$promise.then(function(){e.flowRunList.flowRuns.length>0&&(e.showFlowRunList=!0),e.loggingService.profileEnd(t,o.ProfilingEventNames.deleteFlowCurrentRunsLoadEnd,{status:s.Status.Success})}).catch(function(i){e.loggingService.profileEnd(t,o.ProfilingEventNames.deleteFlowCurrentRunsLoadEnd,{status:s.inferErrorStatus(i),error:s.parseErrorMessage(i)}),e.loggingService.logError("DeleteFlowContentCtrl.initializeFlowCurrentRunsList",i)}).finally(function(){e.flowRunList.spinner.show=!1})},e.prototype.onDeleteFlow=function(){var e=this;this.telemetryService.tagEvent(u.TelemetryEventNames.DeleteFlowDialogDeleteButtonClicked,null,{flowName:this.flow.name}),this.showButtonProgressSpinner=!0,this.deleteFlowActionButton.label=this.clientResources.Dialogs.DeleteFlow.Button.Deleting,this.disableAllButtons();var t=this.loggingService.profileStart(o.ProfilingEventNames.deleteFlowRequestStart);this.telemetryService.tagEvent(u.TelemetryEventNames.DeleteFlow,this.flowId),this.flowsClient.delete({id:this.flow.id}).then(function(){return e.flowsClient.refreshQuery(n.getFlowsQueryParams({isPersonal:!e.isTeamFlow,isShared:e.isTeamFlow}))}).then(function(){e.loggingService.profileEnd(t,o.ProfilingEventNames.deleteFlowEnd,{flowId:e.flowId,status:s.Status.Success,isTeamFlow:e.isTeamFlow}),e.showButtonProgressSpinner=!1,e.handleFlowDeleteCompletion()}).catch(function(i){e.loggingService.profileEnd(t,o.ProfilingEventNames.deleteFlowRequestEnd,{flowId:e.flow.id,status:s.inferErrorStatus(i),error:s.parseErrorMessage(i),isTeamFlow:e.isTeamFlow}),e.loggingService.logError("DeleteFlowContentCtrl.DeleteFlow",i)})},e.prototype.handleCancel=function(){this.telemetryService.tagEvent(u.TelemetryEventNames.DeleteFlowDialogCancelButtonClicked,null,{flowName:this.flowName}),this.hideDialog()},e.prototype.handleFlowDeleteCompletion=function(){this.hideDialog(),this.isTeamFlow?this.navigateToTeamFlowsPage():this.navigateToMyFlowsPage()},e.prototype.navigateToMyFlowsPage=function(){this.navigationService.navigate(this.urlService.flowsRoute())},e.prototype.navigateToTeamFlowsPage=function(){this.navigationService.navigate(this.urlService.sharedFlowsRoute())},e.prototype.handleFlowDeleteError=function(){this.deleteFlowActionButton.label=this.clientResources.Dialogs.DeleteFlow.Button.Delete,this.enableAllButtons()},e.prototype.getDialogContentHeader=function(){return l.format(this.clientResources.Dialogs.DeleteFlow.DeleteHeader,a.getFlowDisplayName(this.flow))},e.prototype.enableAllButtons=function(){this.deleteFlowContentButtons.forEach(function(e){e.disabled=!1})},e.prototype.disableAllButtons=function(){this.deleteFlowContentButtons.forEach(function(e){e.disabled=!0})},e.prototype.hideDialog=function(){this.modalDialog.show=!1},e.$inject=[r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.flowRunsClient,r.default.services.flowsClient,r.default.services.logging,r.default.services.navigation,r.default.services.telemetry,r.default.services.url],e}();t.DeleteFlowDialogCtrl=d},function(e,t){},function(e,t){e.exports='<div class="section-delete-flow-dialog"> <modal-dialog model="deleteFlowDialogCtrl.modalDialog" aria-label="{{deleteFlowDialogCtrl.deleteDialogHeader}} {{deleteFlowDialogCtrl.clientResources.Dialogs.DeleteFlow.DeleteWarning.Common}}"> <dialog-header-content-template> <h1 class="c-subheading-4" ng-if="!deleteFlowDialogCtrl.flowDetailsLoadingSpinner.show">{{deleteFlowDialogCtrl.deleteDialogHeader}}</h1> </dialog-header-content-template> <dialog-body-content-template ng-if="!deleteFlowDialogCtrl.flowDetailsLoadingSpinner.show"> <p>{{deleteFlowDialogCtrl.clientResources.Dialogs.DeleteFlow.DeleteWarning.Common}}</p> <p ng-if="!deleteFlowDialogCtrl.showFlowRunList">{{deleteFlowDialogCtrl.clientResources.Dialogs.DeleteFlow.DeleteWarning.NoCurrentRuns}}</p> <p ng-if="deleteFlowDialogCtrl.showFlowRunList">{{deleteFlowDialogCtrl.clientResources.Dialogs.DeleteFlow.DeleteWarning.CurrentRuns}}</p> <div class="delete-flow-content-run-list-table"> <flow-run-list model="deleteFlowDialogCtrl.flowRunList" ng-if="deleteFlowDialogCtrl.showFlowRunList"></flow-run-list> </div> <div class="delete-flow-content-footer"> <dialog-buttons buttons="deleteFlowDialogCtrl.deleteFlowContentButtons" show-spinner="deleteFlowDialogCtrl.showButtonProgressSpinner"/> </div> </dialog-body-content-template> </modal-dialog> <spinner model="deleteFlowDialogCtrl.spinner"></spinner> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(892);i(893);var o=function(){function e(){this.bindings={flow:"=",show:"="},this.controller=n.EditFlowDetailsCtrl,this.controllerAs="editFlowDetailsCtrl",this.template=i(894)}return e}();t.EditFlowDetails=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.editFlowDetails,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(0),o=i(4),s=i(7),a=i(6),l=i(1),c=i(3);!function(e){e[e.Spin=0]="Spin",e[e.EditForm=1]="EditForm",e[e.Error=2]="Error",e[e.Success=3]="Success"}(r||(r={}));var u=function(){function e(e,t,i,n,o,a){var l=this;this.$q=e,this.$scope=t,this.clientResources=i,this.flowsClient=n,this.logging=o,this.telemetry=a,this.maxDescriptionLength=256,this.modeType=r,this.mode=r.Spin,this.paneSpinner={size:s.SpinnerSize.Large,show:!0,local:s.SpinnerPosition.Local},this.formSubmitSpinner={size:s.SpinnerSize.Large,show:!1,local:s.SpinnerPosition.Local},this.$scope.$watch(function(){return l.flow},function(e,t){!t&&e&&l.flowsClient.get(l.$scope,{id:l.flow.id}).$promise.then(function(e){l.flow=e,l.flowDescription=l.flow.properties.definition.description,l.mode=r.EditForm}).catch(function(e){l.logging.logError("editFlowDetailsCtrl.flowsClient.get",e),l.showError(e)})})}return Object.defineProperty(e.prototype,"maxDescriptionErrorMessage",{get:function(){return l.format(this.clientResources.EditFlowDetails.Description.Error.MaxLength,this.maxDescriptionLength)},enumerable:!0,configurable:!0}),e.prototype.isMode=function(e){return this.mode===e},e.prototype.onClose=function(){this.show=!1},e.prototype.onSave=function(){var e=this,t=this.logging.profileStart(o.ProfilingEventNames.editFlowDetailsSaveStart);this.telemetry.tagEvent(a.TelemetryEventNames.EditFlowDetailsSave),this.formSubmitSpinner.show=!0;var i=angular.copy(this.flow);i.properties.definition.description=this.flowDescription,this.flowsClient.patch({id:this.flow.id},i).then(function(t){return e.flow=t.data,e.flowsClient.refresh({id:e.flow.id})}).then(function(){e.mode=r.Success,e.logging.profileEnd(t,o.ProfilingEventNames.editFlowDetailsSaveEnd,{status:o.Status.Success})}).catch(function(i){e.logging.profileEnd(t,o.ProfilingEventNames.editFlowDetailsSaveEnd,{status:c.inferErrorStatus(i)}),e.showError(i)})},e.prototype.showError=function(e){this.errorMessage=c.parseErrorMessage(e,this.clientResources.Common.SomethingWentWrong),this.mode=r.Error},e.$inject=[n.default.services.$q,n.default.services.$scope,n.default.services.clientResources,n.default.services.flowsClient,n.default.services.logging,n.default.services.telemetry],e}();t.EditFlowDetailsCtrl=u},function(e,t){},function(e,t){e.exports='<section class="edit-flow-details-component" ng-if="editFlowDetailsCtrl.show"> <info-pane pane-title="editFlowDetailsCtrl.clientResources.EditFlowDetails.PaneTitle" expanded="editFlowDetailsCtrl.show" aria-expanded="editFlowDetailsCtrl.show" on-close="editFlowDetailsCtrl.onClose()"> <spinner model="editFlowDetailsCtrl.paneSpinner" ng-if="editFlowDetailsCtrl.isMode(editFlowDetailsCtrl.modeType.Spin)"></spinner> <div ng-if="editFlowDetailsCtrl.isMode(editFlowDetailsCtrl.modeType.EditForm)"> <spinner model="editFlowDetailsCtrl.formSubmitSpinner" ng-if="editFlowDetailsCtrl.formSubmitSpinner.show"></spinner> <form name="editFlowDetails" ng-submit="editFlowDetailsCtrl.onSubmit(editFlowDetails.$valid)" novalidate> <div> <label for="editFlowDetailsDescription" class="c-subheading-5">{{::editFlowDetailsCtrl.clientResources.EditFlowDetails.Description.Label}}</label> <textarea id="editFlowDetailsDescription" name="description" class="f-no-resize" ng-model="editFlowDetailsCtrl.flowDescription" ng-readonly="editFlowDetailsCtrl.formSubmitSpinner.show" ng-attr-placeholder="{{::editFlowDetailsCtrl.clientResources.EditFlowDetails.Description.Placeholder}}" required="required" ng-maxlength="{{::editFlowDetailsCtrl.maxDescriptionLength}}"/>\r\n                        <p class="save-details-error" ng-if="editFlowDetails.description.$error.maxlength">{{::editFlowDetailsCtrl.maxDescriptionErrorMessage}}</p>\r\n                </div>\r\n                <div class="edit-flow-details-actions">\r\n                    <button class="c-button" type="submit" ng-click="editFlowDetailsCtrl.onSave()" ng-disabled="editFlowDetailsCtrl.formSubmitSpinner.show || editFlowDetails.description.$error.maxlength">\r\n                        {{::editFlowDetailsCtrl.clientResources.Common.Save}}\r\n                    </button>\r\n                    <button class="c-button" ng-click="editFlowDetailsCtrl.onClose()" ng-disabled="editFlowDetailsCtrl.formSubmitSpinner.show">{{::editFlowDetailsCtrl.clientResources.Common.Cancel}}</button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n        <div class="status-response" ng-if="editFlowDetailsCtrl.isMode(editFlowDetailsCtrl.modeType.Success)">\r\n            <a class="green-circle-border c-glyph glyph-checkmark"></a>\r\n            <p class="c-paragraph-1">{{::editFlowDetailsCtrl.clientResources.EditFlowDetails.Message.Success}}</p>\r\n        </div>\r\n        <div class="status-response" ng-if="editFlowDetailsCtrl.isMode(editFlowDetailsCtrl.modeType.Error)">\r\n            <a class="red-circle-border c-glyph glyph-error"></a>\r\n            <p class="c-paragraph-1">{{editFlowDetailsCtrl.errorMessage}}</p>\r\n        </div>\r\n    </info-pane>\r\n</section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(896);i(897);var o=function(){function e(){this.controller=n.FlowNewGettingStartedHeroSectionCtrl,this.controllerAs="flowNewGettingStartedHeroSectionCtrl",this.template=i(898)}return e}();t.FlowNewGettingStartedHeroSection=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowNewGettingStartedHeroSection,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=function(){function e(e,t,i){this.$q=e,this.clientResources=t,this.loggingService=i,this.gettingStartedImageSrc=n.default.flowNewGettingStarted}return e.$inject=[r.default.services.$q,r.default.services.clientResources,r.default.services.logging],e}();t.FlowNewGettingStartedHeroSectionCtrl=o},function(e,t){},function(e,t){e.exports='<div class="flow-new-getting-started-hero-section-component"> <div class="row"> <div class="column c-content medium-offset-2 medium-4 large-offset-1 large-4"> <h1 class="c-heading-6">{{flowNewGettingStartedHeroSectionCtrl.clientResources.Flow.New.GettingStarted.HeroSection.Title}}</h1> <p class="c-paragraph-1">{{flowNewGettingStartedHeroSectionCtrl.clientResources.Flow.New.GettingStarted.HeroSection.Text}}</p> </div> <div class="column img-column medium-offset-2 medium-4 large-offset-1 large-6"> <img cdn-src="{{flowNewGettingStartedHeroSectionCtrl.gettingStartedImageSrc}}"/> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(900);i(901);var o=function(){function e(){this.template=i(902),this.bindings={flow:"=",flowName:"=",isShared:"=",context:"="},this.controller=n.FlowConnectionsTileCtrl,this.controllerAs="flowConnectionsTileCtrl"}return e}();t.FlowConnectionsTile=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowTiles.flowConnectionsTile,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(7),o=i(18),s=i(4),a=i(5),l=i(3),c=i(33),u=i(8),p=4,d=function(){function e(e,t,i,r,d,g,m,f){var h=this;this.$q=e,this.$scope=t,this.clientResources=i,this.flowsClient=r,this.flowConnectionsClient=d,this.connectionsClient=g,this.loggingService=m,this.urlService=f,this.connectionSpinner={size:n.SpinnerSize.Small,local:n.SpinnerPosition.LocalHorizontal,message:this.clientResources.FlowPropertyTile.FlowConnectionsTile.Loading},this.fetchFlowConnections=function(){h.connectionSpinner.show=!0;var e=h.loggingService.profileStart(s.ProfilingEventNames.flowConnectionsLoadStart,{flowName:h.flowName});return h.flowConnectionsRows=[],h.flowConnectionsClient.query(h.$scope,{flowName:h.flowName}).$promise.then(function(t){h.loggingService.profileEnd(e,s.ProfilingEventNames.flowConnectionsLoadEnd,{flowName:h.flowName,status:s.Status.Success}),h.flowId=o.getFlowId(h.flowName);var i=h.flow.properties.connectionReferences,r=Object.keys(i||{});r.length>p&&(r=r.slice(0,p)),r.forEach(function(e){var r=i[e],n=t.filter(function(e){return u.equalsIgnoreCase(e.name,r.connectionName)});if(n.length>0){var o=n[0],s=o.properties,l=c.isConnected(o);h.flowConnectionsRows.push({iconUri:r.iconUri,title:s.displayName,subTitle:s.createdBy&&s.createdBy.email||"",statusIcon:l?a.default.statusSuccess:a.default.statusError})}})}).catch(function(t){h.loggingService.profileEnd(e,s.ProfilingEventNames.flowConnectionsLoadEnd,{flowName:h.flowName,status:s.Status.Failure,error:l.parseErrorMessage(t)}),h.loggingService.logError("FlowConnectionsTileCtrl.getFlowConnections",t)}).finally(function(){h.connectionSpinner.show=!1,h.context.onInit()})},this.flowConnectionsTile={title:i.FlowPropertyTile.FlowConnectionsTile.Title,showAll:!0,showAllLink:this.urlService.flowOwnersRoute({flowName:this.flowName}),searchParameters:{backUrl:this.urlService.flowDetailsRoute({flowName:this.flowName,shared:this.isShared})}},this.context.fetchFlowConnections=this.fetchFlowConnections,t.$watch(function(){return h.flow},function(){h.flow&&h.fetchFlowConnections()})}return e.$inject=[r.default.services.$q,r.default.services.$scope,r.default.services.clientResources,r.default.services.flowsClient,r.default.services.flowConnectionsClient,r.default.services.connectionsClient,r.default.services.logging,r.default.services.url],e}();t.FlowConnectionsTileCtrl=d},function(e,t){},function(e,t){e.exports='<property-tile model="flowConnectionsTileCtrl.flowConnectionsTile" class="flow-connections-tile"> <tile-content-template> <spinner model="flowConnectionsTileCtrl.connectionSpinner"></spinner> <div ng-repeat="connection in flowConnectionsTileCtrl.flowConnectionsRows" class="info-card-item"> <div class="info-card-icon"> <img ng-attr-src="{{connection.iconUri}}"/> </div> <div class="info-card-text-section column medium-9"> <div class="info-card-title">{{connection.title}}</div> <div class="info-card-subtitle"> <img ng-attr-src="{{connection.statusIcon}}" onerror=\'this.onerror=null,this.src="/Content/Images/Common/connection.svg"\'/> {{connection.subTitle}} </div> </div> </div> </tile-content-template> </property-tile>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(904);i(905);var o=function(){function e(){this.template=i(906),this.bindings={flow:"="},this.controller=n.FlowDetailsTileCtrl}return e}();t.FlowDetailsTile=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowTiles.flowDetailsTile,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(18),o=i(46),s=i(5),a=function(){function e(e,t,i,r,a){var l=this;this.$sce=e,this.$scope=t,this.clientResources=i,this.flowsClient=r,this.loggingService=a,this.showEditPaneDetails=!1,this.showEditPaneImage=s.default.description,t.$watch(function(){return l.flow},function(){l.flow&&(l.flowName=l.flow.name,l.flowId=n.getFlowId(l.flowName),l.allIcons=o.getIconInfoForFlow(l.flow),l.flowDisplayName=l.flow.properties.displayName,l.flowDescription=l.flow.properties.definition.description)})}return e.prototype.onEditDetails=function(e){!0!==this.showEditPaneDetails&&(e.stopPropagation(),this.showEditPaneDetails=!0)},e.$inject=[r.default.services.$sce,r.default.services.$scope,r.default.services.clientResources,r.default.services.flowsClient,r.default.services.logging],e}();t.FlowDetailsTileCtrl=a},function(e,t){},function(e,t){e.exports='<property-tile class="flow-details-tile"> <tile-content-template> <div class="flow-details-tile-item" ng-if="$ctrl.allIcons"> <div class="left-column"> <api-icon-column class="flow-contact-card" icons="$ctrl.allIcons"></api-icon-column> </div> <div class="flow-details-tile-content"> <div class="flow-details-tile-content-title"> <p class="flow-details-tile-display-name"> {{$ctrl.flowDisplayName}} </p> </div> <div class="flow-details-description"> <p> {{$ctrl.flowDescription}} </p> <div class="edit-details-button" role="button" ng-click="$ctrl.onEditDetails($event)"> <img src="{{$ctrl.showEditPaneImage}}"> <span class="flow-details-edit-description-label"> {{$ctrl.flowDescription ? $ctrl.clientResources.FlowDetails.Label.EditDescription : $ctrl.clientResources.FlowDetails.Label.AddDescription}} </span> </div> </div> </div> </div> </tile-content-template> </property-tile> <edit-flow-details flow="$ctrl.flow" show="$ctrl.showEditPaneDetails"></edit-flow-details>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(908);i(909);var o=function(){function e(){this.template=i(910),this.bindings={flow:"=",context:"="},this.controller=n.FlowMobileBannerTileCtrl,this.controllerAs="flowMobileBannerTileCtrl"}return e}();t.FlowMobileBannerTile=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowTiles.flowMobileBannerTile,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(6),o=i(211),s=function(){function e(e,t,i,r,n,o,s){this.$scope=e,this.$window=t,this.appSettings=i,this.clientResources=r,this.loggingService=n,this.telemetry=o,this.urlService=s,this.showTile=!0,this.AppleStoreEmailDownloadLink=this.appSettings.mobileIosAppStoreUrlForEmail,this.GoogleStoreEmailDownloadLink=this.appSettings.mobileAndroidAppStoreUrlForEmail}return e.prototype.closeAction=function(){this.showTile=!1,this.telemetry.tagEvent(n.TelemetryEventNames.MobileBannerTileCloseClicked)},e.prototype.emailMeAction=function(){this.$window.location.href=o.getEmailLink(this.clientResources,this.appSettings),this.telemetry.tagEvent(n.TelemetryEventNames.MobileBannerTileEmailMeLinkClicked)},e.$inject=[r.default.services.$scope,r.default.services.$window,r.default.services.appSettings,r.default.services.clientResources,r.default.services.logging,r.default.services.telemetry,r.default.services.url],e}();t.FlowMobileBannerTileCtrl=s},function(e,t){},function(e,t){e.exports='<property-tile class="flow-mobile-banner-tile" ng-show="flowMobileBannerTileCtrl.showTile"> <tile-content-template> <div class="mobile-banner-top"> <img class="mobile-banner-image" src="/Content/Images/Banners/MobileFlowProperties.png"> <div class="mobile-banner-text"> <h1>{{flowMobileBannerTileCtrl.clientResources.FlowPropertyTile.MobileBanner.Text1}}</h1> <p>{{flowMobileBannerTileCtrl.clientResources.FlowPropertyTile.MobileBanner.Text2}} <a target="_blank" href="{{flowMobileBannerTileCtrl.appSettings.mobileDownloadPageLearnMoreLink}}">{{flowMobileBannerTileCtrl.clientResources.Common.LearnMore}}</a></p> <a class="mobile-download" target="_blank" href="{{flowMobileBannerTileCtrl.AppleStoreEmailDownloadLink}}"><svg svg-src="/Content/Images/HomeIcons/Mobile/App_Store_Badge.svg"></svg></a> <a class="mobile-download" target="_blank" href="{{flowMobileBannerTileCtrl.GoogleStoreEmailDownloadLink}}"><img src="/Content/Images/HomeIcons/Mobile/google-play-badge.png"></a> </div> <div class="mobile-banner-close-container"> <a href ng-click="flowMobileBannerTileCtrl.closeAction()" class="c-glyph glyph-close"></a> </div> </div> <div class="mobile-banner-email-text-container"> <span class="mobile-banner-email-text">{{flowMobileBannerTileCtrl.clientResources.FlowPropertyTile.MobileBanner.Email.Text1}}</span> <button class="mobile-banner-email-button c-button" ng-click="flowMobileBannerTileCtrl.emailMeAction()">{{flowMobileBannerTileCtrl.clientResources.FlowPropertyTile.MobileBanner.Email.Text2}}</button> </div> </tile-content-template> </property-tile>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(912);i(913);var o=function(){function e(){this.template=i(914),this.bindings={errorAlert:"=",flow:"=",flowName:"=",isShared:"=",context:"="},this.controller=n.FlowOwnersTileCtrl}return e}();t.FlowOwnersTile=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowTiles.flowOwnersTile,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(7),o=i(18),s=i(95),a=i(4),l=i(10),c=i(3),u=i(5),p=i(43),d=i(8),g=4,m=function(){function e(e,t,i,r,m,f,h,v,y,w,C){var S=this;this.$q=e,this.$scope=t,this.clientResources=i,this.flowsClient=r,this.flowRolesClient=m,this.graphService=f,this.urlService=h,this.navigationService=v,this.promiseHelperService=y,this.sessionService=w,this.loggingService=C,this.flowOwnersRows=[],this.coauthorSpinner={size:n.SpinnerSize.Small,local:n.SpinnerPosition.LocalHorizontal,message:this.clientResources.FlowPropertyTile.FlowOwnersTile.Loading},this.addOwnerImage=u.default.addPerson,this.fetchAllCoauthors=function(){return S.coauthorSpinner.show=!0,S.promiseHelperService.toAngularPromise(S.sessionService.getUserSessionAsync()).then(function(e){return d.equalsIgnoreCase(e.userInfo.userType,p.UserType.MicrosoftAccount)?S.$q.resolve():S.fetchOwners().then(function(e){return S.getUserObjects(e)})}).catch(function(e){}).finally(function(){S.coauthorSpinner.show=!1,S.context.onInit()})},this.getUserObjects=function(e){var t={objectIds:e},i=S.loggingService.profileStart(a.ProfilingEventNames.getObjectsByObjectIdsStart,t);return S.graphService.getObjectsByObjectId(e).then(function(t){return S.loggingService.profileEnd(i,a.ProfilingEventNames.getObjectsByObjectIdsEnd,{status:a.Status.Success}),S.graphService.getThumbnailPhotos(e).then(function(e){S.flowOwnersRows=[],t.map(function(t){S.creatorId===t.objectId?S.flowOwnersRows.unshift(S.convertGraphModelToContributorModel(t,e)):S.flowOwnersRows.push(S.convertGraphModelToContributorModel(t,e))})}).catch(function(e){S.loggingService.logError("FlowOwnersTileCtrl.getThumbnailPhotos",e)})}).catch(function(t){var r=c.parseErrorMessage(t);return c.inferErrorStatus(t)===a.Status.Abort?S.loggingService.logWarning("FlowOwnersTileCtrl.getUserObjects",c.parseErrorMessage(t),t):S.loggingService.logError("FlowOwnersTileCtrl.getUserObjects",t),S.loggingService.profileEnd(i,a.ProfilingEventNames.getObjectsByObjectIdsEnd,{status:c.inferErrorStatus(t),error:r,objectIds:e}),S.errorAlert&&(S.errorAlert.type=l.AlertType.Error,S.errorAlert.message=r),S.$q.reject(t)})},this.convertGraphModelToContributorModel=function(e,t){var i=e.objectId;return{iconUri:t.hasOwnProperty(i)?t[i]:"",title:e.displayName,subTitle:e.mail,id:i}},this.fetchOwners=function(){if(S.isShared){var e=S.loggingService.profileStart(a.ProfilingEventNames.flowOwnersLoadStart);return S.flowRolesClient.query(S.$scope,{flowName:S.flowName,roleName:s.FlowRoles.owners}).$promise.then(function(t){S.loggingService.profileEnd(e,a.ProfilingEventNames.flowOwnersLoadEnd,{status:a.Status.Success});var i=[];return t.map(function(e){i.length<g&&i.push(e.properties.principal.id)}),i}).catch(function(t){S.loggingService.logError("FlowOwnersTileCtrl.getFlowPermissions",t);var i=c.parseErrorMessage(t);return S.loggingService.profileEnd(e,a.ProfilingEventNames.flowOwnersLoadEnd,{status:c.inferErrorStatus(t),error:i}),S.errorAlert&&(S.errorAlert.type=l.AlertType.Error,S.errorAlert.message=i),S.$q.reject(t)})}return S.$q.resolve([S.creatorId])},this.flowId=o.getFlowId(this.flowName),this.flowOwnersTile={title:this.clientResources.FlowPropertyTile.FlowOwnersTile.Title,showAll:!0,showAllLink:this.urlService.flowOwnersRoute({flowName:this.flowName}),searchParameters:{backUrl:this.urlService.flowDetailsRoute({flowName:this.flowName,shared:this.isShared})}},this.context.fetchAllCoauthors=this.fetchAllCoauthors,t.$watch(function(){return S.flow},function(){S.flow&&(S.creatorId=S.flow&&S.flow.properties&&S.flow.properties.creator&&S.flow.properties.creator.objectId||"",S.fetchAllCoauthors())})}return e.prototype.addOwnerClick=function(){this.navigationService.navigate(this.urlService.flowOwnersRoute({flowName:this.flowName}),{backUrl:this.urlService.flowDetailsRoute({flowName:this.flowName,shared:this.isShared})})},e.$inject=[r.default.services.$q,r.default.services.$scope,r.default.services.clientResources,r.default.services.flowsClient,r.default.services.flowRolesClient,r.default.services.graph,r.default.services.url,r.default.services.navigation,r.default.services.promiseHelperService,r.default.services.session,r.default.services.logging],e}();t.FlowOwnersTileCtrl=m},function(e,t){},function(e,t){e.exports='<property-tile model="$ctrl.flowOwnersTile " class="flow-owners-tile"> <tile-content-template> <spinner model="$ctrl.coauthorSpinner"></spinner> <div ng-repeat="owner in $ctrl.flowOwnersRows" class="info-card-item"> <div class="info-card-icon"> <avatar mail="owner.subTitle" display-name="owner.title" image-src="owner.iconUri" object-id="owner.id"></avatar> </div> <div class="info-card-text-section column medium-9"> <div class="info-card-title">{{owner.title}}</div> <div class="info-card-subtitle"> {{owner.subTitle}} </div> </div> </div> <div class="info-card-item" ng-click="$ctrl.addOwnerClick()"> <div class="info-card-icon add-owner-icon"> <svg class="img-circle" svg-src="{{$ctrl.addOwnerImage}}"/> </div> <div class="info-card-text-section column medium-9"> <a class="add-owner-title"> {{$ctrl.clientResources.FlowPropertyTile.FlowOwnersTile.AddOwnerText}} </a> </div> </div> </tile-content-template> </property-tile>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(916);i(918);var o=function(){function e(){this.template=i(919),this.bindings={errorAlert:"=",flow:"=",flowName:"=",context:"=",populateRunOnlyUser:"<"},this.controller=n.FlowRunOnlyTileCtrl,this.controllerAs="flowRunOnlyTileCtrl"}return e}();t.FlowRunOnlyTile=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowTiles.flowRunOnlyTile,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(10),o=i(917),s=i(95),a=i(1),l=i(18),c=i(4),u=i(5),p=i(6),d=i(43),g=i(7),m=i(19),f=i(3),h=i(8),v=function(){function e(e,t,i,r,v,y,w,C,S,b,P,R,T,E,A,D,F,N,I,O){var k=this;this.$q=e,this.$routeParams=t,this.$scope=i,this.$timeout=r,this.appSettings=v,this.clientResources=y,this.connectionsClient=w,this.environmentService=C,this.flowConnectionsClient=S,this.flowRolesClient=b,this.flowsClient=P,this.graphService=R,this.loggingService=T,this.navigationService=E,this.policiesService=A,this.promiseHelperService=D,this.sessionService=F,this.telemetryService=N,this.trialDialog=I,this.urlService=O,this.addedUsers=[],this.pendingUsersToAdd=[],this.pendingUsersToDelete=[],this.runOnlySpinner={size:g.SpinnerSize.Small,local:g.SpinnerPosition.LocalHorizontal,message:this.clientResources.ModalDialog.RunOnly.Loading},this.infoPaneSpinner={size:g.SpinnerSize.Small,local:g.SpinnerPosition.LocalHorizontal},this.addUserImage=u.default.addPerson,this.providedByRunOnlyUserId="",this.runtimeConnectionCards=[],this.isRuntimeConnectionConfigurationUpdated=!1,this.showConnectionWarningMessage=!1,this.runtimeConnectionSpinner={size:g.SpinnerSize.Small,local:g.SpinnerPosition.LocalHorizontal},this.modalDialogCancelButton={label:this.clientResources.ModalDialog.RunOnly.Cancel,action:function(e){e.stopPropagation(),k.useEmbeddedConnectionDialog.show=!1}},this.useEmbeddedConnectionDialog={show:!1,buttons:[{label:this.clientResources.ModalDialog.RunOnly.OK,action:function(e){e.stopPropagation(),k.useEmbeddedConnectionDialog.show=!1},primary:!0},this.modalDialogCancelButton]},this.infoPane=!1,this.showConnectionManagementSection=!1,this.enablePaneSaveButton=!1,this.enablePaneCancelButton=!0,this.userAddedErrorMessage=null,this.fetchAllRunOnlyUsers=function(){return k.runOnlySpinner.show=!0,k.promiseHelperService.toAngularPromise(k.sessionService.getUserSessionAsync()).then(function(e){return h.equalsIgnoreCase(e.userInfo.userType,d.UserType.MicrosoftAccount)?k.$q.resolve(null):k.fetchUsers()}).then(function(e){return k.graphService.performActionAfterGettingGraphDetails(e,k.populateAddedUsers,k.populateErrorAlert)}).then(function(){if(k.populateRunOnlyUser){k.infoPane=!0;var e=k.$routeParams.oid||"";k.graphService.performActionAfterGettingGraphDetails([e],k.prepopulatePendingUsersToAdd,k.populateErrorAlert)}}).catch(function(e){}).finally(function(){k.runOnlySpinner.show=!1,k.context.onInit()})},this.fetchUsers=function(){var e=k.loggingService.profileStart(c.ProfilingEventNames.flowRunOnlyLoadStart);return k.flowRolesClient.query(k.$scope,{flowName:k.flowName,roleName:s.FlowRoles.users}).$promise.then(function(t){k.loggingService.profileEnd(e,c.ProfilingEventNames.flowRunOnlyLoadEnd,{status:c.Status.Success});var i=[];return t.map(function(e){i.push(e.properties.principal.id)}),i}).catch(function(t){k.loggingService.logError("FlowRunOnlyTileCtrl.fetchUsers",t);var i=f.parseErrorMessage(t);return k.loggingService.profileEnd(e,c.ProfilingEventNames.flowRunOnlyLoadEnd,{status:f.inferErrorStatus(t),error:i}),k.errorAlert&&(k.errorAlert.type=n.AlertType.Error,k.errorAlert.message=i),Promise.resolve(t)})},this.populateAddedUsers=function(e,t){k.addedUsers=[],e.map(function(e){k.addedUsers.push(m.convertGraphModelToCardModel(e,t))})},this.prepopulatePendingUsersToAdd=function(e,t){e.map(function(e){k.userNotAlreadyAdded(e.objectId)?(k.pendingUsersToAdd.push(m.convertGraphModelToCardModel(e,t)),k.enablePaneSaveButton=!0,k.userAddedErrorMessage=null):k.userAddedErrorMessage=a.format(k.clientResources.FlowInfoPane.RunOnly.Invite.UserAlreadyAdded,e.displayName)})},this.populateErrorAlert=function(e){k.loggingService.logError("FlowRunOnlyTileCtrl.getUserObjects",e);var t=f.parseErrorMessage(e);k.errorAlert&&(k.errorAlert.type=n.AlertType.Error,k.errorAlert.message=t)},this.userNotAlreadyAdded=function(e){var t=k.addedUsers.filter(function(t){return t.id===e}),i=k.pendingUsersToAdd.filter(function(t){return t.id===e});return 0===t.length&&0===i.length},this.seeAllClick=function(e){e.stopPropagation(),k.telemetryService.tagEvent(p.TelemetryEventNames.RunOnlyTileSeeAllClicked),k.tryToOpenInfoPane()},this.addPersonClick=function(e){e.stopPropagation(),k.telemetryService.tagEvent(p.TelemetryEventNames.RunOnlyTileAddPersonClicked),k.tryToOpenInfoPane()},this.tryToOpenInfoPane=function(){k.promiseHelperService.toAngularPromise(k.sessionService.getUserSessionAsync()).then(function(){return k.policiesService.checkUserCanShareFlows()}).then(function(e){e?k.openInfoPane():k.environmentService.isDevEnvironment()?k.trialDialog.showFeatureBlockedOnDeveloperEnvironment():k.trialDialog.showBlockedFeatureStartTrialDialog(function(e){e&&k.openInfoPane()})})},this.openInfoPane=function(){k.resetPaneData(),k.infoPane=!0,k.appSettings.featureFlags.enableRuntimeConnectionManagement&&(k.showConnectionManagementSection=!0,k.fetchRuntimeConnectionConfiguration())},this.onSave=function(){k.telemetryService.tagEvent(p.TelemetryEventNames.RunOnlyPaneSaveClicked);var e=k.flow,t=k.flowRolesClient.modify({flowName:k.flowName,roleName:s.FlowRoles.users},{put:m.convertCardsToAddFlowRolesModel(k.pendingUsersToAdd),delete:k.pendingUsersToDelete}),i=k.$q.defer();k.infoPaneSpinner.show=!0,k.enablePaneSaveButton=!1,k.enablePaneCancelButton=!1,k.isRuntimeConnectionConfigurationUpdated&&(e=k.getUpdatedFlowDefinition(),i=k.flowsClient.patch({id:k.flowId},e));var r=k.loggingService.profileStart(c.ProfilingEventNames.flowRunOnlySaveStart);k.$q.all([t,i]).then(function(){k.pendingUsersToDelete.forEach(function(e){k.addedUsers=k.addedUsers.filter(function(t){return t.id!==e.id})}),k.addedUsers=k.addedUsers.concat(k.pendingUsersToAdd),k.flow=e,k.resetPaneData(),k.loggingService.profileEnd(r,c.ProfilingEventNames.flowRunOnlySaveEnd,{status:c.Status.Success})}).catch(function(e){k.loggingService.logError("FlowRunOnlyTileCtrl.onSave",e);var t=f.parseErrorMessage(e);k.loggingService.profileEnd(r,c.ProfilingEventNames.flowRunOnlySaveEnd,{status:f.inferErrorStatus(e),error:t}),k.errorAlert&&(k.errorAlert.type=n.AlertType.Error,k.errorAlert.message=t)}).finally(function(){k.infoPaneSpinner.show=!1,k.enablePaneCancelButton=!0,k.infoPane=!1})},this.resetPaneData=function(){k.pendingUsersToAdd=[],k.pendingUsersToDelete=[],k.addedUsers.forEach(function(e){e.disabled=!1}),k.userAddedErrorMessage=null,k.enablePaneSaveButton=!1},this.onCancel=function(){k.telemetryService.tagEvent(p.TelemetryEventNames.RunOnlyPaneCancelClicked),k.infoPane=!1},this.onClose=function(){k.telemetryService.tagEvent(p.TelemetryEventNames.RunOnlyPaneCloseClicked),k.infoPane=!1},this.onDeleteAddedUser=function(e){k.telemetryService.tagEvent(p.TelemetryEventNames.RunOnlyPaneDeleteAddedUserClicked);var t={id:e.id,type:e.type};k.pendingUsersToDelete.push(t),k.addedUsers[k.addedUsers.indexOf(e)].disabled=!0,k.enablePaneSaveButton=k.determineSaveButtonDisplay()},this.onAddAddedUser=function(e){k.telemetryService.tagEvent(p.TelemetryEventNames.RunOnlyPaneAddAddedUserClicked),k.pendingUsersToDelete=k.pendingUsersToDelete.filter(function(t){return t.id!==e.id}),k.addedUsers[k.addedUsers.indexOf(e)].disabled=!1,k.enablePaneSaveButton=k.determineSaveButtonDisplay()},this.onDeletePendingToAddUser=function(e,t){e.stopPropagation(),k.telemetryService.tagEvent(p.TelemetryEventNames.RunOnlyPaneDeletePendingToAddUserClicked),k.pendingUsersToAdd=k.pendingUsersToAdd.filter(function(e){return e.id!==t.id}),k.enablePaneSaveButton=k.determineSaveButtonDisplay()},this.determineSaveButtonDisplay=function(){return k.pendingUsersToDelete.length>0||k.pendingUsersToAdd.length>0||k.isRuntimeConnectionConfigurationUpdated},this.fetchRuntimeConnectionConfiguration=function(){k.showConnectionWarningMessage=!1,k.runtimeConnectionSpinner.show=!0;var e=k.loggingService.profileStart(c.ProfilingEventNames.flowRuntimeConnectionManagementStart,{flowName:k.flowName}),t=k.flowConnectionsClient.query(k.$scope,{flowName:k.flowName}).$promise,i=k.connectionsClient.query(k.$scope).$promise;k.$q.all([t,i]).then(function(t){var i=t[0],r=t[1],n=k.flow?angular.copy(k.flow.properties.connectionReferences):{},s=r,l=i,u={},p=s.concat(l).filter(function(e){return!u[e.name]&&e.properties.statuses.filter(function(e){return"Connected"===e.status}).length>0&&(u[e.name]=!0,!0)});0===Object.keys(n).length?k.showConnectionManagementSection=!1:(k.runtimeConnectionCards=[],Object.keys(n).forEach(function(e){var t=n[e],i={id:e,title:t.displayName,subTitle:"",iconUrl:t.iconUri,selectedConnection:"",availableConnectionOptions:[{value:k.providedByRunOnlyUserId,displayName:k.clientResources.FlowInfoPane.RunOnly.ProvidedByRunOnlyUser}],originalConfigurationModified:!1};t.source===o.ConnectionSource.Invoker?(i.subTitle=k.clientResources.FlowInfoPane.RunOnly.ProvideOwnConnection,i.selectedConnection=""):t.source===o.ConnectionSource.Embedded&&(i.subTitle=k.clientResources.FlowInfoPane.RunOnly.EmbeddedConnection,i.selectedConnection=t.connectionName),p.forEach(function(e){e.properties.apiId===t.id&&i.availableConnectionOptions.push({value:e.name,displayName:a.format(k.clientResources.FlowInfoPane.RunOnly.UseThisConnection,e.properties.displayName)})}),k.runtimeConnectionCards.push(i)})),k.loggingService.profileEnd(e,c.ProfilingEventNames.flowRuntimeConnectionManagementEnd,{flowName:k.flowName,status:c.Status.Success})}).catch(function(t){k.errorAlert.type=n.AlertType.Error,k.errorAlert.message=f.parseErrorMessage(t,k.clientResources.Common.SomethingWentWrong),k.loggingService.profileEnd(e,c.ProfilingEventNames.flowRuntimeConnectionManagementEnd,{flowName:k.flowName,status:c.Status.Failure,error:k.errorAlert.message})}).finally(function(){return k.runtimeConnectionSpinner.show=!1})},this.flowId=l.getFlowId(this.flowName),this.flowRunOnlyTile={title:this.clientResources.FlowPropertyTile.RunOnly.Title,showAll:!0,showAllAction:this.seeAllClick,searchParameters:{backUrl:this.urlService.flowDetailsRoute({flowName:this.flowName})}},this.context.fetchAllRunOnlyUsers=this.fetchAllRunOnlyUsers,i.$watch(function(){return k.flow},function(){k.flow&&(k.creatorId=k.flow&&k.flow.properties&&k.flow.properties.creator&&k.flow.properties.creator.objectId||"",k.fetchAllRunOnlyUsers())})}return e.prototype.onGraphAutocompleteSelect=function(e,t){t.stopPropagation();var i=e.model.objectId,r={id:i,title:e.displayName,subTitle:e.mail,type:e.model.objectType};this.userNotAlreadyAdded(i)?(this.pendingUsersToAdd.push(r),this.enablePaneSaveButton=!0,this.userAddedErrorMessage=null):this.userAddedErrorMessage=a.format(this.clientResources.FlowInfoPane.RunOnly.Invite.UserAlreadyAdded,e.displayName)},e.prototype.onRuntimeConnectionSelectionChange=function(e){var t=this;this.telemetryService.tagEvent(p.TelemetryEventNames.RunOnlyPaneModifyConnectionSelectClicked);var i=this.flow.properties.connectionReferences,r=i[e],n=r.source===o.ConnectionSource.Invoker,s=this.runtimeConnectionCards.filter(function(t){return t.id===e})[0];s.selectedConnection!==this.providedByRunOnlyUserId&&(this.modalDialogCancelButton.action=function(i){i.stopPropagation(),t.telemetryService.tagEvent(p.TelemetryEventNames.RunOnlyPaneModifyConnectionModalCancelClicked),t.revertUseEmbeddedConnectionSelection(e),t.updateStatesPerUserSelection()},this.useEmbeddedConnectionDialog.show=!0),s.originalConfigurationModified=n&&s.selectedConnection!==this.providedByRunOnlyUserId||!n&&s.selectedConnection!==r.connectionName,this.updateStatesPerUserSelection()},e.prototype.revertUseEmbeddedConnectionSelection=function(e){var t=this.runtimeConnectionCards.filter(function(t){return t.id===e})[0];t.selectedConnection=this.providedByRunOnlyUserId,t.originalConfigurationModified=this.flow.properties.connectionReferences[e].source!==o.ConnectionSource.Invoker,this.useEmbeddedConnectionDialog.show=!1},e.prototype.getUpdatedFlowDefinition=function(){var e=this,t=angular.copy(this.flow);return this.runtimeConnectionCards.forEach(function(i){var r=i.id;i.originalConfigurationModified&&(i.selectedConnection===e.providedByRunOnlyUserId&&i.originalConfigurationModified?t.properties.connectionReferences[r].source=o.ConnectionSource.Invoker:(t.properties.connectionReferences[r].source=o.ConnectionSource.Embedded,t.properties.connectionReferences[r].connectionName=i.selectedConnection))}),t},e.prototype.updateStatesPerUserSelection=function(){var e=this;this.isRuntimeConnectionConfigurationUpdated=!1,this.runtimeConnectionCards.forEach(function(t){t.originalConfigurationModified&&(e.isRuntimeConnectionConfigurationUpdated=!0)}),this.showConnectionWarningMessage=this.isRuntimeConnectionConfigurationUpdated&&(this.addedUsers.length>0||this.pendingUsersToAdd.length>0),this.enablePaneSaveButton=this.determineSaveButtonDisplay()},e.$inject=[r.default.services.$q,r.default.services.$routeParams,r.default.services.$scope,r.default.services.$timeout,r.default.services.appSettings,r.default.services.clientResources,r.default.services.connectionsClient,r.default.services.environment,r.default.services.flowConnectionsClient,r.default.services.flowRolesClient,r.default.services.flowsClient,r.default.services.graph,r.default.services.logging,r.default.services.navigation,r.default.services.policies,r.default.services.promiseHelperService,r.default.services.session,r.default.services.telemetry,r.default.services.trialDialog,r.default.services.url],e}();t.FlowRunOnlyTileCtrl=v},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionSource={Embedded:"Embedded",Invoker:"Invoker"}},function(e,t){},function(e,t){e.exports='<property-tile model="flowRunOnlyTileCtrl.flowRunOnlyTile" class="flow-run-only-tile"> <tile-content-template> <spinner model="flowRunOnlyTileCtrl.runOnlySpinner"></spinner> <div ng-repeat="user in flowRunOnlyTileCtrl.addedUsers | limitTo: 4" class="info-card-item"> <div class="info-card-icon"> <avatar mail="user.subTitle" display-name="user.title" image-src="user.iconUri" object-id="user.id"></avatar> </div> <div class="info-card-text-section column medium-9"> <div class="info-card-title">{{user.title}}</div> <div class="info-card-subtitle"> {{user.subTitle}} </div> </div> </div> <div class="info-card-item" ng-click="flowRunOnlyTileCtrl.addPersonClick($event)"> <div class="info-card-icon add-owner-icon"> <svg class="img-circle" svg-src="{{flowRunOnlyTileCtrl.addUserImage}}"/> </div> <div class="info-card-text-section column medium-9"> <a class="add-owner-title"> {{flowRunOnlyTileCtrl.clientResources.FlowPropertyTile.RunOnly.AddRunOnly}} </a> </div> </div> <info-pane pane-title="flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Title" expanded="flowRunOnlyTileCtrl.infoPane" on-close="flowRunOnlyTileCtrl.onClose()"> <pane-content> <div class="pane-section"> <h1 class="pane-heading">{{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Invite.Title}}</h1> <p class="pane-subheading">{{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Invite.Description}}</p> <div class="run-tile-graph-container"> <graph-autocomplete on-select="flowRunOnlyTileCtrl.onGraphAutocompleteSelect(value, event)"></graph-autocomplete> <p class="pane-alert" ng-show="flowRunOnlyTileCtrl.userAddedErrorMessage">{{flowRunOnlyTileCtrl.userAddedErrorMessage}}</p> </div> <info-card ng-repeat="user in flowRunOnlyTileCtrl.pendingUsersToAdd" model="user"> <info-card-icon-template> <avatar mail="user.subTitle" display-name="user.title" image-src="user.iconUri" object-id="user.id"></avatar> </info-card-icon-template> <info-card-option-template> <button class="c-glyph glyph-delete option-block" ng-click="flowRunOnlyTileCtrl.onDeletePendingToAddUser($event,user)" ng-disabled="!flowRunOnlyTileCtrl.enablePaneSaveButton"></button> </info-card-option-template> </info-card> </div> <div class="pane-section"> <h1 class="pane-heading">{{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Shared.Title}}</h1> <div class="info-card-container" ng-repeat="user in flowRunOnlyTileCtrl.addedUsers" ng-class="{\'disabled\': user.disabled}"> <info-card model="user"> <info-card-icon-template> <avatar mail="user.subTitle" display-name="user.title" image-src="user.iconUri" object-id="user.id"></avatar> </info-card-icon-template> <info-card-option-template> <button class="c-glyph glyph-delete option-block" ng-click="flowRunOnlyTileCtrl.onDeleteAddedUser(user)" ng-disabled="!flowRunOnlyTileCtrl.enablePaneCancelButton" ng-hide="user.disabled"></button> <button class="c-glyph glyph-create option-block" ng-click="flowRunOnlyTileCtrl.onAddAddedUser(user)" ng-disabled="!flowRunOnlyTileCtrl.enablePaneCancelButton" ng-show="user.disabled"></button> </info-card-option-template> </info-card> </div> <p class="pane-subheading" ng-if="flowRunOnlyTileCtrl.addedUsers.length === 0">{{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Shared.ZeroShared}}</p> </div> <div class="pane-section" ng-if="flowRunOnlyTileCtrl.showConnectionManagementSection"> <spinner model="flowRunOnlyTileCtrl.connectionSpinner"></spinner> <h1 class="pane-heading" ng-if="!flowRunOnlyTileCtrl.connectionSpinner.show">{{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.ConnectionsUsed.Title}}</h1> <p class="pane-subheading" ng-if="!flowRunOnlyTileCtrl.connectionSpinner.show">{{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.ConnectionsUsed.Description}}</p> <div class="row connection-warning-message" ng-if="flowRunOnlyTileCtrl.showConnectionWarningMessage"> <div class="column small-1 icon-column"> <div class="c-glyph glyph-warning"> </div> </div> <div class="column small-11"> <p class="error-details">{{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.ConnectionsUsed.Warning}}</p> </div> </div> <div class="info-card-container connection-card-container" ng-repeat="connectionReference in flowRunOnlyTileCtrl.runtimeConnectionCards"> <info-card model="connectionReference"> <info-card-icon-template> <img ng-attr-src="{{connectionReference.iconUrl}}" onerror=\'this.onerror=null,this.src="/Content/Images/Common/connection.svg"\'/> </info-card-icon-template> <info-card-option-template> <select ng-if="connectionReference.availableConnectionOptions" type="text" ng-model="connectionReference.selectedConnection" ng-change="flowRunOnlyTileCtrl.onRuntimeConnectionSelectionChange(connectionReference.id)"> <option ng-repeat="connectionOption in connectionReference.availableConnectionOptions" value="{{connectionOption.value}}">{{connectionOption.displayName}}</option> </select> </info-card-option-template> </info-card> </div> </div> <div class="pane-section pane-actions"> <button class="c-button" type="submit" ng-click="flowRunOnlyTileCtrl.onSave()" ng-disabled="!flowRunOnlyTileCtrl.enablePaneSaveButton">{{flowRunOnlyTileCtrl.clientResources.Common.Save}}</button> <button class="c-button btn-secondary" ng-click="flowRunOnlyTileCtrl.onCancel()" ng-disabled="!flowRunOnlyTileCtrl.enablePaneCancelButton">{{flowRunOnlyTileCtrl.clientResources.Common.Cancel}}</button> <spinner model="flowRunOnlyTileCtrl.infoPaneSpinner"></spinner> </div> </pane-content> </info-pane> <modal-dialog model="flowRunOnlyTileCtrl.useEmbeddedConnectionDialog" aria-label="{{flowRunOnlyTileCtrl.clientResources.ModalDialog.RunOnly.Title}} {{flowRunOnlyTileCtrl.clientResources.ModalDialog.RunOnly.Description}}"> <dialog-header-content-template> <span>{{flowRunOnlyTileCtrl.clientResources.ModalDialog.RunOnly.Title}}</span> </dialog-header-content-template> <dialog-body-content-template> <div>{{flowRunOnlyTileCtrl.clientResources.ModalDialog.RunOnly.Description}}</div> </dialog-body-content-template> </modal-dialog> </tile-content-template> </property-tile>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(921);i(922);var o=function(){function e(){this.template=i(923),this.bindings={flow:"=",context:"=",isShared:"="},this.controller=n.FlowRunsTileCtrl,this.controllerAs="flowRunsTileCtrl"}return e}();t.FlowRunsTile=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowTiles.flowRunsTile,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(7),s=i(6),a=i(44),l=i(4),c=i(19),u=i(3),p=i(22),d=function(){function e(e,t,i,r,o,s,a){var l=this;this.$scope=e,this.appSettings=t,this.clientResources=i,this.flowRunsClient=r,this.urlService=o,this.loggingService=s,this.telemetry=a,this.iconUrl=n.default.statusWarning,this.showMobileBanner=!1,e.$watchGroup([function(){return l.flow},function(){return l.context.userAccountDefinition}],function(){l.flow&&l.context.userAccountDefinition&&(l.flowId=l.flow.id,l.flowName=l.flow.name,l.initializeFlowRunHistoriesTitle())})}return e.prototype.initializeFlowRunHistoriesTitle=function(){var e=this,t=this.loggingService.profileStart(l.ProfilingEventNames.flowRunsHistoryLoadStart);this.flowRunsTile={title:this.clientResources.FlowPropertyTile.FlowRunsTile.Title,showAll:!0,showAllLink:this.urlService.flowRunsRoute({flowName:this.flowName}),searchParameters:{backUrl:this.urlService.flowDetailsRoute({flowName:this.flowName,shared:this.isShared})}},this.flowRunList={id:"flowRuns",filter:a.FilterNames.allRuns,flowName:this.flowName,flowTriggerHistoriesWithRun:void 0,flowRuns:void 0,flowTriggerHistoryFilter:function(e){return!0},flowRunFilter:function(e){return!0},spinner:{size:o.SpinnerSize.Small,show:!0,local:o.SpinnerPosition.LocalHorizontal,message:this.clientResources.FlowPropertyTile.FlowRunsTile.Loading},loadingMoreSpinner:{size:o.SpinnerSize.Small,local:o.SpinnerPosition.LocalHorizontal},hasMore:function(){return!1},isLoadingMore:!1,loadNextPage:function(){return p.noop()},rows:[],showInTile:!0,top:10,backUrl:this.urlService.flowDetailsRoute({flowName:this.flowName,shared:this.isShared}),isPollingOrRecurrenceTrigger:c.containsTriggerWithRecurrence(this.flow)},this.flowRunsClient.refreshQuery({flowName:this.flowName}).then(function(){return e.flowRunList.flowRuns=e.flowRunsClient.query(e.$scope,{flowName:e.flowName}),e.context.flowRuns=e.flowRunList.flowRuns,e.flowRunList.flowRuns.$promise}).then(function(i){e.loggingService.profileEnd(t,l.ProfilingEventNames.flowRunsHistoryLoadEnd,{status:l.Status.Success}),i&&i.length>10&&(i=i.slice(0,10)),i&&i.length>0&&c.containsConnectionWithNotification(e.flow)&&e.initializeFlowRunsTileMobileBanner()}).catch(function(i){e.loggingService.profileEnd(t,l.ProfilingEventNames.flowRunsHistoryLoadEnd,{status:u.inferErrorStatus(i),error:u.parseErrorMessage(i)}),e.loggingService.logError("FlowRunsTileCtrl.initializeFlowRunHistoriesTitle",i)}).finally(function(){e.flowRunList.spinner.show=!1,e.context.onInit()})},e.prototype.initializeFlowRunsTileMobileBanner=function(){var e=this,t=this.loggingService.profileStart(l.ProfilingEventNames.currentUserDetailsLoadStart);this.context.userAccountDefinition.then(function(i){e.loggingService.profileEnd(t,l.ProfilingEventNames.currentUserDetailsLoadEnd,{status:l.Status.Success}),i&&i.data&&i.data.properties&&(null===i.data.properties.mobileRegistrationTime||void 0===i.data.properties.mobileRegistrationTime)&&(e.telemetry.tagEvent(s.TelemetryEventNames.MobileBannerInRunsTileShown),e.showMobileBanner=!0)}).catch(function(i){e.loggingService.profileEnd(t,l.ProfilingEventNames.currentUserDetailsLoadEnd,{status:u.inferErrorStatus(i),error:u.parseErrorMessage(i)}),e.loggingService.logError("FlowRunsTileCtrl.loadUserDetails",i)})},e.prototype.dismissBanner=function(){this.showMobileBanner=!1},e.$inject=[r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.flowRunsClient,r.default.services.url,r.default.services.logging,r.default.services.telemetry],e}();t.FlowRunsTileCtrl=d},function(e,t){},function(e,t){e.exports='<property-tile model="flowRunsTileCtrl.flowRunsTile" class="flow-runs-tile"> <tile-banner-template> <div class="mobile-banner" ng-if="flowRunsTileCtrl.showMobileBanner"> <span class="mobile-banner-warning"> <svg svg-src="{{flowRunsTileCtrl.iconUrl}}"></svg> </span> <span class="mobile-banner-message">{{flowRunsTileCtrl.clientResources.FlowPropertyTile.FlowRunsMobileBanner.Message}} <a target="_blank" href="{{flowRunsTileCtrl.appSettings.portalMobileLearnMoreLink}}" class="mobile-banner-prompt">{{flowRunsTileCtrl.clientResources.FlowPropertyTile.FlowRunsMobileBanner.Prompt}}</a> </span> <span class="mobile-banner-dismiss c-glyph glyph-close option-block" ng-click="flowRunsTileCtrl.dismissBanner()"></span> </div> </tile-banner-template> <tile-content-template> <flow-run-list model="flowRunsTileCtrl.flowRunList" ng-if="flowRunsTileCtrl.flowRunList"></flow-run-list> </tile-content-template> </property-tile>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(925);i(926);var o=function(){function e(){this.template=i(927),this.bindings={modalDialog:"="},this.controller=n.FlowSaveAsDialogCtrl,this.controllerAs="flowSaveAsDialogCtrl"}return e}();t.FlowSaveAsDialog=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.flowSaveAsDialog,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(0),o=i(19),s=i(1),a=i(71),l=i(18),c=i(10),u=i(15),p=i(36),d=i(14),g=i(23),m=i(4),f=i(7),h=i(6),v=i(3);!function(e){e[e.Initializing=0]="Initializing",e[e.InitFailed=1]="InitFailed",e[e.ConnectionWizard=2]="ConnectionWizard",e[e.SavingDialog=3]="SavingDialog"}(r||(r={}));var y=function(){function e(e,t,i,n,s,a,l,u,p,g,m){var h=this;this.$q=e,this.$scope=t,this.appSettings=i,this.clientResources=n,this.connectionsClient=s,this.flowsClient=a,this.loggingService=l,this.policiesService=u,this.promiseHelperService=p,this.sessionService=g,this.telemetryService=m,this.flowNameMaxLength=d.FlowNameMaxLength,this.state=r.Initializing,this.savingDialogDescription="",this.creatingConnectionDescription="",this.updatedConnectionReferences=null,this.saveActionButton={label:this.clientResources.Dialogs.FlowSaveAs.Save,action:function(){h.onSave()},primary:!0,disabled:!0},this.cancelActionButton={label:this.clientResources.Common.Cancel,action:function(){h.onCancel()}},this.savingDialogButtons=[this.saveActionButton,this.cancelActionButton],this.showButtonActionProgressSpinner=!1,this.errorAlert={type:c.AlertType.None,message:"",options:{}},this.loadingSpinner={size:f.SpinnerSize.Large,local:f.SpinnerPosition.Global,show:!0},this.onConnectionReferencesResolved=function(e){h.updatedConnectionReferences=o.getUpdatedFlowConnectionReferences(e,h.flow),h.connectionsClient.refreshQuery(),h.prepareToShowSavingDialog()},this.modalDialog.disableDefaultStyles=!0,this.flow=this.flowsClient.get(this.$scope,{id:this.modalDialog.flowId}),this.connectionsClient.refreshQuery().then(function(){h.connections=h.connectionsClient.query(t)}).then(function(){return h.$q.all([h.flow.$promise,h.connections.$promise]).then(function(){o.isAnyFlowConnectionNotInGivenConnections(h.flow,h.connections)?h.prepareToShowConnectionWizard():h.prepareToShowSavingDialog()}).catch(function(e){h.state=r.InitFailed,h.loggingService.logError("FlowSaveAsDialogCtrl.Constructor",e),h.showErrorMessage(e)})})}return e.prototype.prepareToShowConnectionWizard=function(){this.designerCreateConfigParameters={connectionsPromise:this.$q.resolve(this.connections),downloadDesignerScriptsPromise:this.downloadDesignerScripts(),designerConfig:this.createCustomizedDesignerConfig(this.flow)},this.connectionReferencesForConnectionDisambiguationComponent=o.getFlowConnectionReferencesNotUsingGivenConnections(this.flow,this.connections),this.creatingConnectionDescription=1===Object.keys(this.connectionReferencesForConnectionDisambiguationComponent).length?this.clientResources.Dialogs.FlowSaveAs.CreateConnectionDescription:this.clientResources.Dialogs.FlowSaveAs.CreateConnectionsDescription,this.state=r.ConnectionWizard},e.prototype.prepareToShowSavingDialog=function(){this.flowDisplayName=this.getNewFlowDefaultDisplayName(),this.isCoauthoredFlow=o.isCoauthoredFlow(this.flow),this.savingDialogDescription=this.isCoauthoredFlow?s.format(this.clientResources.Dialogs.FlowSaveAs.TeamFlowDescription,this.clientResources.Manage.Flows.MyFlows):s.format(this.clientResources.Dialogs.FlowSaveAs.PersonalFlowDescription,this.clientResources.Manage.Flows.MyFlows),this.saveActionButton.disabled=!1,this.state=r.SavingDialog},e.prototype.createCustomizedDesignerConfig=function(e){var t=this,i={};return i.prefetchedData={connectionProviders:o.containsConnectionReferences(this.flow)?Object.keys(this.flow.properties.connectionReferences).map(function(e){return t.flow.properties.connectionReferences[e].apiDefinition}):null},i.canAddOperation=function(e){return new Promise(function(i){t.$scope.$apply(function(){if(!o.isPremiumConnection(e))return void i(!0);t.policiesService.checkShouldShowFreePlanDialog().then(function(e){i(e)})})})},i.connectionWizardUIConfig={defaultAccountDisplayName:this.sessionService.getUserInfo().displayName,hideConnectionWizardHeader:!0},i},e.prototype.downloadDesignerScripts=function(){return this.promiseHelperService.toAngularPromise(p.loadDesignerScripts(this.appSettings,this.loggingService))},e.prototype.onCancel=function(){this.hideModalDialog(),this.telemetryService.tagEvent(h.TelemetryEventNames.FlowSaveAsDialogCancelButtonClicked,null,{originalFlowName:this.flow.name,isTeamFlow:this.isCoauthoredFlow})},e.prototype.onSave=function(){var e=this;this.showButtonActionProgressSpinner=!0,this.setAllButtonsDisabledState(!0),this.saveActionButton.label=this.clientResources.Dialogs.FlowSaveAs.Saving,this.telemetryService.tagEvent(h.TelemetryEventNames.FlowSaveAsDialogSaveButtonClicked,null,{originalFlowName:this.flow.name,isTeamFlow:this.isCoauthoredFlow});var t=this.loggingService.profileStart(m.ProfilingEventNames.saveAsFlowStart);this.$q.when(this.flowDisplayName).then(function(t){o.validateFlowDisplayName(t,e.clientResources)}).then(function(){return e.flowsClient.post({id:l.getNewFlowId()},e.getNewFlowDefinition())}).then(function(i){if(!l.isFlowCreationSuccess(i)){throw new u.ClientError(u.ErrorCodes.flowSaveAsFailed,e.clientResources.Error.FlowSaveAsFailed,null,{responseStatusCode:i&&i.status,responseData:i&&i.data})}e.flowsClient.refreshQuery(l.getFlowsQueryParams({isPersonal:!0})),e.loggingService.profileEnd(t,m.ProfilingEventNames.saveAsFlowEnd,{status:v.Status.Success,newFlowName:i.data.name,originalFlowName:e.flow.name,isTeamFlow:e.isCoauthoredFlow}),e.modalDialog.show=!1}).catch(function(i){e.loggingService.profileEnd(t,m.ProfilingEventNames.saveAsFlowEnd,{status:v.inferErrorStatus(i),error:v.parseErrorMessage(i),originalFlowName:e.flow.name,isTeamFlow:e.isCoauthoredFlow}),e.loggingService.logError("flowSaveAsDialogCtrl.onSave",i),e.showErrorMessage(i)}).finally(function(){e.setAllButtonsDisabledState(!1),e.saveActionButton.label=e.clientResources.Dialogs.FlowSaveAs.SaveAs,e.showButtonActionProgressSpinner=!1})},e.prototype.getNewFlowDefinition=function(){var e={properties:{}},t=a.getConnectionReferencesOfFlowFormat(this.updatedConnectionReferences||this.flow.properties.connectionReferences);return e.properties.displayName=this.flowDisplayName,e.properties.state=g.FlowState.stopped,e.properties.connectionReferences=t,e.properties.definition=angular.copy(this.flow.properties.definition),e},e.prototype.getNewFlowDefaultDisplayName=function(){return this.flow&&this.flow.properties&&this.flow.properties.displayName&&this.clientResources.Dialogs.FlowSaveAs.DefaultNamePrefix+this.flow.properties.displayName},e.prototype.setAllButtonsDisabledState=function(e){this.savingDialogButtons.forEach(function(t){t.disabled=e})},e.prototype.showErrorMessage=function(e){this.errorAlert.type=c.AlertType.Error,this.errorAlert.message=v.parseErrorMessage(e,this.clientResources.Common.SomethingWentWrong)},e.prototype.isInputReadOnly=function(){return this.state===r.InitFailed},e.prototype.hideModalDialog=function(){this.modalDialog.show=!1},e.$inject=[n.default.services.$q,n.default.services.$scope,n.default.services.appSettings,n.default.services.clientResources,n.default.services.connectionsClient,n.default.services.flowsClient,n.default.services.logging,n.default.services.policies,n.default.services.promiseHelperService,n.default.services.session,n.default.services.telemetry],e}();t.FlowSaveAsDialogCtrl=y},function(e,t){},function(e,t){e.exports='<section class="section-flow-save-as-dialog"> <modal-dialog model="flowSaveAsDialogCtrl.modalDialog"> <custom-dialog-content-template> <div class="flow-save-as-dialog-content"> <a role="button" aria-label="Cancel" ng-click="flowSaveAsDialogCtrl.hideModalDialog()" href="" class="c-glyph glyph-close ng-modal-close"></a> <div class="dialog-loading-content" ng-if="flowSaveAsDialogCtrl.state === 0"> <spinner model="flowSaveAsDialogCtrl.loadingSpinner"></spinner> </div> <div class="connection-disambiguation-content" ng-if="flowSaveAsDialogCtrl.state === 2"> <p class="c-paragraph-2 create-connection-description">{{flowSaveAsDialogCtrl.creatingConnectionDescription}}</p> <connection-disambiguation connection-references="flowSaveAsDialogCtrl.connectionReferencesForConnectionDisambiguationComponent" designer-create-config-parameters="flowSaveAsDialogCtrl.designerCreateConfigParameters" on-connection-references-resolved="flowSaveAsDialogCtrl.onConnectionReferencesResolved" on-connection-disambiguation-loaded="flowSaveAsDialogCtrl.onConnectionDisambiguationLoaded"> </connection-disambiguation> </div> <div class="dialog-saving-content" ng-if="flowSaveAsDialogCtrl.state === 3 || flowSaveAsDialogCtrl.state === 1"> <h1 class="c-subheading-1">{{flowSaveAsDialogCtrl.clientResources.Dialogs.FlowSaveAs.Header}}</h1> <p class="c-paragraph-2 flow-save-as-description">{{flowSaveAsDialogCtrl.savingDialogDescription}}</p> <form ng-submit="!flowSaveAsDialogCtrl.isInputReadOnly() && flowSaveAsDialogCtrl.onSave()"> <input type="text" class="c-text-field flow-name-input" ng-model="flowSaveAsDialogCtrl.flowDisplayName" title="{{flowSaveAsDialogCtrl.flowDisplayName}}" ng-readonly="flowSaveAsDialogCtrl.isInputReadOnly()" maxlength="{{flowSaveAsDialogCtrl.flowNameMaxLength}}" placeholder="{{flowSaveAsDialogCtrl.clientResources.Flow.FlowNamePlaceholder.Text}}" aria-label="{{flowSaveAsDialogCtrl.clientResources.Dialogs.FlowSaveAs.FlowNameInputLabel}}"> </form> <alert model="flowSaveAsDialogCtrl.errorAlert"></alert> <dialog-buttons buttons="flowSaveAsDialogCtrl.savingDialogButtons" show-spinner="flowSaveAsDialogCtrl.showButtonActionProgressSpinner"></dialog-buttons> </div> </div> <custom-dialog-content-template> </custom-dialog-content-template></custom-dialog-content-template></modal-dialog> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(929);i(930);var o=function(){function e(){this.controller=n.PopularTriggersCtrl,this.controllerAs="popularTriggersCtrl",this.template=i(931)}return e}();t.PopularTriggers=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.popularTriggers,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(3),o=i(4),s=i(7),a=function(){function e(e,t,i,r,a,l){var c=this;this.$scope=e,this.apiOperationsService=t,this.clientResources=i,this.loggingService=r,this.navigationService=a,this.urlService=l,this.spinner={size:s.SpinnerSize.Large,show:!0,local:s.SpinnerPosition.LocalHorizontal};var u=this.loggingService.profileStart(o.ProfilingEventNames.flowPopularTriggersStart);t.getPopularTriggers(e).then(function(e){c.popularTriggers=e,c.loggingService.profileEnd(u,o.ProfilingEventNames.flowPopularTriggersStart,{count:e.length})}).catch(function(e){c.loggingService.profileEnd(u,o.ProfilingEventNames.flowPopularTriggersStart,{status:n.inferErrorStatus(e),error:n.parseErrorMessage(e)}),c.loggingService.logWarning("PopularTriggersCtrl.constructor","Failed to fetch popular triggers, navigating to new flow page",e),c.navigationService.navigate(c.urlService.newFlowsRoute())}).finally(function(){c.spinner.show=!1})}return e.$inject=[r.default.services.$scope,r.default.services.apiOperationsService,r.default.services.clientResources,r.default.services.logging,r.default.services.navigation,r.default.services.url],e}();t.PopularTriggersCtrl=a},function(e,t){},function(e,t){e.exports='<div class="popular-triggers-component"> <div class="row"> <div class="column"> <spinner model="popularTriggersCtrl.spinner"></spinner> <p ng-if="!popularTriggersCtrl.spinner.show" class="c-heading-6">{{popularTriggersCtrl.clientResources.Flow.New.GettingStarted.Description}}</p> <api-operation-card-list cards="popularTriggersCtrl.popularTriggers" ng-if="!popularTriggersCtrl.spinner.show"></api-operation-card-list> </div> </div> <div class="row c-footer"> <div class="column"> <p>{{popularTriggersCtrl.clientResources.Flow.New.GettingStarted.FooterOr}}</p> <a ng-href="{{popularTriggersCtrl.urlService.newFlowFullPath()}}" class="c-hyperlink c-action-trigger c-glyph glyph-search-reverse" data-event-name="FlowGettingStartedSearchAllTriggersAndServices"> {{popularTriggersCtrl.clientResources.Flow.New.GettingStarted.SearchAllTriggersAndServices}} </a> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(933);i(934);var o=function(){function e(){this.template=i(935),this.bindings={model:"="},this.transclude={tileBannerTemplate:"?tileBannerTemplate",tileContentTemplate:"tileContentTemplate"},this.controller=n.PropertyTileCtrl}return e}();t.PropertyTile=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.propertyTile,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e,t){this.clientResources=e,this.navigationService=t}return e.prototype.showAllClick=function(e){this.model.showAllAction&&this.model.showAllAction(e),this.model.showAllLink&&this.navigationService.navigate(this.model.showAllLink,this.model.searchParameters)},e.$inject=[r.default.services.clientResources,r.default.services.navigation],e}();t.PropertyTileCtrl=n},function(e,t){},function(e,t){e.exports='<div class="property-tile"> <div ng-transclude="tileBannerTemplate"></div> <div class="tile-header" ng-if="$ctrl.model.title"> <h1 class="tile-title">{{$ctrl.model.title}}</h1> <button class="tile-see-all" ng-click="$ctrl.showAllClick($event)" ng-show="$ctrl.model.showAll"> <span>{{$ctrl.clientResources.FlowPropertyTile.SeeAll}}</span> <span class="c-glyph glyph-arrow"></span> </button> </div> <div ng-transclude="tileContentTemplate"></div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(937);i(938);var o=function(){function e(){this.controller=n.RecommendTemplatesCtrl,this.template=i(939),this.bindings={flowName:"="},this.controllerAs="recommendTemplatesCtrl"}return e}();t.RecommendTemplates=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.recommendTemplates,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(47),o=i(7),s=i(6),a=i(20),l=i(32),c=function(){function e(e,t,i,r,n,s){this.$sce=e,this.$scope=t,this.appSettings=i,this.clientResources=r,this.urlService=n,this.telemetry=s,this.recommendedTemplatesSpinner={size:o.SpinnerSize.Small,show:!1,local:o.SpinnerPosition.LocalHorizontal},this.showRecommendedTemplates=!1,this.renderRecommendedTemplates()}return e.prototype.renderRecommendedTemplates=function(){var e=this;if(this.appSettings.featureFlags.recommendTemplatesInPublishPage){this.recommendedTemplatesSpinner.show=!0;var t="";if(this.appSettings.isWidgetPage){var i=this.urlService.getWidgetQueryStringParameters(a.getCurrentEnvironmentName());t=""+l.createQueryString(i)}n.getRecommendedTemplatesViewForPublishFlow(this.flowName,t,function(t){e.recommendedTemplatesHtml=e.$sce.trustAsHtml(t+"<script>$(window).trigger('resize');<\/script>")}).fail(function(t){e.showRecommendedTemplates=!1}).always(function(){e.recommendedTemplatesSpinner.show=!1,e.$scope.$digest()})}},e.prototype.publishFlowRecommendedTemplatedSeeMoreClick=function(){this.telemetry.tagEvent(s.TelemetryEventNames.PublishFlowRecommendedTemplateSeeMoreClicked)},e.$inject=[r.default.services.$sce,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.url,r.default.services.telemetry],e}();t.RecommendTemplatesCtrl=c},function(e,t){},function(e,t){e.exports='<div class="recommended-templates row" ng-bind-html="recommendTemplatesCtrl.recommendedTemplatesHtml"></div> <section class="context-template-recommended" ng-show="recommendTemplatesCtrl.recommendedTemplatesSpinner.show"> <div class="row"> <div class="column x-type-center"> <spinner model="recommendTemplatesCtrl.recommendedTemplatesSpinner"></spinner> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(941);i(943);var o=function(){function e(){this.template=i(944),this.bindings={inputData:"=",onCancel:"<",onDone:"<",onRender:"<",onFlowRunRequestCompletion:"<",onFlowRunRequestError:"<",onFlowRunRequestStart:"<"},this.controller=n.RunFlowContentCtrl,this.controllerAs="runFlowContentCtrl"}return e}();t.RunFlowContent=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.runFlowContent,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(0),o=i(19),s=i(942),a=i(8),l=i(1),c=i(71),u=i(46),p=i(15),d=i(36),g=i(95),m=i(10),f=i(4),h=i(3),v=i(1),y=i(7),w=i(6),C=i(14);!function(e){e[e.NotSpecified=0]="NotSpecified",e[e.ShowConnections=1]="ShowConnections",e[e.ShowInputs=2]="ShowInputs",e[e.ShowCompleted=3]="ShowCompleted"}(r||(r={}));var S=function(){function e(e,t,i,r,n,o,s,a,l,u,p,d,g,v,w,C,S,b,P,R,T,E,A,D){var F=this;this.$http=e,this.$q=t,this.$sce=i,this.$scope=r,this.appSettings=n,this.connectionsClient=o,this.clientResources=s,this.designerConfigService=a,this.environmentService=l,this.fileReader=u,this.flowRolesClient=p,this.flowRunsClient=d,this.flowsClient=g,this.geocodeService=v,this.graphService=w,this.installFlowService=C,this.locationService=S,this.loggingService=b,this.policiesService=P,this.promiseHelperService=R,this.sessionService=T,this.telemetryService=E,this.urlService=A,this.userConsentService=D,this.inputParameterEmails={},this.runFlowActionButton={label:this.clientResources.Dialogs.RunFlow.Button.RunFlow,action:function(){return F.onRunFlow()},primary:!0},this.cancelActionButton={label:this.clientResources.Dialogs.RunFlow.Button.Cancel,action:function(){return F.handleCancel(F.flow)}},this.runFlowContentButtons=[this.runFlowActionButton,this.cancelActionButton],this.flowRunRequestCompletionButton=[{label:this.clientResources.Dialogs.RunFlow.Button.Done,action:function(){return F.handleDone(F.flow)}}],this.flowDetailsLoadingSpinner={size:y.SpinnerSize.Large,local:y.SpinnerPosition.Global,show:!1},this.errorAlert={type:m.AlertType.None,message:"",options:{}},this.filePickerConfigs={},this.connectionReferences={},this.enableDesignerCallBack=!0,this.enableOnRenderEvent=!0,this.onImportFile=function(e,t){var i=F.loggingService.profileStart(f.ProfilingEventNames.runFlowInputContentFileReadStart,{flowName:F.flowName,fileName:e.name});F.fileReader(e).asText().then(function(r){F.inputParameters[t].value=r,F.loggingService.profileEnd(i,f.ProfilingEventNames.runFlowInputContentFileReadEnd,{flowName:F.flowName,fileName:e.name})}).catch(function(t){F.loggingService.logError("RunFlowContentCtrl.onImportFile",t),F.loggingService.profileEnd(i,f.ProfilingEventNames.runFlowInputContentFileReadEnd,{status:h.inferErrorStatus(t),error:h.parseErrorMessage(t),flowName:F.flowName,fileName:e.name})})},this.onClickingContinue=function(e){F.userConsentService.consentIfNecessary().then(function(){F.enableDesignerCallBack&&(F.enableDesignerCallBack=!1,F.installFlow(F.flow,c.getConnectionReferencesOfFlowFormat(e))),F.showInputs()})},this.onConnectionDisambiguationLoaded=function(e){return F.handleOnRender(),null},this.$scope.$watch(function(){return F.inputData},function(){F.promiseHelperService.toAngularPromise(F.sessionService.getUserSessionAsync()).then(function(){return F.handleInputDataChange()})}),this.$scope.$watchCollection(function(){var e=F.inputParameters||{};return Object.keys(e).map(function(t){return e[t].value})},function(){F.readyToRun()})}return e.prototype.handleInputDataChange=function(){var e=this;if(this.inputData&&this.inputData.flowId){this.resetState();var t=this.loggingService.profileStart(f.ProfilingEventNames.runFlowInputContentLoadStart,{flowId:this.inputData.flowId}),i=l.generateGuid();this.getFlowRequestId=i;var r=this.flowsClient.get(this.$scope,{id:this.inputData.flowId});this.connectionsClient.refreshQuery().then(function(){e.connections=e.connectionsClient.query(e.$scope)}).then(function(){return e.$q.all([r.$promise,e.connections.$promise])}).then(function(){if(a.equalsIgnoreCase(e.getFlowRequestId,i)){if(!o.containsTrigger(r))throw new p.ClientError(p.ErrorCodes.flowNotRunnable,l.format(e.clientResources.RunFlow.FlowNotRunnable,r.properties.displayName),null,{flowName:e.flowName,flowUserType:e.flowUserType,triggerName:e.flowTriggerName});e.updateFlowDetails(r),e.handleInvokerConnections(r);var n=o.containsLocationParametersInSchema(r);if(e.isAdditionalInputNeededWithoutLocationParams=o.containsTriggerWithAdditionalInputsThatAreNotLocationParameters(r),e.isAdditionalInputNeededWithoutLocationParams?(e.loadAdditionalInputParameters=!0,e.actionNameTriggeringConsent=e.clientResources.UserConsent.Continue):e.actionNameTriggeringConsent=e.clientResources.Dialogs.RunFlow.Button.RunFlow,n&&!e.appSettings.featureFlags.enableGeolocationConversion)return e.geocodeService.getCoordinates();if(n&&e.appSettings.featureFlags.enableGeolocationConversion)return e.locationService.getLocationInfo()}else e.loggingService.profileEnd(t,f.ProfilingEventNames.runFlowInputContentLoadEnd,{status:h.Status.Abort});return null}).then(function(i){i&&(e.locationInfo=i,e.loadAdditionalInputParameters=!0),e.inputParameters=e.createInputParameters(r),e.enableAllButtons(),e.loggingService.profileEnd(t,f.ProfilingEventNames.runFlowInputContentLoadEnd,{status:h.Status.Success,flowName:e.flowName,flowUserType:e.flowUserType,triggerName:e.flowTriggerName})}).catch(function(i){e.loggingService.profileEnd(t,f.ProfilingEventNames.runFlowInputContentLoadEnd,{status:h.inferErrorStatus(i),error:h.parseErrorMessage(i),flowName:e.flowName,flowUserType:e.flowUserType,triggerName:e.flowTriggerName}),e.loggingService.logError("RunFlowContentCtrl.HandleInputDataChange",i),e.errorAlert.type=m.AlertType.Error,e.errorAlert.message=h.parseErrorMessage(i,e.clientResources.Common.SomethingWentWrong),e.handleFlowRunRequestError(i)}).finally(function(){e.flowDetailsLoadingSpinner.show=!1})}},e.prototype.updateFlowDetails=function(e){var t=this;this.flow=e,this.flowDisplayName=o.getFlowDisplayName(e),this.flowName=o.getFlowName(e),this.flowImageRenderHtml=this.$sce.trustAsHtml(u.getIconsTemplate(u.getIconInfoForFlow(e),!1)),this.flowTriggerName=o.getTrigggerName(e),this.flowUserType=o.getFlowUserType(e),this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(){t.sessionService.isConsumerDomain||t.createOwnerDisplayNames(t.flowName)})},e.prototype.createOwnerDisplayNames=function(e){var t=this;this.flowRolesClient.query(this.$scope,{flowName:e,roleName:g.FlowRoles.owners}).$promise.then(function(e){var i=e.map(function(e){return e.properties.principal.id}).filter(function(e){return"e2b15e41-dd46-4bb4-8366-e85fc527b5f9"!==e});return t.graphService.getObjectsByObjectId(i)}).then(function(e){var i=e.map(function(e){return e.displayName});t.allOwnerDisplayNames=l.format(t.clientResources.RunFlow.Owners,i.join(", ")),t.visibleOwnerDisplayNames=l.format(t.clientResources.RunFlow.Owners,i.slice(0,2).join(", ")),e.length>2&&(t.visibleOwnerDisplayNames=t.visibleOwnerDisplayNames.concat(" +"+(e.length-2)))}).catch(function(e){t.loggingService.logError("runFlowContentCrl.createOwnerDisplayNames",e),t.visibleOwnerDisplayNames=null,t.allOwnerDisplayNames=null})},e.prototype.handleInvokerConnections=function(e){this.hasInvokerConnections=o.containsInvokerConnectionReferences(e),this.hasInvokerConnections&&(this.connectionReferences=o.getInvokerConnectionReferences(e),this.initDesignerCreateConfigParameters(e)),o.isFlowInstalled(e)?(this.showInputs(),this.handleOnRender()):this.hasInvokerConnections?this.showConnections():(this.installFlow(e),this.showInputs(),this.handleOnRender())},e.prototype.downloadDesignerScripts=function(){return this.promiseHelperService.toAngularPromise(d.loadDesignerScripts(this.appSettings,this.loggingService))},e.prototype.showInputs=function(){this.pageState=r.ShowInputs},e.prototype.showConnections=function(){this.pageState=r.ShowConnections},e.prototype.readyToRun=function(){this.inputParameters&&(this.runFlowActionButton.disabled=!this.AreInputParamsValid(this.inputParameters))},e.prototype.AreInputParamsValid=function(e){return Object.keys(e).every(function(t){return!e[t].isRequired||!v.isNullOrWhitespace(e[t].value)})},Object.defineProperty(e.prototype,"shouldShowConnections",{get:function(){return this.pageState===r.ShowConnections},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowInputs",{get:function(){return this.pageState===r.ShowInputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowCompleted",{get:function(){return this.pageState===r.ShowCompleted},enumerable:!0,configurable:!0}),e.prototype.initDesignerCreateConfigParameters=function(e){this.designerCreateConfigParameters={connectionsPromise:this.$q.resolve(this.connections),downloadDesignerScriptsPromise:this.downloadDesignerScripts(),designerConfig:this.createCustomizedDesignerConfig(e)}},e.prototype.createCustomizedDesignerConfig=function(e){var t=this,i={};return i.prefetchedData={connectionProviders:o.containsInvokerConnectionReferences(e)?Object.keys(this.connectionReferences).map(function(e){return t.connectionReferences[e].api}):null},i.canAddOperation=function(e){return new Promise(function(i){t.$scope.$apply(function(){if(!o.isPremiumConnection(e))return void i(!0);t.policiesService.checkShouldShowFreePlanDialog().then(function(e){i(e)})})})},i.connectionWizardUIConfig={defaultAccountDisplayName:this.sessionService.getUserInfo().displayName,hideConnectionWizardHeader:!0},i},e.prototype.installFlow=function(e,t){var i=this;this.installFlowService.installFlow(e,t).then(function(){return i.flowsClient.refresh({id:e.id})}).then(function(){return i.flowsClient.get(i.$scope,{id:e.id}).$promise}).then(function(e){i.flow=e}).catch(function(e){i.loggingService.logError("RunFlowContentCtrl.installFlow",e),i.enableDesignerCallBack=!0})},e.prototype.createInputParameters=function(e){var t=this,i={},r=o.getUserInputParameterSchema(e),n=!1;return r&&r.required&&r.required.forEach(function(e){var a=r.properties[e],c={};c.labelId=l.generateGuid(),c.isImplicit=o.isLocationParameterKey(e),c.isImplicit?(c.value=t.getLocationParameterValue(e),n=!0):(c.type=s.getInputParameterType(a),c.title=s.getInputParameterTitle(a,e),c.description=s.getInputParameterDescription(a)),c.isRequired=!0,c.type===s.InputParameterType.Enum&&(c.enumOptions=a.enum),c.type===s.InputParameterType.Email&&(t.inputParameterEmails[e]=[]),c.type===s.InputParameterType.File&&(t.filePickerConfigs[e]={inputData:e,textFieldPlaceHolder:c.description,onFileSelection:t.onImportFile}),c&&(!o.isLocationParameterKey(e)||t.appSettings.featureFlags.enableGeolocationConversion&&o.isLocationParameterKey(e))&&(i[e]=c)}),n&&!this.appSettings.featureFlags.enableGeolocationConversion&&(i[C.LocationParameterKeys.latitude]={isImplicit:!0,value:this.getLocationParameterValue(C.LocationParameterKeys.latitude)},i[C.LocationParameterKeys.longitude]={isImplicit:!0,value:this.getLocationParameterValue(C.LocationParameterKeys.longitude)}),i},e.prototype.getLocationParameterValue=function(e){if(this.locationInfo)switch(e){case C.LocationParameterKeys.city:return this.locationService.getCity(this.locationInfo);case C.LocationParameterKeys.countryOrRegion:return this.locationService.getCountryOrRegion(this.locationInfo);case C.LocationParameterKeys.fullAddress:return this.locationService.getFullAddress(this.locationInfo);case C.LocationParameterKeys.latitude:return this.locationService.getLatitude(this.locationInfo);case C.LocationParameterKeys.longitude:return this.locationService.getLongitude(this.locationInfo);case C.LocationParameterKeys.postalCode:return this.locationService.getPostalCode(this.locationInfo);case C.LocationParameterKeys.state:return this.locationService.getState(this.locationInfo);case C.LocationParameterKeys.street:return this.locationService.getStreet(this.locationInfo)}return null},e.prototype.onRunFlow=function(){var e=this;this.telemetryService.tagEvent(w.TelemetryEventNames.RunFlowContentRunFlowButtonClicked,null,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName,flowTriggerUri:this.flow.properties.flowTriggerUri}),this.disableAllButtons(),this.showProgressSpinner=!0,this.runFlowActionButton.label=this.clientResources.Dialogs.RunFlow.Button.Running;var t=this.loggingService.profileStart(f.ProfilingEventNames.runFlowRequestStart,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName,flowTriggerUri:this.flow.properties.flowTriggerUri});this.handleFlowRunRequestStart(),this.userConsentService.consentIfNecessary().then(function(){return e.promiseHelperService.toAngularPromise(e.sessionService.getToken(e.appSettings.authResource))}).then(function(t){return e.$http({method:"POST",url:e.flow.properties.flowTriggerUri,data:e.getRequestBody(e.inputParameters),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}})}).then(function(i){if(!(i&&200===i.status||202===i.status))throw new p.ClientError(p.ErrorCodes.flowRunRequestFailed,l.format(e.clientResources.RunFlow.BadRequest,e.flow.properties.displayName),null,{flowName:e.flowName,flowTriggerUri:e.flow.properties.flowTriggerUri,method:"RunFlowContentCtrl.onRunFlow",responseStatusCode:i&&i.status,responseData:i&&i.data});e.loggingService.profileEnd(t,f.ProfilingEventNames.runFlowRequestEnd,{status:h.Status.Success,flowName:e.flowName,flowUserType:e.flowUserType,triggerName:e.flowTriggerName,flowTriggerUri:e.flow.properties.flowTriggerUri}),e.handleFlowRunRequestCompletion(e.flow)}).catch(function(i){e.loggingService.profileEnd(t,f.ProfilingEventNames.runFlowRequestEnd,{status:h.inferErrorStatus(i),error:h.parseErrorMessage(i),flowName:e.flowName,flowUserType:e.flowUserType,triggerName:e.flowTriggerName,flowTriggerUri:e.flow.properties.flowTriggerUri}),e.loggingService.logError("RunFlowContentCtrl.onRunFlow",i),e.errorAlert.type=m.AlertType.Error,e.errorAlert.message=h.parseErrorMessage(i,e.clientResources.Common.SomethingWentWrong),e.handleFlowRunRequestError(i)}).finally(function(){e.showProgressSpinner=!1,e.runFlowActionButton.label=e.clientResources.Dialogs.RunFlow.Button.RunFlow,e.enableAllButtons()})},e.prototype.getRequestBody=function(e){var t=this.constructRequestBodyParameters(this.inputParameters);return o.containsRequestApiConnectionTrigger(this.flow)?this.generateRequestBodyWithImplicitData(t,this.inputData.implicitData):JSON.stringify(t)},e.prototype.generateRequestBodyWithImplicitData=function(e,t){var i=this,r=[],n={};return t&&t.length>0?t.forEach(function(t){i.flow.properties&&i.flow.properties.triggerSchema&&i.flow.properties.triggerSchema.properties&&i.flow.properties.triggerSchema.properties.rows&&(t={entity:t}),r.push(_.merge(t,e))}):r.push(e),n.rows=r,JSON.stringify(n)},e.prototype.constructRequestBodyParameters=function(e){var t=this,i={};return Object.keys(e||{}).forEach(function(r){var n=r.split("."),o=e[r].value;i=t.constructRequestBodyFormat(i,n,o)}),i},e.prototype.constructRequestBodyFormat=function(e,t,i){return 1===t.length?e[t[0]]=i:(e[t[0]]=e[t[0]]||{},e[t[0]]=this.constructRequestBodyFormat(e[t[0]],t.slice(1),i)),e},e.prototype.handleCancel=function(e){this.telemetryService.tagEvent(w.TelemetryEventNames.RunFlowContentCancelButtonClicked,null,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName}),this.onCancel&&this.onCancel(e)},e.prototype.onEmailAdd=function(e,t,i,r){!v.isEmpty(r.value)&&(this.inputParameterEmails[i]||[]).map(function(e){return e.model.mail}).indexOf(e.model.mail)>-1||(this.inputParameterEmails[i]=(this.inputParameterEmails[i]||[]).concat(e),r.value=this.inputParameterEmails[i].map(function(e){return e.model.mail}).join(","))},e.prototype.onEmailDelete=function(e,t,i){this.inputParameterEmails[t]=(this.inputParameterEmails[t]||[]).filter(function(t){return!a.equalsIgnoreCase(t.model.mail,e.model.mail)}),i.value=this.inputParameterEmails[t].map(function(e){return e.model.mail}).join(",")},e.prototype.handleDone=function(e){this.telemetryService.tagEvent(w.TelemetryEventNames.RunFlowContentDoneButtonClicked,null,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName}),this.onDone&&this.onDone(e)},e.prototype.handleFlowRunRequestStart=function(){this.onFlowRunRequestStart&&this.onFlowRunRequestStart()},e.prototype.handleFlowRunRequestCompletion=function(e){this.pageState=r.ShowCompleted,this.isUserTypeFlow=o.isUserTypeFlow(e),this.flowRunHistoryUrl=this.getFlowRunHistoryUrl(e),this.flowRunsClient.refreshQuery({flowName:o.getFlowName(e)}),this.onFlowRunRequestCompletion&&this.onFlowRunRequestCompletion(e)},e.prototype.handleFlowRunRequestError=function(e){this.onFlowRunRequestError&&this.onFlowRunRequestError(e)},e.prototype.getFlowRunHistoryUrl=function(e){return this.urlService.flowRunsFullPath({flowName:o.getFlowName(e),environmentName:this.environmentService.getCurrentEnvironmentName()})},e.prototype.enableAllButtons=function(){this.runFlowContentButtons.forEach(function(e){e.disabled=!1})},e.prototype.disableAllButtons=function(){this.runFlowContentButtons.forEach(function(e){e.disabled=!0})},e.prototype.resetState=function(){this.flowDetailsLoadingSpinner.show=!0,this.pageState=r.NotSpecified,this.isAdditionalInputNeededWithoutLocationParams=!1,this.runFlowContentButtons.filter(function(e){return e.primary}).forEach(function(e){return e.disabled=!0}),this.errorAlert.type=m.AlertType.None,this.errorAlert.message="",this.enableOnRenderEvent=!0},e.prototype.handleOnRender=function(){this.onRender&&this.enableOnRenderEvent&&(this.onRender(),this.enableOnRenderEvent=!1)},e.$inject=[n.default.services.$http,n.default.services.$q,n.default.services.$sce,n.default.services.$scope,n.default.services.appSettings,n.default.services.connectionsClient,n.default.services.clientResources,n.default.services.designerConfig,n.default.services.environment,n.default.services.fileReaderHelperService,n.default.services.flowRolesClient,n.default.services.flowRunsClient,n.default.services.flowsClient,n.default.services.geocode,n.default.services.graph,n.default.services.installFlowService,n.default.services.locationService,n.default.services.logging,n.default.services.policies,n.default.services.promiseHelperService,n.default.services.session,n.default.services.telemetry,n.default.services.url,n.default.services.userConsent],e}();t.RunFlowContentCtrl=S},function(e,t,i){"use strict";function r(e,t){return e&&e.title?e.title:t}function n(e){return e&&e.description?e.description:null}function o(e){return this.isInputParameterTypeEnum(e)?c.Enum:this.isInputParameterTypeFile(e)?c.File:this.isInputParameterTypeEmail(e)?c.Email:c.Text}function s(e){return!!(e&&u.equalsIgnoreCase(e.type,"string")&&e.enum&&e.enum.length>0)}function a(e){return!!(e&&u.equalsIgnoreCase(e.type,"object")&&e.properties&&e.properties.contentBytes&&e.properties.name)}function l(e){return!!(e&&u.equalsIgnoreCase(e.type,"string")&&u.equalsIgnoreCase(e.format,"email"))}Object.defineProperty(t,"__esModule",{value:!0});var c,u=i(8);!function(e){e[e.Enum=0]="Enum",e[e.File=1]="File",e[e.Text=2]="Text",e[e.Email=3]="Email"}(c=t.InputParameterType||(t.InputParameterType={})),t.getInputParameterTitle=r,t.getInputParameterDescription=n,t.getInputParameterType=o,t.isInputParameterTypeEnum=s,t.isInputParameterTypeFile=a,t.isInputParameterTypeEmail=l},function(e,t){},function(e,t){e.exports='<div class="run-flow-content" ng-if="runFlowContentCtrl.inputData && runFlowContentCtrl.inputData.flowId"> <div class="flow-details-spinner-container" ng-show="runFlowContentCtrl.flowDetailsLoadingSpinner.show"> <spinner model="runFlowContentCtrl.flowDetailsLoadingSpinner"></spinner> </div> <div class="scroll-content"> <div ng-show="!runFlowContentCtrl.flowDetailsLoadingSpinner.show"> <div ng-show="!runFlowContentCtrl.shouldShowCompleted"> <div class="run-flow-content-header"> <span class="flow-contact-card" ng-if="runFlowContentCtrl.flowImageRenderHtml" ng-bind-html="runFlowContentCtrl.flowImageRenderHtml"></span> <div class="display-name-container"> <p class="c-subheading-4 display-name flow-title" ng-if="runFlowContentCtrl.flowDisplayName" title="{{runFlowContentCtrl.flowDisplayName}}">{{runFlowContentCtrl.flowDisplayName}}</p> <p class="c-paragraph-4 display-name owner-names" ng-if="runFlowContentCtrl.visibleOwnerDisplayNames" title="{{runFlowContentCtrl.allOwnerDisplayNames}}">{{runFlowContentCtrl.visibleOwnerDisplayNames}}</p> </div> </div> <div class="connection-disambiguation" ng-if="runFlowContentCtrl.shouldShowConnections"> <connection-disambiguation connection-references="runFlowContentCtrl.connectionReferences" designer-create-config-parameters="runFlowContentCtrl.designerCreateConfigParameters" on-connection-references-resolved="runFlowContentCtrl.onClickingContinue" on-connection-disambiguation-loaded="runFlowContentCtrl.onConnectionDisambiguationLoaded"> </connection-disambiguation> </div> <div ng-show="runFlowContentCtrl.shouldShowInputs"> <div class="run-flow-content-body"> <div class="additional-inputs-info" ng-if="runFlowContentCtrl.isAdditionalInputNeededWithoutLocationParams && runFlowContentCtrl.loadAdditionalInputParameters"> <div ng-repeat="(key, inputParameter) in runFlowContentCtrl.inputParameters"> <div ng-if="!inputParameter.isImplicit"> <ng-switch on="inputParameter.type"> <label for="{{inputParameter.labelId}}" class="input-label">{{inputParameter.title}} <span ng-show="inputParameter.isRequired" class="context-required-text">*</span></label> <div ng-switch-when="0" class="c-select"> <select id="{{inputParameter.labelId}}" ng-model="inputParameter.value" ng-options="inputOptions for inputOptions in inputParameter.enumOptions"> <option value="" selected="selected" disabled="disabled">{{inputParameter.description}}</option> </select> </div> <file-picker ng-switch-when="1" model="runFlowContentCtrl.filePickerConfigs[key]"/> <div class="c-textarea" ng-switch-when="2"> <textarea id="{{inputParameter.labelId}}" ng-model="inputParameter.value" max-length="2048" ng-attr-placeholder="{{inputParameter.description}}">\r\n                                            </textarea> </div> <div ng-switch-when="3"> <graph-autocomplete class="autocomplete-container" on-select="runFlowContentCtrl.onEmailAdd(value, event, key, inputParameter)" limit="20"/> <email-display items="runFlowContentCtrl.inputParameterEmails[key]" on-email-delete="runFlowContentCtrl.onEmailDelete(item, key, inputParameter)"/> </div> </ng-switch> </div> </div> </div> <span class="no-additional-input-text" ng-if="!runFlowContentCtrl.isAdditionalInputNeededWithoutLocationParams">{{runFlowContentCtrl.clientResources.Dialogs.RunFlow.NoAddionalInputNeeded}}</span> </div> <div class="run-flow-content-footer"> <alert class="alert-container" model="runFlowContentCtrl.errorAlert"></alert> <dialog-buttons buttons="runFlowContentCtrl.runFlowContentButtons" show-spinner="runFlowContentCtrl.showProgressSpinner"/> <button title="{{runFlowContentCtrl.clientResources.RunFlow.EditConnections}}" class="edit-button c-glyph glyph-edit" ng-if="!runFlowContentCtrl.appSettings.isWidgetPage && runFlowContentCtrl.shouldShowInputs && runFlowContentCtrl.hasInvokerConnections" ng-click="runFlowContentCtrl.showConnections()">{{runFlowContentCtrl.clientResources.RunFlow.EditConnections}}</button> </div> </div> </div> </div> <div ng-if="runFlowContentCtrl.shouldShowCompleted"> <div class="flow-run-request-completion-content"> <span class="green-circle-border c-glyph glyph-checkmark"></span> <p class="c-paragraph-1">{{runFlowContentCtrl.clientResources.Dialogs.RunFlow.RunStartedSuccessfully}}</p> <a class="flow-run-activity c-paragraph-3" ng-if="!runFlowContentCtrl.isUserTypeFlow" ng-href="{{runFlowContentCtrl.flowRunHistoryUrl}}" target="_blank">{{runFlowContentCtrl.clientResources.Dialogs.RunFlow.SeeFlowRunActivity}}</a> </div> <div class="flow-run-request-completion-footer"> <dialog-buttons buttons="runFlowContentCtrl.flowRunRequestCompletionButton"/> </div> </div> </div> <section class="widget-footer" ng-if="runFlowContentCtrl.appSettings.isWidgetPage"> <button class="edit-button c-glyph glyph-edit" ng-if="runFlowContentCtrl.shouldShowInputs && runFlowContentCtrl.hasInvokerConnections" ng-click="runFlowContentCtrl.showConnections()">{{runFlowContentCtrl.clientResources.RunFlow.EditConnections}}</button> <widget-consent consent-on-action-name="runFlowContentCtrl.actionNameTriggeringConsent"> </widget-consent> </section> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(946);i(947);var o=function(){function e(){this.template=i(948),this.bindings={modalDialog:"=",flowId:"<"},this.controller=n.RunFlowDialogCtrl,this.controllerAs="runFlowDialogCtrl"}return e}();t.RunFlowDialog=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.runFlowDialog,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.handleCancel=function(){e.hideDialog()},this.modalDialog.show&&this.setRunFlowContentInput()}return e.prototype.setRunFlowContentInput=function(){this.runFlowContentInputData={flowId:this.flowId}},e.prototype.hideDialog=function(){this.modalDialog.show=!1},e}();t.RunFlowDialogCtrl=r},function(e,t){},function(e,t){e.exports='<div class="section-run-flow-dialog"> <modal-dialog model="runFlowDialogCtrl.modalDialog"> <custom-dialog-content-template> <run-flow-content input-data="runFlowDialogCtrl.runFlowContentInputData" on-cancel="runFlowDialogCtrl.handleCancel" on-done="runFlowDialogCtrl.handleCancel"> </run-flow-content> </custom-dialog-content-template> </modal-dialog> <spinner model="runFlowDialogCtrl.spinner"></spinner> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(950);i(951);var o=function(){function e(){this.template=i(952),this.bindings={model:"="},this.controller=n.RunOperationSummaryCtrl,this.controllerAs="runOperationSummaryCtrl"}return e}();t.RunOperationSummary=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.runOperationSummary,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e){this.clientResources=e}return e.$inject=[r.default.services.clientResources],e}();t.RunOperationSummaryCtrl=n},function(e,t){},function(e,t){e.exports='<div class="row run-operation-summary"> <div class="column"> <div class="row"> <div class="column"> <p class="main-title">{{runOperationSummaryCtrl.model.title}}</p> </div> </div> <div class="row title-row"> <div class="column"> <p class="title">{{runOperationSummaryCtrl.clientResources.FlowRun.Operation.FixIt.Title}}</p> </div> </div> <div class="row description-row"> <div class="column"> <p class="description">{{runOperationSummaryCtrl.model.fixDescription}}</p> </div> </div> <div class="row title-row"> <div class="column"> <p class="title">{{runOperationSummaryCtrl.clientResources.FlowRun.Operation.ErrorType.Title}}</p> </div> </div> <div class="row description-row"> <div class="column"> <p class="description">{{runOperationSummaryCtrl.model.errorDescription}}</p> </div> </div> <div ng-if="runOperationSummaryCtrl.model.errorDetails"> <div class="row title-row"> <div class="column"> <p class="title">{{runOperationSummaryCtrl.clientResources.FlowRun.Operation.ErrorDetails.Title}}</p> </div> </div> <div class="row description-row"> <div class="column"> <p class="description">{{runOperationSummaryCtrl.clientResources.FlowRun.Operation.ErrorDetails.Description}}</p> </div> </div> <div class="row multiple-failures-row" ng-if="runOperationSummaryCtrl.model.duplicateFailureCount > 1"> <div class="column small-1 icon-column"> <div class="c-glyph glyph-warning"> </div> </div> <div class="column small-11"> <p class="error-details">{{runOperationSummaryCtrl.model.duplicateFailureCount}} {{runOperationSummaryCtrl.clientResources.FlowRun.Summary.MultipleFailures}}</p> </div> </div> <div class="row error-details-row"> <div class="column"> <p class="error-details">{{runOperationSummaryCtrl.model.errorDetails}}</p> </div> </div> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(954);i(955);var o=function(){function e(){this.bindings={model:"="},this.controller=n.SubmitTemplateCtrl,this.controllerAs="submitTemplateCtrl",this.template=i(956)}return e}();t.SubmitTemplate=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.submitTemplate,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=i(0),o=i(23),s=i(10),a=i(57),l=i(7),c=i(6),u=i(44),p=i(1),d=i(82),g=i(3),m=i(22);!function(e){e[e.Spin=0]="Spin",e[e.RunHistory=1]="RunHistory",e[e.SubmitForm=2]="SubmitForm",e[e.Error=3]="Error",e[e.Success=4]="Success"}(r=t.SubmitTemplateCtrlMode||(t.SubmitTemplateCtrlMode={}));var f=function(){function e(e,t,i,n,o,a,c,u,p,d,g){var m=this;this.$q=e,this.$scope=t,this.appSettings=i,this.clientResources=n,this.dateTimeService=o,this.flowRunsClient=a,this.flowsClient=c,this.logging=u,this.telemetry=p,this.templatePublishService=d,this.urlService=g,this.modeType=r,this.mode=r.Spin,this.paneSpinner={size:l.SpinnerSize.Large,show:!0,local:l.SpinnerPosition.Local},this.formSubmitSpinner={size:l.SpinnerSize.Large,show:!1,local:l.SpinnerPosition.Local},this.errorStatusAlert={type:s.AlertType.Error,message:"",options:{control:{action:function(){return m.onClose()}}}},e.all([this.loadFlowData(),this.loadRunListData()]).then(function(){m.isFlowRunningSuccessfully()?(m.templateTitle=m.flow.properties.displayName,m.templateDescription=m.flow.properties.definition.description,m.templateCategories=m.appSettings.templateCategories.map(function(e){return{id:e.id,name:e.name,selected:!1}}),m.mode=r.SubmitForm):m.mode=r.RunHistory}).catch(function(e){return m.showError(e)})}return Object.defineProperty(e.prototype,"maxTitleLength",{get:function(){return e.maxTitleLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxTitleErrorMessage",{get:function(){return p.format(this.clientResources.Publish.Invalid.Title.Error,e.maxTitleLength)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minDescriptionLength",{get:function(){return e.minDescriptionLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minDescriptionErrorMessage",{get:function(){return p.format(this.clientResources.Publish.Invalid.Description.Error,e.minDescriptionLength)},enumerable:!0,configurable:!0}),e.prototype.isMode=function(e){return this.mode===e},e.prototype.onClose=function(){this.model.show=!1},e.prototype.onSubmit=function(e){var t=this;if(e){this.telemetry.tagEvent(c.TelemetryEventNames.PublishFlowStarted),this.formSubmitSpinner.show=!0;var i=this.templateCategories.filter(function(e){return e.selected}).map(function(e){return e.id});this.templatePublishService.submitToPendingGallery(this.templateTitle,this.templateDescription,i,this.flow).then(function(){return t.mode=r.Success}).catch(function(e){return t.showError(e)})}},e.prototype.loadFlowData=function(){var e=this;return this.flowsClient.get(this.$scope,{id:this.model.flow.id}).$promise.then(function(t){return e.flow=t}).catch(function(t){return e.logging.logError("submitTemplateCtrl.loadFlowData.flowsClient.get",t),e.$q.reject(t)})},e.prototype.loadRunListData=function(){var t=this,i={size:l.SpinnerSize.Small,show:!1},r=this.model.flow.name;this.flowRunsTile={title:this.clientResources.FlowPropertyTile.FlowRunsTile.Title,showAll:!0,showAllLink:this.urlService.flowRunsRoute({flowName:r}),searchParameters:{backUrl:this.urlService.flowDetailsRoute({flowName:r,shared:this.model.isShared})}};var n={flowName:r,$top:e.maxRunHistoryToLoad};return this.flowRunsClient.refreshQuery(n).then(function(){var e=t.flowRunsClient.query(t.$scope,n);return t.flowRunList={id:"flowRuns",filter:u.FilterNames.allRuns,flowName:r,flowTriggerHistoriesWithRun:void 0,flowRuns:e,flowTriggerHistoryFilter:function(e){return!0},flowRunFilter:function(e){return!0},hasMore:function(){return!1},isLoadingMore:!1,spinner:i,loadingMoreSpinner:i,loadNextPage:function(){return m.noop()},showInTile:!0},e.$promise}).catch(function(e){return t.logging.logError("submitTemplateCtrl.loadRunListData.flowRunsClient.query",e),t.$q.reject(e)})},e.prototype.isFlowRunningSuccessfully=function(){var e=d.getDate(this.flow.properties.lastModifiedTime);this.lastModifiedFriendlyTime=this.dateTimeService.getFriendlyTimeSinceString(a.DefaultDateTimeOptions,e);for(var t=0,i=this.flowRunList.flowRuns;t<i.length;t++){var r=i[t];if(d.getDate(r.properties.startTime)<e)break;if(r.properties.status!==o.Status.running)return r.properties.status===o.Status.succeeded||(this.flowRunHistoryError=this.clientResources.TemplateSubmission.Message.LastRunNotSuccessful,!1)}return this.flowRunHistoryError=this.clientResources.TemplateSubmission.Message.NoSuccessSinceModified,!1},e.prototype.showError=function(e){this.errorStatusAlert.message=g.parseErrorMessage(e,this.clientResources.Common.SomethingWentWrong),this.mode=r.Error},e.maxRunHistoryToLoad=10,e.maxTitleLength=65,e.minDescriptionLength=25,e.$inject=[n.default.services.$q,n.default.services.$scope,n.default.services.appSettings,n.default.services.clientResources,n.default.services.dateTime,n.default.services.flowRunsClient,n.default.services.flowsClient,n.default.services.logging,n.default.services.telemetry,n.default.services.templatePublish,n.default.services.url],e}();t.SubmitTemplateCtrl=f},function(e,t){},function(e,t){e.exports='<section class="section-flow-submit-template"> <info-pane pane-title="submitTemplateCtrl.clientResources.TemplateSubmission.Action.Name" expanded="submitTemplateCtrl.model.show" on-close="submitTemplateCtrl.onClose()"> <spinner model="submitTemplateCtrl.paneSpinner" ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.Spin)"></spinner> <div ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.SubmitForm)"> <spinner model="submitTemplateCtrl.formSubmitSpinner" ng-if="submitTemplateCtrl.formSubmitSpinner.show"></spinner> <form name="submitTemplate" ng-submit="submitTemplateCtrl.onSubmit(submitTemplate.$valid)" novalidate> <div> <label for="submitTemplateTitle" class="c-subheading-5">{{submitTemplateCtrl.clientResources.TemplateSubmission.Title.Label}}</label> <input id="submitTemplateTitle" name="title" type="text" class="c-input c-text-field submit-input" ng-model="submitTemplateCtrl.templateTitle" ng-readonly="submitTemplateCtrl.formSubmitSpinner.show" placeholder="{{submitTemplateCtrl.clientResources.TemplateSubmission.Title.Placeholder}}" required="required" ng-maxlength="{{submitTemplateCtrl.maxTitleLength}}"/> <div class="publish-validation" ng-if="submitTemplate.$submitted || submitTemplate.title.$touched"> <p class="publish-error" ng-if="submitTemplate.title.$error.required">{{submitTemplateCtrl.clientResources.Publish.Empty.Title.Error}}</p> <p class="publish-error" ng-if="submitTemplate.title.$error.maxlength">{{submitTemplateCtrl.maxTitleErrorMessage}}</p> </div> </div> <div class="c-textarea"> <label for="submitTemplateDescription" class="c-subheading-5">{{submitTemplateCtrl.clientResources.TemplateSubmission.Description.Label}}</label> <textarea id="submitTemplateDescription" name="description" class="c-input c-textarea f-no-resize" ng-model="submitTemplateCtrl.templateDescription" ng-readonly="submitTemplateCtrl.formSubmitSpinner.show" ng-attr-placeholder="{{submitTemplateCtrl.clientResources.TemplateSubmission.Description.Placeholder}}" required="required" ng-minlength="{{submitTemplateCtrl.minDescriptionLength}}"/>\r\n                    <div class="publish-validation" ng-if="submitTemplate.$submitted || submitTemplate.description.$touched">\r\n                        <p class="publish-error" ng-if="submitTemplate.description.$error.required">{{submitTemplateCtrl.clientResources.Publish.Empty.Description.Error}}</p>\r\n                        <p class="publish-error" ng-if="submitTemplate.description.$error.minlength">{{submitTemplateCtrl.minDescriptionErrorMessage}}</p>\r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    <label class="c-subheading-5">{{submitTemplateCtrl.clientResources.TemplateSubmission.Categories.Label}}</label>\r\n                    <div class="submit-template-categories c-checkbox" ng-repeat="templateCategory in submitTemplateCtrl.templateCategories">\r\n                        <label class="c-label">\r\n                            <input type="checkbox" name="{{templateCategory.id}}" ng-model="templateCategory.selected" ng-disabled="submitTemplateCtrl.formSubmitSpinner.show"/>\r\n                            <span>{{templateCategory.name}}</span>\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                <div class="submit-template-actions">\r\n                    <button class="c-button" ng-click="submitTemplateCtrl.onClose()" ng-disabled="submitTemplateCtrl.formSubmitSpinner.show">{{submitTemplateCtrl.clientResources.TemplateSubmission.Command.Cancel}}</button>\r\n                    <button class="c-button" type="submit" ng-disabled="submitTemplateCtrl.formSubmitSpinner.show">{{submitTemplateCtrl.clientResources.TemplateSubmission.Command.Submit}}</button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n        <div ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.RunHistory)">\r\n            <div>\r\n                <div class="x-type-center">\r\n                    <a class="yellow-warning c-glyph glyph-warning"></a>\r\n                </div>\r\n\r\n                <p>{{submitTemplateCtrl.flowRunHistoryError}}</p>\r\n                <p>{{submitTemplateCtrl.clientResources.TemplateSubmission.Message.LastModifiedTime}} {{submitTemplateCtrl.lastModifiedFriendlyTime}}</p>\r\n            </div>\r\n            <property-tile model="submitTemplateCtrl.flowRunsTile" class="flow-runs-tile">\r\n                <tile-content-template>\r\n                    <flow-run-list model="submitTemplateCtrl.flowRunList"></flow-run-list>\r\n                </tile-content-template>\r\n            </property-tile>\r\n        </div>\r\n        <div class="success-response" ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.Success)">\r\n            <a class="green-circle-border c-glyph glyph-checkmark"></a>\r\n            <p class="c-paragraph-1">{{submitTemplateCtrl.clientResources.TemplateSubmission.Message.Success}}</p>\r\n        </div>\r\n        <div ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.Error)">\r\n            <alert model="submitTemplateCtrl.errorStatusAlert"></alert>\r\n        </div>\r\n    </info-pane>\r\n</section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(958);i(959);var o=function(){function e(){this.template=i(960),this.bindings={createFromTemplateArgs:"=",installFlow:"=",onCreateFlowCompletion:"<",onCreateFlowError:"<",onRender:"<"},this.controller=n.TemplateWidgetCtrl,this.controllerAs="templateWidgetCtrl"}return e}();t.TemplateWidget=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.templateWidget,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(71),o=i(15),s=i(3),a=i(36),l=i(177),c=i(7),u=i(19),p=i(47),d=function(){function e(e,t,i,r,n,o,s,a,u,p,d,g,m,f,h){var v=this;this.$q=e,this.$sce=t,this.$scope=i,this.appSettings=r,this.clientResources=n,this.connectionsClient=o,this.flowsClient=s,this.installFlowService=a,this.loggingService=u,this.promiseHelperService=p,this.policiesService=d,this.sessionService=g,this.templateCreationHelperService=m,this.templatesClient=f,this.userConsentService=h,this.connectionReferences={},this.enableDesignerReferencesResolvedCallback=!0,this.creatingFlowSpinner={size:c.SpinnerSize.Large,local:c.SpinnerPosition.LocalHorizontal,show:!1},this.onConnectionReferenceResolved=function(e){v.enableDesignerReferencesResolvedCallback&&(v.enableDesignerReferencesResolvedCallback=!1,v.createFromTemplateArgs.delegatedAuthorizationSource&&Object.keys(e).forEach(function(t){e[t].source=l.ConnectionSource.Invoker}),v.showConnectionWizard=!1,v.userConsentService.consentIfNecessary().then(function(){return v.createAndInstallFlow(e)}).catch(function(e){v.loggingService.logError("templateWidgetCtrl.onConnectionReferenceResolved",e),v.onCreateFlowError&&v.onCreateFlowError(e)}))},this.onConnectionDisambiguationLoaded=function(e){v.onRender&&v.onRender()},this.$scope.$watch(function(){return v.createFromTemplateArgs},function(){return v.handleCreateFromTemplate(v.createFromTemplateArgs)})}return e.prototype.handleCreateFromTemplate=function(e){var t=this;if(e&&e.templateName){var i=this.getTemplate(e.templateName);this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(){return i}).then(function(e){var i=e.connectionReferences;t.designerCreateConfigParameters={connectionsPromise:t.connectionsClient.query(t.$scope).$promise,downloadDesignerScriptsPromise:t.promiseHelperService.toAngularPromise(a.loadDesignerScripts(t.appSettings,t.loggingService)),designerConfig:t.createCustomizedDesignerConfig(i)},t.connectionReferences=i,t.showConnectionWizard=!0,t.enableDesignerReferencesResolvedCallback=!0}).catch(function(e){t.onCreateFlowError&&t.onCreateFlowError(e)})}},e.prototype.getTemplate=function(e){var t=this,i=p.getTemplateId("public",e);return this.templatesClient.get(this.$scope,{id:i}).$promise.then(function(e){if(!e){var r="Template not found, templateId:"+i;return t.loggingService.logError(o.ErrorCodes.runFlowWidgetTemplateDefinitionEmpty,new Error(r)),t.$q.reject({code:o.ErrorCodes.runFlowWidgetTemplateDefinitionEmpty,message:r})}try{return{definition:e.properties.definition,connectionReferences:e.properties.connectionReferences,definitionSummary:e.properties.definitionSummary}}catch(e){var r="Error loading templateId:"+i+", error:"+e;return t.loggingService.logError(o.ErrorCodes.runFlowWidgetTemplateError,e),t.$q.reject({code:o.ErrorCodes.runFlowWidgetTemplateError,message:"Error loading template, error:"+e})}})},e.prototype.createCustomizedDesignerConfig=function(e){var t=this,i={};return i.prefetchedData={connectionProviders:e?Object.keys(e).map(function(t){return e[t].api}):null},i.canAddOperation=function(e){return new Promise(function(i){t.$scope.$apply(function(){if(!u.isPremiumConnection(e))return void i(!0);t.policiesService.checkShouldShowFreePlanDialog().then(function(e){i(e)})})})},i.connectionWizardUIConfig={defaultAccountDisplayName:this.sessionService.getUserInfo().displayName,hideConnectionWizardHeader:!0},i},e.prototype.createAndInstallFlow=function(e){var t=this;this.creatingFlowSpinner.show=!0;var i;this.templateCreationHelperService.createFlowWithConnectionReferences(this.$scope,this.createFromTemplateArgs.templateName,e,this.createFromTemplateArgs.delegatedAuthorizationSource,JSON.parse(this.appSettings.widgetInfo.templatesSettings.defaultParams)).then(function(r){return i=r.data,t.installFlow?t.installFlowService.installFlow(i,n.getConnectionReferencesOfFlowFormat(e)):t.$q.resolve()}).then(function(){return t.flowsClient.refresh({id:i.id})}).then(function(){return t.flowsClient.get(t.$scope,{id:i.id}).$promise}).then(function(e){t.creatingFlowSpinner.show=!1,t.onCreateFlowCompletion&&t.onCreateFlowCompletion(e.name)}).catch(function(e){s.parseErrorCode(e)===s.errorConstants.outOfBoxTemplateInstanceNotUniqueCode&&e.data&&e.data.error&&e.data.error.extendedData&&e.data.error.extendedData.flowName?t.onCreateFlowCompletion&&t.onCreateFlowCompletion(e.data.error.extendedData.flowName):(t.loggingService.logError("templateWidgetCtrl.createAndInstallFlow",e),t.onCreateFlowError&&t.onCreateFlowError(e))})},e.$inject=[r.default.services.$q,r.default.services.$sce,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.connectionsClient,r.default.services.flowsClient,r.default.services.installFlowService,r.default.services.logging,r.default.services.promiseHelperService,r.default.services.policies,r.default.services.session,r.default.services.templateCreationHelper,r.default.services.templatesClient,r.default.services.userConsent],e}();t.TemplateWidgetCtrl=d},function(e,t){},function(e,t){e.exports='<div class="template-widget-component"> <div class="flow-details-spinner-container" ng-show="templateWidgetCtrl.creatingFlowSpinner.show"> <spinner model="templateWidgetCtrl.creatingFlowSpinner"></spinner> </div> <div class="templateWidget"> <div class="connection-disambiguation" ng-if="templateWidgetCtrl.showConnectionWizard"> <connection-disambiguation connection-references="templateWidgetCtrl.connectionReferences" designer-create-config-parameters="templateWidgetCtrl.designerCreateConfigParameters" on-connection-references-resolved="templateWidgetCtrl.onConnectionReferenceResolved" on-connection-disambiguation-loaded="templateWidgetCtrl.onConnectionDisambiguationLoaded"> </connection-disambiguation> </div> </div> <widget-consent consent-on-action-name="templateWidgetCtrl.clientResources.UserConsent.Continue"> </widget-consent> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(962);i(963);var o=function(){function e(){this.template=i(964),this.controller=n.WidgetConsentCtrl,this.bindings={consentOnActionName:"="},this.controllerAs="widgetConsentCtrl"}return e}();t.WidgetConsent=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.widgetConsent,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(1),o=function(){function e(e,t,i,r){this.appSettings=e,this.clientResources=t,this.sessionService=i,this.userConsentService=r}return Object.defineProperty(e.prototype,"termsAndConditionsHtml",{get:function(){return n.format(this.clientResources.UserConsent.TermsAndConditions.Text,this.consentOnActionName,this.userConsentService.termsAndConditionsLink)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"flowAdvertisementHtml",{get:function(){var e='<a href="'+this.appSettings.portalUrl+'" target="_blank">'+this.clientResources.Common.MicrosoftFlow+"</a>";return n.format(this.clientResources.UserConsent.PoweredByFormat,e)},enumerable:!0,configurable:!0}),e.$inject=[r.default.services.appSettings,r.default.services.clientResources,r.default.services.session,r.default.services.userConsent],e}();t.WidgetConsentCtrl=o},function(e,t){},function(e,t){e.exports='<div class="widget-consent"> <section class="integrated-consent" ng-if="widgetConsentCtrl.userConsentService.shouldShowIntegratedConsent()"> <div class="c-checkbox" ng-show="widgetConsentCtrl.userConsentService.isCheckboxShown"> <label class="c-label email-consent-input"> <input ng-model="widgetConsentCtrl.userConsentService.isEmailOptedIn" type="checkbox"> <span>{{widgetConsentCtrl.userConsentService.getPromotionalEmailText()}}</span> </label> </div> <div class="fine-print terms-and-conditions" ng-bind-html="widgetConsentCtrl.termsAndConditionsHtml"></div> </section> <div class="fine-print" ng-bind-html="widgetConsentCtrl.flowAdvertisementHtml"></div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(966);i(967);var o=function(){function e(){this.template=i(968),this.controller=n.ZeroActivitiesCtrl,this.controllerAs="zeroActivitiesCtrl"}return e}();t.ZeroActivities=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.zeroActivities,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(0),o=i(37),s=function(){function e(e,t,i,n,o,s){this.$window=e,this.clientResources=t,this.navigationService=i,this.telemetryService=n,this.appSettings=o,this.urlService=s,this.image=r.default.activitiesZero}return e.prototype.createFromBlank=function(){this.telemetryService.tagEvent(o.TelemetryEventNames.CreateFlowStarted,{source:"Manage Activity - Zero Activity"}),this.navigationService.navigate(this.urlService.newFlowsRoute())},e.prototype.browseTemplates=function(){this.telemetryService.tagEvent(o.TelemetryEventNames.BrowseTemplatesClicked,{source:"Manage Activity - Zero Activity"}),this.$window.location.href="/"+this.appSettings.locale+"/templates/"},e.$inject=[n.default.services.$window,n.default.services.clientResources,n.default.services.navigation,n.default.services.telemetry,n.default.services.appSettings,n.default.services.url],e}();t.ZeroActivitiesCtrl=s},function(e,t){},function(e,t){e.exports='<div class="context-manage-zeroactivities"> <div class="row"> <div class="column medium-4 medium-offset-4"> <img cdn-src="{{zeroActivitiesCtrl.image}}" alt="{{zeroActivitiesCtrl.clientResources.Manage.Activity.Zero.Heading}}"/> </div> </div> <div class="row"> <div class="column medium-8 medium-offset-2"> <h2>{{zeroActivitiesCtrl.clientResources.Manage.Activity.Zero.Heading}}</h2> <p class="c-paragraph-1">{{zeroActivitiesCtrl.clientResources.Manage.Activity.Zero.Description}}</p> </div> </div> <div class="row"> <div class="column medium-3 medium-offset-3"> <button class="c-button" ng-click="zeroActivitiesCtrl.createFromBlank()">{{zeroActivitiesCtrl.clientResources.Manage.Flows.ZeroFlowsCreateNew}}</button> </div> <div class="column medium-3"> <button class="c-button btn btn-primary" ng-click="zeroActivitiesCtrl.browseTemplates()">{{zeroActivitiesCtrl.clientResources.Manage.Flows.ZeroFlowsBrowseTemplates}}</button> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(970);i(971);var o=function(){function e(){this.template=i(972),this.controller=n.ZeroFlowRunsCtrl,this.controllerAs="zeroFlowRunsCtrl",this.bindings={filter:"="}}return e}();t.ZeroFlowRuns=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.zeroFlowRuns,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(0),o=i(44),s=function(){function e(e){this.filter===o.FilterNames.failedRuns?(this.image=r.default.flowsZeroFailures,this.heading=e.FlowRun.No.Failure.Heading,this.description=e.FlowRun.No.Failure.Description):(this.image=r.default.flowsZeroRuns,this.heading=e.FlowRun.No.Runs.Heading,this.description=e.FlowRun.No.Runs.Description)}return e.$inject=[n.default.services.clientResources],e}();t.ZeroFlowRunsCtrl=s},function(e,t){},function(e,t){e.exports='<div class="context-manage-zeroflowruns"> <div class="row"> <div class="column medium-4 medium-offset-4"> <img cdn-src="{{zeroFlowRunsCtrl.image}}" alt="{{zeroFlowRunsCtrl.zeroFlowRunsHeading}}"/> </div> </div> <div class="row"> <div class="column medium-6 medium-offset-3"> <h2 class="c-heading-1">{{zeroFlowRunsCtrl.heading}}</h2> <p class="c-paragraph-1">{{zeroFlowRunsCtrl.description}}</p> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(974);i(975);var o=function(){function e(){this.template=i(976),this.bindings={flowName:"<"},this.controller=n.ZeroFlowRunsSlideInPaneCtrl,this.controllerAs="zeroFlowRunsSlideInPaneCtrl"}return e}();t.ZeroFlowRunsSlideInPane=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.zeroFlowRunsSlideInPane,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(10),o=i(15),s=i(1),a=i(83),l=i(197),c=i(82),u=i(19),p=i(46),d=i(18),g=i(217),m=i(4),f=i(7),h=i(3),v=i(155),y=i(19),w=function(){function e(){}return e}(),C=function(){function e(e,t,i,r,n,o,s,a){this.$scope=e,this.clientResources=t,this.dateTimeService=i,this.flowConnectionsClient=r,this.flowTriggerHistoriesClient=n,this.flowTriggerClient=o,this.flowsClient=s,this.loggingService=a,this.showSlideInPane=!0,this.paneSpinner={size:f.SpinnerSize.Large,show:!0,local:f.SpinnerPosition.Local},this.getFlowTriggerDetails()}return e.prototype.getFlowTriggerDetails=function(){var e=this,t=this.loggingService.profileStart(m.ProfilingEventNames.zeroFlowRunsInfoPaneGetStart);this.flowtriggerDetails=new w,this.paneSpinner.show=!0;var i=this.flowsClient.get(this.$scope,{id:d.getFlowId(this.flowName)});i.$promise.then(function(){var t=i.properties&&i.properties.definition,r=Object.keys(t.triggers);if(r&&r.length>0){var n=u.getTrigggerName(i),s=l.getConnectionReference(n,i);e.flowtriggerDetails.iconUri=p.getIconInfoForOperation(u.getTrigger(i),v.DefaultIcon.Trigger,i.properties.connectionReferences).iconUri,e.flowtriggerDetails.apiDefinitionName=e.getFlowTriggerApiDefinitionDisplayName(s),e.flowtriggerDetails.name=e.getFlowTriggerName(n);var a=t.triggers[n]&&t.triggers[n].recurrence;return e.flowtriggerDetails.frequency=e.getFlowTriggerRecurrence(a),e.flowTriggerClient.get(e.$scope,{id:g.getFlowTriggerId(e.flowName,n)})}throw new o.ClientError(o.ErrorCodes.invalidFlowDefinition,e.clientResources.FlowRuns.Errors.InvalidFlowDefinition,null,{flowName:i.name})}).then(function(e){return e.$refresh().then(function(){return e})}).then(function(t){var r=t.properties,n=r&&r.createdTime;return e.flowtriggerDetails.flowCreationTime=e.dateTimeService.getTimeAtDateTimeString(c.getDate(n)),e.flowtriggerDetails.lastChecked=e.getLastExecutionTime(r),e.flowTriggerHistoriesClient.query(e.$scope,{flowName:i.name,flowTriggerName:u.getTrigggerName(i)}).$promise}).then(function(i){e.flowtriggerDetails.flowStatus=e.getFlowTriggerStatus(i),e.loggingService.profileEnd(t,m.ProfilingEventNames.zeroFlowRunsInfoPaneGetEnd,{status:h.Status.Success})}).catch(function(i){e.loggingService.logError("ZeroFlowRunsSlideInPaneCtrl.getFlowTriggerDetails",i),e.loggingService.profileEnd(t,m.ProfilingEventNames.zeroFlowRunsInfoPaneGetEnd,{status:h.Status.Failure}),e.showErrorAlert(h.parseErrorMessage(i,e.clientResources.Common.SomethingWentWrong))}).finally(function(){e.paneSpinner.show=!1})},e.prototype.showErrorAlert=function(e){this.statusAlert.type=n.AlertType.Error,this.statusAlert.message=e},e.prototype.getFlowTriggerRecurrence=function(e){var t=e&&e.frequency,i=e.interval,r=a.getDateTimeUnits(this.clientResources,!1),n=a.getDateTimeUnitToDisplay(r,t,i);return s.format(this.clientResources.FlowRun.No.Runs.TriggerFrequency.Description,i,n)},e.prototype.getFlowTriggerApiDefinitionDisplayName=function(e){var t=e&&e.apiDefinition&&e.apiDefinition.properties&&e.apiDefinition.properties.displayName;return t?s.format(this.clientResources.FlowRun.No.Runs.TriggerKind.Text,t):null},e.prototype.getFlowTriggerName=function(e){return s.format(this.clientResources.FlowRun.No.Runs.TriggerName.Text,u.getTrigggerDisplayName(e))},e.prototype.getFlowTriggerStatus=function(e){var t=e.filter(function(e){return y.isSuccessful(e)});return 0===e.length?this.clientResources.FlowRun.No.Runs.NeverRun:0===t.length?this.clientResources.FlowRun.No.Runs.Trigger.Failed:this.clientResources.FlowRun.No.Runs.Trigger.Succeeded},e.prototype.getLastExecutionTime=function(e){var t=e&&e.lastExecutionTime;return t?this.dateTimeService.getTimeAtDateTimeString(c.getDate(t)):this.clientResources.FlowRun.No.Runs.NeverRun},e.$inject=[r.default.services.$scope,r.default.services.clientResources,r.default.services.dateTime,r.default.services.flowConnectionsClient,r.default.services.flowTriggerHistoriesClient,r.default.services.flowTriggersClient,r.default.services.flowsClient,r.default.services.logging],e}();t.ZeroFlowRunsSlideInPaneCtrl=C},function(e,t){},function(e,t){e.exports='<spinner model="zeroFlowRunsSlideInPaneCtrl.paneSpinner"></spinner> <div class="zero-flow-runs-pane-content" ng-if="!zeroFlowRunsSlideInPaneCtrl.paneSpinner.show"> <div class="pane-section"> <h1 class="pane-heading">{{zeroFlowRunsSlideInPaneCtrl.clientResources.FlowRun.No.Runs.CreatedOn}}</h1> <p class="pane-subheading">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.flowCreationTime}}</p> </div> <div class="pane-section"> <h1 class="pane-heading">{{zeroFlowRunsSlideInPaneCtrl.clientResources.FlowRun.No.Runs.Status}}</h1> <p class="pane-subheading">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.flowStatus}}</p> </div> <div class="pane-section"> <h1 class="pane-heading trigger-details-label">{{zeroFlowRunsSlideInPaneCtrl.clientResources.FlowRun.No.Runs.TriggerDetails}}</h1> <div class="info-card-item row"> <div class="info-card-icon"> <img ng-attr-src="{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.iconUri}}"/> </div> <div class="info-card-text-section column medium-6 small-6"> <h1 class="pane-heading">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.apiDefinitionName}}</h1> <p class="pane-subheading info-card-subtitle">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.name}}</p> </div> </div> </div> <div class="pane-section"> <h1 class="pane-heading">{{zeroFlowRunsSlideInPaneCtrl.clientResources.FlowRun.No.Runs.TriggerFrequency.Label}}</h1> <p class="pane-subheading">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.frequency}}</p> </div> <div class="pane-section"> <h1 class="pane-heading">{{zeroFlowRunsSlideInPaneCtrl.clientResources.FlowRun.No.Runs.LastRun}}</h1> <p class="pane-subheading">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.lastChecked}}</p> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(978);i(979);var o=function(){function e(){this.template=i(980),this.controller=n.ZeroFlowsCtrl,this.controllerAs="zeroFlowsCtrl"}return e}();t.ZeroFlows=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.zeroFlows,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(0),o=i(10),s=i(70),a=i(123),l=i(3),c=i(7),u=i(37),p=i(18),d=i(47),g=function(){function e(e,t,i,n,s,a,l,u,p,d,g,m,f,h,v,y,w,C,S,b){var P=this;this.$q=e,this.$sce=t,this.$scope=i,this.$window=n,this.apisClient=s,this.appSettings=a,this.clientResources=l,this.connectionHelper=u,this.connectionsClient=p,this.environmentService=d,this.flowsClient=g,this.logging=m,this.navigationService=f,this.navigationHelperService=h,this.templateCreationHelper=v,this.promiseHelperService=y,this.sessionService=w,this.telemetryService=C,this.templatesClient=S,this.urlService=b,this.oneClickTemplateAddButtonSelector=".template-item .content a.c-button",this.disabledButtonClass="disabled-button",this.dataEventTemplateNameAttribute="data-event-templatename",this.oneClickTemplateAddButtonOnClick=null,this.zeroFlowsImage=r.default.flowsZero,this.widgetCreateButtonsEnabled=!1,this.oneClickHeroTemplatesSpinner={size:c.SpinnerSize.Large,show:!1,local:c.SpinnerPosition.LocalHorizontal},this.errorAlert={type:o.AlertType.None,message:"",options:{}},this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).finally(function(){P.widgetCreateButtonsEnabled=!0}),this.renderOneClickHeroTemplates()}return e.prototype.createFromBlank=function(){this.telemetryService.tagEvent(u.TelemetryEventNames.CreateFlowStarted,{source:"Manage Flows - Zero Flows"}),this.navigationHelperService.navigateToNewBlankFlow()},e.prototype.browseTemplates=function(){this.telemetryService.tagEvent(u.TelemetryEventNames.BrowseTemplatesClicked,{source:"Manage Flows - Zero Flows"}),this.navigationHelperService.navigateToBrowseTemplates()},e.prototype.getMatchingConnectionReference=function(e,t){var i=new RegExp("^"+e+"/"),r=t.filter(function(e){return i.test(e.id)});return r.length>0?r[0]:void 0},e.prototype.shouldDisableCreateLinks=function(){return this.appSettings.isWidgetPage&&!this.widgetCreateButtonsEnabled},e.prototype.getMatchingApi=function(e,t){var i=new RegExp("^"+e+"$"),r=t.filter(function(e){return i.test(e.id)});return r.length>0?r[0]:void 0},e.prototype.updateOperationRuntimeUrl=function(e,t,i){var r=this;if(i){if(i.type===s.FlowTemplateOperationType.If){var n=$.extend({},i.actions,(i.else||{}).actions);Object.keys(n).forEach(function(i){r.updateOperationRuntimeUrl(e,t,n[i])})}if(!a.isNativeOperation(i)&&i.inputs&&i.inputs.host&&i.inputs.host.api){var o=i.inputs.host.api.runtimeUrl,l="shared_"+o.substr(o.lastIndexOf("/")+1);e===l&&(i.inputs.host.api.runtimeUrl=t.api.properties.primaryRuntimeUrl)}}},e.prototype.shouldRenderOneClickHeroTemplates=function(){return!this.appSettings.isWidgetPage&&this.appSettings.featureFlags.oneClickTemplatesOnZeroFlowsPage},e.prototype.renderOneClickHeroTemplates=function(){var e=this;this.appSettings.featureFlags.oneClickTemplatesOnZeroFlowsPage&&(this.oneClickHeroTemplatesSpinner.show=!0,d.getOneClickHeroTemplatesView(function(t){e.oneClickHeroTemplatesHtml=e.$sce.trustAsHtml(t+"<script>$(window).trigger('resize');<\/script>")}).fail(function(t){e.logging.logError("ZeroFlowsCtrl.Constructor.GetTemplates",t)}).always(function(){e.oneClickHeroTemplatesSpinner.show=!1,e.$scope.$digest()}).then(function(){e.$oneClickTemplateAddButtons=angular.element(""+e.oneClickTemplateAddButtonSelector),e.$oneClickTemplateAddButtons&&e.$oneClickTemplateAddButtons.length>0&&e.registerOneClickTemplateAddButtonHandler()}))},e.prototype.registerOneClickTemplateAddButtonHandler=function(){var e=this;this.oneClickTemplateAddButtonOnClick=function(t){e.oneClickHeroTemplatesSpinner.show=!0,t.preventDefault(),e.$oneClickTemplateAddButtons.addClass(e.disabledButtonClass),e.currentClickedButton=t.currentTarget,e.currentClickedButton.innerText=e.clientResources.OneClick.Adding;var i=e.currentClickedButton.attributes[e.dataEventTemplateNameAttribute].value;e.templateCreationHelper.autoCreateFlow(e.$scope,i).then(function(t){t&&e.navigationService.navigate(e.urlService.flowDetailsRoute({flowName:t,shared:!1}))}).then(function(){return e.flowsClient.refreshQuery(p.getFlowsQueryParams({isPersonal:!0}))}).catch(function(t){return e.showErrorMessage(t)}).finally(function(){return e.oneClickHeroTemplatesSpinner.show=!1})},this.$oneClickTemplateAddButtons.on("click",this.oneClickTemplateAddButtonOnClick)},e.prototype.showErrorMessage=function(e){this.logging.logError("ZeroFlowsCtrl.OneClickTemplateCreate",e),this.errorAlert.type=o.AlertType.Error,this.errorAlert.message=l.parseErrorMessage(e,this.clientResources.Common.SomethingWentWrong),this.currentClickedButton.innerText=this.clientResources.OneClick.Add,this.$oneClickTemplateAddButtons.removeClass(this.disabledButtonClass)},e.$inject=[n.default.services.$q,n.default.services.$sce,n.default.services.$scope,n.default.services.$window,n.default.services.apisClient,n.default.services.appSettings,n.default.services.clientResources,n.default.services.connectionHelper,n.default.services.connectionsClient,n.default.services.environment,n.default.services.flowsClient,n.default.services.logging,n.default.services.navigation,n.default.services.navigationHelper,n.default.services.templateCreationHelper,n.default.services.promiseHelperService,n.default.services.session,n.default.services.telemetry,n.default.services.templatesClient,n.default.services.url],e}();t.ZeroFlowsCtrl=g},function(e,t){},function(e,t){e.exports='<div class="context-manage-zeroflows" ng-if="!zeroFlowsCtrl.shouldRenderOneClickHeroTemplates()"> <div class="row" ng-class="{\'row-isWidgetPage\' : zeroFlowsCtrl.appSettings.isWidgetPage}"> <div class="column medium-6 medium-offset-3"> <img cdn-src="{{zeroFlowsCtrl.zeroFlowsImage}}" alt="{{zeroFlowsCtrl.clientResources.Manage.Flows.ZeroFlows}}"/> </div> </div> <div class="row" ng-class="{\'row-isWidgetPage\' : zeroFlowsCtrl.appSettings.isWidgetPage}"> <div class="column"> <h2>{{zeroFlowsCtrl.clientResources.Manage.Flows.ZeroFlowsHeading}}</h2> <p>{{zeroFlowsCtrl.clientResources.Manage.Flows.ZeroFlowsDescription}}</p> </div> </div> <div class="row" ng-class="{\'row-isWidgetPage\' : zeroFlowsCtrl.appSettings.isWidgetPage}"> <div class="column medium-3 medium-offset-3"> <button class="c-button" ng-disabled="zeroFlowsCtrl.shouldDisableCreateLinks()" ng-click="zeroFlowsCtrl.createFromBlank()">{{zeroFlowsCtrl.clientResources.Manage.Flows.ZeroFlowsCreateNew}}</button> </div> <div class="column medium-3"> <button class="c-button btn btn-primary" ng-disabled="zeroFlowsCtrl.shouldDisableCreateLinks()" ng-click="zeroFlowsCtrl.browseTemplates()">{{zeroFlowsCtrl.clientResources.Manage.Flows.ZeroFlowsBrowseTemplates}}</button> </div> </div> </div> <div class="context-manage-zeroflows-oneclick" ng-if="zeroFlowsCtrl.shouldRenderOneClickHeroTemplates()"> <alert model="zeroFlowsCtrl.errorAlert"></alert> <div class="one-click-templates" ng-bind-html="zeroFlowsCtrl.oneClickHeroTemplatesHtml"></div> <div class="x-type-center one-click-spinner" ng-show="zeroFlowsCtrl.oneClickHeroTemplatesSpinner.show"> <spinner model="zeroFlowsCtrl.oneClickHeroTemplatesSpinner"></spinner> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(176),i(124),i(196),i(201),i(202)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(198),i(983),i(217),i(18),i(47)},function(e,t,i){"use strict";function r(e,t,i){return o.getAppSettings().featureFlags.enableEnvironments?"/providers/Microsoft.ProcessSimple/environments/"+s.getCurrentEnvironmentName()+"/flows/"+e+"/triggers/"+t+"/histories/"+i:"/providers/Microsoft.ProcessSimple/flows/"+e+"/triggers/"+t+"/histories/"+i}Object.defineProperty(t,"__esModule",{value:!0}),i(21);var n=i(0),o=i(9),s=i(20),a=i(14);t.IFlowTriggerHistoriesConstant={urlPath:"/providers/Microsoft.ProcessSimple/flows/:flowName/triggers/:flowTriggerName/histories",urlPathWithEnvironments:"/providers/Microsoft.ProcessSimple/environments/"+s.getCurrentEnvironmentName()+"/flows/:flowName/triggers/:flowTriggerName/histories",resourceType:"/providers/Microsoft.ProcessSimple/flows/triggers/histories"},t.FlowTriggersPollFrequency={listFlowTriggerHistories:6e4,getFlowTriggerHistory:45e3,evictionDelay:3e5},t.getFlowTriggerHistoryId=r,angular.module(n.default.modules.processSimpleData).factory(n.default.services.flowTriggerHistoriesClient,[n.default.services.azureResourceClientFactory,n.default.services.appSettings,n.default.services.environment,function(e,i,r){var n=i.featureFlags.enableEnvironments?t.IFlowTriggerHistoriesConstant.urlPathWithEnvironments:t.IFlowTriggerHistoriesConstant.urlPath,o={urlBase:a.ProcessSimpleResourceProviderManagementEndpoint,urlPath:t.IFlowTriggerHistoriesConstant.urlPathWithEnvironments+"/:flowTriggerHistoryId/resubmit",name:"resubmit",method:"POST",params:{flowName:"@flowName",flowTriggerName:"@flowTriggerName",flowTriggerHistoryId:"@flowTriggerHistoryId"}};return e({apiVersion:i.featureFlags.enableEnvironments?i.processSimpleResourceProviderApiVersionWithEnvironments:i.processSimpleResourceProviderApiVersion,urlPath:n,resourceType:t.IFlowTriggerHistoriesConstant.resourceType,rest:{get:{params:{flowName:"@flowName",flowTriggerName:"@flowTriggerName",id:"@id",$expand:"properties/run/properties"}},query:{lazyPaging:!0,params:{flowName:"@flowName",flowTriggerName:"@flowTriggerName",id:"@id",$expand:"properties/run/properties",$top:40}}},actions:[o],options:{atomize:!1,evictionDelay:t.FlowTriggersPollFrequency.evictionDelay}})}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(985),i(989),i(993),i(997)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(986);i(987);var o=function(){function e(){this.restrict="E",this.template=i(988),this.scope={model:"="},this.controller=n.FlowListDirectiveCtrl,this.controllerAs="controller"}return e}();t.FlowListDirective=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.flowList,[function(){return new o}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(19),n=i(0),o=i(5),s=i(23),a=i(57),l=i(10),c=i(44),u=i(18),p=i(7),d=i(6),g=i(46),m=i(1),f=i(3),h=i(19),v=function(){function e(e,t,i,r,n,o,s,a,l,c,u,d,g,m,f,h,v,y,w){var C=this;this.$q=e,this.$sce=t,this.$scope=i,this.$window=r,this.appSettings=n,this.clientResources=o,this.dateTime=s,this.environmentService=a,this.flowRunService=l,this.flowsClient=c,this.flowTriggerHistoriesClient=u,this.flowTriggerClient=d,this.loggingService=g,this.logicAppTemplateExportService=m,this.navigationService=f,this.policiesService=h,this.telemetry=v,this.trialDialog=y,this.urlService=w,this.spinner={size:p.SpinnerSize.Large,local:p.SpinnerPosition.Local},this.deleteFlowDialog={show:!1},this.runFlowDialog={show:!1,disableDefaultStyles:!0},this.flowSaveAsDialog={show:!1,flowId:null},this.submitTemplatePane={flow:null,isShared:this.$scope.model.isShared,show:!1},this.$scope.model.flows.$watch(this.$scope,function(){C.onLoadComplete()})}return e.prototype.showErrorAlert=function(e,t){this.$scope.model.statusAlert.type=l.AlertType.Error,this.$scope.model.statusAlert.message=e,this.$scope.model.statusAlert.options.link=t},e.prototype.hideErrorAlert=function(){this.$scope.model.statusAlert.type=l.AlertType.None,this.$scope.model.statusAlert.message="",this.$scope.model.statusAlert.options.link=null},e.prototype.changeFlowState=function(e,t){var i=this;e&&e.stopPropagation(),this.hideErrorAlert();var r=this.isFlowStarted(t);this.telemetry.tagEvent(r?d.TelemetryEventNames.StopFlowClicked:d.TelemetryEventNames.StartFlowClicked,{flowName:t.name});var n=t.properties.state;t.properties.state=r?s.FlowState.stopped:s.FlowState.started;var o=r?t.$stop():t.$start();this.$scope.model.flows.$apply(),o.then(function(){i.flowsClient.refresh({id:t.id}),i.flowsClient.refreshQuery(u.getFlowsQueryParams({isPersonal:!i.$scope.model.isShared,isShared:i.$scope.model.isShared}))}).catch(function(e){var r,o=null;f.isDLPViolationError(e)?(r=i.clientResources.Flow.Error.DLPViolation.Message,o=f.dlpViolationLink):r=f.parseErrorMessage(e,i.clientResources.Common.SomethingWentWrong),i.loggingService.logError("FlowListDirectiveCtrl.ChangeFlowState",{name:"ChangeFlowStateError",message:r}),t.properties.state=n,i.$scope.model.flows.$apply(),i.showErrorAlert(r,o)})},e.prototype.viewFlow=function(e){this.telemetry.tagEvent(d.TelemetryEventNames.ViewFlow,e.id),this.hideErrorAlert(),this.appSettings.featureFlags.enableFlowCoauthoring&&r.isCoauthoredFlow(e)?this.navigationService.navigate(this.urlService.flowDetailsRoute({flowName:e.name,shared:!0})):this.navigationService.navigate(this.urlService.flowDetailsRoute({flowName:e.name,shared:!1}))},e.prototype.editFlow=function(e){this.telemetry.tagEvent(d.TelemetryEventNames.UpdateFlowStarted,e.id),this.hideErrorAlert(),this.appSettings.isWidgetPage&&!this.appSettings.featureFlags.enableWidgetEdit?this.handleEditFromWidget(e):this.appSettings.featureFlags.enableFlowCoauthoring&&r.isCoauthoredFlow(e)?this.navigationService.navigate(this.urlService.editSharedFlowRoute({flowName:e.name})):this.navigationService.navigate(this.urlService.editFlowRoute({flowName:e.name}))},e.prototype.removeFromMarkedForDeletion=function(e){this.$scope.model.markedForDeletion.filter(function(t){return t.id!==e.id})},e.prototype.listRuns=function(e){this.telemetry.tagEvent(d.TelemetryEventNames.ListFlowRuns,e.id),this.appSettings.isWidgetPage?this.handleListRunFromWidget(e):this.navigationService.navigate(this.urlService.flowRunsRoute({flowName:e.name}),{filter:c.FilterNames.allRuns})},e.prototype.listFlowOwners=function(e){var t=this;this.policiesService.checkUserCanShareFlows(!1).then(function(i){i?(t.telemetry.tagEvent(d.TelemetryEventNames.ListFlowOwners,e.id),t.navigationService.navigate(t.urlService.flowOwnersRoute({flowName:e.name}))):t.environmentService.isDevEnvironment()?t.trialDialog.showFeatureBlockedOnDeveloperEnvironment():t.trialDialog.showBlockedFeatureStartTrialDialog()})},e.prototype.rowDefaultAction=function(e){this.appSettings.featureFlags.enableFlowProperty?this.viewFlow(e.flow):this.editFlow(e.flow)},e.prototype.getCommandText=function(e){return e.inProgress&&e.inProgressText?e.inProgressText:e.text},e.prototype.isCommandDisabled=function(e){return e.disabled||e.inProgress},e.prototype.isFlowStarted=function(e){return r.isStarted(e)},e.prototype.isFlowDisabled=function(e){return r.isDisabled(e)},e.prototype.getFlowStateCommandText=function(e){return r.getFlowStateCommandText(e,this.clientResources)},e.prototype.getFlowStateText=function(e){return this.isFlowStarted(e)?this.clientResources.Flow.State.on:this.clientResources.Flow.State.off},e.prototype.clickCommand=function(e,t){if(e.stopPropagation(),!this.isCommandDisabled(t)){var i=t.click();i&&i.finally&&(t.inProgress=!0,i.finally(function(){return t.inProgress=!1}))}},e.prototype.onLoadComplete=function(){var e=this,t=this.convertFlowsToRows(this.$scope.model.flows.filter(function(t){return!e.$scope.model.markedForDeletion.some(function(e){return e.id===t.id})}));this.$scope.model.rows=t.sort(function(t,i){return-1*e.dateTime.compareDates(t.lastModified,i.lastModified)})},e.prototype.convertFlowsToRows=function(e){var t=this;return e.map(function(e){return t.createFlowRow(e)})},e.prototype.createFlowRow=function(e){var t=this,i=e.properties.lastModifiedTime?this.dateTime.getFriendlyTimeSinceString(a.DefaultDateTimeOptions,m.getDate(e.properties.lastModifiedTime)):null,n=this.appSettings.featureFlags.enableFlowProperty?{text:this.clientResources.Flow.Commands.EditFlow,iconUrl:"glyph-edit",click:function(){return t.editFlow(e)}}:{text:this.clientResources.Flow.Commands.ListRuns,iconUrl:"glyph-info",click:function(){return t.listRuns(e)}},s=[n];this.appSettings.featureFlags.enableFlowCoauthoring&&(!this.appSettings.isWidgetPage||this.appSettings.isWidgetPage&&this.appSettings.featureFlags.enableWidgetTeamFlows)&&s.push({text:this.clientResources.Flow.Commands.Owners,iconUrl:"glyph-owners",click:function(){return t.listFlowOwners(e)}});var l=[];if(this.isFlowStarted(e)&&h.isRunnableFlow(e)){var c=this.getRunNowCommand(e);l.push(c)}this.appSettings.featureFlags.enableFlowSaveAs&&l.push({text:this.clientResources.Dialogs.FlowSaveAs.SaveAs,iconUrl:"glyph-saveas",click:function(){return t.showFlowSaveAsDialog(e)}}),this.appSettings.featureFlags.enableFlowSubmitTemplateDropDown&&l.push({text:this.clientResources.TemplateSubmission.Action.Name,iconSrc:o.default.submitAsTemplate,click:function(){return t.submitToGallery(e)}});var u=this.getExportCommand(e);u&&l.push(u),l.push({text:this.clientResources.Flow.Commands.Delete,iconUrl:"glyph-delete",click:function(){return t.showDeleteFlowDialog(e)}});var p=angular.copy(s);return p=p.concat(l),p.unshift({text:this.clientResources.Flow.Commands.ChangeStatus,iconUrl:"",click:function(){return t.changeFlowState(null,e)}}),{id:e.id,displayName:e.properties.displayName,friendlyLastModified:this.isFlowDisabled(e)?this.clientResources.Flow.Status.ActivitySuspended:i,lastModified:e.properties.lastModifiedTime,flow:e,isTeamFlow:this.appSettings.featureFlags.enableFlowCoauthoring&&r.isCoauthoredFlow(e)&&!this.$scope.model.isShared,commands:s,commandsInDropDown:l,imageRenderHtml:this.$sce.trustAsHtml(g.getIconsTemplate(g.getIconInfoForFlow(e),!1)),allCommands:p}},e.prototype.getExportCommand=function(e){var t=this;if(!this.policiesService.shouldEnableFlowImportExport()&&!this.policiesService.shouldEnableLogicAppTemplateExport())return null;var i={text:this.clientResources.Common.Export,iconUrl:"glyph-export",click:_.noop,commands:[]};if(this.policiesService.shouldEnableFlowImportExport()&&i.commands.push({text:this.clientResources.Export.Package.MenuItem,click:function(){return t.tryNavigateToExportFlowPage(e)}}),this.policiesService.shouldEnableLogicAppTemplateExport()){var r={text:this.clientResources.Export.Logicapp.MenuItem,click:function(){r.text=t.clientResources.Export.Logicapp.Exporting,t.exportLogicAppTemplate(e).finally(function(){r.text=t.clientResources.Export.Logicapp.MenuItem})}};i.commands.push(r)}return i},e.prototype.getRunNowCommand=function(e){var t=this;return{text:this.clientResources.Flow.Commands.RunNow,iconUrl:"glyph-resubmit",click:function(){return t.showRunFlowDialog(e)}}},e.prototype.showRunFlowDialog=function(e){this.runFlowId=e.id,this.runFlowDialog.show=!0},e.prototype.showDeleteFlowDialog=function(e){this.flowToDelete=e,this.deleteFlowDialog.show=!0},e.prototype.handleEditFromWidget=function(e){var t=this.appSettings.featureFlags.enableEnvironments?this.environmentService.getCurrentEnvironmentName():null,i=this.urlService.editFlowFullPath({flowName:e.name,environmentName:t});this.$window.open(i,"_blank")},e.prototype.handleListRunFromWidget=function(e){var t=this.appSettings.featureFlags.enableEnvironments?this.environmentService.getCurrentEnvironmentName():null,i=this.urlService.flowRunsFullPath({flowName:e.name,environmentName:t});this.$window.open(i,"_blank")},e.prototype.showFlowSaveAsDialog=function(e){this.flowSaveAsDialog.flowId=e.id,this.flowSaveAsDialog.show=!0},e.prototype.submitToGallery=function(e){this.submitTemplatePane.flow=e,this.submitTemplatePane.show=!0},e.prototype.exportLogicAppTemplate=function(e){return this.telemetry.tagEvent(d.TelemetryEventNames.FlowListExportLogicAppTemplateClicked,null,{flowName:e.name}),this.logicAppTemplateExportService.exportTemplate(e)},e.prototype.tryNavigateToExportFlowPage=function(e){this.telemetry.tagEvent(d.TelemetryEventNames.FlowListExportBapPackagedClicked,null,{flowName:e.name}),this.policiesService.shouldShowUpgradeToProDialog()?this.trialDialog.showUpgradeToProRequiredDialog():this.navigationService.navigate(this.urlService.exportFlowsRoute(e.name))},e.$inject=[n.default.services.$q,n.default.services.$sce,n.default.services.$scope,n.default.services.$window,n.default.services.appSettings,n.default.services.clientResources,n.default.services.dateTime,n.default.services.environment,n.default.services.flowRun,n.default.services.flowsClient,n.default.services.flowTriggerHistoriesClient,n.default.services.flowTriggersClient,n.default.services.logging,n.default.services.logicAppTemplateExport,n.default.services.navigation,n.default.services.policies,n.default.services.telemetry,n.default.services.trialDialog,n.default.services.url],e}();t.FlowListDirectiveCtrl=v},function(e,t){},function(e,t){e.exports='<div class="c-table flow-list"> <table class="flows" aria-colcount="4"> <thead> <tr class="row"> <th class="column large-1 medium-2 small-3" aria-label="{{::controller.clientResources.ListHeader.Icon}}"></th> <th class="column large-5 medium-4 small-6">{{::controller.clientResources.ListHeader.Name}}</th> <th class="column large-2 medium-2 small-2">{{::controller.clientResources.ListHeader.LastModified}}</th> <th class="flow-actions column large-4 medium-4 hide-for-small-only" aria-label="{{::controller.clientResources.ListHeader.Actions}}"></th> </tr> </thead> <tbody> <spinner model="controller.spinner"></spinner> <run-flow-dialog ng-if="controller.runFlowDialog.show" modal-dialog="controller.runFlowDialog" flow-id="controller.runFlowId"/> <delete-flow-dialog ng-if="controller.deleteFlowDialog.show" modal-dialog="controller.deleteFlowDialog" flow="controller.flowToDelete"/> <flow-save-as-dialog modal-dialog="controller.flowSaveAsDialog" ng-if="controller.flowSaveAsDialog.show"/> <tr ng-repeat="row in model.rows" ng-hide="controller.spinner.show" class="row"> <td class="column large-1 medium-2 small-3 flow-contact-card-cell" ng-click="controller.rowDefaultAction(row)" role="presentation" aria-label="{{::controller.clientResources.Flow.Labels.Icon}}: {{row.displayName}}"> <div class="flow-contact-card" ng-bind-html="row.imageRenderHtml"></div> </td> <td class="column large-5 medium-4 small-6 flow-name" ng-click="controller.rowDefaultAction(row)" role="link" aria-label="{{::controller.clientResources.Flow.Labels.Name}}: {{row.displayName}}"> <div class="table-cell-name-multiline"> <div>{{row.displayName}}</div> <div class="premium-label-container" ng-show="row.isTeamFlow"> <span class="premium-label"> {{controller.clientResources.Manage.Flows.TeamFlow.Tag}} </span> </div> </div> </td> <td class="column large-2 medium-2 small-2" ng-class="{\'violates-policy\': controller.isFlowDisabled(row.flow)}" ng-click="controller.rowDefaultAction(row)" role="presentation" aria-label="{{::controller.clientResources.Flow.Labels.LastModified}}: {{row.friendlyLastModified}}">{{row.friendlyLastModified}}</td> <td class="column large-4 medium-4 hide-for-small-only f-numerical"> <div class="context-glyph-tile"> <div class="c-toggle" ng-click="controller.changeFlowState($event, row.flow)" tabindex="-1" role="checkbox" aria-label="{{::controller.clientResources.Flow.Labels.StartedCheckbox}}: {{controller.isFlowStarted(row.flow)}}" ng-attr-title="{{controller.getFlowStateCommandText(row.flow)}}: {{row.displayName}}"> <button role="checkbox" aria-checked="{{controller.isFlowStarted(row.flow)}}"></button> <span class="toggle-text">{{controller.getFlowStateText(row.flow)}}</span> </div> <button class="img-button c-glyph" ng-class="[command.iconUrl, {\'disabled\': controller.isCommandDisabled(command)}]" aria-label="{{::controller.clientResources.Flow.Labels.Action}}: {{controller.getCommandText(command)}}" role="button" ng-repeat="command in row.commands" ng-click="controller.clickCommand($event, command)" ng-attr-title="{{controller.getCommandText(command)}}: {{row.displayName}}"> <span class="x-screen-reader">{{controller.getCommandText(command)}}</span> </button> <list-commands model="row.commandsInDropDown" class="command-item"></list-commands> </div> </td> <td class="column small-1 show-for-small-only"> <list-commands model="row.allCommands"></list-commands> </td> </tr> </tbody> </table> <div class="load-more-flows x-type-center" ng-show="!controller.spinner.show && model.rows.length > 0"> <button class="c-button f-transparent" ng-show="model.hasMore() && !model.isLoadingMore" ng-click="model.loadNextPage()">{{::controller.clientResources.List.ShowMore}}</button> </div> <div class="load-more-flows x-type-center"> <spinner model="model.loadingMoreSpinner"></spinner> </div> <submit-template model="controller.submitTemplatePane" ng-if="controller.submitTemplatePane.show"></submit-template> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(990),o=function(){function e(){this.controller=n.FlowDesignerDirectiveCtrl,this.controllerAs="flowDesignerDirectiveCtrl",this.restrict="E",this.scope={context:"=",model:"=",onInit:"&"},this.template=i(992)}return e}();t.FlowDesignerDirective=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.flowDesigner,[function(){return new o}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(15),o=i(36),s=i(39),a=i(1),l=i(8),c=i(19),u=i(58);i(991);var p=function(){function e(e,t,i,r,p,d,g,m,f,h,v,y,w,C,S,b,P,R){var T=this;this.$element=e,this.$q=t,this.$scope=i,this.apisClient=r,this.appSettings=p,this.authenticationService=d,this.clientResources=g,this.connectionsClient=m,this.flowManagementService=f,this.environmentService=h,this.loggingService=v,this.navigationService=y,this.oAuthService=w,this.policiesService=C,this.promiseHelperService=S,this.telemetryService=b,this.trialDialogService=P,this.sessionService=R,this._disposed=!1,this.viewPermissionsDialog={show:!1,buttons:[{label:this.clientResources.Dialogs.ViewPermissions.Button.Close,action:function(){T.viewPermissionsDialog.show=!1},primary:!0}]},this.loadDesigner=function(){var e=T.$element.find(".msla-container")[0],t=o.loadDesignerScripts(T.appSettings,T.loggingService);T.$q.all([T.$scope.onInit(),T.toAngularPromise(t),T.toAngularPromise(T.sessionService.getUserSessionAsync()),T.promiseHelperService.toAngularPromise(u.getVisibleHideKeys(T.apisClient,T.sessionService))]).then(function(t){var i=t[0],r=t[1],n=(t[2],t[3]),s=i||{},a=s.prefetchedData||{},l=r.designercore,u={designercore:l,designerElement:e,appSettings:T.appSettings,telemetryService:T.telemetryService,oAuthService:T.oAuthService,getArmAccessToken:function(){return o.toDesignerPromise(T.authenticationService.getToken(T.appSettings.authResource))},getRuntimeAccessToken:function(){return o.toDesignerPromise(T.authenticationService.getToken(T.appSettings.authResource))},getConsentServerAccessToken:function(){return o.toDesignerPromise(T.authenticationService.getToken(T.appSettings.consentServerAadResourceUri))},prefetchedData:{connections:a.connections,connectionProviders:a.apis},azureADServiceFactory:function(e){return new l.AzureADService(e,T.appSettings.microsoftGraphUrl,function(){return T.authenticationService.getToken(T.appSettings.microsoftGraphResource)})},flowManagementServiceFactory:function(e){return T.flowManagementService.saveFlow=s.onSaveFlow,T.flowManagementService},canAddOperation:function(e){return new Promise(function(t){T.$scope.$apply(function(){if(!c.isPremiumConnection(e))return void t(!0);T.policiesService.checkShouldShowFreePlanDialog().then(function(e){e?T.trialDialogService.showStartFreeTrialDialog(function(e){t(e)}):t(!0)})})})},showViewPermissionsDialog:function(e){T.$scope.$apply(function(){T.connectionProvider=e,T.viewPermissionsDialog.show=!0})},allowCoauthoring:s.allowCoauthoring,showCalloutHints:s.showCalloutHints,flowName:s.flowName,defaultRecurrence:T.policiesService.getDefaultRecurrence(),visibleHideKeys:n.join(",")};T.appSettings.featureFlags.enableEnvironments&&(u.environment={name:T.environmentService.getCurrentEnvironmentName()});var p=o.createDesigner(u);T.designerReady.resolve(p)}).catch(function(e){T.loggingService.logError("FlowDesignerDirectiveCtrl.LoadDesigner",e),T.designerReady.reject(new n.ClientError(n.ErrorCodes.flowsDesignerScriptLoadError,a.format(T.clientResources.FlowDesignerDirectiveBase.DesignerScriptLoadError,e.message),e))})},this.designerReady=t.defer(),i.$on("$destroy",function(){T.connectionReferencesStoreSubscription&&T.connectionReferencesStoreSubscription.unsubscribe(),T.designerReady.promise.then(function(e){e&&!T._disposed&&(T._disposed=!0,e.dispose())})});var E=i.context;E.getDefinition=function(){return T.designerReady.promise.then(function(e){var t=T.$q.defer();try{t.resolve(e.getWorkflow())}catch(e){var i=l.equalsIgnoreCase(s.DESIGNER_INVALID_SKU_ERROR_CODE,e.code)?e:new n.ClientError(n.ErrorCodes.flowsDesignerGetDefinitionError,e.message,e);t.reject(i)}return t.promise})},E.loadTrigger=function(e){return T.designerReady.promise.then(function(t){return T.toAngularPromise(t.loadTrigger(e,{schema:T.appSettings.designer.definitionSchemaUri,contentVersion:"1.0.0.0"}))}).then(function(){return T.render()}).catch(function(e){throw new n.ClientError(n.ErrorCodes.flowsDesignerLoadDefinitionError,e.message,e)})},E.loadDefinition=function(e,t,i){return T.designerReady.promise.then(function(r){var n={definition:e,references:t,properties:{sku:{name:"Standard"}}},o={collapsePopulatedParameters:T.appSettings.featureFlags.designerCollapsePopulatedParameters&&!!i,skipValidation:!!i};return T.toAngularPromise(r.loadWorkflow(n,o)).then(function(){return T.render()})}).catch(function(e){throw new n.ClientError(n.ErrorCodes.flowsDesignerLoadDefinitionError,e.message,e)})},E.getTriggers=function(){return T.designerReady.promise.then(function(e){return e.Data.Triggers})},E.areAllConnectionReferencesValid=!1,E.setReadOnly=function(e){T.designerReady.promise.then(function(t){t.setReadOnly(e)})},E.updateCallbacksOnSave=function(e){T.designerReady.promise.then(function(t){t.updateCallbacksOnSave(e)})},this.loadDesigner()}return e.prototype.render=function(){var e=this;return this.designerReady.promise.then(function(t){if(e.connectionReferencesStoreSubscription=e.getConnectionReferencesStoreSubscription(t.Data.ConnectionReferences),e.validateConnectionReferences(t.Data.ConnectionReferences),e._disposed)throw new n.ClientError(n.ErrorCodes.aborted,e.clientResources.FlowDesignerDirectiveBase.DesignerDisposed,null);t.render(),e.navigationService.confirmNavigateAway(e.$scope,{message:e.clientResources.Flow.Discard.Changes.Message,confirmation:e.clientResources.Flow.Discard.Changes.Confirmation,condition:function(){return t&&t.isWorkflowModified()}})})},e.prototype.toAngularPromise=function(e){var t=this;return this.$q(function(i,r){e.then(function(e){return i(e)}).catch(function(e){t.loggingService.logError("FlowDesignerDirectiveCtrl.LoadDesigner",e),r(e)})})},e.prototype.getConnectionReferencesStoreSubscription=function(e){var t=this;return e.onChanged(function(){var i=t.$scope.context.areAllConnectionReferencesValid;t.cacheNewConnections(e),t.validateConnectionReferences(e),t.$scope.context.areAllConnectionReferencesValid!==i&&t.$scope.$apply()})},e.prototype.cacheNewConnections=function(t){var i=t.getData(),r=this.connectionsClient.query(this.$scope),n=!1;i&&i.forEach(function(t){e.isConnectionReferenceValid(t)&&!r.some(function(e){return l.equalsIgnoreCase(e.id,t.connection.id)})&&(n=!0)}),n&&this.connectionsClient.refreshQuery()},e.prototype.validateConnectionReferences=function(t){var i=t.getData();i&&(this.$scope.context.areAllConnectionReferencesValid=i.map(function(t){return e.isConnectionReferenceValid(t)}).every(function(e){return!0===e}))},e.isConnectionReferenceValid=function(e){return e&&e.connection&&!!e.connection.id},e.$inject=[r.default.services.$element,r.default.services.$q,r.default.services.$scope,r.default.services.apisClient,r.default.services.appSettings,r.default.services.authentication,r.default.services.clientResources,r.default.services.connectionsClient,r.default.services.designerFlowManagementService,r.default.services.environment,r.default.services.logging,r.default.services.navigation,r.default.services.oAuth,r.default.services.policies,r.default.services.promiseHelperService,r.default.services.telemetry,r.default.services.trialDialog,r.default.services.session],e}();t.FlowDesignerDirectiveCtrl=p},function(e,t){},function(e,t){e.exports='<div class="msla-container msla-host-processsimple"></div> <view-permissions-dialog connection-provider="flowDesignerDirectiveCtrl.connectionProvider" modal-dialog="flowDesignerDirectiveCtrl.viewPermissionsDialog"/>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(994);i(995);var o=function(){function e(){this.controller=n.FlowRunListDirectiveCtrl,this.controllerAs="flowRunListDirectiveCtrl",this.restrict="E",this.scope={model:"="},this.template=i(996)}return e}();t.FlowRunListDirective=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.flowRunList,[function(){return new o}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(23),n=i(19),o=i(0),s=i(5),a=i(82),l=i(57),c=function(){function e(e,t,i,r,n,o){var s=this;this.$scope=e,this.appsettings=t,this.clientResources=i,this.dateTimeService=r,this.navigationService=n,this.urlService=o,this.showSlideInPane=!1,this.isWatchingFlowTriggerHistoriesWithRun=!1,this.isWatchingFlowRuns=!1,this.$scope.model.rows=[],this.$scope.$watch("model.flowTriggerHistoriesWithRun",function(e,t){!s.isWatchingFlowTriggerHistoriesWithRun&&s.$scope.model.flowTriggerHistoriesWithRun&&(s.isWatchingFlowTriggerHistoriesWithRun=!0,s.$scope.model.flowTriggerHistoriesWithRun.$watch(s.$scope,function(){s.onFlowTriggerHistoriesWithRunLoadComplete()}))}),this.$scope.$watch("model.flowRuns",function(e,t){!s.isWatchingFlowRuns&&s.$scope.model.flowRuns&&(s.isWatchingFlowRuns=!0,s.$scope.model.flowRuns.$watch(s.$scope,function(){s.onFlowRunsLoadComplete()}))})}return e.prototype.rowDefaultAction=function(e){var t=this.$scope.model.backUrl;n.isFlowCheck(e)?this.navigationService.navigate(this.urlService.flowCheckRoute({flowName:this.$scope.model.flowName,runName:e.name}),{backUrl:t,runStatus:n.getRunStatus(e)}):this.navigationService.navigate(this.urlService.flowRunRoute({flowName:this.$scope.model.flowName,runName:e.name}),{backUrl:t,runStatus:n.getRunStatus(e)})},e.prototype.toggleSlideInPane=function(e){e.stopPropagation(),this.showSlideInPane=!this.showSlideInPane},e.prototype.onFlowRunsLoadComplete=function(){var e=this,t=this.mergeRows(this.$scope.model.rows,this.$scope.model.flowRuns.map(function(t){return e.createFlowRunRow(t)}));this.$scope.model.rows=this.sortRows(this.filterRows(t));var i=this.$scope.model.top;i&&(this.$scope.model.rows=this.$scope.model.rows.slice(0,i))},e.prototype.onFlowTriggerHistoriesWithRunLoadComplete=function(){var e=this,t=this.mergeRows(this.$scope.model.rows,this.$scope.model.flowTriggerHistoriesWithRun.map(function(t){return e.createFlowRunRowFromTriggerHistory(t)}));this.$scope.model.rows=this.sortRows(this.filterRows(t));var i=this.$scope.model.top;i&&(this.$scope.model.rows=this.$scope.model.rows.slice(0,i))},e.prototype.filterRows=function(e){var t=this;return this.$scope.model.flowTriggerHistoriesWithRun?this.$scope.model.flowTriggerHistoryFilter?e.filter(function(e){return t.$scope.model.flowTriggerHistoryFilter(e.triggerHistoryItem)}):e:this.$scope.model.flowRunFilter?e.filter(function(e){return t.$scope.model.flowRunFilter(e.flowRunItem)}):e},e.prototype.mergeRows=function(e,t){var i=e.reduce(function(e,t){return e[t.id]=t,e},{}),r=t.reduce(function(e,t){return e[t.id]=t,e},i);return Object.keys(r).map(function(e){return r[e]})},e.prototype.sortRows=function(e){var t=this;return e.sort(function(e,i){var r=i&&i.flowRunItem&&i.flowRunItem.properties&&i.flowRunItem.properties.startTime||i&&i.triggerHistoryItem&&i.triggerHistoryItem.properties&&i.triggerHistoryItem.properties.startTime,n=e&&e.flowRunItem&&e.flowRunItem.properties&&e.flowRunItem.properties.startTime||e&&e.triggerHistoryItem&&e.triggerHistoryItem.properties&&e.triggerHistoryItem.properties.startTime;return t.dateTimeService.compareDates(r,n)})},e.prototype.createFlowRunRow=function(e){var t=[],i=e.properties.startTime,r=e.properties.endTime;return{flowRunItem:e,commands:t,duration:this.dateTimeService.getFriendlyTimeSinceString(l.DefaultDateTimeOptions,a.getDate(i),r?a.getDate(r):null),endTime:e.properties.endTime,flowRun:e,id:e.id,name:e.name,startTime:this.$scope.model.showInDialog?this.dateTimeService.getTimeAtDateTimeString(a.getDate(i)):this.dateTimeService.getFriendlyTimeSinceString(l.DefaultDateTimeOptions,a.getDate(i)),status:e.properties.status,statusImage:this.getStatusImage(e.properties.status),type:e.type}},e.prototype.getStatusImage=function(e){var t=s.default.statusInfo;switch(e){case r.Status.succeeded:t=s.default.statusSuccess;break;case r.Status.running:t=s.default.statusProgress;break;case r.Status.failed:t=s.default.statusError}return t},e.prototype.createFlowRunRowFromTriggerHistory=function(e){var t=[],i=e.properties.startTime,r=e.properties.endTime,n=e.properties.run&&e.properties.run.properties&&e.properties.run.properties.status||e.properties.status,o=e.properties.run;return o&&(i=o.properties.startTime,r=o.properties.endTime),{flowRunItem:e.properties.run,triggerHistoryItem:e,commands:t,duration:this.dateTimeService.getFriendlyTimeSinceString(l.DefaultDateTimeOptions,a.getDate(i),r?a.getDate(r):null),endTime:e.properties.endTime,flowRun:e,id:e.id,name:e.name,startTime:this.dateTimeService.getFriendlyTimeSinceString(l.DefaultDateTimeOptions,a.getDate(i)),status:n,statusImage:this.getStatusImage(e.properties.status),type:e.type}},e.$inject=[o.default.services.$scope,o.default.services.appSettings,o.default.services.clientResources,o.default.services.dateTime,o.default.services.navigation,o.default.services.url],e}();t.FlowRunListDirectiveCtrl=c},function(e,t){},function(e,t){e.exports='<div class="c-table flow-runs"> <table ng-if="model.rows.length !== 0" ng-class="[{\'tile-row\': !!model.showInTile || !!model.showInDialog}]"> <thead ng-hide="!!model.showInTile"> <tr> <th ng-hide="model.showInDialog">{{flowRunListDirectiveCtrl.clientResources.ListHeader.Status}}</th> <th>{{flowRunListDirectiveCtrl.clientResources.ListHeader.StartTime}}</th> <th>{{flowRunListDirectiveCtrl.clientResources.ListHeader.Duration}}</th> <th></th> </tr> </thead> <tbody> <spinner model="model.spinner"></spinner> <tr ng-repeat="row in model.rows" style="cursor:pointer" ng-click="flowRunListDirectiveCtrl.rowDefaultAction(row)" ng-hide="model.spinner.show"> <td class="text-ellipse" ng-hide="model.showInDialog"> <svg class="status-image" svg-src="{{row.statusImage}}" ng-show="!!model.showInTile"/> {{row.status}} </td> <td class="text-ellipse">{{row.startTime}}</td> <td class="text-ellipse">{{row.duration}}</td> <td> <button class="img-button c-glyph glyph-arrow" aria-label="{{flowRunListDirectiveCtrl.clientResources.FlowRuns.View.FlowRun}}" ng-attr-title="{{flowRunListDirectiveCtrl.clientResources.FlowRuns.View.FlowRun}}" ng-hide="model.showInDialog"/> </td> </tr> </tbody> </table> <div class="load-more" ng-hide="model.spinner.show || model.rows.length === 0 || !!model.showInTile"> <a ng-show="model.hasMore() && !model.isLoadingMore" ng-click="model.loadNextPage()" href="" aria-label="{{flowRunListDirectiveCtrl.clientResources.FlowRuns.AriaLabel.LoadMore}}">{{flowRunListDirectiveCtrl.clientResources.List.ShowMore}}</a> <spinner model="model.loadingMoreSpinner"></spinner> </div> <div ng-if="!model.spinner.show && model.rows.length === 0"> <div ng-if="!model.showInTile"> <zero-flow-runs filter="model.filter"></zero-flow-runs> </div> <div ng-if="!!model.showInTile"> <p class="zero-run-text">{{flowRunListDirectiveCtrl.clientResources.FlowPropertyTile.ZeroFlowRun.Text}} <a class="learn-more-button c-paragraph-3" role="button" aria-label="{{flowRunListDirectiveCtrl.clientResources.FlowPropertyTile.ZeroFlowRun.LearnMoreButton.Text}}" ng-if="flowRunListDirectiveCtrl.appsettings.featureFlags.enableSummaryPaneOnZeroFlowRuns && model.isPollingOrRecurrenceTrigger" ng-click="flowRunListDirectiveCtrl.toggleSlideInPane($event)"> {{flowRunListDirectiveCtrl.clientResources.FlowPropertyTile.ZeroFlowRun.LearnMoreButton.Text}} </a> </p> <info-pane pane-title="flowRunListDirectiveCtrl.clientResources.FlowRun.No.Runs.Pane.Title" expanded="flowRunListDirectiveCtrl.showSlideInPane" ng-if="!!flowRunListDirectiveCtrl.appsettings.featureFlags.enableSummaryPaneOnZeroFlowRuns"> <zero-flow-runs-slide-in-pane flow-name="model.flowName" ng-if="flowRunListDirectiveCtrl.showSlideInPane"></zero-flow-runs-slide-in-pane> </info-pane> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(998),o=function(){function e(){this.controller=n.FlowMonitorDirectiveCtrl,this.controllerAs="flowMonitorCtrl",this.restrict="E",this.scope={context:"=",model:"=",onInit:"&",onLoadComplete:"&",onLoadError:"&"},this.template=i(999)}return e}();t.FlowMonitorDirective=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.flowMonitor,[function(){return new o}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(15),o=i(36),s=i(7),a=i(1),l=i(58),c=function(){function e(e,t,i,r,n,a,c,u,p,d,g,m,f,h){var v=this;this.$element=e,this.$q=t,this.$scope=i,this.apisClient=r,this.appSettings=n,this.authenticationService=a,this.clientResources=c,this.connectionsClient=u,this.runInstanceService=p,this.environmentService=d,this.loggingService=g,this.oAuthService=m,this.sessionService=f,this.telemetryService=h,this._disposed=!1,this.loadMonitor=function(){var e=v.$element.find(".msla-container")[0],t=v.connectionsClient.query(v.$scope);v.$q.all([o.loadDesignerScripts(v.appSettings,v.loggingService),l.getVisibleHideKeys(v.apisClient,v.sessionService)]).then(function(i){var r=i[0],n=i[1],s={designercore:r.designercore,designerElement:e,appSettings:v.appSettings,telemetryService:v.telemetryService,oAuthService:v.oAuthService,getArmAccessToken:function(){return o.toDesignerPromise(v.authenticationService.getToken(v.appSettings.authResource))},getRuntimeAccessToken:function(){return o.toDesignerPromise(v.authenticationService.getToken(v.appSettings.authResource))},getConsentServerAccessToken:function(){return o.toDesignerPromise(v.authenticationService.getToken(v.appSettings.consentServerAadResourceUri))},prefetchedData:{connections:t&&t.length>1?t.toJSON():void 0},runInstanceServiceFactory:function(e){return v.runInstanceService.createDesignerRunInstanceService(v.$scope.model.isFlowCheck)},visibleHideKeys:n.join(",")};v.appSettings.featureFlags.enableEnvironments&&(s.environment={name:v.environmentService.getCurrentEnvironmentName()});var a=o.createDesignerMonitor(s);return a.loadRun(v.$scope.model.flowRunId).then(function(){a.render(),v.monitorReady.resolve(a),v.spinner.show=!1}).catch(function(e){e.code&&e.error&&e.error.message&&"AzureResourceManagerRequestFailed"===e.code&&e.error.message.includes("WorkflowRunNotFound")?(a.render(),v.monitorReady.resolve(a),v.spinner.show=!1):v.handleDesignerLoadError(e)})}).catch(function(e){v.handleDesignerLoadError(e)}).then(function(){v.$scope.onLoadComplete()})},this.monitorReady=this.$q.defer(),this.$scope.$on("$destroy",function(){v.monitorReady.promise.then(function(e){e&&!v._disposed&&(v._disposed=!0,e.dispose())})}),this.$scope.context.refreshRun=function(){var e=v.$scope.model.flowRunId;v.monitorReady.promise.then(function(t){t&&t.refreshRun(e)})},this.spinner={size:s.SpinnerSize.Large,show:!0,local:s.SpinnerPosition.Local},this.$scope.onInit(),this.loadMonitor()}return e.prototype.handleDesignerLoadError=function(e){this.loggingService.logError("FlowDesignerDirectiveCtrl.LoadDesigner",e);var t=a.format(this.clientResources.FlowDesignerDirectiveBase.DesignerScriptLoadError,e.message);this.monitorReady.reject(new n.ClientError(n.ErrorCodes.flowsDesignerScriptLoadError,t,e)),this.spinner.show=!1,this.$scope.model.monitorLoadError=e,this.$scope.onLoadError()},e.$inject=[r.default.services.$element,r.default.services.$q,r.default.services.$scope,r.default.services.apisClient,r.default.services.appSettings,r.default.services.authentication,r.default.services.clientResources,r.default.services.connectionsClient,r.default.services.runInstanceService,r.default.services.environment,r.default.services.logging,r.default.services.oAuth,r.default.services.session,r.default.services.telemetry],e}();t.FlowMonitorDirectiveCtrl=c},function(e,t){e.exports='<div class="msla-container msla-host-processsimple"> <spinner model="flowMonitorCtrl.spinner"></spinner> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1001),i(1002),i(1003),i(1004),i(1005),i(1006),i(1007),i(1008)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(e,t){this.appSettings=e,this.authenticationService=t}return e.prototype.create=function(e){var t=this;return function(i){return new e.AzureADService(i,t.appSettings.microsoftGraphUrl,function(){return t.authenticationService.getToken(t.appSettings.microsoftGraphResource)})}},e.$inject=[r.default.services.appSettings,r.default.services.authentication],e}();t.DesignerAzureADService=n,angular.module(r.default.modules.processSimpleServices).service(r.default.services.designerAzureADService,n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(){}return e}();t.DesignerConnectionService=n,angular.module(r.default.modules.processSimpleServices).service(r.default.services.designerFlowManagementService,n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=function(){function e(){}return e}();t.DesignerFlowManagementService=n,angular.module(r.default.modules.processSimpleServices).service(r.default.services.designerFlowManagementService,n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(12);var r=i(0),n=i(14),o=i(49),s=i(44),a=function(){function e(e,t,i,r,n){this.$http=e,this.$q=t,this.appSettings=i,this.backendService=r,this.environmentService=n}return e.prototype.getDownloadLinkAsyncPollState=function(e){var t=this,i=o.concatParts(this.appSettings.processSimpleResourceProviderManagementEndpoint,this.appSettings.processSimpleResourceProviderPath),r="environments/"+this.environmentService.getCurrentEnvironmentName()+"/flows/"+e.flowName+"/exportRuns",s={method:"POST",url:o.concatParts(i,r),headers:(a={},a[n.HeaderKeys.contentType]=n.MimeTypes.applicationJson,a),params:{"api-version":this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments},data:{statusFilter:this.getStatusFilter(e.filter)}};return this.backendService.getOrCreateCachedAsyncPoller({evictionDelay:e.reset?-1:3e5,cacheParams:s,action:function(){return t.$http(s)},eventName:"FlowRunsHistoryCsvDownload",eventData:{flowName:e.flowName}});var a},e.prototype.getStatusFilter=function(e){switch(e){case s.FilterNames.successfulRuns:return"Succeeded";case s.FilterNames.failedRuns:return"Failed";case s.FilterNames.runningRuns:return"Running";case s.FilterNames.cancelledRuns:return"Cancelled";case s.FilterNames.allRuns:default:return"NotSpecified"}},e.$inject=[r.default.services.$http,r.default.services.$q,r.default.services.appSettings,r.default.services.backend,r.default.services.environment],e}();t.FlowRunsHistoryCsvDownloadService=a,angular.module(r.default.modules.processSimpleServices).service(r.default.services.flowRunsHistoryCsvDownloadService,a)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(216);angular.module(r.default.modules.processSimpleServices).factory(r.default.services.oAuth,[r.default.services.appSettings,r.default.services.storage,r.default.services.clientResources,function(e,t,i){return new n.OAuthService(e,t,i)}])},function(e,t,i){"use strict";function r(e){var t={},i=[];return Object.keys(e.properties.connectionReferences||{}).forEach(function(r){var n=e.properties.connectionReferences[r];if(n){var o=angular.copy(n.apiDefinition||n.api);if(o&&o.properties){o.properties.swagger||(o.properties.swagger=n.swagger);var s=o.name.toUpperCase();t[s]||(t[s]=!0,i.push(o))}}}),i}Object.defineProperty(t,"__esModule",{value:!0}),i(12);var n=i(0),o=i(1),s=i(36),a=i(15),l=i(18),c=function(){function e(e,t,i,r,n,o,s,a){this.$http=e,this.$q=t,this.$scope=i,this.appSettings=r,this.clientResources=n,this.environmentService=o,this.flowsClient=s,this.loggingService=a}return e.prototype.createDesignerRunInstanceService=function(e){var t=this;return{getRunInstance:function(i,r){return t.getRunInstance(i,r,e)}}},e.prototype.getOperationOutput=function(e,t){var i=this;if(t.outputsLink)return this.$http({method:"GET",url:t.outputsLink.uri}).then(function(e){return[].concat(e.data)}).catch(function(e){throw i.loggingService.logError("RunInstanceService.GetOperationOutput",e),e});var r=this.$q.defer();return r.resolve([{statusCode:t.code,error:t.error}]),r.promise},e.prototype.getRunInstance=function(e,t,i){var n=this;void 0===i&&(i=!1);var l=e.split("/"),c=l[0],u=l[2];if(!c||!u){var p=new a.ClientError(a.ErrorCodes.runInstanceServiceInvalidId,o.format(this.clientResources.RunInstanceService.invalidRunId,e),null,{runId:e});return this.loggingService.logError("RunInstanceService.getRunInstance",p),Promise.reject(p)}var d=this.getRunOrCheck(e,c,u,t,i).then(function(i){var o=t?i.properties.flow:null,s=o?r(o):null,a=i.properties.actions;return i.properties.actions&&delete i.properties.actions,{run:i,runActions:Object.keys(a).map(function(t){return{id:e+"/actions/"+t,type:n.appSettings.processSimpleProviderName+"/flows/runs/actions/",name:t,properties:a[t]}}),workflowVersion:o,apis:s}});return d.catch(function(i){n.loggingService.logError("RunInstanceService.getRunInstance",i,{runId:e,flowName:c,runName:u,includeWorkflow:t})}),s.toDesignerPromise(d)},e.prototype.getRunOrCheck=function(e,t,i,r,n){return n?this.getRunByTriggerHistory(t,i):this.getRunOrCheckOnRunNotFound(e,t,i,r)},e.prototype.getRunOrCheckOnRunNotFound=function(e,t,i,r){var n=this;return this.getRun(t,i,r).then(function(t){if(t&&200===t.status)return t.data;throw new a.ClientError(a.ErrorCodes.runInstanceServiceInvalidStatusCode,o.format(n.clientResources.RunInstanceService.invalidGetRunStatusCode,e,t&&t.status),null,{status:t&&t.status})}).catch(function(e){if(e&&e.data&&404===e.status)return n.loggingService.logInfo("RunInstanceService.getRunInstance.RunNotFound","run not found",{flowName:t,runName:i}),n.getRunByTriggerHistory(t,i);throw e})},e.prototype.getRun=function(e,t,i){var r=this.appSettings.processSimpleManagementUri+(this.appSettings.featureFlags.enableEnvironments?"/environments/"+this.environmentService.getCurrentEnvironmentName()+"/":"/")+"flows/"+e+"/runs/"+t,n=["properties/actions"];return i&&n.push("properties/flow"),this.$http({method:"GET",url:r,params:{"api-version":this.appSettings.featureFlags.enableEnvironments?this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments:this.appSettings.processSimpleResourceProviderApiVersion,$expand:n.join(",")}})},e.prototype.getRunByTriggerHistory=function(e,t){var i,r=this,n=this.flowsClient.get(this.$scope,{id:l.getFlowId(e)});return n.$promise.then(function(){var o=n.properties.definition.triggers;return i=Object.keys(o||{})[0],r.getTriggerHistory(e,i,t)}).then(function(n){if(n&&n.data&&200===n.status)return n.data;throw new a.ClientError(a.ErrorCodes.runInstanceServiceInvalidTriggerHistoryResponse,o.format(r.clientResources.RunInstanceService.invalidTriggerHistoryResponse,"flows/"+e+"/runs/"+t),null,{flowName:e,runName:t,triggerName:i})}).then(function(o){var s=o.properties;return s.name=i,{name:t,id:"/providers/"+r.appSettings.processSimpleProviderName+"/flows/"+e+"/runs/"+t,type:r.appSettings.processSimpleProviderName+"/flows/runs",properties:{startTime:s.startTime,endTime:s.endTime,status:s.status,actions:{},trigger:s,flow:n.toJSON()}}})},e.prototype.getTriggerHistory=function(e,t,i){var r=this.appSettings.processSimpleManagementUri+(this.appSettings.featureFlags.enableEnvironments?"/environments/"+this.environmentService.getCurrentEnvironmentName()+"/":"/")+"flows/"+e+"/triggers/"+t+"/histories/"+i;return this.$http({method:"GET",url:r,params:{"api-version":this.appSettings.featureFlags.enableEnvironments?this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments:this.appSettings.processSimpleResourceProviderApiVersion}})},e.$inject=[n.default.services.$http,n.default.services.$q,n.default.services.$rootScope,n.default.services.appSettings,n.default.services.clientResources,n.default.services.environment,n.default.services.flowsClient,n.default.services.logging],e}();t.RunInstanceService=c,t.getApisFromFlow=r,angular.module(n.default.modules.processSimpleServices).service(n.default.services.runInstanceService,c)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(6),o=i(47),s=function(){function e(e,t,i,r,n,o,s,a,l){this.$http=e,this.$q=t,this.$scope=i,this.appSettings=r,this.clientResources=n,this.flowsClient=o,this.logging=s,this.telemetry=a,this.templatesClient=l}return e.prototype.submitToPendingGallery=function(e,t,i,r){var s=this,a={properties:{displayName:e,summary:t,description:t,connectionReferences:this.getTemplateConnectionReferences(r),categoryNames:i,definition:r.properties.definition}},l=o.getGalleryTemplatesId("pending");return this.templatesClient.post({id:l},a).then(function(){return s.telemetry.tagEvent(n.TelemetryEventNames.PublishFlowCompleted,{status:n.TelemetryEventStatus.succeeded},{flowName:r.name})}).catch(function(e){return s.logging.logError("TemplatePublishService.SubmitToGallery",e),s.telemetry.tagEvent(n.TelemetryEventNames.PublishFlowCompleted,{status:n.TelemetryEventStatus.failed},{flowName:r.name,error:e}),s.$q.reject(e)})},e.prototype.getTemplateConnectionReferences=function(e){var t={},i=e.properties.connectionReferences||{};return Object.keys(i).forEach(function(e){t[e]={api:{id:i[e].id}}}),t},e.$inject=[r.default.services.$http,r.default.services.$q,r.default.services.$rootScope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.flowsClient,r.default.services.logging,r.default.services.telemetry,r.default.services.templatesClient],e}();t.TemplatePublishService=s,angular.module(r.default.modules.processSimpleServices).service(r.default.services.templatePublish,s)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1010)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1011)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1012);i(1013);var o=function(){function e(){this.controller=n.LandingCtrl,this.template=i(1014),this.controllerAs="landingCtrl"}return e}();t.Landing=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.landing,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e}();t.LandingCtrl=r},function(e,t){},function(e,t){e.exports="<div ng-view></div>"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1016)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1017)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1018);i(1019);var o=function(){function e(){this.controller=n.NotificationListCtrl,this.template=i(1020),this.controllerAs="notificationListCtrl"}return e}();t.NotificationList=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.notificationList,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(55),s=i(137),a=i(83),l=i(46),c=i(168),u=i(78),p=function(){function e(e,t,i,r,s,a,l,c,u,p,d,g,m,f){var h=this;this.$element=e,this.$sce=t,this.$scope=i,this.$timeout=r,this.$window=s,this.appSettings=a,this.clientResources=l,this.domHelperService=c,this.environmentService=u,this.feedEventDefinitionsClient=p,this.flowRunCountService=d,this.planService=g,this.policiesService=m,this.urlService=f,this.billingPeriodFlowRuns=0,this.expanded=!1,this.headerNotificaitonListButtonId="header-notification-button",this.headerNotificationCountId="header-notitication-count",this.images=n.default,this.feedEvents=[],this.feedEventDefinitionType=o.FeedEventDefinitionType;var v=document.getElementById(this.headerNotificaitonListButtonId);this.$headerNotificationListButton=angular.element(v),this.registerNotificationListComponent(),this.appSettings.featureFlags.enableBilling&&this.planService.isPlanFreeAndNotSeeded()&&this.flowRunCountService.getFlowRunCount().then(function(e){h.billingPeriodFlowRuns=e,h.updateAlertNumber(h.numberOfAlerts)})}return e.prototype.showAllActivities=function(){this.close(!1)},e.prototype.notificationEventClicked=function(e){this.close(!1)},e.prototype.getFeedEventLink=function(e){return c.getNavigationInfo(e)},e.prototype.getFeedEventDataEventName=function(e){switch(e&&e.properties&&e.properties.type){case o.FeedEventDefinitionType.AggregatedFail:return"NotificationListAggregatedFailClicked";case o.FeedEventDefinitionType.BrokenConnection:return"NotificationListBrokenConnectionClicked";case o.FeedEventDefinitionType.FlowSuspended:return"NotificationListFlowSuspendedClicked";default:return""}},e.prototype.getFeedEventTitle=function(e){switch(e&&e.properties&&e.properties.type){case o.FeedEventDefinitionType.AggregatedFail:return this.clientResources.Manage.Activity.Flow.Failed;case o.FeedEventDefinitionType.BrokenConnection:case o.FeedEventDefinitionType.PushNotification:case o.FeedEventDefinitionType.AggregatedSuccess:case o.FeedEventDefinitionType.FlowSuspended:return e.properties.title;default:return""}},e.prototype.getFeedEventDescription=function(e){switch(e&&e.properties&&e.properties.type){case o.FeedEventDefinitionType.AggregatedFail:case o.FeedEventDefinitionType.AggregatedSuccess:case o.FeedEventDefinitionType.PushNotification:case o.FeedEventDefinitionType.FlowSuspended:return e.properties.object.displayName;case o.FeedEventDefinitionType.BrokenConnection:return e.properties.object.description;default:return""}},e.prototype.getFeedEventTimeSinceString=function(e){var t=new Date(e.properties.timestamp),i=new Date;return a.getFriendlyTimeSinceString(this.clientResources,{UseShortFormat:!0,UseShortUnit:!0},t,i)},e.prototype.getFeedEventIconHtml=function(e){return this.$sce.trustAsHtml(l.getIconsTemplate(l.getIconInfoForFeedEvent(e),o.isFailure(e)))},e.prototype.getFeedEventAriaLabel=function(e){var t=new Date(e.properties.timestamp);return this.getFeedEventDescription(e)+" "+this.getFeedEventTitle(e)+" "+a.getFriendlyTimeSinceString(this.clientResources,{UseShortFormat:!1,UseShortUnit:!1},t,null)},e.prototype.registerNotificationListComponent=function(){var t=this,i=u.toISOString(a.getIntervalDate(new Date,-1*this.appSettings.notificationDaysInterval)),r=this.feedEventDefinitionsClient.query(this.$scope,{$filter:"Timestamp ge "+i+" and Type ne 'Success' and Type ne 'PushNotification'",$aggregate:"Fail",$expand:"Runs"});r.$watch(this.$scope,function(){r.length&&(t.feedEvents=r.filter(function(t){return t&&t.properties&&e.SupportedFeedEventTypes.indexOf(t.properties.type)>=0})),t.updateAlertNumber(t.numberOfAlerts)}),this.domHelperService.registerOpenOnClick(this,this.$scope,this.headerNotificaitonListButtonId,this.$element)},e.prototype.close=function(e){void 0===e&&(e=!0),this.expanded=!1},Object.defineProperty(e.prototype,"shouldShowFlowRunsWarning",{get:function(){return s.getFlowRunSeverity(this.billingPeriodFlowRuns,this.policiesService.getMonthlyFlowRunAllotment())===s.FlowRunSeverity.high&&this.planService.isPlanFreeAndNotSeeded()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfAlerts",{get:function(){return this.feedEvents.length+(this.shouldShowFlowRunsWarning?1:0)},enumerable:!0,configurable:!0}),e.prototype.updateAlertNumber=function(e){var t=this.$headerNotificationListButton.find("#"+this.headerNotificationCountId);t&&t.length>0&&t.remove(),e&&this.$headerNotificationListButton.append('<span class="type-c1 c-caption-1" id="'+this.headerNotificationCountId+'">'+(e>99?"99+":e)+"</span>"),this.$timeout(function(){$(window).trigger("resize")},50)},e.SupportedFeedEventTypes=[o.FeedEventDefinitionType.AggregatedFail,o.FeedEventDefinitionType.FlowSuspended,o.FeedEventDefinitionType.BrokenConnection],e.$inject=[r.default.services.$element,r.default.services.$sce,r.default.services.$scope,r.default.services.$timeout,r.default.services.$window,r.default.services.appSettings,r.default.services.clientResources,r.default.services.domHelper,r.default.services.environment,r.default.services.feedEventDefinitionsClient,r.default.services.flowRunCount,r.default.services.plan,r.default.services.policies,r.default.services.url],e}();t.NotificationListCtrl=p},function(e,t){},function(e,t){e.exports='<div class="context-header-popup context-header-popup-notifications" ng-if="notificationListCtrl.expanded" aria-hidden="{{!notificationListCtrl.expanded}}" aria-labelby="{{notificationListCtrl.headerNotificationListButtonId}}"> <h2 class="c-heading-4" ng-show="notificationListCtrl.feedEvents.length > 0 || notificationListCtrl.shouldShowFlowRunsWarning">{{notificationListCtrl.clientResources.notification.title}}</h2> <ul> <li ng-show="notificationListCtrl.shouldShowFlowRunsWarning" ng-if="notificationListCtrl.appSettings.featureFlags.enableBilling"> <a ng-href="{{notificationListCtrl.urlService.pricingRoute()}}" data-event-name="NotificationBillingWarningClicked"> <div class="context-notificationlist"> <div class="notificationlist-imageholder"> <div class="context-icon-template" style="background-color:#07f"> <div class="error-icon"> <img cdn-src="{{notificationListCtrl.images.statusWarning}}"/> </div> <div class="multi-icon-set icon-set-1"> <img cdn-src="{{notificationListCtrl.images.flowLight}}" alt=""/> </div> </div> </div> <div class="notificationlist-text"> <p class="c-paragraph-4">{{notificationListCtrl.clientResources.FlowRuns.Warning1}}</p> <p class="type-c1 c-caption-1">{{notificationListCtrl.clientResources.FlowRuns.Warning2}}</p> </div> </div> </a> </li> <li ng-repeat="feedEvent in notificationListCtrl.feedEvents"> <a href="{{notificationListCtrl.getFeedEventLink(feedEvent)}}" ng-click="notificationListCtrl.notificationEventClicked(feedEvent)" aria-label="{{notificationListCtrl.getFeedEventAriaLabel(feedEvent)}}" data-event-name="{{notificationListCtrl.getFeedEventDataEventName(feedEvent)}}"> <div class="context-notificationlist" aria-hidden="true"> <div class="notificationlist-imageholder"> <div ng-bind-html-compile="{{notificationListCtrl.getFeedEventIconHtml(feedEvent)}}"></div> </div> <div class="notificationlist-text"> <p class="c-paragraph-4">{{notificationListCtrl.getFeedEventTitle(feedEvent)}}</p> <p class="type-c1 c-caption-1">{{notificationListCtrl.getFeedEventDescription(feedEvent)}}</p> </div> <div class="notificationlist-timesince"> <span aria-label="{{notificationCtrl.clientResources.notification.timeSince.ariaLabel}}" class="type-c1 c-caption-1">{{notificationListCtrl.getFeedEventTimeSinceString(feedEvent)}}</span> </div> </div> </a> </li> </ul> <div class="notificationlist-zero" ng-if="notificationListCtrl.feedEvents.length === 0 && !notificationListCtrl.shouldShowFlowRunsWarning"> <div class="notificationlist-zero-imageholder"> <img align="middle" alt="{{clientResources.notification.zero.heading}}" cdn-src="{{notificationListCtrl.images.notificationsZero}}"> </div> <div class="notificationlist-zero-text"> <p>{{clientResources.notification.zero.heading}}</p> </div> </div> <div class="notificationlist-showall"> <a class="type-c1 c-caption-1" href="activities" ng-click="notificationListCtrl.showAllActivities()" data-event-name="HeaderActivityFeedClicked" data-event-from="notitfication-list"> {{notificationListCtrl.clientResources.notification.gotoActivityFeed}} </a> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1022),i(1027)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1023)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(218),o=i(1024);i(1025);var s=function(){function e(){this.restrict="E",this.template=i(1026),this.replace=!0,this.scope={},this.link=function(e,t,i){var r=function(){var e=t.find("iframe#"+n.NpsConstants.IFrameId);e&&(e.remove(),t.css("display","none"))};e.closeNpsHostIframe=function(){r()},e.resizeNpsHostIframe=function(){var e=t.find("iframe#"+n.NpsConstants.IFrameId);e&&e.addClass(n.NpsConstants.ThankYouDialogClass)},e.connectToNps=function(){e.initListener(),r();var i='<iframe name="npsFrame" id="'+n.NpsConstants.IFrameId+'" sandbox="allow-same-origin allow-scripts allow-popups allow-forms" src="'+e.renderUrl+'"></iframe>';t.append(i),$("#"+n.NpsConstants.IFrameId).load(function(){t.css("display","flex")})}},this.controller=o.NpsHostDirectiveCtrl}return e}();t.NpsHostDirective=s,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.npsHost,[function(){return new s}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(218),o=i(143),s=i(32),a=i(8),l=i(3),c=function(){function e(e,t,i,r,a,c,u,p){var d=this;this.$scope=e,this.$timeout=t,this.$window=i,this.appSettings=r,this.loggingService=a,this.npsHttpService=c,this.sessionService=u,this.urlService=p,this.appLoadedWaitInterval=3e4,this.listener=function(e){return d.receiveMessage(e)},this.$scope.initListener=function(){return d.$window.addEventListener(n.NpsConstants.MessageEventType,d.listener)},this.$scope.$on("$destroy",function(){d.destoryIframeListener()}),this.redirectRoot=this.appSettings.npsOriginUrl;var g=this.sessionService.getUserSession();if(g&&g.userInfo){var m=this.sessionService.isConsumerDomain?this.convertPuidToZeroPaddedGuid(g.userInfo.puid):g.userInfo.uniqueId,f=s.parseUri(s.concatParts(this.redirectRoot,n.NpsConstants.RenderPath)),h=s.parseUri(s.concatParts(this.redirectRoot,n.NpsConstants.DisplayPath));f.parameters[n.NpsConstants.LanguageParam]=this.appSettings.locale,f.parameters[n.NpsConstants.PuidParam]=m,h.parameters[n.NpsConstants.PuidParam]=m,this.$scope.renderUrl=o.composeUri(f.protocol,f.host,f.path,s.createQueryString(f.parameters));var v=o.composeUri(h.protocol,h.host,h.path,s.createQueryString(h.parameters));this.$timeout(function(){return d.npsHttpService.shouldShowNpsDialog(v).then(function(e){e&&d.$scope.connectToNps()}).catch(function(e){l.inferErrorStatus(e)===l.Status.Abort?d.loggingService.logWarning("NpsHostDirectiveCtrl.connectToNps","Failed to connect to nps host: "+l.parseErrorMessage(e),e):d.loggingService.logError("NpsHostDirectiveCtrl.connectToNps",e)})},this.appLoadedWaitInterval)}}return e.prototype.convertPuidToZeroPaddedGuid=function(e){return null!==e&&16===e.length?"00000000-0000-0000-".concat(e.substr(0,4)).concat("-").concat(e.substr(4,12)).toLowerCase():null},e.prototype.destoryIframeListener=function(){this.$window.removeEventListener(n.NpsConstants.MessageEventType,this.listener),this.$scope.closeNpsHostIframe()},e.prototype.receiveMessage=function(e){if(e&&this.urlService.isNpsOriginUrl(e.origin)&&e.data&&e.data.msgType){var t=e.data.msgType;a.equalsIgnoreCase(t,n.NpsConstants.CloseNpsDialog)?this.destoryIframeListener():a.equalsIgnoreCase(t,n.NpsConstants.ResizeNpsDialog)?this.$scope.resizeNpsHostIframe():this.loggingService.logWarning("npsHostDirectiveCtrl.receiveMessage","Unknown event type: "+t,{UnknownEventType:t})}},e.$inject=[r.default.services.$scope,r.default.services.$timeout,r.default.services.$window,r.default.services.appSettings,r.default.services.logging,r.default.services.npsHttpService,r.default.services.session,r.default.services.url],e}();t.NpsHostDirectiveCtrl=c},function(e,t){},function(e,t){e.exports='<div class="npsHost" style="display:none"> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1028)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e,t){this.$http=e,this.loggingService=t}return e.prototype.shouldShowNpsDialog=function(e){var t=this;return this.$http.get(e).then(function(e){var i=e&&200===e.status&&e.data&&e.data.display;return t.loggingService.logInfo("NpsHttpService.shouldShowNpsDialog.DisplayEndppoint","Is Nps dialog shown: "+i,{isNpsDialogShown:i}),i})},e.$inject=[r.default.services.$http,r.default.services.logging],e}();t.NpsHttpService=n,angular.module(r.default.modules.processSimpleServices).service(r.default.services.npsHttpService,n)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1030),i(219),i(1033)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(215);i(1031);var o=function(){function e(){this.controller=n.TrialDialogCtrl,this.template=i(1032),this.controllerAs="trialDialogCtrl",this.bindings={controls:"<"}}return e}();t.TrialDialog=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.trialDialog,new o)},function(e,t){},function(e,t){e.exports='<div class="c-dialog trial-dialog" ng-if="trialDialogCtrl.showDialog"> <div role="presentation" tabindex="-1" data-js-dialog-hide></div> <div role="dialog" tabindex="-1" class="x-type-center"> <div class="trial-dialog-header"> <div class="trial-dialog-header-image"> <img cdn-src="{{trialDialogCtrl.dialog.headerImage}}"/> </div> <div> <h3> {{trialDialogCtrl.dialog.title}} </h3> </div> <div class="trial-dialog-content" ng-bind-html-compile="{{trialDialogCtrl.dialog.content}}"></div> </div> <div class="row trial-dialog-action"> <button ng-if="trialDialogCtrl.dialog.cancelButton" data-event-name="{{trialDialogCtrl.dialog.cancelButton.eventName}}" class="c-button trial-dialog-button" ng-click="trialDialogCtrl.dialog.cancelButton.action()" data-js-dialog-hide> {{trialDialogCtrl.dialog.cancelButton.text}} </button> <button data-event-name="{{trialDialogCtrl.dialog.acceptButton.eventName}}" class="c-button btn btn-primary trial-dialog-button" ng-click="trialDialogCtrl.dialog.acceptButton.action()" ng-disabled="trialCtrl.startTrialInProgress" data-js-dialog-hide> {{trialDialogCtrl.dialog.acceptButton.text}} </button> <div class="trial-dialog-error" ng-if="trialDialogCtrl.dialog.errorMessage"> <p class="error-message">{{trialDialogCtrl.dialog.errorMessage}}</p> </div> <div class="trial-dialog-action-footer" ng-if="trialDialogCtrl.dialog.footerText" ng-show="trialDialogCtrl.appSettings.featureFlags.enablePurchaseNow" ng-bind-html="trialDialogCtrl.dialog.footerText"></div> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1034),i(1037)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(1035),o=function(){function e(){this.restrict="AE",this.template=i(1036),this.controllerAs="controller",this.controller=n.TrialButtonCtrl,this.scope={eventName:"@eventName",description:"@description",licenseId:"@licenseId",currency:"@currency"}}return e}();t.TrialButton=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.trialButton,[function(){return new o}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(){function e(e,t,i,r){this.$scope=e,this.sessionService=t,this.trialDialogService=i,this.urlService=r}return e.prototype.startTrial=function(){var e=this;this.isActionPending=!0,this.sessionService.isAuthenticated&&this.sessionService.isConsumerDomain?this.trialDialogService.showUpgradeToProRequiredDialog(function(){e.isActionPending=!1}):window.location.replace(this.urlService.startTrialRoute(this.$scope.licenseId,this.$scope.currency))},e.$inject=[r.default.services.$scope,r.default.services.session,r.default.services.trialDialog,r.default.services.url],e}();t.TrialButtonCtrl=n},function(e,t){e.exports='<a class="c-button btn" ng-disabled="controller.isActionPending" role="button" data-event-name="{{eventName}}" href="" ng-click="controller.startTrial()"> {{description}} </a>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(1038);i(1039);var o=function(){function e(){this.restrict="AE",this.template=i(1040),this.controllerAs="purchaseButton",this.controller=n.PurchaseButtonCtrl,this.scope={buttonType:"@buttonType",description:"@description",eventName:"@eventName",purchaseUrl:"@purchaseUrl",tenantPurchaseUrl:"@tenantPurchaseUrl"}}return e}();t.PurchaseButton=o,angular.module(r.default.modules.processSimpleDirectives).directive(r.default.directives.purchaseButton,[function(){return new o}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(220),o=i(8);t.PurchaseButtonType={button:"button"};var s=function(){function e(e,t,i,r,o,s,a){var l=this;this.$scope=e,this.$windowService=t,this.appSettings=i,this.graphService=r,this.sessionService=o,this.trialDialogService=s,this.urlService=a,this.userIsBillingAdmin=!1,this.sessionService.isOrgId?(this.isActionPending=!0,this.graphService.getUserRoles().then(function(e){l.userIsBillingAdmin=n.canUserPurchaseForOthers(e)}).finally(function(){l.isActionPending=!1,l.populateEventData()})):this.populateEventData()}return e.prototype.purchaseLicense=function(){this.appSettings.featureFlags.enableIndividualPurchase?this.handlePurchaseWhenIndividualPurchaseEnabled():this.handlePurchaseWhenIndividualPurchaseDisabled()},e.prototype.handlePurchaseWhenIndividualPurchaseEnabled=function(){var e=this;this.userIsBillingAdmin?(this.isActionPending=!0,this.trialDialogService.showBillingAdminPurchaseDialog(function(t){t?e.$windowService.location.replace(e.$scope.tenantPurchaseUrl):e.$windowService.location.replace(e.$scope.purchaseUrl),e.isActionPending=!1})):this.sessionService.isAuthenticated?this.$windowService.location.replace(this.$scope.purchaseUrl):window.location.href=this.urlService.signinRoute()},e.prototype.handlePurchaseWhenIndividualPurchaseDisabled=function(){var e=this;this.userIsBillingAdmin?this.$windowService.location.assign(this.$scope.tenantPurchaseUrl):this.sessionService.isAuthenticated?(this.isActionPending=!0,this.trialDialogService.showIndividualPurchaseNotSupportedDialog(function(){e.isActionPending=!1})):window.location.href=this.urlService.signinRoute()},e.prototype.isButton=function(){return o.equalsIgnoreCase(this.$scope.buttonType,t.PurchaseButtonType.button)},e.prototype.populateEventData=function(){this.eventData={isOrgId:this.sessionService.isOrgId,isAdmin:this.userIsBillingAdmin}},e.$inject=[r.default.services.$scope,r.default.services.$window,r.default.services.appSettings,r.default.services.graph,r.default.services.session,r.default.services.trialDialog,r.default.services.url],e}();t.PurchaseButtonCtrl=s},function(e,t){},function(e,t){e.exports='<a ng-class="{\'c-button btn\':purchaseButton.isButton(), \'purchase-button-link\':!purchaseButton.isButton()}" ng-disabled="purchaseButton.isActionPending" data-event-name="{{eventName}}" data-event-data="{{purchaseButton.eventData}}" href="" ng-click="purchaseButton.purchaseLicense()"> {{description}} </a>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1042)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1043)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1044)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1045);i(1047);var o=function(){function e(){this.template=i(1048),this.controller=n.SettingsPaneCtrl,this.controllerAs="settingsPaneCtrl"}return e}();t.SettingsPane=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.settingsPane,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(1046),o=i(6),s=i(4),a=i(7),l=i(3),c=i(9),u=function(){function e(e,t,i,r,o,s,l,u,p,d,g,m){this.$element=e,this.$http=t,this.$interval=i,this.$scope=r,this.$window=o,this.appSettings=s,this.clientResources=l,this.domHelperService=u,this.loggingService=p,this.sessionService=d,this.telemetryService=g,this.urlService=m,this.publicspinner={size:a.SpinnerSize.Small,show:!0,local:a.SpinnerPosition.LocalStatic},this.error="",this.languages=n.LANGUAGES,this.locales=n.LOCALES,this.selectedLanguageCode="",this.selectedLocaleCode="",this.expanded=!1,this.isSaveInProgress=!1,this.registerOpenOnClickSettingsButton(),this.initializeUserSettings(),"tip0"!==c.getAppSettings().environment&&(this.languages.push({languageCode:"qps",displayName:"Pseudolocale"}),this.locales.push({languageCode:"qps",localeCode:"qps-ploc",displayName:"Pseudolocale"}))}return e.prototype.onLanguageChange=function(){var e=this;!!this.selectedLocaleCode&&this.getCurrentlySelectedLocale().languageCode===this.selectedLanguageCode||(this.selectedLocaleCode=this.locales.filter(function(t){return t.languageCode===e.selectedLanguageCode})[0].localeCode)},e.prototype.areMultipleLocalesForSelectedLanguage=function(){var e=this;return this.locales.filter(function(t){return t.languageCode===e.selectedLanguageCode}).length>1},e.prototype.updateUserPreferences=function(){var e=this;this.error="";var t={preferredLocale:this.selectedLocaleCode};this.telemetryService.tagEvent(o.TelemetryEventNames.SettingsPaneUpdateSettingsClicked,null,{newUserPreferences:t,oldUserPreferences:this.sessionService.getUserSession().userPreferences,currentLocale:this.appSettings.locale}),this.isSaveInProgress=!0,this.$http.post(this.urlService.userPreferencesRoute(),t).then(function(){e.handleLocaleRefresh()}).catch(function(t){e.loggingService.logError(s.ProfilingEventNames.userPreferencesUpdateFailed,t),e.error=l.parseErrorMessage(t,e.clientResources.Common.SomethingWentWrong)}).finally(function(){e.isSaveInProgress=!1})},e.prototype.cancel=function(){this.initializeUserSettings(),this.expanded=!1},e.prototype.shouldDisableSaveButton=function(){return!this.selectedLocaleCode||this.isSaveInProgress},e.prototype.isLocaleInRoute=function(){return this.getCurrentUrl().indexOf(this.appSettings.locale)>-1&&-1===this.getCurrentUrl().indexOf("manage")},e.prototype.initializeUserSettings=function(){var e=this;this.sessionService.getUserSessionAsync().then(function(t){var i=t.userPreferences.preferredLocale;if(i){var r=e.getLocaleByLocaleCode(i);e.selectedLanguageCode=r.languageCode,e.selectedLocaleCode=r.localeCode}})},e.prototype.getCurrentlySelectedLocale=function(){return this.getLocaleByLocaleCode(this.selectedLocaleCode)},e.prototype.registerOpenOnClickSettingsButton=function(){this.domHelperService.registerOpenOnClick(this,this.$scope,"header-settings-button",this.$element)},e.prototype.getLocaleByLocaleCode=function(e){return this.locales.filter(function(t){return t.localeCode===e})[0]},e.prototype.handleLocaleRefresh=function(){this.isLocaleInRoute()?this.navigateTo(this.getCurrentUrl().replace("/"+this.appSettings.locale+"/","/")):this.$window.location.reload()},e.prototype.getCurrentUrl=function(){return this.$window.location.href},e.prototype.navigateTo=function(e){this.$window.location.href=e},e.$inject=[r.default.services.$element,r.default.services.$http,r.default.services.$interval,r.default.services.$scope,r.default.services.$window,r.default.services.appSettings,r.default.services.clientResources,r.default.services.domHelper,r.default.services.logging,r.default.services.session,r.default.services.telemetry,r.default.services.url],e}();t.SettingsPaneCtrl=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LANGUAGES=[{languageCode:"en",displayName:"English"},{languageCode:"eu",displayName:"euskara"},{languageCode:"bg",displayName:"Български"},{languageCode:"ca",displayName:"Català"},{languageCode:"zh",displayName:"中文(简体)"},{languageCode:"zhtwhk",displayName:"中文(繁體)"},{languageCode:"hr",displayName:"Hrvatski"},{languageCode:"cs",displayName:"Čeština"},{languageCode:"da",displayName:"Dansk"},{languageCode:"nl",displayName:"Nederlands"},{languageCode:"et",displayName:"Eesti"},{languageCode:"fi",displayName:"Suomi"},{languageCode:"fr",displayName:"Français"},{languageCode:"gl",displayName:"galego"},{languageCode:"de",displayName:"Deutsch"},{languageCode:"el",displayName:"Ελληνικά"},{languageCode:"hi",displayName:"हिंदी"},{languageCode:"hu",displayName:"Magyar"},{languageCode:"id",displayName:"Indonesia"},{languageCode:"it",displayName:"Italiano"},{languageCode:"jp",displayName:"日本語"},{languageCode:"kk",displayName:"Қазақ"},{languageCode:"ko",displayName:"한국어"},{languageCode:"lv",displayName:"Latviešu"},{languageCode:"lt",displayName:"Lietuvių"},{languageCode:"ms",displayName:"Bahasa Melayu"},{languageCode:"nb",displayName:"Norsk"},{languageCode:"pl",displayName:"Polski"},{languageCode:"pt",displayName:"Português"},{languageCode:"ro",displayName:"Română"},{languageCode:"ru",displayName:"Русский"},{languageCode:"sr-cyrl",displayName:"српски"},{languageCode:"sr-latn",displayName:"Srpski"},{languageCode:"sk",displayName:"Slovenčina"},{languageCode:"sl",displayName:"Slovenski"},{languageCode:"es",displayName:"Español"},{languageCode:"sv",displayName:"Svenska"},{languageCode:"th",displayName:"ไทย"},{languageCode:"tr",displayName:"Türkçe"},{languageCode:"uk",displayName:"Українська"},{languageCode:"vi",displayName:"Tiếng Việt"}],t.LOCALES=[{languageCode:"en",localeCode:"en-au",displayName:"Australia"},{languageCode:"en",localeCode:"en-ca",displayName:"Canada"},{languageCode:"en",localeCode:"en-in",displayName:"India"},{languageCode:"en",localeCode:"en-ie",displayName:"Ireland"},{languageCode:"en",localeCode:"en-my",displayName:"Malaysia"},{languageCode:"en",localeCode:"en-nz",displayName:"New Zealand"},{languageCode:"en",localeCode:"en-sg",displayName:"Singapore"},{languageCode:"en",localeCode:"en-za",displayName:"South Africa"},{languageCode:"en",localeCode:"en-gb",displayName:"United Kingdom"},{languageCode:"en",localeCode:"en-us",displayName:"United States"},{languageCode:"eu",localeCode:"eu-es",displayName:"euskara"},{languageCode:"ca",localeCode:"ca-es",displayName:"Català"},{languageCode:"bg",localeCode:"bg-bg",displayName:"България"},{languageCode:"zh",localeCode:"zh-cn",displayName:"中国"},{languageCode:"zhtwhk",localeCode:"zh-tw",displayName:"台灣"},{languageCode:"zhtwhk",localeCode:"zh-hk",displayName:"香港特別行政區"},{languageCode:"hr",localeCode:"hr-hr",displayName:"Hrvatska"},{languageCode:"cs",localeCode:"cs-cz",displayName:"Česká republika"},{languageCode:"da",localeCode:"da-dk",displayName:"Danmark"},{languageCode:"nl",localeCode:"nl-be",displayName:"België"},{languageCode:"nl",localeCode:"nl-nl",displayName:"Nederland"},{languageCode:"et",localeCode:"et-ee",displayName:"Eesti"},{languageCode:"fi",localeCode:"fi-fi",displayName:"Suomi"},{languageCode:"fr",localeCode:"fr-be",displayName:"Belgique"},{languageCode:"fr",localeCode:"fr-ca",displayName:"Canada"},{languageCode:"fr",localeCode:"fr-fr",displayName:"France"},{languageCode:"fr",localeCode:"fr-ch",displayName:"Suisse"},{languageCode:"gl",localeCode:"gl-es",displayName:"galego"},{languageCode:"de",localeCode:"de-de",displayName:"Deutschland"},{languageCode:"de",localeCode:"de-at",displayName:"Österreich"},{languageCode:"de",localeCode:"de-ch",displayName:"Schweiz"},{languageCode:"el",localeCode:"el-gr",displayName:"Ελλάδα"},{languageCode:"hi",localeCode:"hi-in",displayName:"भारत"},{languageCode:"hu",localeCode:"hu-hu",displayName:"Magyarország"},{languageCode:"id",localeCode:"id-id",displayName:"Indonesia"},{languageCode:"it",localeCode:"it-it",displayName:"Italia"},{languageCode:"jp",localeCode:"ja-jp",displayName:"日本"},{languageCode:"kk",localeCode:"kk-kz",displayName:"Қазақстан"},{languageCode:"ko",localeCode:"ko-kr",displayName:"대한민국"},{languageCode:"lv",localeCode:"lv-lv",displayName:"Latvija"},{languageCode:"lt",localeCode:"lt-lt",displayName:"Lietuva"},{languageCode:"ms",localeCode:"ms-my",displayName:"Asia Tenggara"},{languageCode:"nb",localeCode:"nb-no",displayName:"Norge"},{languageCode:"pl",localeCode:"pl-pl",displayName:"Polska"},{languageCode:"pt",localeCode:"pt-br",displayName:"Brasil"},{languageCode:"pt",localeCode:"pt-pt",displayName:"Portugal"},{languageCode:"ro",localeCode:"ro-ro",displayName:"România"},{languageCode:"ru",localeCode:"ru-ru",displayName:"Россия"},{languageCode:"sr-cyrl",localeCode:"sr-cyrl-ba",displayName:"Босна и Херцеговина"},{languageCode:"sr-cyrl",localeCode:"sr-cyrl-rs",displayName:"Реп. Србија и Реп. Црна Гора"},{languageCode:"sr-latn",localeCode:"sr-latn-rs",displayName:"Rep. Srbija i Rep. Crna Gora"},{languageCode:"sk",localeCode:"sk-sk",displayName:"Slovenská republika"},{languageCode:"sl",localeCode:"sl-si",displayName:"Slovenija"},{languageCode:"es",localeCode:"es-ar",displayName:"Argentina"},{languageCode:"es",localeCode:"es-cl",displayName:"Chile"},{languageCode:"es",localeCode:"es-co",displayName:"Colombia"},{languageCode:"es",localeCode:"es-es",displayName:"España"},{languageCode:"es",localeCode:"es-hn",displayName:"Latinoamérica"},{languageCode:"es",localeCode:"es-mx",displayName:"México"},{languageCode:"sv",localeCode:"sv-se",displayName:"Sverige"},{languageCode:"th",localeCode:"th-th",displayName:"ไทย"},{languageCode:"tr",localeCode:"tr-tr",displayName:"Türkiye"},{languageCode:"uk",localeCode:"uk-ua",displayName:"Україна"},{languageCode:"vi",localeCode:"vi-vn",displayName:"Việt Nam"}]},function(e,t){},function(e,t){e.exports='<info-pane expanded="settingsPaneCtrl.expanded" pane-title="settingsPaneCtrl.clientResources.Settings.Title" toggle-button-id="\'header-settings-button\'"> <section class="settings-pane-content"> <section> <h1 class="c-paragraph-2">{{::settingsPaneCtrl.clientResources.Settings.Language.Title}}</h1> <div class="section-content"> <label for="language-selection" class="c-paragraph-3">{{::settingsPaneCtrl.clientResources.Settings.Language.LanguageHeader}}</label> <div class="c-select"> <select name="language-selection" id="language-selection" ng-options="language.languageCode as language.displayName for language in settingsPaneCtrl.languages | orderBy:\'displayName\'" ng-model="settingsPaneCtrl.selectedLanguageCode" ng-change="settingsPaneCtrl.onLanguageChange()"> <option value="" disabled="disabled" hidden>{{settingsPaneCtrl.clientResources.Settings.Language.defaultValue}}</option> </select> </div> <label for="locale-selection" class="c-paragraph-3">{{::settingsPaneCtrl.clientResources.Settings.Language.LocaleHeader}}</label> <div class="c-select"> <select class="c-paragraph-4" name="locale-selection" id="locale-selection" ng-options="locale.localeCode as locale.displayName for locale in settingsPaneCtrl.locales | filter:locale.languageCode=settingsPaneCtrl.selectedLanguageCode : true | orderBy:\'displayName\'" ng-model="settingsPaneCtrl.selectedLocaleCode" ng-disabled="!settingsPaneCtrl.areMultipleLocalesForSelectedLanguage()"> </select> </div> </div> </section> <div class="error" ng-if="settingsPaneCtrl.error">{{settingsPaneCtrl.error}}</div> <button class="c-button btn-primary" ng-click="settingsPaneCtrl.updateUserPreferences()" ng-disabled="settingsPaneCtrl.shouldDisableSaveButton()">{{settingsPaneCtrl.clientResources.Common.Save}}</button> <button class="c-button btn-secondary" ng-click="settingsPaneCtrl.cancel()">{{::settingsPaneCtrl.clientResources.Common.Cancel}}</button> <spinner model="settingsPaneCtrl.spinner" ng-if="settingsPaneCtrl.showSpinner"></spinner> </section> </info-pane>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1050),i(1123),i(1125),i(1126)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1051),i(1055),i(1059),i(1063),i(1067),i(1072),i(1077),i(1081),i(1085),i(1089),i(1093),i(1097),i(1101),i(1106),i(1110),i(1114),i(1119)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1052);i(1053);var o=function(){function e(){this.template=i(1054),this.controller=n.CustomApiActionCtrl,this.controllerAs="customApiActionCtrl"}return e}();t.CustomApiAction=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.customApiAction,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(16),o=i(27),s=i(48),a=i(24),l=i(61),c=i(17),u=i(6),p=i(11),d=function(){function e(e,t,i,r,l,c,d,g,m){var f=this;this.$routeParams=e,this.$scope=t,this.$timeout=i,this.appSettings=r,this.clientResources=l,this.navigationService=c,this.swaggerEditorDataService=d,this.swaggerValidationService=g,this.telemetryService=m,this.urlMaxLength=1024,this.contentMaxLength=1048576,this.validationFilters={},this.verbs=Object.keys(o.Methods).map(function(e){return o.Methods[e]}).map(function(e){return{method:e,displayName:e.toUpperCase()}}),this.visibilityItems=Object.keys(n.Visibility).map(function(e){return n.Visibility[e]}).map(function(e){return{visibility:e,displayName:e}}),this.importPane={isRequestPane:!1,isVisible:!1},this.navigateToReferenceParameter=function(e,t){var i=a.getReferenceParameterIndex(f.swaggerEditorDataService.SwaggerEditorData,e,t);i>=0&&f.navigationService.navigate(s.getReferenceUrl(f.swaggerEditorDataService.SwaggerEditorData,e,i))},this.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiActionVisited),this.actionIndex=this.$routeParams.actionIndex,this.baseViolator=new p.Violator({itemPath:p.Paths.Actions+"["+this.actionIndex+"]"}),this.validationFilters={summary:new p.FilteredResults(new p.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:p.Paths.OperationSummary})),description:new p.FilteredResults(new p.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:p.Paths.OperationDescription})),operationId:new p.FilteredResults(new p.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:p.Paths.OperationId})),path:new p.FilteredResults(new p.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:p.Paths.Path})),bodyParameter:new p.FilteredResults(new p.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:p.Paths.OperationParameters}))},this.dropdownCommands=this.getDropdownCommands(),this.resetActionData(),this.processRequest(),this.processResponses(),this.operationVisibility=this.action.operation[n.Swagger.Visibility]||n.Visibility.none,this.$scope.$watchGroup([function(){return f.swaggerValidationService.resultCollection.results},function(){return f.validationFilters}],function(){Object.keys(f.validationFilters).map(function(e){return f.validationFilters[e]}).forEach(function(e){return e.updateFilteredResults(f.swaggerValidationService.resultCollection)})})}return Object.defineProperty(e.prototype,"action",{get:function(){return this.swaggerEditorDataService.swagger.actions[this.actionIndex]},enumerable:!0,configurable:!0}),e.prototype.resetActionData=function(){this.request={pathParameters:[],queryParameters:[],headerParameters:[],bodyParameter:null},this.responses=[],this.clearPaneData()},e.prototype.getDropdownCommands=function(){var e=this;return[{text:this.clientResources.Manage.Apis.EditToolTip,iconUrl:"glyph-edit",click:function(t){e.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiEditParameterClicked);var i=a.getParameterIndex(t,e.action.operation.parameters,e.swaggerEditorDataService.swagger),r=e.action.operation.parameters[i],o=a.resolveParameter(r,e.swaggerEditorDataService.swagger);a.isReference(r)?e.navigateToReferenceParameter({name:o.name,source:n.ReferenceSource.parameters},o):e.navigateToInlineParameter(i,o)}},{text:this.clientResources.Manage.Apis.DeleteToolTip,iconUrl:"glyph-delete",click:function(t){e.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiDeleteParameterClicked);var i=a.getParametersWithResolvedReferences(e.action.operation.parameters,e.swaggerEditorDataService.swagger).indexOf(t);e.action.operation.parameters.splice(i,1),e.isPathParameter(e.request.pathParameters,t)&&e.removePathParameter(e.action,t),e.processRequest(),e.processResponses()}}]},e.prototype.isPathParameter=function(e,t){return a.getParametersWithResolvedReferences(e,this.swaggerEditorDataService.swagger).indexOf(t)>-1},e.prototype.removePathParameter=function(e,t){var i=e.path.split("/"),r=i.indexOf("{"+t.name+"}");r>0&&(i.splice(r-1,2),e.path=i.join("/"))},e.prototype.processRequest=function(){var e=this,t=a.getParametersWithResolvedReferences(this.action.operation.parameters,this.swaggerEditorDataService.swagger);t.forEach(function(t){e.validationFilters[l.getUniqueParameterName(t)]||(e.validationFilters[l.getUniqueParameterName(t)]=new p.FilteredResults(new p.Violator({itemPath:c.getPathToParameter(t,e.action.operation,e.baseViolator,e.swaggerEditorDataService.SwaggerEditorData)})))}),this.request.pathParameters=t.filter(function(e){return e.in&&e.in===o.ParameterLocations.path}),this.request.queryParameters=t.filter(function(e){return e.in&&e.in===o.ParameterLocations.query}),this.request.headerParameters=t.filter(function(e){return e.in&&e.in===o.ParameterLocations.header}),this.request.bodyParameter=t.filter(function(e){return e.in&&e.in===o.ParameterLocations.body})[0]},e.prototype.getIconUrlForParameter=function(e){return this.validationFilters[l.getUniqueParameterName(e)]?this.validationFilters[l.getUniqueParameterName(e)].resultCollection.mostSevereResultTypeImage:null},e.prototype.processResponses=function(){var e=this;this.responses=[],this.action.operation&&Array.isArray(this.action.operation.responses)&&this.action.operation.responses.forEach(function(t){var i;if(a.isReference(t.item)){var r=t.item;i=a.getJsonReference(e.swaggerEditorDataService.swagger,r.$ref)}else i=t.item;e.responses.push({name:t.name,responseWithResolvedReference:i}),e.validationFilters[t.name]||(e.validationFilters[t.name]=new p.FilteredResults(new p.Violator({itemPath:c.getPathToResponse(t,e.action.operation,e.baseViolator,e.swaggerEditorDataService.SwaggerEditorData)})))})},e.prototype.getIconUrlForResponse=function(e){return this.validationFilters[e.name]?this.validationFilters[e.name].resultCollection.mostSevereResultTypeImage:null},e.prototype.navigateToResponse=function(e){var t=this.action.operation.responses.map(function(e){return e.name}).indexOf(e),i=this.action.operation.responses[t];if(a.isReference(i.item)){var r=a.getJsonReference(this.swaggerEditorDataService.swagger,i.item.$ref);this.navigateToReferenceResponse({name:e,source:n.ReferenceSource.responses},r)}else this.navigationService.navigate(s.getInlineResponseUrl(this.swaggerEditorDataService.SwaggerEditorData,this.actionIndex,"action",t))},e.prototype.navigateToReferenceResponse=function(e,t){var i=a.getReferenceResponseIndex(this.swaggerEditorDataService.SwaggerEditorData,e,t);i>=0&&this.navigationService.navigate(s.getReferenceUrl(this.swaggerEditorDataService.SwaggerEditorData,e,i))},e.prototype.navigateToInlineParameter=function(e,t){a.isInlineParameterIndexValid(e,this.action)&&this.navigationService.navigate(s.getInlineParameterUrl(this.swaggerEditorDataService.SwaggerEditorData,this.actionIndex,"action",e))},e.prototype.showRequestPane=function(){this.importPane.isRequestPane=!0,this.showPane()},e.prototype.showResponsePane=function(){this.importPane.isRequestPane=!1,this.showPane()},e.prototype.showPane=function(){var e=this;this.$timeout(function(){e.importPane.isVisible=!0})},e.prototype.importSampleRequest=function(e){this.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiImportFromSampleRequestClicked),a.updateActionRequest(e.url,e.verb,e.headers,e.body,this.action,this.swaggerEditorDataService.SwaggerEditorData,this.clientResources)&&this.processRequest(),this.clearPaneData()},e.prototype.importSampleResponse=function(e){this.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiImportFromSampleResponseClicked),a.updateActionResponse(e.headers,e.body,this.action,this.swaggerEditorDataService.SwaggerEditorData,this.clientResources)&&this.processResponses(),this.clearPaneData()},e.prototype.clearPaneData=function(){this.importPane.isVisible=!1,this.importSampleModel={url:"",verb:void 0,headers:"",body:""}},e.prototype.visibilityChanged=function(){this.operationVisibility===n.Visibility.none?delete this.action.operation[n.Swagger.Visibility]:this.action.operation[n.Swagger.Visibility]=this.operationVisibility},e.$inject=[r.default.services.$routeParams,r.default.services.$scope,r.default.services.$timeout,r.default.services.appSettings,r.default.services.clientResources,r.default.services.navigation,r.default.services.swaggerEditorData,r.default.services.swaggerValidationService,r.default.services.telemetry],e}();t.CustomApiActionCtrl=d},function(e,t){},function(e,t){e.exports='<div class="subsection-manage custom-api-action"> <section> <div class="pane-title"> <span>{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Heading}}</span> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label"> <span class="context-required-text">*</span> {{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Summary.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Summary.Hyperlink\'"/> </label> <validated-input input-model="customApiActionCtrl.action.operation.summary" validation-result-collection="customApiActionCtrl.validationFilters.summary.resultCollection" is-required="true"/> </div> <div class="pane-field"> <label class="pane-field-label"> <span class="context-required-text">*</span> {{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Description.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Description.Hyperlink\'"/> </label> <validated-input input-model="customApiActionCtrl.action.operation.description" validation-result-collection="customApiActionCtrl.validationFilters.description.resultCollection" is-required="true"/> </div> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.OperationId.Label}}</label> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.OperationId.Subtitle}}</label> <validated-input input-model="customApiActionCtrl.action.operation.operationId" validation-result-collection="customApiActionCtrl.validationFilters.operationId.resultCollection" is-required="true"/> </div> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"> {{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Visibility.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Visibility.Hyperlink\'"/> </legend> <div> <div ng-repeat="visibilityItem in customApiActionCtrl.visibilityItems"> <label class="c-label"> <input type="radio" aria-label="{{visibilityItem.visibility}}" name="visibilityFieldset" ng-value="visibilityItem.displayName" ng-change="customApiActionCtrl.visibilityChanged()" ng-model="customApiActionCtrl.operationVisibility"/> <span>{{visibilityItem.displayName}}</span> </label> </div> </div> </fieldset> </div> </div> </section> <section class="section-custom-api-action-section"> <h5 class="c-heading-5">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Heading}}</h5> <p class="c-subheading-5">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Request.Description}}</p> <div class="request-pane"> <div class="pane-title"> <span>{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Heading}}</span> <a href="#" role="button" class="c-glyph glyph-download import-heading" ng-click="customApiActionCtrl.showRequestPane()">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label}}</a> </div> <div class="pane-content"> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"><span class="context-required-text">*</span> {{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Heading}}</legend> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Description}}</label> <div> <div ng-repeat="verb in customApiActionCtrl.verbs track by verb.method"> <label class="c-label"> <input type="radio" aria-label="{{verb.method}}" name="verbFieldset" value="{{verb.displayName}}" ng-checked="verb.method === customApiActionCtrl.action.method" ng-model="customApiActionCtrl.action.method" ng-change="customApiActionCtrl.action.method = verb.method"> <span>{{verb.displayName}}</span> </label> </div> </div> </fieldset> </div> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Heading}}</label> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Description}}</label> <validated-input input-model="customApiActionCtrl.action.path" validation-result-collection="customApiActionCtrl.validationFilters.path.resultCollection" is-read-only="true" is-required="true"/> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Path.Heading}}</label> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Path.Description}}</label> <div class="pane-elements"> <token-block ng-repeat="pathParameter in customApiActionCtrl.request.pathParameters track by pathParameter.name" commands="customApiActionCtrl.dropdownCommands" token="pathParameter" required="pathParameter.required" title="pathParameter.name" icon-url="customApiActionCtrl.getIconUrlForParameter(pathParameter)"></token-block> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Query.Heading}}</label> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Query.Description}}</label> <div class="pane-elements"> <token-block ng-repeat="queryParameter in customApiActionCtrl.request.queryParameters track by queryParameter.name" commands="customApiActionCtrl.dropdownCommands" token="queryParameter" required="queryParameter.required" title="queryParameter.name" icon-url="customApiActionCtrl.getIconUrlForParameter(queryParameter)"></token-block> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Heading}}</label> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Description}}</label> <div class="pane-elements"> <token-block ng-repeat="headerParameter in customApiActionCtrl.request.headerParameters track by headerParameter.name" commands="customApiActionCtrl.dropdownCommands" token="headerParameter" required="headerParameter.required" title="headerParameter.name" icon-url="customApiActionCtrl.getIconUrlForParameter(headerParameter)"></token-block> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Heading}}</label> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Description}}</label> <div class="pane-elements"> <token-block ng-if="customApiActionCtrl.request.bodyParameter" commands="customApiActionCtrl.dropdownCommands" token="customApiActionCtrl.request.bodyParameter" required="customApiActionCtrl.request.bodyParameter.required" title="customApiActionCtrl.request.bodyParameter.name" icon-url="customApiActionCtrl.validationFilters.bodyParameter.resultCollection.mostSevereResultTypeImage"></token-block> </div> </div> </div> </div> </section> <section class="section-custom-api-action-section"> <h5 class="c-heading-5">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Response.Heading}}</h5> <p class="c-subheading-5">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Response.Description}}</p> <div class="pane-content response-item" ng-repeat="response in customApiActionCtrl.responses" ng-click="customApiActionCtrl.navigateToResponse(response.name)"> <span class="status-code" title="{{response.name}}">{{response.name}}</span> <span class="display-name" title="{{response.responseWithResolvedReference.description}}">{{response.responseWithResolvedReference.description}}</span> <img src="{{customApiActionCtrl.getIconUrlForResponse(response)}}"/> </div> <div class="add-response"> <a href="#" role="button" class="f-lightweight c-glyph glyph-download" ng-click="customApiActionCtrl.showResponsePane()">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.AddResponse.Label}}</a> </div> </section> <section class="section-custom-api-action-section"> <validation-results heading-above-pane="customApiActionCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading" sub-heading-above-pane="customApiActionCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.Action" base-violator="customApiActionCtrl.baseViolator" include-referenced-results="true"/> </section> <hr/> <info-pane class="import-sample-pane" pane-title="customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label" expanded="customApiActionCtrl.importPane.isVisible"> <div ng-if="customApiActionCtrl.importPane.isRequestPane" class="request-content"> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"><span class="context-required-text">*</span> {{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Heading}}</legend> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Description}}</label> <div> <div ng-repeat="verb in customApiActionCtrl.verbs track by verb.method"> <label class="c-label"> <input type="radio" aria-label="{{verb.method}}" ng-value="verb" ng-checked="verb === customApiActionCtrl.importSampleModel.verb" ng-model="customApiActionCtrl.importSampleModel.verb"> <span>{{verb.displayName}}</span> </label> </div> </div> </fieldset> </div> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Heading}}</label> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.UrlSample.Description}}</label> <input class="c-text-field" type="text" ng-model="customApiActionCtrl.importSampleModel.url" maxlength="customApiActionCtrl.urlMaxLength" placeholder="{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Url.Placeholder}}" aria-required="true"/> </div> </div> <div class="pane-field c-textarea"> <label class="pane-field-label">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Heading}}</label> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Description}}</label> <textarea class="f-no-resize f-scroll textarea-content" name="textarea-default" rows="5" maxlength="customApiActionCtrl.contentMaxLength" ng-attr-placeholder="{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Headers.Placeholder}}" ng-model="customApiActionCtrl.importSampleModel.headers"></textarea> </div> <div class="pane-field c-textarea"> <label class="pane-field-label">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Heading}}</label> <label class="subtitle">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Description}}</label> <textarea class="f-no-resize f-scroll textarea-content" name="textarea-default" rows="10" maxlength="customApiActionCtrl.contentMaxLength" ng-attr-placeholder="{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Body.Placeholder}}" ng-model="customApiActionCtrl.importSampleModel.body"></textarea> </div> <section class="save-discard"> <button type="submit" ng-click="customApiActionCtrl.importPane.isRequestPane ? customApiActionCtrl.importSampleRequest(customApiActionCtrl.importSampleModel) : customApiActionCtrl.importSampleResponse(customApiActionCtrl.importSampleModel)" class="c-button">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Import.Label}}</button> <button ng-click="customApiActionCtrl.clearPaneData()" class="c-button btn-secondary">{{customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Close.Label}}</button> </section> </info-pane> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1056);i(1057);var o=function(){function e(){this.template=i(1058),this.controller=n.CustomApiDefinitionCtrl,this.controllerAs="customApiDefinitionCtrl"}return e}();t.CustomApiDefinition=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.customApiDefinition,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(34),o=i(100),s=i(24),a=i(48),l=i(16),c=i(6),u=i(11),p=function(){function e(e,t,i,r,n,a,l,p,d){var g=this;if(this.$routeParams=e,this.$scope=t,this.$timeout=i,this.appSettings=r,this.clientResources=n,this.navigationService=a,this.swaggerEditorDataService=l,this.swaggerValidationService=p,this.telemetryService=d,this.schemaProperties=[],this.referencingOperationItems=[],this.validationFilters={},this.backButton={url:"",click:function(){g.selectedSchemaPropertyIndex=void 0,g.processSchema()},showLabel:!0},this.telemetryService.tagEvent(c.TelemetryEventNames.CustomApiDefinitionVisited),this.definitionIndex=this.$routeParams.definitionIndex,this.baseViolator=new u.Violator({itemPath:u.Paths.Definitions+"["+this.definitionIndex+"]"}),this.schemaSwaggerItem={itemPath:""+this.baseViolator.fullSwaggerPath+u.Paths.Item},this.validationFilters={name:new u.FilteredResults(new u.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:u.Paths.Name}))},this.processSchema(),this.selectedSchemaPropertyIndex=void 0,this.dropdownCommands=[{text:this.clientResources.Manage.Apis.EditToolTip,iconUrl:"glyph-edit",click:function(e){g.selectedSchemaPropertyIndex=g.schemaProperties.indexOf(e),g.selectedSchemaPropertyViolator=new u.Violator(g.schemaSwaggerItem,{schemaProperty:e})}}],this.appSettings.featureFlags.enableSwaggerEditorDynamicValues){var m=s.getReferencingItemsOfDefinition(this.swaggerEditorDataService.swagger,this.definition.name);this.referencingOperationItems=m.map(function(e){return e.operationItem}),this.inRequest=m.some(function(e){return e.referenceType===s.parameterType})}this.$scope.$watch(function(){return g.selectedSchemaProperty},function(e,t){e&&t&&e.key===t.key&&o.saveSchemaProperty(g.swaggerEditorDataService.swagger,g.selectedSchemaProperty,g.definition.item,"#/definitions/"+g.definition.name,e.required!==t.required)},!0),this.$scope.$watchGroup([function(){return g.swaggerValidationService.resultCollection.results},function(){return g.validationFilters}],function(){Object.keys(g.validationFilters).map(function(e){return g.validationFilters[e]}).forEach(function(e){return e.updateFilteredResults(g.swaggerValidationService.resultCollection)})})}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.swaggerEditorDataService.swagger.definitions[this.definitionIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedSchemaProperty",{get:function(){return this.schemaProperties?this.schemaProperties[this.selectedSchemaPropertyIndex]:null},enumerable:!0,configurable:!0}),e.prototype.processSchema=function(){var e=this;this.resolvedSchema=n.resolveSchema(this.swaggerEditorDataService.swagger,this.definition.item),this.schemaProperties=n.getLeafSchemaProperties(this.resolvedSchema.schema),this.schemaProperties.forEach(function(t){e.validationFilters[t.key]||(e.validationFilters[t.key]=new u.FilteredResults(new u.Violator(e.schemaSwaggerItem,{schemaProperty:t})))})},e.prototype.getSchemaPropertyIconUrl=function(e){return this.validationFilters[e.key]?this.validationFilters[e.key].resultCollection.mostSevereResultTypeImage:null},e.prototype.navigateToReference=function(e){var t=this.swaggerEditorDataService.swagger.definitions.indexOf(this.swaggerEditorDataService.swagger.definitions.filter(function(t){return t.name===e})[0]);this.navigationService.navigate(a.getReferenceUrl(this.swaggerEditorDataService.SwaggerEditorData,{name:"",source:l.ReferenceSource.definitions},t))},e.$inject=[r.default.services.$routeParams,r.default.services.$scope,r.default.services.$timeout,r.default.services.appSettings,r.default.services.clientResources,r.default.services.navigation,r.default.services.swaggerEditorData,r.default.services.swaggerValidationService,r.default.services.telemetry],e}();t.CustomApiDefinitionCtrl=p},function(e,t){},function(e,t){e.exports='<div class="subsection-manage custom-api-definition"> <section ng-if="customApiDefinitionCtrl.selectedSchemaPropertyIndex !== undefined"> <backbutton model="customApiDefinitionCtrl.backButton"></backbutton> </section> <div ng-if="customApiDefinitionCtrl.selectedSchemaPropertyIndex === undefined"> <section> <div class="pane-title"> <span>{{customApiDefinitionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Heading}}</span> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiDefinitionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Name.Label}}</label> <validated-input input-model="customApiDefinitionCtrl.definition.name" validation-result-collection="customApiDefinitionCtrl.validationFilters.name.resultCollection" is-required="true"/> </div> <div class="pane-field" ng-if="customApiDefinitionCtrl.resolvedSchema.referencesUsed.length > 0"> <label class="pane-field-label">{{customApiDefinitionCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Heading}}</label> <label class="subtitle">{{customApiDefinitionCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Description}}</label> <div class="pane-elements"> <div ng-repeat="reference in customApiDefinitionCtrl.resolvedSchema.referencesUsed"> <a class="reference-link" href="#" ng-click="customApiDefinitionCtrl.navigateToReference(reference)">{{reference}}</a> </div> </div> </div> <div class="pane-field" ng-if="customApiDefinitionCtrl.schemaProperties.length > 0"> <label class="pane-field-label">{{customApiDefinitionCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Heading}}</label> <label class="subtitle">{{customApiDefinitionCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Description}}</label> <div class="pane-elements"> <token-block ng-repeat="schemaProperty in customApiDefinitionCtrl.schemaProperties track by schemaProperty.key" commands="customApiDefinitionCtrl.dropdownCommands" token="schemaProperty" required="schemaProperty.required" title="schemaProperty.title || schemaProperty.name" icon-url="customApiDefinitionCtrl.getSchemaPropertyIconUrl(schemaProperty)"></token-block> </div> </div> </div> </section> <section> <validation-results heading-above-pane="customApiDefinitionCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading" sub-heading-above-pane="customApiDefinitionCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.Definition" base-violator="customApiDefinitionCtrl.baseViolator"/> </section> </div> <section ng-if="customApiDefinitionCtrl.selectedSchemaPropertyIndex !== undefined"> <schema-property items="customApiDefinitionCtrl.schemaProperties" index="customApiDefinitionCtrl.selectedSchemaPropertyIndex" base-violator="customApiDefinitionCtrl.selectedSchemaPropertyViolator" referencing-operation-items="customApiDefinitionCtrl.referencingOperationItems" in-request="customApiDefinitionCtrl.inRequest"></schema-property> </section> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1060);i(1061);var o=function(){function e(){this.template=i(1062),this.controller=n.CustomApiParameterCtrl,this.controllerAs="customApiParameterCtrl"}return e}();t.CustomApiParameter=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.customApiParameter,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(27),o=i(1),s=i(6),a=i(16),l=i(48),c=i(34),u=i(100),p=i(24),d=i(221),g=i(11),m=function(){function e(e,t,i,r,c,m,f,h,v){var y=this;this.$routeParams=e,this.$scope=t,this.$timeout=i,this.appSettings=r,this.clientResources=c,this.navigationService=m,this.swaggerEditorDataService=f,this.swaggerValidationService=h,this.telemetryService=v,this.referencingOperationItems=[],this.validationFilters={},this.requiredOptions=[{displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Required.Yes,value:!0},{displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Required.No,value:!1}],this.locationOptions=[{displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Path,value:n.ParameterLocations.path},{displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Query,value:n.ParameterLocations.query},{displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Header,value:n.ParameterLocations.header},{displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Body,value:n.ParameterLocations.body}],this.schemaProperties=[],this.backButton={url:"",click:function(){o.isNullOrUndefined(y.selectedSchemaPropertyIndex)?o.isNullOrUndefined(y.actionIndex)?o.isNullOrUndefined(y.triggerIndex)||y.navigationService.navigate(l.getTriggerUrl(y.swaggerEditorDataService.SwaggerEditorData,y.triggerIndex)):y.navigationService.navigate(l.getActionUrl(y.swaggerEditorDataService.SwaggerEditorData,y.actionIndex)):y.selectedSchemaPropertyIndex=void 0},showLabel:!0},this.availableTypes=[n.Types.string,n.Types.integer,n.Types.number,n.Types.boolean,n.Types.array],this.availableFormats={string:["","byte","binary","date","date-time","password"],integer:["int32","int64"],number:["float","double"],boolean:null,array:null,object:null},this.visibilityItems=Object.keys(a.Visibility).map(function(e){return a.Visibility[e]}).map(function(e){return{visibility:e,displayName:e}}),this.parameterGetter=(w={},w[d.Mode.InlineAction]=function(){return y.swaggerEditorDataService.swagger.actions[y.actionIndex].operation.parameters[y.parameterIndex]},w[d.Mode.InlineTrigger]=function(){return y.swaggerEditorDataService.swagger.triggers[y.triggerIndex].operation.parameters[y.parameterIndex]},w[d.Mode.Definition]=function(){return y.swaggerEditorDataService.swagger.parameters[y.parameterIndex].item},w[d.Mode.Undefined]=function(){return{}},w),this.parameterReferenceGetter=(C={},C[d.Mode.InlineAction]=function(){return""},C[d.Mode.InlineTrigger]=function(){return""},C[d.Mode.Definition]=function(){return"#/parameters/"+y.swaggerEditorDataService.swagger.parameters[y.parameterIndex].name},C[d.Mode.Undefined]=function(){return""},C),this.operationItemGetter=(S={},S[d.Mode.InlineAction]=function(){return y.swaggerEditorDataService.swagger.actions[y.actionIndex]},S[d.Mode.InlineTrigger]=function(){return y.swaggerEditorDataService.swagger.triggers[y.triggerIndex]},S[d.Mode.Definition]=function(){return null},S[d.Mode.Undefined]=function(){return null},S),this.baseViolatorGetter=(b={},b[d.Mode.InlineAction]=function(){return new g.Violator({itemPath:g.Paths.Actions+"["+y.actionIndex+"]"+g.Paths.OperationParameters+"["+y.parameterIndex+"]"})},b[d.Mode.InlineTrigger]=function(){return new g.Violator({itemPath:g.Paths.Triggers+"["+y.triggerIndex+"]"+g.Paths.OperationParameters+"["+y.parameterIndex+"]"})},b[d.Mode.Definition]=function(){return new g.Violator({itemPath:g.Paths.Parameters+"["+y.parameterIndex+"]"+g.Paths.Item})},b[d.Mode.Undefined]=function(){return null},b),this.telemetryService.tagEvent(s.TelemetryEventNames.CustomApiParameterVisited),this.actionIndex=this.$routeParams.actionIndex,this.triggerIndex=this.$routeParams.triggerIndex,this.parameterIndex=this.$routeParams.parameterIndex,this.mode=d.Mode.Undefined,o.isNullOrUndefined(this.actionIndex)||o.isNullOrUndefined(this.parameterIndex)?o.isNullOrUndefined(this.triggerIndex)||o.isNullOrUndefined(this.parameterIndex)?o.isNullOrUndefined(this.parameterIndex)||(this.mode=d.Mode.Definition):this.mode=d.Mode.InlineTrigger:this.mode=d.Mode.InlineAction,this.baseViolator=this.baseViolatorGetter[this.mode](),this.schemaSwaggerItem={itemPath:this.baseViolator.fullSwaggerPath,propertyPath:g.Paths.Schema},this.validationFilters={name:new g.FilteredResults(new g.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:g.Paths.Name})),summary:new g.FilteredResults(new g.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:g.Paths.XMsSummary})),description:new g.FilteredResults(new g.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:g.Paths.Description})),default:new g.FilteredResults(new g.Violator({itemPath:this.baseViolator?this.baseViolator.fullSwaggerPath:void 0,propertyPath:g.Paths.Default}))},this.parameterVisibility=this.parameter[a.Swagger.Visibility]||a.Visibility.none,this.selectedSchemaPropertyIndex=void 0,this.processSchema(),this.dropdownCommands=[{text:this.clientResources.Manage.Apis.EditToolTip,iconUrl:"glyph-edit",click:function(e){y.selectedSchemaPropertyIndex=y.schemaProperties.indexOf(e),y.selectedSchemaPropertyViolator=new g.Violator(y.schemaSwaggerItem,{schemaProperty:e})}}],this.mode===d.Mode.InlineAction||this.mode===d.Mode.InlineTrigger?this.referencingOperationItems=[this.operationItem]:this.mode===d.Mode.Definition&&(this.referencingOperationItems=p.getOperationsWithParameterReference(this.swaggerEditorDataService.swagger,this.swaggerEditorDataService.swagger.parameters[this.parameterIndex].name)),this.$scope.$watch(function(){return y.selectedSchemaProperty},function(e,t){e&&t&&e.key===t.key&&u.saveSchemaProperty(y.swaggerEditorDataService.swagger,y.selectedSchemaProperty,y.parameter.schema,y.parameterReferenceGetter[y.mode](),e.required!==t.required)},!0),this.$scope.$watchGroup([function(){return y.swaggerValidationService.resultCollection.results},function(){return y.validationFilters}],function(){Object.keys(y.validationFilters).map(function(e){return y.validationFilters[e]}).forEach(function(e){return e.updateFilteredResults(y.swaggerValidationService.resultCollection)})});var w,C,S,b}return Object.defineProperty(e.prototype,"parameter",{get:function(){return this.parameterGetter[this.mode]()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"operationItem",{get:function(){return this.operationItemGetter[this.mode]()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldDisplayBackButton",{get:function(){return!o.isNullOrUndefined(this.selectedSchemaPropertyIndex)||!o.isNullOrUndefined(this.actionIndex)||!o.isNullOrUndefined(this.triggerIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBodyParameter",{get:function(){return"body"===this.parameter.in},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedSchemaProperty",{get:function(){return this.schemaProperties?this.schemaProperties[this.selectedSchemaPropertyIndex]:null},enumerable:!0,configurable:!0}),e.prototype.processSchema=function(){var e=this;this.isBodyParameter&&this.parameter.schema&&(this.resolvedSchema=c.resolveSchema(this.swaggerEditorDataService.swagger,this.parameter.schema),this.schemaProperties=c.getLeafSchemaProperties(this.resolvedSchema.schema),this.schemaProperties.forEach(function(t){e.validationFilters[t.key]||(e.validationFilters[t.key]=new g.FilteredResults(new g.Violator(e.schemaSwaggerItem,{schemaProperty:t})))}))},e.prototype.getSchemaPropertyIconUrl=function(e){return this.validationFilters[e.key]?this.validationFilters[e.key].resultCollection.mostSevereResultTypeImage:null},e.prototype.visibilityChanged=function(){this.parameterVisibility===a.Visibility.none?delete this.parameter[a.Swagger.Visibility]:this.parameter[a.Swagger.Visibility]=this.parameterVisibility},e.$inject=[r.default.services.$routeParams,r.default.services.$scope,r.default.services.$timeout,r.default.services.appSettings,r.default.services.clientResources,r.default.services.navigation,r.default.services.swaggerEditorData,r.default.services.swaggerValidationService,r.default.services.telemetry],e}();t.CustomApiParameterCtrl=m},function(e,t){},function(e,t){e.exports='<div class="subsection-manage custom-api-parameter"> <section ng-if="customApiParameterCtrl.shouldDisplayBackButton"> <backbutton model="customApiParameterCtrl.backButton"></backbutton> </section> <div> <section ng-if="customApiParameterCtrl.selectedSchemaPropertyIndex === undefined"> <div class="pane-title"> <span>{{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Heading}}</span> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Name.Label}}</label> <validated-input input-model="customApiParameterCtrl.parameter.name" validation-result-collection="customApiParameterCtrl.validationFilters.name.resultCollection" is-required="true"/> </div> <div class="pane-field" ng-if="!customApiParameterCtrl.isBodyParameter"> <label class="pane-field-label"> {{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Description.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Description.Hyperlink\'"/> </label> <validated-input input-model="customApiParameterCtrl.parameter.description" validation-result-collection="customApiParameterCtrl.validationFilters.description.resultCollection"/> </div> <div class="pane-field" ng-if="!customApiParameterCtrl.isBodyParameter"> <label class="pane-field-label"> {{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Summary.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Summary.Hyperlink\'"/> </label> <validated-input input-model="customApiParameterCtrl.parameter[\'x-ms-summary\']" validation-result-collection="customApiParameterCtrl.validationFilters.summary.resultCollection"/> </div> <div class="pane-field" ng-if="!customApiParameterCtrl.isBodyParameter"> <label class="pane-field-label">{{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.DefaultValue.Label}}</label> <validated-input input-model="customApiParameterCtrl.parameter.default" validation-result-collection="customApiParameterCtrl.validationFilters.default.resultCollection"/> </div> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"><span class="context-required-text">*</span> {{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Required.Label}}</legend> <div class="c-group"> <div ng-repeat="option in customApiParameterCtrl.requiredOptions track by option.displayName"> <label class="c-label"> <input type="radio" aria-label="{{option.displayName}}" ng-value="option.value" ng-checked="option.value === customApiParameterCtrl.parameter.required" ng-model="customApiParameterCtrl.parameter.required"/> <span>{{option.displayName}}</span> </label> </div> </div> </fieldset> </div> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"> {{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.General.Visibility.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Visibility.Hyperlink\'"/> </legend> <div> <div ng-repeat="visibilityItem in customApiParameterCtrl.visibilityItems"> <label class="c-label"> <input type="radio" aria-label="{{visibilityItem.visibility}}" name="visibilityFieldset" ng-value="visibilityItem.displayName" ng-change="customApiParameterCtrl.visibilityChanged()" ng-model="customApiParameterCtrl.parameterVisibility"/> <span>{{visibilityItem.displayName}}</span> </label> </div> </div> </fieldset> </div> <div class="pane-field"> <fieldset class="c-radio f-inline" disabled="disabled"> <legend class="pane-field-label"><span class="context-required-text">*</span> {{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Label}}</legend> <div class="c-group"> <div ng-repeat="option in customApiParameterCtrl.locationOptions track by option.displayName"> <label class="c-label"> <input type="radio" aria-label="{{option.displayName}}" ng-value="option.value" ng-checked="option.value === customApiParameterCtrl.parameter.in" ng-model="customApiParameterCtrl.parameter.in"/> <span>{{option.displayName}}</span> </label> </div> </div> </fieldset> </div> <div class="pane-field" ng-if="!customApiParameterCtrl.isBodyParameter"> <div class="select-option-container"> <label class="pane-field-label">{{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Type.Label}}</label> <select ng-model="customApiParameterCtrl.parameter.type" type="text" class="select-option"> <option ng-repeat="type in customApiParameterCtrl.availableTypes" value="{{type}}">{{type}}</option> </select> </div><div class="select-option-container"> <label class="pane-field-label">{{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Format.Label}}</label> <select ng-model="customApiParameterCtrl.parameter.format" type="text" ng-disabled="customApiParameterCtrl.parameter.type == null || customApiParameterCtrl.availableFormats[customApiParameterCtrl.parameter.type] === null" class="select-option"> <option ng-repeat="format in customApiParameterCtrl.availableFormats[customApiParameterCtrl.parameter.type]" value="{{format}}">{{format}}</option> </select> </div> </div> <parameter-dropdown-editor ng-if="customApiParameterCtrl.appSettings.featureFlags.enableSwaggerEditorDynamicValues && !customApiParameterCtrl.isBodyParameter" parameter="customApiParameterCtrl.parameter" operation-items="customApiParameterCtrl.referencingOperationItems"> </parameter-dropdown-editor> <div class="pane-field" ng-if="customApiParameterCtrl.isBodyParameter && customApiParameterCtrl.schemaProperties.length > 0"> <label class="pane-field-label">{{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Heading}}</label> <label class="subtitle">{{customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Description}}</label> <div class="pane-elements"> <token-block ng-repeat="schemaProperty in customApiParameterCtrl.schemaProperties track by schemaProperty.key" commands="customApiParameterCtrl.dropdownCommands" token="schemaProperty" required="schemaProperty.required" title="schemaProperty.title || schemaProperty.name" icon-url="customApiParameterCtrl.getSchemaPropertyIconUrl(schemaProperty)"></token-block> </div> </div> </div> </section> <section ng-if="customApiParameterCtrl.selectedSchemaPropertyIndex === undefined "> <validation-results heading-above-pane="customApiParameterCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading" sub-heading-above-pane="customApiParameterCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.Parameter" base-violator="customApiParameterCtrl.baseViolator"/> </section> </div> <section ng-if="customApiParameterCtrl.selectedSchemaPropertyIndex !== undefined"> <schema-property items="customApiParameterCtrl.schemaProperties" index="customApiParameterCtrl.selectedSchemaPropertyIndex" base-violator="customApiParameterCtrl.selectedSchemaPropertyViolator" referencing-operation-items="customApiParameterCtrl.referencingOperationItems" in-request="true"></schema-property> </section> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1064);i(1065);var o=function(){function e(){this.template=i(1066),this.controller=n.CustomApiResponseCtrl,this.controllerAs="customApiResponseCtrl"}return e}();t.CustomApiResponse=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.customApiResponse,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(34),o=i(100),s=i(48),a=i(16),l=i(61),c=i(48),u=i(1),p=i(15),d=i(6),g=i(221),m=i(11),f=function(){function e(e,t,i,r,n,s,a,l,p){var f=this;this.$routeParams=e,this.$scope=t,this.$timeout=i,this.appSettings=r,this.clientResources=n,this.navigationService=s,this.swaggerEditorDataService=a,this.swaggerValidationService=l,this.telemetryService=p,this.contentMaxLength=1048576,this.headerTypes=["boolean","integer","number","string"],this.schemaProperties=[],this.validationFilters={},this.backButton={url:"",click:function(){u.isNullOrUndefined(f.selectedSchemaPropertyIndex)?u.isNullOrUndefined(f.actionIndex)?u.isNullOrUndefined(f.triggerIndex)||f.navigationService.navigate(c.getTriggerUrl(f.swaggerEditorDataService.SwaggerEditorData,f.triggerIndex)):f.navigationService.navigate(c.getActionUrl(f.swaggerEditorDataService.SwaggerEditorData,f.actionIndex)):(f.selectedSchemaPropertyIndex=void 0,f.processSchema())},showLabel:!0},this.isPaneVisible=!1,this.responseGetter=(h={},h[g.Mode.InlineAction]=function(){return f.swaggerEditorDataService.swagger.actions[f.actionIndex].operation.responses[f.responseIndex]},h[g.Mode.InlineTrigger]=function(){return f.swaggerEditorDataService.swagger.triggers[f.triggerIndex].operation.responses[f.responseIndex]},h[g.Mode.Definition]=function(){return f.swaggerEditorDataService.swagger.responses[f.responseIndex]},h[g.Mode.Undefined]=function(){return{}},h),this.responseReferenceGetter=(v={},v[g.Mode.InlineAction]=function(){return""},v[g.Mode.InlineTrigger]=function(){return""},v[g.Mode.Definition]=function(){return"#/responses/"+f.swaggerEditorDataService.swagger.responses[f.responseIndex].name},v[g.Mode.Undefined]=function(){return""},v),this.baseViolatorGetter=(y={},y[g.Mode.InlineAction]=function(){return new m.Violator({itemPath:m.Paths.Actions+"["+f.actionIndex+"]"+m.Paths.OperationResponses+"["+f.responseIndex+"]"})},y[g.Mode.InlineTrigger]=function(){return new m.Violator({itemPath:m.Paths.Triggers+"["+f.triggerIndex+"]"+m.Paths.OperationResponses+"["+f.responseIndex+"]"})},y[g.Mode.Definition]=function(){return new m.Violator({itemPath:m.Paths.Responses+"["+f.responseIndex+"]"})},y[g.Mode.Undefined]=function(){return null},y),this.telemetryService.tagEvent(d.TelemetryEventNames.CustomApiResponseVisited),this.actionIndex=this.$routeParams.actionIndex,this.triggerIndex=this.$routeParams.triggerIndex,this.responseIndex=this.$routeParams.responseIndex,this.mode=g.Mode.Undefined,u.isNullOrUndefined(this.actionIndex)||u.isNullOrUndefined(this.responseIndex)?u.isNullOrUndefined(this.triggerIndex)||u.isNullOrUndefined(this.responseIndex)?u.isNullOrUndefined(this.responseIndex)||(this.mode=g.Mode.Definition):this.mode=g.Mode.InlineTrigger:this.mode=g.Mode.InlineAction,this.baseViolator=this.baseViolatorGetter[this.mode](),this.schemaSwaggerItem={itemPath:""+this.baseViolator.fullSwaggerPath+m.Paths.Item,propertyPath:m.Paths.Schema},this.validationFilters={name:new m.FilteredResults(new m.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:m.Paths.Name}))},this.processSchema(),this.selectedSchemaPropertyIndex=void 0,this.dropdownCommands=[{text:this.clientResources.Manage.Apis.EditToolTip,iconUrl:"glyph-edit",click:function(e){f.selectedSchemaPropertyIndex=f.schemaProperties.indexOf(e),f.selectedSchemaPropertyViolator=new m.Violator(f.schemaSwaggerItem,{schemaProperty:e})}}],this.$scope.$watch(function(){return f.selectedSchemaProperty},function(e,t){e&&t&&e.key===t.key&&o.saveSchemaProperty(f.swaggerEditorDataService.swagger,f.selectedSchemaProperty,f.response.item.schema,f.responseReferenceGetter[f.mode](),!1)},!0),this.$scope.$watchGroup([function(){return f.swaggerValidationService.resultCollection.results},function(){return f.validationFilters}],function(){Object.keys(f.validationFilters).map(function(e){return f.validationFilters[e]}).forEach(function(e){return e.updateFilteredResults(f.swaggerValidationService.resultCollection)})});var h,v,y}return Object.defineProperty(e.prototype,"selectedSchemaProperty",{get:function(){return this.schemaProperties?this.schemaProperties[this.selectedSchemaPropertyIndex]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"response",{get:function(){return this.responseGetter[this.mode]()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldDisplayBackButton",{get:function(){return!u.isNullOrUndefined(this.selectedSchemaPropertyIndex)||!u.isNullOrUndefined(this.actionIndex)||!u.isNullOrUndefined(this.triggerIndex)},enumerable:!0,configurable:!0}),e.prototype.getSchemaPropertyIconUrl=function(e){return this.validationFilters[e.key]?this.validationFilters[e.key].resultCollection.mostSevereResultTypeImage:null},e.prototype.processSchema=function(){var e=this;this.response.item.schema&&(this.resolvedSchema=n.resolveSchema(this.swaggerEditorDataService.SwaggerEditorData.swagger,this.response.item.schema),this.schemaProperties=n.getLeafSchemaProperties(this.resolvedSchema.schema),this.schemaProperties.forEach(function(t){e.validationFilters[t.key]||(e.validationFilters[t.key]=new m.FilteredResults(new m.Violator(e.schemaSwaggerItem,{schemaProperty:t})))}))},e.prototype.navigateToReference=function(e){var t=this.swaggerEditorDataService.SwaggerEditorData.swagger,i=t.definitions.indexOf(t.definitions.filter(function(t){return t.name===e})[0]);this.navigationService.navigate(s.getReferenceUrl(this.swaggerEditorDataService.SwaggerEditorData,{name:"",source:a.ReferenceSource.definitions},i))},e.prototype.importSampleResponse=function(e){if(this.telemetryService.tagEvent(d.TelemetryEventNames.CustomApiImportFromSampleResponseClicked),!u.isEmpty(e.body)||!u.isEmpty(e.headers)){var t=n.generateSchemaFromJson(e.body);if(u.isNullOrUndefined(t))return void(this.swaggerEditorDataService.SwaggerEditorData.validatationError=new p.ClientError(p.ErrorCodes.customApiImportFromSampleError,this.clientResources.Manage.CustomApi.RightPane.Definition.ImportFromSampleResponse.Error,null));this.response.item.schema=t;var i=l.getHeadersForResponse(e.headers);u.isEmpty(i)?delete this.response.item.headers:this.response.item.headers=i,this.processSchema(),this.clearPaneData()}},e.prototype.clearPaneData=function(){this.isPaneVisible=!1,this.importSampleModel={headers:"",body:""}},e.prototype.showPane=function(){var e=this;this.isPaneVisible=!0,this.$timeout(function(){e.isPaneVisible=!0})},e.$inject=[r.default.services.$routeParams,r.default.services.$scope,r.default.services.$timeout,r.default.services.appSettings,r.default.services.clientResources,r.default.services.navigation,r.default.services.swaggerEditorData,r.default.services.swaggerValidationService,r.default.services.telemetry],e}();t.CustomApiResponseCtrl=f},function(e,t){},function(e,t){e.exports='<div class="subsection-manage custom-api-response"> <section ng-if="customApiResponseCtrl.shouldDisplayBackButton"> <backbutton model="customApiResponseCtrl.backButton"></backbutton> </section> <div ng-if="customApiResponseCtrl.selectedSchemaPropertyIndex === undefined"> <section> <div class="pane-title"> <span>{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Heading}}</span> <a href="#" role="button" class="c-glyph glyph-download import-heading" ng-click="customApiResponseCtrl.showPane()">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label}}</a> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Name.Label}}</label> <validated-input input-model="customApiResponseCtrl.response.name" validation-result-collection="customApiResponseCtrl.validationFilters.name.resultCollection" is-required="true"/> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Headers.Heading}}</label> <label class="subtitle">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Headers.Description}}</label> <div ng-if="customApiResponseCtrl.response.item.headers"> <div class="pane-field"> <div class="pane-table"> <div class="row pane-table-header"> <div class="column medium-4"> <label>{{customApiResponseCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Name}}</label> </div> <div class="column medium-5"> <label>{{customApiResponseCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Description}}</label> </div> <div class="column medium-3"> <label>{{customApiResponseCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Type}}</label> </div> <hr/> </div> <div ng-repeat="(headerKey, header) in customApiResponseCtrl.response.item.headers"> <div class="row pane-table-body"> <div class="column medium-4"> <div class="c-label"> {{headerKey}} </div> </div> <div class="column medium-5"> <div class="pane-row-input"> <input type="text" class="c-text-field" ng-model="header.description"/> </div> </div> <div class="field column medium-3"> <div class="c-select pane-row-input"> <select ng-model="header.type"> <option ng-repeat="headerType in customApiResponseCtrl.headerTypes" value="{{headerType}}"> {{headerType}} </option> </select> </div> </div> </div> </div> </div> </div> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiResponseCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Heading}}</label> <label class="subtitle">{{customApiResponseCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Description}}</label> <div class="pane-elements" ng-if="customApiResponseCtrl.resolvedSchema.referencesUsed.length > 0"> <div ng-repeat="reference in customApiResponseCtrl.resolvedSchema.referencesUsed"> <a class="reference-link" href="#" ng-click="customApiResponseCtrl.navigateToReference(reference)">{{reference}}</a> </div> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Heading}}</label> <label class="subtitle">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Description}}</label> <div class="pane-elements" ng-if="customApiResponseCtrl.schemaProperties.length > 0"> <token-block ng-repeat="schemaproperty in customApiResponseCtrl.schemaProperties track by schemaproperty.key" commands="customApiResponseCtrl.dropdownCommands" token="schemaproperty" required="schemaproperty.required" title="schemaproperty.title || schemaproperty.name" icon-url="customApiResponseCtrl.getSchemaPropertyIconUrl(schemaproperty)"></token-block> </div> </div> </div> </section> <section> <validation-results heading-above-pane="customApiResponseCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading" sub-heading-above-pane="customApiResponseCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.Response" base-violator="customApiResponseCtrl.baseViolator"/> </section> </div> <section ng-if="customApiResponseCtrl.selectedSchemaPropertyIndex !== undefined"> <schema-property items="customApiResponseCtrl.schemaProperties" index="customApiResponseCtrl.selectedSchemaPropertyIndex" base-violator="customApiResponseCtrl.selectedSchemaPropertyViolator"></schema-property> </section> <info-pane class="import-sample-pane" pane-title="customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label" expanded="customApiResponseCtrl.isPaneVisible"> <div class="pane-field c-textarea"> <label class="pane-field-label">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Heading}}</label> <label class="subtitle">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Description}}</label> <textarea class="f-no-resiz\'e f-scroll textarea-content" name="textarea-default" rows="5" maxlength="customApiResponseCtrl.contentMaxLength" ng-attr-placeholder="{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Headers.Placeholder}}" ng-model="customApiResponseCtrl.importSampleModel.headers"></textarea> </div> <div class="pane-field c-textarea"> <label class="pane-field-label">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Heading}}</label> <label class="subtitle">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Description}}</label> <textarea class="f-no-resize f-scroll textarea-content" name="textarea-default" rows="10" maxlength="customApiResponseCtrl.contentMaxLength" ng-attr-placeholder="{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Body.Placeholder}}" ng-model="customApiResponseCtrl.importSampleModel.body"></textarea> </div> <section class="save-discard"> <button type="submit" ng-click="customApiResponseCtrl.importSampleResponse(customApiResponseCtrl.importSampleModel)" class="c-button">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Import.Label}}</button> <button ng-click="customApiResponseCtrl.clearPaneData()" class="c-button btn-secondary">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Close.Label}}</button> </section> </info-pane> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1068);i(1070);var o=function(){function e(){this.template=i(1071),this.controller=n.CustomApiTriggerCtrl,this.controllerAs="customApiTriggerCtrl"}return e}();t.CustomApiTrigger=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.customApiTrigger,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(16),o=i(27),s=i(48),a=i(24),l=i(61),c=i(17),u=i(6),p=i(48),d=i(34),g=i(100),m=i(1069),f=i(11),h=i(1),v=function(){function e(e,t,i,r,l,c,p,d,h){var v=this;this.$routeParams=e,this.$scope=t,this.$timeout=i,this.appSettings=r,this.clientResources=l,this.navigationService=c,this.swaggerEditorDataService=p,this.swaggerValidationService=d,this.telemetryService=h,this.urlMaxLength=1024,this.contentMaxLength=1048576,this.parameterLocationMap=[{keyName:"pathParameters",displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Path,in:o.ParameterLocations.path},{keyName:"queryParameters",displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Query,in:o.ParameterLocations.query},{keyName:"headerParameters",displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Header,in:o.ParameterLocations.header}],this.PollingTriggerMetadata={mode:"polling",kind:"query"},this.validationFilters={},this.backButton={url:"",click:function(){v.selectedSchemaPropertyIndex=void 0},showLabel:!0},this.headerTypes=["boolean","integer","number","string"],this.valuePaths=[],this.schemaProperties=[],this.verbs=Object.keys(o.Methods).map(function(e){return o.Methods[e]}).map(function(e){return{method:e,displayName:e.toUpperCase()}}),this.visibilityItems=Object.keys(n.Visibility).map(function(e){return n.Visibility[e]}).map(function(e){return{visibility:e,displayName:e}}),this.triggerTypeItems=(y={},y[m.Webhook]={type:m.Webhook,displayName:this.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Webhook.DisplayName,isDisabled:!1},y[m.Polling]={type:m.Polling,displayName:this.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.DisplayName,isDisabled:!this.appSettings.featureFlags.enableQueryFilterTrigger},y),this.webhookCallbackParameters=[],this.importPane={isRequestPane:!1,isVisible:!1},this.navigateToReferenceParameter=function(e,t){var i=a.getReferenceParameterIndex(v.swaggerEditorDataService.SwaggerEditorData,e,t);i>=0&&v.navigationService.navigate(s.getReferenceUrl(v.swaggerEditorDataService.SwaggerEditorData,e,i))},this.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiTriggerVisited),this.triggerIndex=this.$routeParams.triggerIndex,this.baseViolator=new f.Violator({itemPath:f.Paths.Triggers+"["+this.triggerIndex+"]"}),this.validationFilters={summary:new f.FilteredResults(new f.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:f.Paths.OperationSummary})),description:new f.FilteredResults(new f.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:f.Paths.OperationDescription})),operationId:new f.FilteredResults(new f.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:f.Paths.OperationId})),path:new f.FilteredResults(new f.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:f.Paths.Path})),bodyParameter:new f.FilteredResults(new f.Violator({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:f.Paths.OperationParameters}))},this.notificationContent?this.triggerType=m.Webhook:JSON.stringify(this.trigger.operation[n.Swagger.TriggerMetadata])===JSON.stringify(this.PollingTriggerMetadata)&&(this.triggerType=m.Polling),this.selectedSchemaPropertyIndex=void 0,this.dropdownCommands=this.getDropdownCommands(),this.schemaDropdownCommands=this.getSchemaDropdownCommands(),this.resetTriggerData(),this.processRequest(),this.processResponses(),this.processNotificationSchema(),this.operationVisibility=this.trigger.operation[n.Swagger.Visibility]||n.Visibility.none,this.$scope.$watch(function(){return v.triggerType},function(){return v.onTriggerTypeChanged()}),this.$scope.$watch(function(){return v.selectedCallbackParameter},function(e,t){t&&v.unsetNotificationUrl(t),e&&v.setNotificationUrl(e)}),this.$scope.$watch(function(){return v.selectedValuePath},function(){v.selectedValuePath&&v.onSelectedValuePathChanged()}),this.$scope.$watch(function(){return v.request},function(){v.triggerType===m.Webhook?(v.updateWebhookCallbackParameters(),v.updateSelectedCallbackParameter()):v.triggerType===m.Polling&&(v.updateSelectedQueryParameter(),v.updateValuePaths(),v.updateSelectedValuePath())}),this.$scope.$watch(function(){return v.selectedQueryParameter},function(e,t){t&&v.unsetTriggerValue(t),e&&v.setTriggerValue(e)}),this.$scope.$watch(function(){return v.selectedSchemaProperty},function(e,t){e&&t&&e.key===t.key&&g.saveSchemaProperty(v.swaggerEditorDataService.swagger,v.selectedSchemaProperty,v.notificationContent.schema,"",e.required!==t.required)},!0),this.$scope.$watchGroup([function(){return v.swaggerValidationService.resultCollection.results},function(){return v.validationFilters}],function(){Object.keys(v.validationFilters).map(function(e){return v.validationFilters[e]}).forEach(function(e){return e.updateFilteredResults(v.swaggerValidationService.resultCollection)})});var y}return e.prototype.resetTriggerData=function(){this.request={pathParameters:[],queryParameters:[],headerParameters:[],bodyParameter:null},this.clearPaneData()},Object.defineProperty(e.prototype,"trigger",{get:function(){return this.swaggerEditorDataService.swagger.triggers[this.triggerIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"notificationContent",{get:function(){return this.trigger.operation[n.Swagger.NotificationContent]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedSchemaProperty",{get:function(){return this.schemaProperties?this.schemaProperties[this.selectedSchemaPropertyIndex]:null},enumerable:!0,configurable:!0}),e.prototype.onTriggerTypeChanged=function(){this.triggerType===m.Webhook?(delete this.trigger.operation[n.Swagger.TriggerMetadata],this.trigger.operation[n.Swagger.Trigger]=n.Trigger.Single,this.notificationContent||(this.trigger.operation[n.Swagger.NotificationContent]={})):this.triggerType===m.Polling&&(delete this.trigger.operation[n.Swagger.NotificationContent],this.trigger.operation[n.Swagger.Trigger]=n.Trigger.Batch,this.trigger.operation[n.Swagger.TriggerMetadata]=this.PollingTriggerMetadata)},e.prototype.onSelectedValuePathChanged=function(){var e=this;if(this.selectedQueryParameter&&this.selectedValuePath){var t=this.trigger.operation.parameters.map(function(e){return e.in===o.ParameterLocations.query?e.name:""}).indexOf(this.selectedQueryParameter.name);if(-1!==t)this.trigger.operation.parameters[t][n.Swagger.TriggerValue]=(r={},r[n.TriggerMetadata.ValueCollection]=this.selectedValuePath.parentArray||"",r[n.TriggerMetadata.ValuePath]=this.selectedValuePath.name,r);else{var i=this.trigger.operation.parameters.map(function(t){return a.isReference(t)?a.resolveParameter(t,e.swaggerEditorDataService.swagger).name:""}).indexOf(this.selectedQueryParameter.name);-1!==i&&(this.swaggerEditorDataService.swagger.parameters[i][n.Swagger.TriggerValue]=(s={},s[n.TriggerMetadata.ValueCollection]=this.selectedValuePath.parentArray||"",s[n.TriggerMetadata.ValuePath]=this.selectedValuePath.name,s))}var r,s}},e.prototype.updateSelectedQueryParameter=function(){this.selectedQueryParameter=this.request.queryParameters.filter(function(e){return!!e[n.Swagger.TriggerValue]})[0]},e.prototype.updateValuePaths=function(){var e=this.responses.filter(function(e){return"200"===e.name})[0]||this.responses.filter(function(e){return"201"===e.name})[0]||this.responses.filter(function(e){return"default"===e.name})[0];if(e){var t=d.resolveSchema(this.swaggerEditorDataService.swagger,e.responseWithResolvedReference.schema);this.valuePaths=d.getLeafSchemaProperties(t.schema).filter(function(e){return e.isInsideArray})}},e.prototype.updateSelectedValuePath=function(){var e=this;if(this.selectedQueryParameter){var t=this.trigger.operation.parameters.map(function(e){return e.in===o.ParameterLocations.query?e.name:""}).indexOf(this.selectedQueryParameter.name);if(-1!==t){var i=this.trigger.operation.parameters[t][n.Swagger.TriggerValue];if(i){var r=i[n.TriggerMetadata.ValueCollection];this.selectedValuePath=this.valuePaths.filter(function(e){return(h.isEmpty(r)||e.parentArray===r)&&e.name===i[n.TriggerMetadata.ValuePath]})[0]}}else{var s=this.trigger.operation.parameters.map(function(t){return a.isReference(t)?a.resolveParameter(t,e.swaggerEditorDataService.swagger).name:""}).indexOf(this.selectedQueryParameter.name);if(-1!==s){var l=this.swaggerEditorDataService.swagger.parameters[s][n.Swagger.TriggerValue];if(l){var c=l[n.TriggerMetadata.ValueCollection];this.selectedValuePath=this.valuePaths.filter(function(e){return(h.isEmpty(c)||e.parentArray===c)&&e.name===l[n.TriggerMetadata.ValuePath]})[0]}}}}},e.prototype.updateWebhookCallbackParameters=function(){var e=this;if(this.webhookCallbackParameters=[],this.parameterLocationMap.forEach(function(t){e.request[t.keyName]&&e.request[t.keyName].length>0&&(e.webhookCallbackParameters.push({name:t.displayName,isDisabled:!0,in:t.in},{name:"----------------------------",isDisabled:!0,in:t.in}),e.request[t.keyName].forEach(function(i){e.webhookCallbackParameters.push({name:i.name,isDisabled:!1,in:t.in})}),e.webhookCallbackParameters.push({name:"",isDisabled:!0,in:t.in}))}),this.request.bodyParameter){var t=d.resolveSchema(this.swaggerEditorDataService.SwaggerEditorData.swagger,this.request.bodyParameter.schema),i=d.getLeafSchemaProperties(t.schema);i&&i.length>0&&(this.webhookCallbackParameters.push({name:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Body,isDisabled:!0,in:"body"},{name:"----------------------------",isDisabled:!0,in:"body"}),i.forEach(function(t){e.webhookCallbackParameters.push({name:t.name,isDisabled:!1,in:"body",key:t.key})}))}},e.prototype.updateSelectedCallbackParameter=function(){var e=a.getParametersWithResolvedReferences(this.trigger.operation.parameters,this.swaggerEditorDataService.swagger),t=e.filter(function(e){return"body"!==e.in&&!0===e[n.Swagger.NotificationUrl]&&"internal"===e[n.Swagger.Visibility]})[0],i=void 0;if(t)i=this.webhookCallbackParameters.filter(function(e){return e.in===t.in&&e.name===t.name})[0];else{var r=e.filter(function(e){return"body"===e.in})[0];if(!r)return void(this.selectedCallbackParameter=this.webhookCallbackParameters[0]);var o=d.resolveSchema(this.swaggerEditorDataService.SwaggerEditorData.swagger,r.schema),s=d.getLeafSchemaProperties(o.schema),l=s.filter(function(e){return!!e.isNotificationUrl})[0];l&&(i=this.webhookCallbackParameters.filter(function(e){return e.key===l.key})[0])}this.selectedCallbackParameter=i||this.webhookCallbackParameters[0]},e.prototype.unsetTriggerValue=function(e){var t=this,i=this.trigger.operation.parameters.map(function(e){return e.in===o.ParameterLocations.query?e.name:""}).indexOf(e.name);-1!==i&&delete this.trigger.operation.parameters[i][n.Swagger.TriggerValue];var r=this.trigger.operation.parameters.map(function(e){return a.isReference(e)?a.resolveParameter(e,t.swaggerEditorDataService.swagger).name:""}).indexOf(e.name);-1!==r&&delete this.swaggerEditorDataService.swagger.parameters[r][n.Swagger.TriggerValue]},e.prototype.setTriggerValue=function(e){var t=this;if(this.selectedValuePath){var i=this.trigger.operation.parameters.map(function(e){return e.in===o.ParameterLocations.query?e.name:""}).indexOf(e.name);-1!==i&&(this.trigger.operation.parameters[i][n.Swagger.TriggerValue]=(s={},s[n.TriggerMetadata.ValueCollection]=this.selectedValuePath.parentArray||"",s[n.TriggerMetadata.ValuePath]=this.selectedValuePath.name,s));var r=this.trigger.operation.parameters.map(function(e){return a.isReference(e)?a.resolveParameter(e,t.swaggerEditorDataService.swagger).name:""}).indexOf(e.name);-1!==r&&(this.swaggerEditorDataService.swagger.parameters[r][n.Swagger.TriggerValue]=(l={},l[n.TriggerMetadata.ValueCollection]=this.selectedValuePath.parentArray||"",l[n.TriggerMetadata.ValuePath]=this.selectedValuePath.name,l));var s,l}},e.prototype.unsetNotificationUrl=function(e){if(e)switch(e.in){case"path":case"query":case"header":var t=this.getRawParameterInfo(e);if(a.isReference(t.parameter)){var i=this.swaggerEditorDataService.swagger.parameters.indexOf(this.swaggerEditorDataService.swagger.parameters.filter(function(e){return"#/parameters/"+e.name===t.parameter.$ref})[0]);delete this.swaggerEditorDataService.swagger.parameters[i][n.Swagger.NotificationUrl],this.swaggerEditorDataService.swagger.parameters[i][n.Swagger.Visibility]="important"}else delete this.trigger.operation.parameters[t.index][n.Swagger.NotificationUrl],this.trigger.operation.parameters[t.index][n.Swagger.Visibility]="important";break;case"body":var r=this.getResolvedPathInfo(e),o=r.resolvedPath,s=r.index;if(o.reference)_.unset(this.swaggerEditorDataService.SwaggerEditorData.swagger.definitions[s].item,o.path+"."+n.Swagger.NotificationUrl),_.set(this.swaggerEditorDataService.SwaggerEditorData.swagger.definitions[s].item,o.path+"."+n.Swagger.Visibility,"important");else{var l=this.trigger.operation.parameters.filter(function(e){return"body"===e.in})[0],c=this.trigger.operation.parameters.indexOf(l);_.unset(this.trigger.operation.parameters[c].schema,o.path+"."+n.Swagger.NotificationUrl),_.set(this.trigger.operation.parameters[c].schema,o.path+"."+n.Swagger.Visibility,"important")}}},e.prototype.setNotificationUrl=function(e){switch(e.in){case"path":case"query":case"header":var t=this.getRawParameterInfo(e);if(a.isReference(t.parameter)){var i=this.swaggerEditorDataService.swagger.parameters.indexOf(this.swaggerEditorDataService.swagger.parameters.filter(function(e){return"#/parameters/"+e.name===t.parameter.$ref})[0]);this.swaggerEditorDataService.swagger.parameters[i][n.Swagger.NotificationUrl]=!0,this.swaggerEditorDataService.swagger.parameters[i][n.Swagger.Visibility]="internal"}else{if(!this.trigger.operation.parameters[t.index])break;this.trigger.operation.parameters[t.index][n.Swagger.NotificationUrl]=!0,this.trigger.operation.parameters[t.index][n.Swagger.Visibility]="internal"}break;case"body":var r=this.getResolvedPathInfo(e),o=r.resolvedPath,s=r.index;if(o.reference)_.set(this.swaggerEditorDataService.SwaggerEditorData.swagger.definitions[s].item,o.path+"."+n.Swagger.NotificationUrl,!0),_.set(this.swaggerEditorDataService.SwaggerEditorData.swagger.definitions[s].item,o.path+"."+n.Swagger.Visibility,"internal");else{var l=this.trigger.operation.parameters.filter(function(e){return"body"===e.in})[0],c=this.trigger.operation.parameters.indexOf(l);_.set(this.trigger.operation.parameters[c].schema,o.path+"."+n.Swagger.NotificationUrl,!0),_.set(this.trigger.operation.parameters[c].schema,o.path+"."+n.Swagger.Visibility,"internal")}}},e.prototype.getRawParameterInfo=function(e){var t=a.getParametersWithResolvedReferences(this.trigger.operation.parameters,this.swaggerEditorDataService.swagger),i=t.filter(function(t){return t.name===e.name&&t.in===e.in})[0],r=t.indexOf(i);return{parameter:this.trigger.operation.parameters[r],index:r}},e.prototype.getResolvedPathInfo=function(e){var t=d.resolveSchema(this.swaggerEditorDataService.SwaggerEditorData.swagger,this.request.bodyParameter.schema),i=d.getLeafSchemaProperties(t.schema),r=i.filter(function(t){return t.key===e.key})[0],n=this.swaggerEditorDataService.SwaggerEditorData.swagger,o=d.resolveSchemaProperties([r],this.request.bodyParameter.schema,n),s=o[r.key],a=n.definitions.indexOf(n.definitions.filter(function(e){return e.name===s.reference})[0]);return{resolvedPath:s,index:a}},e.prototype.getDropdownCommands=function(){var e=this;return[{text:this.clientResources.Manage.Apis.EditToolTip,iconUrl:"glyph-edit",click:function(t){e.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiEditParameterClicked);var i=a.getParameterIndex(t,e.trigger.operation.parameters,e.swaggerEditorDataService.swagger),r=e.trigger.operation.parameters[i],o=a.resolveParameter(r,e.swaggerEditorDataService.swagger);a.isReference(r)?e.navigateToReferenceParameter({name:o.name,source:n.ReferenceSource.parameters},o):e.navigateToInlineParameter(i,o)}},{text:this.clientResources.Manage.Apis.DeleteToolTip,iconUrl:"glyph-delete",click:function(t){e.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiDeleteParameterClicked);var i=a.getParametersWithResolvedReferences(e.trigger.operation.parameters,e.swaggerEditorDataService.swagger).indexOf(t);e.trigger.operation.parameters.splice(i,1),e.isPathParameter(e.request.pathParameters,t)&&e.removePathParameter(e.trigger,t),e.processRequest()}}]},e.prototype.getSchemaDropdownCommands=function(){var e=this;return[{text:this.clientResources.Manage.Apis.EditToolTip,iconUrl:"glyph-edit",click:function(t){e.selectedSchemaPropertyIndex=e.schemaProperties.indexOf(t)}}]},e.prototype.isPathParameter=function(e,t){return a.getParametersWithResolvedReferences(e,this.swaggerEditorDataService.swagger).indexOf(t)>-1},e.prototype.removePathParameter=function(e,t){var i=e.path.split("/"),r=i.indexOf("{"+t.name+"}");r>0&&(i.splice(r-1,2),e.path=i.join("/"))},e.prototype.processRequest=function(){var e=this,t=a.getParametersWithResolvedReferences(this.trigger.operation.parameters,this.swaggerEditorDataService.swagger);t.forEach(function(t){e.validationFilters[l.getUniqueParameterName(t)]||(e.validationFilters[l.getUniqueParameterName(t)]=new f.FilteredResults(new f.Violator({itemPath:c.getPathToParameter(t,e.trigger.operation,e.baseViolator,e.swaggerEditorDataService.SwaggerEditorData)})))}),this.request.pathParameters=t.filter(function(e){return e.in&&e.in===o.ParameterLocations.path}),this.request.queryParameters=t.filter(function(e){return e.in&&e.in===o.ParameterLocations.query}),this.request.headerParameters=t.filter(function(e){return e.in&&e.in===o.ParameterLocations.header}),this.request.bodyParameter=t.filter(function(e){return e.in&&e.in===o.ParameterLocations.body})[0]},e.prototype.getIconUrlForParameter=function(e){return this.validationFilters[l.getUniqueParameterName(e)]?this.validationFilters[l.getUniqueParameterName(e)].resultCollection.mostSevereResultTypeImage:null},e.prototype.processResponses=function(){var e=this;this.responses=[],this.trigger.operation&&Array.isArray(this.trigger.operation.responses)&&this.trigger.operation.responses.forEach(function(t){var i;i=a.isReference(t.item)?a.getJsonReference(e.swaggerEditorDataService.swagger,t.item.$ref):t.item,e.responses.push({name:t.name,responseWithResolvedReference:i}),e.validationFilters[t.name]||(e.validationFilters[t.name]=new f.FilteredResults(new f.Violator({itemPath:c.getPathToResponse(t,e.trigger.operation,e.baseViolator,e.swaggerEditorDataService.SwaggerEditorData)})))})},e.prototype.getIconUrlForResponse=function(e){return this.validationFilters[e.name]?this.validationFilters[e.name].resultCollection.mostSevereResultTypeImage:null},e.prototype.processNotificationSchema=function(){this.notificationContent&&this.notificationContent.schema&&(this.resolvedSchema=d.resolveSchema(this.swaggerEditorDataService.swagger,this.notificationContent.schema),this.schemaProperties=d.getLeafSchemaProperties(this.resolvedSchema.schema))},e.prototype.navigateToResponse=function(e){var t=this.trigger.operation.responses.map(function(e){return e.name}).indexOf(e),i=this.trigger.operation.responses[t];if(a.isReference(i.item)){var r=a.getJsonReference(this.swaggerEditorDataService.swagger,i.item.$ref);this.navigateToReferenceResponse({name:e,source:n.ReferenceSource.responses},r)}else this.navigationService.navigate(s.getInlineResponseUrl(this.swaggerEditorDataService.SwaggerEditorData,this.triggerIndex,"trigger",t))},e.prototype.navigateToReferenceResponse=function(e,t){var i=a.getReferenceResponseIndex(this.swaggerEditorDataService.SwaggerEditorData,e,t);i>=0&&this.navigationService.navigate(s.getReferenceUrl(this.swaggerEditorDataService.SwaggerEditorData,e,i))},e.prototype.navigateToInlineParameter=function(e,t){a.isInlineParameterIndexValid(e,this.trigger)&&this.navigationService.navigate(s.getInlineParameterUrl(this.swaggerEditorDataService.SwaggerEditorData,this.triggerIndex,"trigger",e))},e.prototype.showRequestPane=function(){this.importPane.isRequestPane=!0,this.showPane()},e.prototype.showResponsePane=function(){this.importPane.isRequestPane=!1,this.showPane()},e.prototype.showPane=function(){var e=this;this.$timeout(function(){e.importPane.isVisible=!0})},e.prototype.onImportClicked=function(){this.importPane.isRequestPane?this.importSampleRequest(this.importSampleModel):this.triggerType===m.Webhook?this.importSampleWebhookResponse(this.importSampleModel):this.importSampleResponse(this.importSampleModel)},e.prototype.importSampleRequest=function(e){this.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiImportFromSampleRequestClicked),a.updateActionRequest(e.url,e.verb,e.headers,e.body,this.trigger,this.swaggerEditorDataService.SwaggerEditorData,this.clientResources)&&(this.trigger.path&&this.triggerType===m.Polling&&(this.trigger.path="/trigger"+(0===this.trigger.path.indexOf("/")?this.trigger.path:"/"+this.trigger.path)),this.processRequest()),this.clearPaneData(),this.updateWebhookCallbackParameters()},e.prototype.importSampleWebhookResponse=function(e){this.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiImportFromSampleResponseClicked),a.updateWebhookResponse(e.headers,e.body,this.trigger,this.swaggerEditorDataService.SwaggerEditorData,this.clientResources)&&this.processNotificationSchema(),this.clearPaneData()},e.prototype.importSampleResponse=function(e){this.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiImportFromSampleResponseClicked),a.updateActionResponse(e.headers,e.body,this.trigger,this.swaggerEditorDataService.SwaggerEditorData,this.clientResources)&&(this.processResponses(),this.updateValuePaths()),this.clearPaneData()},e.prototype.navigateToReference=function(e){var t=this.swaggerEditorDataService.SwaggerEditorData.swagger,i=t.definitions.indexOf(t.definitions.filter(function(t){return t.name===e})[0]);this.navigationService.navigate(p.getReferenceUrl(this.swaggerEditorDataService.SwaggerEditorData,{name:"",source:n.ReferenceSource.definitions},i))},e.prototype.clearPaneData=function(){this.importPane.isVisible=!1,this.importSampleModel={url:"",verb:void 0,headers:"",body:""}},e.prototype.visibilityChanged=function(){this.operationVisibility===n.Visibility.none?delete this.trigger.operation[n.Swagger.Visibility]:this.trigger.operation[n.Swagger.Visibility]=this.operationVisibility},e.$inject=[r.default.services.$routeParams,r.default.services.$scope,r.default.services.$timeout,r.default.services.appSettings,r.default.services.clientResources,r.default.services.navigation,r.default.services.swaggerEditorData,r.default.services.swaggerValidationService,r.default.services.telemetry],e}();t.CustomApiTriggerCtrl=v},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Webhook="Webhook",t.Polling="Polling"},function(e,t){},function(e,t){e.exports='<div class="subsection-manage custom-api-trigger"> <section ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex !== undefined"> <backbutton model="customApiTriggerCtrl.backButton"></backbutton> </section> <section ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex === undefined"> <div class="pane-title"> <span>{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Heading}}</span> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label"> <span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Summary.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Summary.Hyperlink\'"/> </label> <validated-input input-model="customApiTriggerCtrl.trigger.operation.summary" validation-result-collection="customApiTriggerCtrl.validationFilters.summary.resultCollection" is-required="true"/> </div> <div class="pane-field"> <label class="pane-field-label"> <span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Description.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Description.Hyperlink\'"/> </label> <validated-input input-model="customApiTriggerCtrl.trigger.operation.description" validation-result-collection="customApiTriggerCtrl.validationFilters.description.resultCollection" is-required="true"/> </div> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.OperationId.Label}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.OperationId.Subtitle}}</label> <validated-input input-model="customApiTriggerCtrl.trigger.operation.operationId" validation-result-collection="customApiTriggerCtrl.validationFilters.operationId.resultCollection" is-required="true"/> </div> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Visibility.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.Visibility.Hyperlink\'"/> </legend> <div> <div ng-repeat="visibilityItem in customApiTriggerCtrl.visibilityItems"> <label class="c-label"> <input type="radio" aria-label="{{visibilityItem.visibility}}" name="visibilityFieldset" ng-value="visibilityItem.displayName" ng-change="customApiTriggerCtrl.visibilityChanged()" ng-model="customApiTriggerCtrl.operationVisibility"/> <span>{{visibilityItem.displayName}}</span> </label> </div> </div> </fieldset> </div> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.TriggerType.Hyperlink\'"/> </legend> <div> <div ng-repeat="(triggerTypeItemKey, triggerTypeItem) in customApiTriggerCtrl.triggerTypeItems"> <label class="c-label"> <input ng-disabled="triggerTypeItem.isDisabled" type="radio" aria-label="{{triggerTypeItem.type}}" name="triggerTypeFieldset" ng-value="triggerTypeItem.type" ng-model="customApiTriggerCtrl.triggerType"/> <span>{{triggerTypeItem.displayName}}</span> </label> </div> </div> </fieldset> </div> </div> </section> <section class="section-custom-api-trigger-section" ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex === undefined"> <h5 class="c-heading-5">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Heading}}</h5> <p class="c-subheading-5">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Request.Description}}</p> <div class="request-pane"> <div class="pane-title"> <span>{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Heading}}</span> <a href="#" role="button" class="c-glyph glyph-download import-heading" ng-click="customApiTriggerCtrl.showRequestPane()">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label}}</a> </div> <div class="pane-content"> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"><span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Heading}}</legend> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Description}}</label> <div> <div ng-repeat="verb in customApiTriggerCtrl.verbs track by verb.method"> <label class="c-label"> <input type="radio" aria-label="{{verb.method}}" name="verbFieldset" value="{{verb.displayName}}" ng-checked="verb.method === customApiTriggerCtrl.trigger.method" ng-model="customApiTriggerCtrl.trigger.method" ng-change="customApiTriggerCtrl.trigger.method = verb.method"> <span>{{verb.displayName}}</span> </label> </div> </div> </fieldset> </div> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Description}}</label> <validated-input input-model="customApiTriggerCtrl.trigger.path" validation-result-collection="customApiTriggerCtrl.validationFilters.path.resultCollection" is-read-only="true" is-required="true"/> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Path.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Path.Description}}</label> <div class="pane-elements"> <token-block ng-repeat="pathParameter in customApiTriggerCtrl.request.pathParameters track by pathParameter.name" commands="customApiTriggerCtrl.dropdownCommands" token="pathParameter" required="pathParameter.required" title="pathParameter.name" icon-url="customApiTriggerCtrl.getIconUrlForParameter(pathParameter)"></token-block> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Query.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Query.Description}}</label> <div class="pane-elements"> <token-block ng-repeat="queryParameter in customApiTriggerCtrl.request.queryParameters track by queryParameter.name" commands="customApiTriggerCtrl.dropdownCommands" token="queryParameter" required="queryParameter.required" title="queryParameter.name" icon-url="customApiTriggerCtrl.getIconUrlForParameter(queryParameter)"></token-block> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Description}}</label> <div class="pane-elements"> <token-block ng-repeat="headerParameter in customApiTriggerCtrl.request.headerParameters track by headerParameter.name" commands="customApiTriggerCtrl.dropdownCommands" token="headerParameter" required="headerParameter.required" title="headerParameter.name" icon-url="customApiTriggerCtrl.getIconUrlForParameter(headerParameter)"></token-block> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Description}}</label> <div class="pane-elements"> <token-block ng-if="customApiTriggerCtrl.request.bodyParameter" commands="customApiTriggerCtrl.dropdownCommands" token="customApiTriggerCtrl.request.bodyParameter" required="customApiTriggerCtrl.request.bodyParameter.required" title="customApiTriggerCtrl.request.bodyParameter.name" icon-url="customApiTriggerCtrl.validationFilters.bodyParameter.resultCollection.mostSevereResultTypeImage"></token-block> </div> </div> </div> </div> </section> <section class="section-custom-api-trigger-section" ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex === undefined && customApiTriggerCtrl.triggerType === \'Polling\'"> <h5 class="c-heading-5">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Response.Heading}}</h5> <p class="c-subheading-5">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Response.Description}}</p> <div class="pane-content response-item" ng-repeat="response in customApiTriggerCtrl.responses" ng-click="customApiTriggerCtrl.navigateToResponse(response.name)"> <span class="status-code" title="{{response.name}}">{{response.name}}</span> <span class="display-name" title="{{response.responseWithResolvedReference.description}}">{{response.responseWithResolvedReference.description}}</span> <img src="{{customApiTriggerCtrl.getIconUrlForResponse(response)}}"/> </div> <div class="add-response"> <a href="#" role="button" class="f-lightweight c-glyph glyph-download" ng-click="customApiTriggerCtrl.showResponsePane()">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Definition.AddResponse.Label}}</a> </div> </section> <section class="section-custom-api-trigger-section" ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex === undefined && customApiTriggerCtrl.triggerType === \'Webhook\'"> <h5 class="c-heading-5">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Response.Heading}}</h5> <p class="c-subheading-5">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Response.Description}}</p> <div class="request-pane"> <div class="pane-title"> <span>{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Response.Heading}}</span> <a href="#" role="button" class="c-glyph glyph-download import-heading" ng-click="customApiTriggerCtrl.showResponsePane()">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label}}</a> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Description.Label}}</label> <input class="c-text-field" type="text" ng-model="customApiTriggerCtrl.notificationContent.description" aria-required="true"/> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Response.Headers.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Response.Headers.Description}}</label> <div ng-if="customApiTriggerCtrl.notificationContent.headers"> <div class="pane-field"> <div class="pane-table"> <div class="row pane-table-header"> <div class="column medium-4"> <label>{{customApiTriggerCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Name}}</label> </div> <div class="column medium-5"> <label>{{customApiTriggerCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Description}}</label> </div> <div class="column medium-3"> <label>{{customApiTriggerCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Type}}</label> </div> <hr/> </div> <div ng-repeat="(headerKey, header) in customApiTriggerCtrl.notificationContent.headers"> <div class="row pane-table-body"> <div class="column medium-4"> <div class="c-label"> {{headerKey}} </div> </div> <div class="column medium-5"> <div class="pane-row-input"> <input type="text" class="c-text-field" ng-model="header.description"/> </div> </div> <div class="field column medium-3"> <div class="c-select pane-row-input"> <select ng-model="header.type"> <option ng-repeat="headerType in customApiTriggerCtrl.headerTypes" value="{{headerType}}"> {{headerType}} </option> </select> </div> </div> </div> </div> </div> </div> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Description}}</label> <div class="pane-elements" ng-if="customApiTriggerCtrl.resolvedSchema.referencesUsed.length > 0"> <div ng-repeat="reference in customApiTriggerCtrl.resolvedSchema.referencesUsed"> <a class="reference-link" href="#" ng-click="customApiTriggerCtrl.navigateToReference(reference)">{{reference}}</a> </div> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Description}}</label> <div class="pane-elements" ng-if="customApiTriggerCtrl.schemaProperties.length > 0"> <token-block ng-repeat="schemaProperty in customApiTriggerCtrl.schemaProperties track by schemaProperty.key" commands="customApiTriggerCtrl.schemaDropdownCommands" token="schemaProperty" required="schemaProperty.required" title="schemaProperty.title || schemaProperty.name"></token-block> </div> </div> </div> </div> </section> <section class="section-custom-api-trigger-section" ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex === undefined"> <h5 class="c-heading-5">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Configuration.Heading}}</h5> <div class="request-pane"> <div class="pane-title"> <span>{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Configuration.Heading}}</span> </div> <div class="pane-content" ng-if="customApiTriggerCtrl.triggerType === \'Webhook\'"> <div class="pane-field"> <legend class="pane-field-label"><span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Configuration.Callback.Heading}}</legend> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Configuration.Callback.Description}}</label> <div class="select-option-container"> <select class="select-option" ng-model="customApiTriggerCtrl.selectedCallbackParameter" ng-options="parameter as parameter.name disable when parameter.isDisabled for parameter in customApiTriggerCtrl.webhookCallbackParameters"> </select> </div> </div> <message-bar aria-label="{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Delete.AriaLabel}}"> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Delete.Highlight.Pre}}<strong>{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Delete.Highlight.Required}}</strong>{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Delete.Highlight.Post}} </message-bar> </div> <div class="pane-content" ng-if="customApiTriggerCtrl.triggerType === \'Polling\'"> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.QueryParameter.Description}}</label> <div class="c-select"> <select ng-model="customApiTriggerCtrl.selectedQueryParameter" ng-options="parameter as parameter.name for parameter in customApiTriggerCtrl.request.queryParameters"> <option value="" selected="selected" disabled="disabled">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.QueryParameter.PlaceHolder}}</option> </select> </div> </div> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.QueryParameter.Value.Description}}</label> <div class="c-select"> <select ng-model="customApiTriggerCtrl.selectedValuePath" ng-options="valuePath as valuePath.parentArray + \': \' + valuePath.name for valuePath in customApiTriggerCtrl.valuePaths"> <option value="" selected="selected" disabled="disabled">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.ValuePath.PlaceHolder}}</option> </select> </div> </div> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Hint.Description}}</label> <input class="c-text-field" type="text" ng-model="customApiTriggerCtrl.trigger.operation[\'x-ms-trigger-hint\']" maxlength="customApiTriggerCtrl.urlMaxLength" placeholder="{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Hint.Placeholder}}" aria-required="true"/> </div> </div> </div> </section> <section class="section-custom-api-trigger-section" ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex === undefined"> <validation-results heading-above-pane="customApiTriggerCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading" sub-heading-above-pane="customApiTriggerCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.Trigger" base-violator="customApiTriggerCtrl.baseViolator" include-referenced-results="true"/> </section> <section ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex !== undefined"> <schema-property items="customApiTriggerCtrl.schemaProperties" index="customApiTriggerCtrl.selectedSchemaPropertyIndex"></schema-property> </section> <info-pane class="import-sample-pane" pane-title="customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label" expanded="customApiTriggerCtrl.importPane.isVisible"> <div ng-if="customApiTriggerCtrl.importPane.isRequestPane" class="request-content"> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"><span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Heading}}</legend> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Description}}</label> <div> <div ng-repeat="verb in customApiTriggerCtrl.verbs track by verb.method"> <label class="c-label"> <input type="radio" aria-label="{{verb.method}}" ng-value="verb" ng-checked="verb === customApiTriggerCtrl.importSampleModel.verb" ng-model="customApiTriggerCtrl.importSampleModel.verb"> <span>{{verb.displayName}}</span> </label> </div> </div> </fieldset> </div> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span> {{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Definition.UrlSample.Description}}</label> <input class="c-text-field" type="text" ng-model="customApiTriggerCtrl.importSampleModel.url" maxlength="customApiTriggerCtrl.urlMaxLength" placeholder="{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Url.Placeholder}}" aria-required="true"/> </div> </div> <div class="pane-field c-textarea"> <label class="pane-field-label">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Description}}</label> <textarea class="f-no-resize f-scroll textarea-content" name="textarea-default" rows="5" maxlength="customApiTriggerCtrl.contentMaxLength" ng-attr-placeholder="{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Headers.Placeholder}}" ng-model="customApiTriggerCtrl.importSampleModel.headers"></textarea> </div> <div class="pane-field c-textarea"> <label class="pane-field-label">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Heading}}</label> <label class="subtitle">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Description}}</label> <textarea class="f-no-resize f-scroll textarea-content" name="textarea-default" rows="10" maxlength="customApiTriggerCtrl.contentMaxLength" ng-attr-placeholder="{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Body.Placeholder}}" ng-model="customApiTriggerCtrl.importSampleModel.body"></textarea> </div> <section class="save-discard"> <button type="submit" ng-click="customApiTriggerCtrl.onImportClicked()" class="c-button">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Import.Label}}</button> <button ng-click="customApiTriggerCtrl.clearPaneData()" class="c-button btn-secondary">{{customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Close.Label}}</button> </section> </info-pane> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1073);i(1075);var o=function(){function e(){this.controller=n.CustomConnectorDialogCtrl,this.template=i(1076),this.controllerAs="customConnectorDialogCtrl",this.bindings={model:"=",onContinue:"&"}}return e}();t.CustomConnectorDialog=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customConnectorDialog,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),n=i(0),o=i(72),s=i(5),a=i(62),l=i(222),c=i(32),u=i(24),p=i(107),d=i(223),g="swagger",m="postman",f="url",h=0,v=1,y=function(){function e(e,t,i,n,o,a,l){var c=this;this.$scope=e,this.appSettings=t,this.clientResources=i,this.customApiHelperService=n,this.fileReader=o,this.loggingService=a,this.swaggerEditorDataService=l,this.CreateDialogMode={Blank:"Blank",OpenApiFile:"OpenApiFile",OpenApiUrl:"OpenApiUrl",Postman:"Postman"},this.importTypes=[{format:"",label:"",description:""},{format:g,label:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.Label,description:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.PlaceHolder},{format:f,label:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.Label,description:"https://"},{format:m,label:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.Label,description:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.PlaceHolder}],this.selectedImportType=this.importTypes[0],this.uploadIcon=s.default.contentUpload,this.onImportFile=function(e){var t=e.target.files[0];t&&(c.selectedImportType.format===g?c.onImportSwaggerFile(t):c.selectedImportType.format===m&&c.onImportPostmanCollection(t))},this.dialogData={swagger:angular.copy(u.DeserializedBaseSwagger)},this.customApiDialog={show:this.model.show,buttons:[{label:this.clientResources.Manage.CustomApi.General.Continue,action:function(){c.swaggerEditorDataService.SwaggerEditorData.displayName=c.dialogData.displayName,c.validationError=d.validateDisplayName(c.swaggerEditorDataService.SwaggerEditorData.displayName),c.validationError||(c.swaggerEditorDataService.SwaggerEditorData.swagger=c.dialogData.swagger,c.dialogMode===c.CreateDialogMode.Blank&&(c.swaggerEditorDataService.SwaggerEditorData.swagger.info.title=c.dialogData.displayName),c.swaggerEditorDataService.SwaggerEditorData.swaggerFileName=c.dialogData.swaggerFileName||r.getSlug(c.swaggerEditorDataService.SwaggerEditorData.displayName)+".swagger.json",c.swaggerEditorDataService.SwaggerEditorData.securityTabDetails.initialConnectionParameters=c.swaggerEditorDataService.constructInitialConnectionParametersFromSwagger(),c.swaggerEditorDataService.swaggerEditorUIData.swaggerUpdatedFromList=!!c.model.api,c.model.show=!1,c.onContinue({api:c.model.api}))},primary:!0,disabled:!0},{label:this.clientResources.Common.Cancel,action:function(){c.dialogData={swagger:angular.copy(u.DeserializedBaseSwagger)},c.validationError=void 0,c.model.show=!1},primary:!1}]},this.customApiDialog.buttons[v].disabled=this.customApiDialog.showProgressSpinner,this.$scope.$watch(function(){return c.model.show},function(){c.selectedImportType=c.importTypes[c.model.dialogMode],c.dialogMode=Object.keys(c.CreateDialogMode)[c.model.dialogMode],c.customApiDialog.show=c.model.show,c.model.api&&(c.dialogData.displayName=c.model.api.properties.displayName)}),this.$scope.$watch(function(){return JSON.stringify(c.dialogData)},function(){switch(c.customApiDialog.buttons[h].disabled=!0,c.dialogMode){case c.CreateDialogMode.Blank:c.customApiDialog.buttons[h].disabled=r.isNullOrUndefined(c.dialogData.displayName);break;case c.CreateDialogMode.OpenApiFile:case c.CreateDialogMode.OpenApiUrl:case c.CreateDialogMode.Postman:c.customApiDialog.buttons[h].disabled=r.isNullOrUndefined(c.dialogData.displayName)||r.isNullOrUndefined(c.dialogData.swagger)||r.isNullOrUndefined(c.dialogData.swaggerFileName)||JSON.stringify(c.dialogData.swagger)===JSON.stringify(u.DeserializedBaseSwagger)}})}return Object.defineProperty(e.prototype,"paneTitle",{get:function(){return this.model.api?this.clientResources.Manage.CustomApi.Update.Dialog.Heading:this.clientResources.Manage.CustomApi.Create.Dialog.Heading},enumerable:!0,configurable:!0}),e.prototype.onImportUrl=function(){var e=this;if(!c.isHttpsUrl(this.dialogData.swaggerUrl))return void(this.validationError=new p.ClientError("customConnectorDialogCtrl.onImportUrl",this.clientResources.Manage.CustomConnector.Import.UrlNotHttps,null));this.customApiDialog.showProgressSpinner=!0,this.customApiHelperService.getSwaggerFromUrl(this.dialogData.swaggerUrl,!0).then(function(t){var i=JSON.stringify(t),n=new Blob([i]),o=r.convertBlobToFile(n,"swagger.json");e.onImportSwaggerFile(o)}).catch(function(t){e.validationError=new p.ClientError("customConnectorDialogCtrl.onImportUrl",e.clientResources.Manage.CustomConnector.Import.UrlError,null),e.loggingService.logError("customConnectorDialogCtrl.onImportUrl",t)}).finally(function(){e.customApiDialog.showProgressSpinner=!1})},e.prototype.onImportPostmanCollection=function(e){var t=this;r.getFileSizeInMb(e)>=1||this.fileReader(e).asText().then(function(e){var i;try{i=JSON.parse(e)}catch(e){return}var r=i;r&&r.requests&&r.requests.length>0&&(i.info&&i.info.schema&&i.info.schema===o.PostmanCollectionV2Schema||(t.updateDialogData("generatedApiDefinition.swagger.json",a.deserialize(new l.PostmanCollectionConverter({assignTestValues:t.appSettings.featureFlags.enableAdvancedTestApiMode}).convertToSwagger(e))),t.loggingService.logInfo("SwaggerGeneratedFromPostmanCollection","Swagger was successfully generated from the imported Postman collection")))})},e.prototype.onImportSwaggerFile=function(e){var t=this;r.getFileSizeInMb(e)>=1||this.fileReader(e).asText().then(function(i){var n;try{if("object"!=typeof(n=JSON.parse(i)))throw t.validationError=new p.ClientError("onImportSwaggerFile",t.clientResources.Manage.CustomConnector.Import.FileNotJson,null),new Error("Swagger file is not a json object")}catch(e){return t.validationError=new p.ClientError("onImportSwaggerFile",r.format(t.clientResources.Manage.CustomConnector.Import.InvalidSwagger,e),null),void t.loggingService.logError("GeneralSwaggerEditorTabCtrl.onImportSwaggerFile",e)}t.updateDialogData(e.name,a.deserialize(_.assign({},u.BaseSwagger,n)))})},e.prototype.updateDialogData=function(e,t){this.dialogData.swaggerFileName=e,this.dialogData.swagger=t},e.$inject=[n.default.services.$scope,n.default.services.appSettings,n.default.services.clientResources,n.default.services.customApiHelper,n.default.services.fileReaderHelperService,n.default.services.logging,n.default.services.swaggerEditorData],e}();t.CustomConnectorDialogCtrl=y},function(e,t,i){"use strict";function r(e,t){void 0===t&&(t={});var i=b.parseUri(e.url).parameters;return Object.keys(i).map(function(e){var r={name:e,default:i[e],in:y.ParameterLocations.query,type:y.Types.string,required:!0};return t.assignTestValue&&s(r),r[w.Swagger.Summary]=e,r})}function n(e,t){void 0===t&&(t={});var i=[];return v.isNullOrUndefined(e.pathVariables)?i:i=Object.keys(e.pathVariables).map(function(i){var r={name:i,default:e.pathVariables[i],in:y.ParameterLocations.path,type:y.Types.string,required:!0};return t.assignTestValue&&s(r),r[w.Swagger.Summary]=i,r})}function o(e,t){void 0===t&&(t={});var i=[],r=e.headers.split("\n").filter(function(e){return e.trim().length>0});return r&&r.length>0&&r.forEach(function(e){var r=u(e);if(r){var n=Object.keys(r)[0],o=r[n];if(n!==S.AuthorizationHeaderName){var a={name:n,in:y.ParameterLocations.header,required:!0,type:"string",default:o,description:n};t.assignTestValue&&s(a),a[w.Swagger.Summary]=a.name,i.push(a)}}}),i}function s(e){e[w.Swagger.TestValue]=e.default,delete e.default}function a(e,t){void 0===t&&(t={});var i=null;if(d(e)){if(e.data&&0!==e.data.length){var r=e.data,n=C.generateSchemaFromJson(JSON.stringify(r),{assignDefaultValue:!t.assignTestValue,assignTestValue:t.assignTestValue});i={name:y.ParameterLocations.body,in:y.ParameterLocations.body,schema:n,required:!0}}}else{var n=C.generateSchemaFromJson(e.rawModeData,{assignDefaultValue:!t.assignTestValue,assignTestValue:t.assignTestValue});i={name:y.ParameterLocations.body,in:y.ParameterLocations.body,schema:n,required:!0}}return i}function l(e){var t=g(e);return Object.keys(e.pathVariables).forEach(function(i){var r=h(i),n=m(i);t.host.indexOf(r)>-1&&(e.url=e.url.replace(n,e.pathVariables[i]),delete e.pathVariables[i])}),e}function c(e){var t=b.parseUri(e.url).path;return Object.keys(e.pathVariables).forEach(function(e){var i=m(e),r=f(e);t=t.replace(i,r)}),t}function u(e){if(null===e)return null;var t=e.indexOf(":");return-1===t?null:(i={},i[e.substr(0,t)]=e.substr(t+1),i);var i}function p(e){var t=[];return e.forEach(function(e){var i=b.parseUri(e.trim()),r=i.protocol;t.some(function(e){return e===r})||t.push(r)}),t}function d(e){if(P.isNullOrUndefined(e.rawModeData))return!0;var t;try{t=JSON.parse(e.rawModeData)}catch(e){return!1}return _.isEmpty(t)}function g(e){var t=e.url.trim();return v.isNullOrUndefined(e.pathVariables)||Object.keys(e.pathVariables).forEach(function(e){var i=m(e),r=h(e);t=t.replace(i,r)}),b.parseUri(t)}function m(e){return":"+e}function f(e){return"{"+e+"}"}function h(e){return e+"__placeholder"}Object.defineProperty(t,"__esModule",{value:!0});var v=i(1),y=i(27),w=i(16),C=i(34),S=i(72),b=i(35),P=i(1);t.generateQueryParameters=r,t.generatePathParameters=n,t.generateHeaderParameters=o,t.generateBodyParameter=a,t.getRequestUpdatedWithHostParameter=l,t.generateSwaggerPath=c,t.parseHeader=u,t.generateSchemes=p},function(e,t){},function(e,t){e.exports='<div class="custom-connector-dialog"> <modal-dialog model="customConnectorDialogCtrl.customApiDialog"> <dialog-header-content-template> <span>{{::customConnectorDialogCtrl.paneTitle}}</span> <div class="m-alert f-warning" role="alert" ng-if="customConnectorDialogCtrl.validationError"> <button class="c-action-trigger c-glyph glyph-cancel" aria-label="{{::customConnectorDialogCtrl.clientResources.Manage.CustomConnector.Close.AriaLabel}}" ng-click="customConnectorDialogCtrl.validationError = undefined"></button> <div> <div class="c-glyph glyph-info" aria-label="{{::customConnectorDialogCtrl.clientResources.Manage.CustomConnector.Information.AriaLabel}}"></div> <p class="c-paragraph">{{::customConnectorDialogCtrl.validationError.message}}</p> </div> </div> </dialog-header-content-template> <dialog-body-content-template> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label">{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromBlank.Name.Label}}</label> <input ng-disabled="customConnectorDialogCtrl.model.api" class="c-text-field" type="text" ng-model="customConnectorDialogCtrl.dialogData.displayName"/> </div> <div class="pane-field" ng-if="[customConnectorDialogCtrl.CreateDialogMode.OpenApiFile, customConnectorDialogCtrl.CreateDialogMode.Postman].indexOf(customConnectorDialogCtrl.dialogMode) !== -1"> <label ng-if="customConnectorDialogCtrl.dialogMode === customConnectorDialogCtrl.CreateDialogMode.OpenApiFile" class="pane-field-label">{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromOpenAPIFile.Upload.Label}}</label> <label ng-if="customConnectorDialogCtrl.dialogMode === customConnectorDialogCtrl.CreateDialogMode.Postman" class="pane-field-label">{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromPostman.Upload.Label}}</label> <div class="pane-field-swagger-file"> <div class="pane-field-swagger-file-name"> <input class="c-text-field" type="text" ng-model="customConnectorDialogCtrl.dialogData.swaggerFileName" readonly="readonly"/> <input type="file" id="input-file" on-input-file-change="customConnectorDialogCtrl.onImportFile" ngf-select ngf-pattern="\'.json\'" ngf-accept="\'.json\'" ngf-max-size="{{customConnectorDialogCtrl.appSettings.CustomApiUploadFileSize}}"/> </div> <div class="pane-field-swagger-upload-glyph"> <label for="input-file"> <img cdn-src="{{customConnectorDialogCtrl.uploadIcon}}"/> </label> </div> </div> </div> <div class="pane-field" ng-if="customConnectorDialogCtrl.dialogMode === customConnectorDialogCtrl.CreateDialogMode.OpenApiUrl"> <div class="pane-field-swagger-url"> <label class="pane-field-label">{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromOpenAPIUrl.Upload.Label}}</label> <div class="pane-field-swagger-url-name"> <input class="c-text-field" type="text" ng-model="customConnectorDialogCtrl.dialogData.swaggerUrl" placeholder="{{customConnectorDialogCtrl.selectedImportType.description}}"/> </div> <div class="pane-field-swagger-upload-button"> <button type="submit" class="c-button" ng-disabled="!customConnectorDialogCtrl.dialogData.swaggerUrl" ng-click="customConnectorDialogCtrl.onImportUrl()"> {{customConnectorDialogCtrl.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.Button}} </button> </div> </div> </div> </div> </dialog-body-content-template> </modal-dialog> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1078);i(1079);var o=function(){function e(){this.template=i(1080),this.controller=n.DefinitionSwaggerEditorTabCtrl,this.controllerAs="definitionSwaggerEditorTabCtrl"}return e}();t.DefinitionSwaggerEditorTab=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.definitionTab,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(31),o=i(16),s=i(48),a=i(24),l=i(17),c=i(10),u=i(1),p=i(11),d=".left-pane.scrollbox",g=function(){function e(e,t,i,r,l,p,g,m,f){var h=this;this.$interval=e,this.$routeParams=t,this.$scope=i,this.$timeout=r,this.appSettings=l,this.clientResources=p,this.navigationService=g,this.swaggerEditorDataService=m,this.swaggerValidationService=f,this.pageFullyRendered=!1,this.confirmDialog={title:"",message:"",show:!1,onConfirm:void 0},this.actionStatuses=[],this.triggerStatuses=[],this.definitionsStatuses=[],this.parameterStatuses=[],this.responseStatuses=[],this.selectedActionIndex=-1,this.selectedTriggerIndex=-1,this.selectedReferenceIndex=-1,this.referenceIndexFromRoute={definitions:-1,parameters:-1,responses:-1},this.inlineIndexFromRoute={inlineParameter:-1,inlineResponse:-1},this.addNewAction=function(){var e=a.getNewAction();h.swaggerEditorDataService.SwaggerEditorData.swagger.actions.push(e),h.navigationService.navigate(s.getActionUrl(h.swaggerEditorDataService.SwaggerEditorData,h.swaggerEditorDataService.SwaggerEditorData.swagger.actions.length-1))},this.addNewTrigger=function(){var e=a.getNewTrigger();h.swaggerEditorDataService.SwaggerEditorData.swagger.triggers.push(e),h.navigationService.navigate(s.getTriggerUrl(h.swaggerEditorDataService.SwaggerEditorData,h.swaggerEditorDataService.SwaggerEditorData.swagger.triggers.length-1))},this.deleteAction=function(e){Array.isArray(h.swaggerEditorDataService.SwaggerEditorData.swagger.actions)&&(h.swaggerEditorDataService.isDeployedSwaggerAction(e)?(h.confirmDialog.title=h.clientResources.Dialogs.DeleteCustomApiAction.Title,h.confirmDialog.message=u.format(h.clientResources.Dialogs.DeleteCustomApiAction.Message,e.operation.operationId),h.confirmDialog.onConfirm=function(){return h.onDeleteActionConfirmed(e)},h.confirmDialog.show=!0):h.onDeleteActionConfirmed(e))},this.deleteTrigger=function(e){Array.isArray(h.swaggerEditorDataService.SwaggerEditorData.swagger.triggers)&&(h.swaggerEditorDataService.isDeployedSwaggerTrigger(e)?(h.confirmDialog.title=h.clientResources.Dialogs.DeleteCustomApiTrigger.Title,h.confirmDialog.message=u.format(h.clientResources.Dialogs.DeleteCustomApiTrigger.Message,e.operation.operationId),h.confirmDialog.onConfirm=function(){return h.onDeleteTriggerConfirmed(e)},h.confirmDialog.show=!0):h.onDeleteTriggerConfirmed(e))},this.onDeleteActionConfirmed=function(e){h.spliceOperationItem(h.swaggerEditorDataService.SwaggerEditorData.swagger.actions,e)&&(h.swaggerEditorDataService.SwaggerEditorData.swagger.actions.length>0?h.navigateToAction(h.swaggerEditorDataService.SwaggerEditorData.swagger.actions.length-1):n.getCustomApiDefinitionUrl(h.swaggerEditorDataService.SwaggerEditorData.editMode,h.swaggerEditorDataService.SwaggerEditorData.apiName))},this.onDeleteTriggerConfirmed=function(e){h.spliceOperationItem(h.swaggerEditorDataService.SwaggerEditorData.swagger.triggers,e)&&(h.swaggerEditorDataService.SwaggerEditorData.swagger.triggers.length>0?h.navigateToTrigger(h.swaggerEditorDataService.SwaggerEditorData.swagger.triggers.length-1):n.getCustomApiDefinitionUrl(h.swaggerEditorDataService.SwaggerEditorData.editMode,h.swaggerEditorDataService.SwaggerEditorData.apiName))},this.navigateToAction=function(e,t){h.saveLeftColumnScrollPosition(),h.navigationService.navigate(s.getActionUrl(h.swaggerEditorDataService.SwaggerEditorData,e))},this.navigateToTrigger=function(e,t){h.saveLeftColumnScrollPosition(),h.navigationService.navigate(s.getTriggerUrl(h.swaggerEditorDataService.SwaggerEditorData,e))},this.navigateToReference=function(e,t){h.saveLeftColumnScrollPosition(),h.navigationService.navigate(s.getReferenceUrl(h.swaggerEditorDataService.SwaggerEditorData,t,h.getSourceIndex(t)))},this.getActionStatus=function(e,t){return!e||u.isNullOrUndefined(t)?c.AlertType.None:h.actionStatuses[t]||c.AlertType.None},this.getTriggerStatus=function(e,t){return!e||u.isNullOrUndefined(t)?c.AlertType.None:h.triggerStatuses[t]||c.AlertType.None},this.getReferenceStatus=function(e,t){if(!e)return c.AlertType.None;switch(e.source){case o.ReferenceSource.parameters:return h.parameterStatuses[h.getSourceIndex(e)]||c.AlertType.None;case o.ReferenceSource.responses:return h.responseStatuses[h.getSourceIndex(e)]||c.AlertType.None;case o.ReferenceSource.definitions:return h.definitionsStatuses[h.getSourceIndex(e)]||c.AlertType.None;default:return c.AlertType.None}},this.selectedActionIndex=null,this.selectedTriggerIndex=null,this.selectedReferenceIndex=null,this.references=[];var v=this.$routeParams.actionIndex,y=parseInt(v,10),w=this.$routeParams.triggerIndex,C=parseInt(w,10);this.inlineIndexFromRoute={inlineParameter:y>=0||C>=0?parseInt(this.$routeParams.parameterIndex,10):-1,inlineResponse:y>=0||C>=0?parseInt(this.$routeParams.responseIndex,10):-1},this.referenceIndexFromRoute={definitions:parseInt(this.$routeParams.definitionIndex,10),parameters:y>=0||C>=0?-1:parseInt(this.$routeParams.parameterIndex,10),responses:y>=0||C>=0?-1:parseInt(this.$routeParams.responseIndex,10)},this.$scope.$watchGroup([function(){return h.swaggerEditorDataService.SwaggerEditorData.swagger.definitions},function(){return h.swaggerEditorDataService.SwaggerEditorData.swagger.responses},function(){return h.swaggerEditorDataService.SwaggerEditorData.swagger.parameters}],function(){h.references=[].concat(o.convertToReferences(h.swaggerEditorDataService.SwaggerEditorData.swagger.definitions,o.ReferenceSource.definitions),o.convertToReferences(h.swaggerEditorDataService.SwaggerEditorData.swagger.parameters,o.ReferenceSource.parameters),o.convertToReferences(h.swaggerEditorDataService.SwaggerEditorData.swagger.responses,o.ReferenceSource.responses))}),this.$scope.$watch(function(){return h.swaggerEditorDataService.SwaggerEditorData.swagger.triggers},function(){a.isTriggerIndexValid(C,h.swaggerEditorDataService.SwaggerEditorData)&&(h.selectedTriggerIndex=C)}),this.$scope.$watch(function(){return h.swaggerEditorDataService.SwaggerEditorData.swagger.actions},function(){a.isActionIndexValid(y,h.swaggerEditorDataService.SwaggerEditorData)&&(h.selectedActionIndex=y),h.isItemSelected||Array.isArray(h.swaggerEditorDataService.SwaggerEditorData.swagger.actions)&&h.swaggerEditorDataService.SwaggerEditorData.swagger.actions.length>0&&h.navigateToAction(0,h.swaggerEditorDataService.SwaggerEditorData.swagger.actions[0].operation)}),this.$scope.$watch(function(){return h.references},function(){var e=o.ReferenceSources.filter(function(e){return a.isReferenceIndexValid(e,h.referenceIndexFromRoute[e],h.swaggerEditorDataService.SwaggerEditorData)})[0];e&&(h.selectedReferenceIndex=h.getIndex(h.referenceIndexFromRoute[e],e))}),this.$scope.$watch(function(){return h.swaggerValidationService.resultCollection.results},function(){h.updateFoldingListStatuses()}),this.swaggerValidationService.validateIfSwaggerChanged(this.swaggerEditorDataService.swagger),this.$interval(function(){return h.swaggerValidationService.validateIfSwaggerChanged(h.swaggerEditorDataService.swagger)},5e3),$(d).scrollTop(this.swaggerEditorDataService.swaggerEditorUIData.leftColumnScrollPosition),this.$timeout(function(){return h.pageFullyRendered=!0})}return Object.defineProperty(e.prototype,"isItemSelected",{get:function(){return!u.isNullOrUndefined(this.selectedActionIndex)&&this.selectedActionIndex>=0||!u.isNullOrUndefined(this.selectedTriggerIndex)&&this.selectedTriggerIndex>=0||!u.isNullOrUndefined(this.inlineIndexFromRoute.inlineParameter)&&this.inlineIndexFromRoute.inlineParameter>=0||!u.isNullOrUndefined(this.inlineIndexFromRoute.inlineResponse)&&this.inlineIndexFromRoute.inlineResponse>=0||!u.isNullOrUndefined(this.referenceIndexFromRoute.definitions)&&this.referenceIndexFromRoute.definitions>=0||!u.isNullOrUndefined(this.referenceIndexFromRoute.parameters)&&this.referenceIndexFromRoute.parameters>=0||!u.isNullOrUndefined(this.referenceIndexFromRoute.responses)&&this.referenceIndexFromRoute.responses>=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowAction",{get:function(){return a.isActionIndexValid(this.selectedActionIndex,this.swaggerEditorDataService.SwaggerEditorData)&&!this.shouldShowInlineActionParameter&&!this.shouldShowInlineActionResponse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowTrigger",{get:function(){return a.isTriggerIndexValid(this.selectedTriggerIndex,this.swaggerEditorDataService.SwaggerEditorData)&&!this.shouldShowInlineTriggerParameter&&!this.shouldShowInlineTriggerResponse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowInlineParameter",{get:function(){return this.shouldShowInlineActionParameter||this.shouldShowInlineTriggerParameter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowInlineResponse",{get:function(){return this.shouldShowInlineActionResponse||this.shouldShowInlineTriggerResponse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowInlineActionParameter",{get:function(){return a.isActionIndexValid(this.selectedActionIndex,this.swaggerEditorDataService.SwaggerEditorData)&&a.isInlineParameterIndexValid(this.inlineIndexFromRoute.inlineParameter,this.swaggerEditorDataService.swagger.actions[this.selectedActionIndex])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowInlineActionResponse",{get:function(){return a.isActionIndexValid(this.selectedActionIndex,this.swaggerEditorDataService.SwaggerEditorData)&&a.isInlineResponseIndexValid(this.inlineIndexFromRoute.inlineResponse,this.swaggerEditorDataService.swagger.actions[this.selectedActionIndex])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowInlineTriggerParameter",{get:function(){return a.isTriggerIndexValid(this.selectedTriggerIndex,this.swaggerEditorDataService.SwaggerEditorData)&&a.isInlineParameterIndexValid(this.inlineIndexFromRoute.inlineParameter,this.swaggerEditorDataService.swagger.triggers[this.selectedTriggerIndex])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShowInlineTriggerResponse",{get:function(){return Number.isInteger(this.inlineIndexFromRoute.inlineResponse)&&a.isTriggerIndexValid(this.selectedTriggerIndex,this.swaggerEditorDataService.SwaggerEditorData)&&a.isInlineResponseIndexValid(this.inlineIndexFromRoute.inlineResponse,this.swaggerEditorDataService.swagger.actions[this.selectedTriggerIndex])},enumerable:!0,configurable:!0}),e.prototype.spliceOperationItem=function(e,t){var i=e.indexOf(t);return i>=0&&(e.splice(i,1),!0)},e.prototype.updateFoldingListStatuses=function(){var e=this;Array.isArray(this.swaggerEditorDataService.swagger.actions)&&this.swaggerEditorDataService.swagger.actions.forEach(function(t,i){e.updateActionStatus(t,i)}),Array.isArray(this.swaggerEditorDataService.swagger.triggers)&&this.swaggerEditorDataService.swagger.triggers.forEach(function(t,i){e.updateTriggerStatus(t,i)}),Array.isArray(this.swaggerEditorDataService.swagger.definitions)&&this.swaggerEditorDataService.swagger.definitions.forEach(function(t,i){e.updateDefinitionStatus(i)}),Array.isArray(this.swaggerEditorDataService.swagger.parameters)&&this.swaggerEditorDataService.swagger.parameters.forEach(function(t,i){e.updateParameterStatus(i)}),Array.isArray(this.swaggerEditorDataService.swagger.responses)&&this.swaggerEditorDataService.swagger.parameters.forEach(function(t,i){e.updateResponseStatus(i)})},e.prototype.updateActionStatus=function(e,t){var i=new p.Violator({itemPath:p.Paths.Actions+"["+t+"]"}),r=this.swaggerValidationService.resultCollection.filterOnViolator(i);r.add(l.getOperationReferencedResults(e,this.swaggerEditorDataService.swagger,this.swaggerValidationService.resultCollection)),this.actionStatuses[t]=this.filterOutSuccess(r.mostSevereAlertType)},e.prototype.updateTriggerStatus=function(e,t){var i=new p.Violator({itemPath:p.Paths.Triggers+"["+t+"]"}),r=this.swaggerValidationService.resultCollection.filterOnViolator(i);r.add(l.getOperationReferencedResults(e,this.swaggerEditorDataService.swagger,this.swaggerValidationService.resultCollection)),this.triggerStatuses[t]=this.filterOutSuccess(r.mostSevereAlertType)},e.prototype.updateDefinitionStatus=function(e){var t=new p.Violator({itemPath:p.Paths.Definitions+"["+e+"]"}),i=this.swaggerValidationService.resultCollection.filterOnViolator(t);this.definitionsStatuses[e]=this.filterOutSuccess(i.mostSevereAlertType)},e.prototype.updateParameterStatus=function(e){var t=new p.Violator({itemPath:p.Paths.Parameters+"["+e+"]"}),i=this.swaggerValidationService.resultCollection.filterOnViolator(t);this.parameterStatuses[e]=this.filterOutSuccess(i.mostSevereAlertType)},e.prototype.updateResponseStatus=function(e){var t=new p.Violator({itemPath:p.Paths.Responses+"["+e+"]"}),i=this.swaggerValidationService.resultCollection.filterOnViolator(t);this.responseStatuses[e]=this.filterOutSuccess(i.mostSevereAlertType)},e.prototype.saveLeftColumnScrollPosition=function(){this.swaggerEditorDataService.swaggerEditorUIData.leftColumnScrollPosition=$(d).scrollTop()},e.prototype.getOperationText=function(e){return e.operation.operationId},e.prototype.filterOutSuccess=function(e){return e===c.AlertType.Success?c.AlertType.None:e},e.prototype.getReferenceText=function(e){return e.name},e.prototype.getIndex=function(e,t){var i=this.references.filter(function(e){return e.source===t});return this.references.indexOf(i[e])},e.prototype.getSourceIndex=function(e){return this.references.filter(function(t){return t.source===e.source}).indexOf(e)},e.$inject=[r.default.services.$interval,r.default.services.$routeParams,r.default.services.$scope,r.default.services.$timeout,r.default.services.appSettings,r.default.services.clientResources,r.default.services.navigation,r.default.services.swaggerEditorData,r.default.services.swaggerValidationService],e}();t.DefinitionSwaggerEditorTabCtrl=g},function(e,t){},function(e,t){e.exports='<div class="custom-api-definition-tab"> <section class="row section-custom-api-component-section"> <div class="column medium-3 left-pane scrollbox"> <div class="scrollbox-content" ng-class="definitionSwaggerEditorTabCtrl.pageFullyRendered ? \'fully-rendered\' : \'\'"> <folding-list title="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Actions.Heading" description="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Actions.Description" learn-more-hyperlink="" add-new-text="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Actions.AddNew" on-add-new="definitionSwaggerEditorTabCtrl.addNewAction" filter-text="definitionSwaggerEditorTabCtrl.filterText" items="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.SwaggerEditorData.swagger.actions" get-item-text="definitionSwaggerEditorTabCtrl.getOperationText" get-item-status="definitionSwaggerEditorTabCtrl.getActionStatus" on-delete="definitionSwaggerEditorTabCtrl.deleteAction" on-item-click="definitionSwaggerEditorTabCtrl.navigateToAction" selected-item-index="definitionSwaggerEditorTabCtrl.selectedActionIndex" is-collapsed="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.swaggerEditorUIData.foldingListCollapseState.actions"/> <hr/> <folding-list ng-if="definitionSwaggerEditorTabCtrl.appSettings.featureFlags.enableCustomApiTrigger && !definitionSwaggerEditorTabCtrl.appSettings.isWidgetPage" title="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Triggers.Heading" description="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Triggers.Description" learn-more-hyperlink="" add-new-text="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Triggers.AddNew" on-add-new="definitionSwaggerEditorTabCtrl.addNewTrigger" filter-text="definitionSwaggerEditorTabCtrl.filterText" items="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.SwaggerEditorData.swagger.triggers" get-item-text="definitionSwaggerEditorTabCtrl.getOperationText" get-item-status="definitionSwaggerEditorTabCtrl.getTriggerStatus" on-delete="definitionSwaggerEditorTabCtrl.deleteTrigger" on-item-click="definitionSwaggerEditorTabCtrl.navigateToTrigger" selected-item-index="definitionSwaggerEditorTabCtrl.selectedTriggerIndex" is-collapsed="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.swaggerEditorUIData.foldingListCollapseState.triggers"/> <hr ng-if="definitionSwaggerEditorTabCtrl.appSettings.featureFlags.enableCustomApiTrigger && !definitionSwaggerEditorTabCtrl.appSettings.isWidgetPage"/> <folding-list title="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.References.Heading" description="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.References.Description" learn-more-hyperlink="" filter-text="definitionSwaggerEditorTabCtrl.filterText" items="definitionSwaggerEditorTabCtrl.references" get-item-text="definitionSwaggerEditorTabCtrl.getReferenceText" get-item-status="definitionSwaggerEditorTabCtrl.getReferenceStatus" on-item-click="definitionSwaggerEditorTabCtrl.navigateToReference" selected-item-index="definitionSwaggerEditorTabCtrl.selectedReferenceIndex" is-collapsed="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.swaggerEditorUIData.foldingListCollapseState.references"/> </div> </div> <div class="column medium-8 medium-offset-1 right-pane scrollbox"> <div class="scrollbox-content"> <custom-api-action ng-if="definitionSwaggerEditorTabCtrl.shouldShowAction"/> <custom-api-trigger ng-if="definitionSwaggerEditorTabCtrl.shouldShowTrigger && definitionSwaggerEditorTabCtrl.appSettings.featureFlags.enableCustomApiTrigger"/> <custom-api-parameter ng-if="definitionSwaggerEditorTabCtrl.shouldShowInlineParameter"/> <custom-api-response ng-if="definitionSwaggerEditorTabCtrl.shouldShowInlineResponse"/> <div ng-if="definitionSwaggerEditorTabCtrl.selectedReferenceIndex !== null" ng-switch on="definitionSwaggerEditorTabCtrl.references[definitionSwaggerEditorTabCtrl.selectedReferenceIndex].source"> <custom-api-definition ng-switch-when="definitions"/> <custom-api-parameter ng-switch-when="parameters"/> <custom-api-response ng-switch-when="responses"/> </div> </div> </div> </section> <confirm-dialog title="{{definitionSwaggerEditorTabCtrl.confirmDialog.title}}" message="{{definitionSwaggerEditorTabCtrl.confirmDialog.message}}" show="definitionSwaggerEditorTabCtrl.confirmDialog.show" on-confirm="definitionSwaggerEditorTabCtrl.confirmDialog.onConfirm"></confirm-dialog> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1082);i(1083);var o=function(){function e(){this.template=i(1084),this.bindings={model:"="},this.controller=n.CustomApiDetailsTabCtrl,this.controllerAs="customApiDetailsTabCtrl"}return e}();t.CustomApiDetailsTab=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.detailsTab,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(96),o=i(8),s=i(24),a=i(1),l=i(6),c=function(){function e(e,t,i,r,c,u,p){var d=this;this.$routeParams=e,this.$scope=t,this.appSettings=i,this.apisClient=r,this.clientResources=c,this.environmentService=u,this.telemetryService=p,this.ApiAuthenticationType={Basic:"basic",Oauth2:"oauth2",ApiKey:"apiKey",None:"none"},this.authenticationTypes=[{value:this.ApiAuthenticationType.None,displayName:this.clientResources.Manage.CustomApi.Security.noAuth},{value:this.ApiAuthenticationType.Basic,displayName:this.clientResources.Manage.CustomApi.Security.basic},{value:this.ApiAuthenticationType.ApiKey,displayName:this.clientResources.Manage.CustomApi.Security.apiKey},{value:this.ApiAuthenticationType.Oauth2,displayName:this.clientResources.Manage.CustomApi.Security.oauth2}],this.telemetryService.tagEvent(l.TelemetryEventNames.CustomApiDetailsTabVisited),this.model.spinner.show=!0,this.$scope.$watch(function(){return d.model.api},function(){if(!a.isEmpty(d.model.api)&&!a.isEmpty(d.model.api.properties)&&!a.isEmpty(d.model.api.properties.swagger)){var e=d.model.api.properties.swagger,t=s.getAuthenticationTypeFromSwagger(e);d.authenticationType=d.authenticationTypes.filter(function(e){return o.equalsIgnoreCase(e.value,t)})[0],o.equalsIgnoreCase(d.authenticationType.value,d.ApiAuthenticationType.Oauth2)&&!a.isEmpty(d.model.api.properties.connectionParameters)&&d.model.api.properties.connectionParameters.hasOwnProperty("token")&&(d.redirectUrl=d.model.api.properties.connectionParameters.token.oAuthSettings.redirectUrl)}}),this.model.permissions.$watch(this.$scope,function(){d.flowPermissionsList={permissions:d.model.permissions.filter(function(e){return d.model.spinner.show=!1,o.equalsIgnoreCase(e.properties.roleName,n.RoleName.Owner)})}})}return e.$inject=[r.default.services.$routeParams,r.default.services.$scope,r.default.services.appSettings,r.default.services.apisClient,r.default.services.clientResources,r.default.services.environment,r.default.services.telemetry],e}();t.CustomApiDetailsTabCtrl=c},function(e,t){},function(e,t){e.exports='<section class="subsection-manage section-custom-api-details-tab"> <div class="row top-align"> <spinner model="customApiDetailsTabCtrl.spinner"></spinner> <div class="column" ng-hide="customApiDetailsTabCtrl.spinner.show"> <div class="form-row"> <h1 class="ng-binding">{{customApiDetailsTabCtrl.clientResources.Manage.CustomApi.Details.Description}}</h1> <span class="form-element">{{customApiDetailsTabCtrl.model.api.properties.description}}</span> </div> <div class="form-row" ng-if="!!customApiDetailsTabCtrl.flowPermissionsList"> <h1 class="ng-binding">{{customApiDetailsTabCtrl.clientResources.Manage.CustomApi.Details.Owner}}</h1> <flow-permissions-list model="customApiDetailsTabCtrl.flowPermissionsList"/> </div> <div class="form-row"> <h1 class="ng-binding">{{customApiDetailsTabCtrl.clientResources.Manage.CustomApi.Details.AuthenticationType}}</h1> <span class="form-element">{{customApiDetailsTabCtrl.authenticationType.displayName}}</span> </div> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(25);var r=i(0),n=i(1086);i(1087);var o=function(){function e(){this.template=i(1088),this.bindings={title:"<",description:"<",learnMoreHyperlink:"<",addNewText:"<",onAddNew:"<",filterText:"=",items:"<",getItemText:"<",getItemStatus:"<",onDelete:"<",onItemClick:"<",selectedItemIndex:"=",isCollapsed:"="},this.controller=n.FoldingListCtrl,this.controllerAs="foldingListCtrl"}return e}();t.FoldingList=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.foldingList,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(10),s=function(){function e(e,t){this.appSettings=e,this.clientResources=t,this.alertTypeToIcon=(i={},i[o.AlertType.Warning]=n.default.statusWarning,i[o.AlertType.Error]=n.default.statusError,i[o.AlertType.Info]=n.default.statusInfo,i[o.AlertType.Progress]=n.default.statusProgress,i[o.AlertType.Success]=n.default.statusSuccess,i[o.AlertType.None]=null,i),this.populateCommands();var i}return Object.defineProperty(e.prototype,"shouldDisplayCommands",{get:function(){return!!this.onDelete},enumerable:!0,configurable:!0}),e.prototype.populateCommands=function(){var e=this;if(this.commandsPerItem=new Map,this.shouldDisplayCommands)for(var t=this,i=0,r=this.items.length;i<r;i++)!function(i,r){var n=t.items[i];t.commandsPerItem.set(n,[{text:t.clientResources.Manage.Apis.DeleteToolTip,iconUrl:"glyph-delete",click:function(){return e.onDelete(n)}}])}(i)},e.prototype.getCommands=function(e){return this.commandsPerItem.get(e)},e.prototype.getIconUrl=function(e,t){return this.getItemStatus?this.alertTypeToIcon[this.getItemStatus(e,t)]:null},e.$inject=[r.default.services.appSettings,r.default.services.clientResources],e}();t.FoldingListCtrl=s},function(e,t){},function(e,t){e.exports='<div class="context-folding-list" title="{{foldingListCtrl.title}}"> <div class="title" ng-click="foldingListCtrl.isCollapsed = !foldingListCtrl.isCollapsed" aria-expanded="{{!foldingListCtrl.isCollapsed}}"> <span class="folding-list-collapse c-glyph glyph-arrow" ng-if="foldingListCtrl.isCollapsed"></span> <span class="folding-list-collapse c-glyph glyph-arrowdown" ng-if="!foldingListCtrl.isCollapsed"></span> <span class="title">{{foldingListCtrl.title}} ({{foldingListCtrl.items ? foldingListCtrl.items.length : 0}})</span> </div> <div ng-if="!foldingListCtrl.isCollapsed"> <p class="description">{{foldingListCtrl.description}}</p> <a ng-if="foldingListCtrl.learnMoreHyperlink" class="c-hyperlink" target="_blank" href="{{foldingListCtrl.learnMoreHyperlink}}">{{foldingListCtrl.clientResources.Manage.CustomApi.LearnMore}}</a> <ul> <li class="list-item" ng-repeat="item in foldingListCtrl.items" title="{{foldingListCtrl.getItemText(item)}}"> <a ng-class="{\'selected\': foldingListCtrl.selectedItemIndex === $index}" ng-click="foldingListCtrl.onItemClick($index, item)"> <img class="item-status" src="{{foldingListCtrl.getIconUrl(item, $index)}}"> <span class="index">{{$index+1}}</span> <span class="item-text" ng-class="{\'commands\': foldingListCtrl.shouldDisplayCommands}">{{foldingListCtrl.getItemText(item)}}</span> </a> <list-commands class="command-item" ng-if="foldingListCtrl.shouldDisplayCommands" model="foldingListCtrl.getCommands(item)"></list-commands> </li> </ul> <div class="list-item" ng-if="foldingListCtrl.addNewText" title="{{foldingListCtrl.addNewText}}"> <div ng-click="foldingListCtrl.onAddNew()" role="button"> <span class="index add-new c-glyph glyph-create"></span> <span class="add-new-text">{{foldingListCtrl.addNewText}}</span> </div> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1090);i(1091);var o=function(){function e(){this.template=i(1092),this.controller=n.GeneralSwaggerEditorTabCtrl,this.controllerAs="generalSwaggerEditorTabCtrl"}return e}();t.GeneralSwaggerEditorTab=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.generalTab,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(10),n=i(0),o=i(72),s=i(24),a=i(31),l=i(6),c=i(62),u=i(222),p=i(5),d=i(15),g=i(1),m=i(67),f=i(11),h=i(207),v=1,y=["image/jpeg","image/jpg","image/png"],w="swagger",C="postman",S="url",b=function(){function e(e,t,i,r,n,o,s,a,c){var u=this;this.$scope=e,this.appSettings=t,this.clientResources=i,this.customApiHelperService=r,this.loggingService=n,this.fileReader=o,this.navigationService=s,this.swaggerEditorDataService=a,this.telemetryService=c,this.uploadIcon=p.default.contentUpload,this.iconBrandColorValidationResults=new f.ValidationResultCollection,this.hostValidationResults=new f.ValidationResultCollection,this.basePathValidationResults=new f.ValidationResultCollection,this.importTypes=[{format:w,label:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.Label,description:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.PlaceHolder},{format:S,label:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.Label,description:"https://"},{format:C,label:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.Label,description:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.PlaceHolder}],this.selectedImportType=this.importTypes[0],this.onImportFile=function(e){u.dismissValidationError();var t=e.target.files[0];t&&(u.selectedImportType.format===w?(u.telemetryService.tagEvent(l.TelemetryEventNames.SwaggerFileUploaded),u.onImportSwaggerFile(t)):u.selectedImportType.format===C&&(u.telemetryService.tagEvent(l.TelemetryEventNames.PostmanCollectionUploaded),u.onImportPostmanCollection(t)))},this.onImportIconFile=function(e){e&&(u.dismissValidationError(),u.telemetryService.tagEvent(l.TelemetryEventNames.CustomApiIconUploaded),g.getFileSizeInMb(e)>=v?u.setValidationError(u.clientResources.Manage.CustomApi.General.MaxIconSizeExceeded):u.isValidImageFileFormat(e.type)?(u.swaggerEditorData.swaggerIconFile=e,u.fileReader(u.swaggerEditorData.swaggerIconFile).asDataURL().then(function(e){u.swaggerEditorData.swaggerIconFileContentUrl=e,u.swaggerEditorDataService.setIconDisplay()})):u.setValidationError(u.clientResources.Manage.CustomApi.General.InvalidIconFileFormat))},this.telemetryService.tagEvent(l.TelemetryEventNames.CustomApiGeneralTabVisited),this.swaggerEditorData=this.swaggerEditorDataService.SwaggerEditorData,this.$scope.$watch(function(){return u.swaggerEditorData.swaggerIconBrandColor},function(){return u.onIconBrandColorChanged()}),this.$scope.$watch(function(){return u.swaggerEditorData.swagger.host},function(){return u.onHostChanged()}),this.$scope.$watch(function(){return u.swaggerEditorData.swagger.basePath},function(){return u.onBasePathChanged()})}return Object.defineProperty(e.prototype,"isLogicApps",{get:function(){return h.isLogicApps(this.appSettings)},enumerable:!0,configurable:!0}),e.prototype.onImportUrl=function(){var e=this;this.dismissValidationError();var t=this.swaggerEditorData.swaggerUrl;if(t){if(!m.isHttpsUrl(t))return void this.setValidationError(this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.Error.notHttps);this.telemetryService.tagEvent(l.TelemetryEventNames.SwaggerUrlUploaded),this.swaggerEditorData.spinner.show=!0,this.swaggerEditorData.statusAlert.options.show(r.AlertType.Progress,this.clientResources.Manage.CustomApi.DownloadingSwagger),this.customApiHelperService.getSwaggerFromUrl(t,!0).then(function(t){var i=JSON.stringify(t),r=new Blob([i]),n=g.convertBlobToFile(r,"swagger.json");e.onImportSwaggerFile(n),e.swaggerEditorData.statusAlert.options.hide()}).catch(function(t){e.setValidationError(e.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.Error.downloadFailed),e.loggingService.logError("GeneralSwaggerEditorTabCtrl.onImportUrl",t)}).finally(function(){e.swaggerEditorData.spinner.show=!1})}},e.prototype.onImportPostmanCollection=function(e){var t=this;if(g.getFileSizeInMb(e)>=1)return void this.setValidationError(this.clientResources.Manage.CustomApi.General.MaxPostmanCollectionFileSizeExceeded);this.fileReader(e).asText().then(function(e){var i;try{i=JSON.parse(e)}catch(e){return void t.setValidationError(t.clientResources.Manage.CustomApi.General.FileNotInJsonFormat)}var r=i;return r&&r.requests&&r.requests.length>0?i.info&&i.info.schema&&i.info.schema===o.PostmanCollectionV2Schema?void t.setValidationError(t.clientResources.Manage.CustomApi.General.PostmanCollectionV2NotSupported):(t.updateSwaggerEditorData("generatedApiDefinition.swagger.json",c.deserialize(new u.PostmanCollectionConverter({assignTestValues:t.appSettings.featureFlags.enableAdvancedTestApiMode}).convertToSwagger(e))),void t.loggingService.logInfo("SwaggerGeneratedFromPostmanCollection","Swagger was successfully generated from the imported Postman collection")):void t.setValidationError(t.clientResources.Manage.CustomApi.General.InvalidPostmanCollection)})},e.prototype.onImportSwaggerFile=function(e){var t=this;if(g.getFileSizeInMb(e)>=1)return void this.setValidationError(this.clientResources.Manage.CustomApi.General.MaxSwaggerFileSizeExceeded);this.fileReader(e).asText().then(function(i){var r;try{if("object"!=typeof(r=JSON.parse(i)))throw new Error("Swagger file is not a json object")}catch(e){return t.loggingService.logError("GeneralSwaggerEditorTabCtrl.onImportSwaggerFile",e),void t.setValidationError(t.clientResources.Manage.CustomApi.General.FileNotInJsonFormat)}t.updateSwaggerEditorData(e.name,c.deserialize(_.assign({},s.BaseSwagger,r)))})},e.prototype.onIconBrandColorChanged=function(){this.iconBrandColorValidationResults.clear();var e=this.swaggerEditorDataService.validateSwaggerIconBrandColor();e?this.iconBrandColorValidationResults.add(new f.ValidationResult(e.code,f.ResultType.Error,e.message,null)):this.swaggerEditorDataService.setIconDisplay()},e.prototype.onHostChanged=function(){this.hostValidationResults.clear();var e=this.swaggerEditorDataService.validateSwaggerHost();e&&this.hostValidationResults.add(new f.ValidationResult(e.code,f.ResultType.Error,e.message,null))},e.prototype.onBasePathChanged=function(){this.basePathValidationResults.clear();var e=this.swaggerEditorDataService.validateSwaggerBasePath();e&&this.basePathValidationResults.add(new f.ValidationResult(e.code,f.ResultType.Error,e.message,null))},e.prototype.updateSwaggerEditorData=function(e,t){this.swaggerEditorData.swaggerFileName=e,this.swaggerEditorData.swagger=t,this.swaggerEditorData.securityTabDetails.initialConnectionParameters=this.swaggerEditorDataService.constructInitialConnectionParametersFromSwagger(),this.swaggerEditorData.editMode||this.swaggerEditorDataService.updateDisplayName()},e.prototype.dismissValidationError=function(){this.swaggerEditorData.validatationError=null},e.prototype.setValidationError=function(e){this.swaggerEditorData.validatationError=new d.ClientError(d.ErrorCodes.customApiValidationError,e,null)},e.prototype.continue=function(){this.navigationService.navigate(a.getCustomApiBaseUrl(this.swaggerEditorData.editMode,this.swaggerEditorData.apiName)+"/security")},e.prototype.isValidImageFileFormat=function(e){return y.some(function(t){return t===e.toLowerCase()})},e.$inject=[n.default.services.$scope,n.default.services.appSettings,n.default.services.clientResources,n.default.services.customApiHelper,n.default.services.logging,n.default.services.fileReaderHelperService,n.default.services.navigation,n.default.services.swaggerEditorData,n.default.services.telemetry],e}();t.GeneralSwaggerEditorTabCtrl=b},function(e,t){},function(e,t){e.exports='<div class="section-custom-api-general-tab"> <section class="row section-custom-api-component-section" ng-if="generalSwaggerEditorTabCtrl.isLogicApps || !generalSwaggerEditorTabCtrl.appSettings.featureFlags.enableBlankConnector"> <div class="column medium-3 left-pane"> <div class="title">{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.LeftPane.ImportSwagger.Heading}}</div> <p> {{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.LeftPane.ImportSwagger.Description}} <learn-more resource="\'Manage.CustomApi.General.LeftPane.Hyperlink\'"/> </p> </div> <div class="column medium-8 medium-offset-1 right-pane"> <div class="pane-title"> <span>{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Import.Heading}}</span> </div> <div class="pane-content"> <div class="pane-field"> <fieldset class="c-radio f-inline"> <div ng-repeat="importType in generalSwaggerEditorTabCtrl.importTypes"> <label class="c-label pane-field-label"> <input type="radio" aria-label="{{importType.label}}" name="importTypeFieldset" ng-value="importType" ng-checked="importType === generalSwaggerEditorTabCtrl.selectedImportType" ng-model="generalSwaggerEditorTabCtrl.selectedImportType"/> <span>{{importType.label}}</span> </label> </div> </fieldset> <div class="pane-field-swagger-file" ng-if="generalSwaggerEditorTabCtrl.selectedImportType.format !== \'url\'"> <div class="pane-field-swagger-file-name"> <input class="c-text-field" type="text" ng-model="generalSwaggerEditorTabCtrl.swaggerEditorData.swaggerFileName" readonly="readonly" placeholder="{{generalSwaggerEditorTabCtrl.selectedImportType.description}}"/> <input type="file" id="input-file" on-input-file-change="generalSwaggerEditorTabCtrl.onImportFile" ngf-select ngf-pattern="\'.json\'" ngf-accept="\'.json\'" ngf-max-size="{{generalSwaggerEditorTabCtrl.appSettings.CustomApiUploadFileSize}}"/> </div> <div class="pane-field-swagger-upload-glyph"> <label for="input-file"> <img cdn-src="{{generalSwaggerEditorTabCtrl.uploadIcon}}"/> </label> </div> </div> <div class="pane-field-swagger-url" ng-if="generalSwaggerEditorTabCtrl.selectedImportType.format === \'url\'"> <div class="pane-field-swagger-url-name"> <input class="c-text-field" type="text" ng-model="generalSwaggerEditorTabCtrl.swaggerEditorData.swaggerUrl" placeholder="{{generalSwaggerEditorTabCtrl.selectedImportType.description}}"/> </div> <div class="pane-field-swagger-upload-button"> <button type="submit" class="c-button" ng-disabled="!generalSwaggerEditorTabCtrl.swaggerEditorData.swaggerUrl" ng-click="generalSwaggerEditorTabCtrl.onImportUrl()"> {{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.Button}} </button> </div> </div> </div> </div> </div> </section> <hr ng-if="generalSwaggerEditorTabCtrl.isLogicApps || !generalSwaggerEditorTabCtrl.appSettings.featureFlags.enableBlankConnector"/> <section class="row section-custom-api-component-section"> <div class="column medium-3 left-pane"> <div class="title">{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Heading}}</div> <p>{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.LeftPane.GeneralInformation.Description}}</p> </div> <div class="column medium-8 medium-offset-1 right-pane"> <div class="pane-title"> <span>{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Heading}}</span> </div> <div class="pane-content"> <div class="icon-section"> <div class="icon-holder"> <button class="c-button icon-holder-button" ngf-select="generalSwaggerEditorTabCtrl.onImportIconFile($file)" ngf-pattern="\'image/*\'" ngf-accept="\'image/*\'" ngf-max-size="{{generalSwaggerEditorTabCtrl.appSettings.CustomApiUploadFileSize}}"> <div class="icon-holder-image" ng-style="generalSwaggerEditorTabCtrl.swaggerEditorData.swaggerIconDisplay"></div> <div class="c-label icon-holder-label">{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Icon.Upload}}</div> </button> </div> <div class="icon-description"> <label>{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Icon.Label}}</label> <label>{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Icon.Description}}</label> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.IconBrandColor.Label}}</label> <validated-input input-model="generalSwaggerEditorTabCtrl.swaggerEditorData.swaggerIconBrandColor" input-placeholder="::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.IconBrandColor.PlaceHolder" input-maxlength="7" validation-result-collection="generalSwaggerEditorTabCtrl.iconBrandColorValidationResults"/> </div> <div class="pane-field"> <label class="pane-field-label">{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Description.Label}}</label> <div class="c-textarea"> <textarea ng-attr-placeholder="{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Description.PlaceHolder}}" ng-model="generalSwaggerEditorTabCtrl.swaggerEditorData.swagger.info.description"/>\r\n                    </div>\r\n                </div>\r\n                <div class="pane-field">\r\n                    <label class="pane-field-label"><span class="context-required-text">*</span> {{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Host.Label}}</label>\r\n                    <validated-input input-model="generalSwaggerEditorTabCtrl.swaggerEditorData.swagger.host" input-maxlength="100" , input-placeholder="::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Host.PlaceHolder" , validation-result-collection="generalSwaggerEditorTabCtrl.hostValidationResults" is-required="true"/>\r\n                </div>\r\n                <div class="pane-field">\r\n                    <label class="pane-field-label">{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.BaseUrl.Label}}</label>\r\n                    <validated-input input-model="generalSwaggerEditorTabCtrl.swaggerEditorData.swagger.basePath" input-maxlength="100" validation-result-collection="generalSwaggerEditorTabCtrl.basePathValidationResults"/>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </section>\r\n    <section class="row section-custom-api-component-section">\r\n        <div class="column medium-3 left-pane minimal-content">\r\n        </div>\r\n        <div class="column medium-7 medium-offset-1">\r\n            <button type="submit" class="c-button" ng-click="generalSwaggerEditorTabCtrl.continue()">{{generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.General.Continue}}</button>\r\n        </div>\r\n    </section>\r\n</div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1094);i(1095);var o=function(){function e(){this.template=i(1096),this.bindings={parameter:"=",schemaProperty:"=",operationItems:"<"},this.controller=n.ParameterDropdownEditorCtrl,this.controllerAs="parameterDropdownEditorCtrl"}return e}();t.ParameterDropdownEditor=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.parameterDropdownEditor,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(27),o=i(16),s=i(34),a=i(24),l=i(1),c=function(){function e(e,t,i){var r=this;this.$scope=e,this.clientResources=t,this.swaggerEditorDataService=i,this.useCustomValueDropdownOption=this.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValueParameter.UseCustomValue,this.DropdownType={disabled:this.clientResources.Manage.CustomApi.ParameterDropdownEditor.DropdownType.Disabled,static:this.clientResources.Manage.CustomApi.ParameterDropdownEditor.DropdownType.Static,dynamic:this.clientResources.Manage.CustomApi.ParameterDropdownEditor.DropdownType.Dynamic},this.dropdownTypes=[this.DropdownType.disabled,this.DropdownType.static,this.DropdownType.dynamic],this.selectedDropdownType=this.DropdownType.disabled,this.enumString="",this.currentOperationParameterNames=[],this.dynamicValueOperationIndex=-1,this.dynamicValueOperationOptions=[],this.valuePathIndex=-1,this.valuePathOptions=[],this.valueTitleIndex=-1,this.valueTitleOptions=[],this.dynamicValueParameters=[],this.dynamicValueOperationOptions=this.swaggerEditorDataService.swagger.actions.filter(function(e){return"get"===e.method}).map(function(e){return e.operation}),this.initializeDropdownType(),this.$scope.$watch(function(){return r.selectedDropdownType},function(){r.updateDropdownType()}),this.$scope.$watch(function(){return r.enumString},function(){r.updateEnum()}),this.$scope.$watch(function(){return r.dynamicValueOperationIndex},function(e,t){e!==t&&r.onDynamicValueOperationChanged()}),this.$scope.$watch(function(){return r.valuePathIndex},function(e,t){e!==t&&(r.populateValueTitleOptions(),r.valuePathOutputParameter&&r.saveDynamicValues())}),this.$scope.$watch(function(){return r.valueTitleIndex},function(e,t){e!==t&&r.valueTitleOutputParameter&&r.saveDynamicValues()})}return e.prototype.initializeDropdownType=function(){this.dynamicValues?this.selectedDropdownType=this.DropdownType.dynamic:this.isSchemaProperty&&this.schemaProperty.enum||!this.isSchemaProperty&&this.parameter.enum?this.selectedDropdownType=this.DropdownType.static:this.selectedDropdownType=this.DropdownType.disabled},Object.defineProperty(e.prototype,"isSchemaProperty",{get:function(){return l.isNullOrUndefined(this.parameter)&&!l.isNullOrUndefined(this.schemaProperty)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"operationDropdownEnabled",{get:function(){return this.swaggerEditorDataService.swagger.actions.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dynamicValueOperation",{get:function(){return this.dynamicValueOperationOptions?this.dynamicValueOperationOptions[this.dynamicValueOperationIndex]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valuePathOutputParameter",{get:function(){return this.valuePathOptions[this.valuePathIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueTitleOutputParameter",{get:function(){return this.valueTitleOptions[this.valueTitleIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dynamicValues",{get:function(){return this.isSchemaProperty?this.schemaProperty.dynamicValues:this.parameter[o.Swagger.DynamicValues]},enumerable:!0,configurable:!0}),e.prototype.updateDropdownType=function(){switch(this.selectedDropdownType){case this.DropdownType.static:this.clearDynamicValues(),this.enumString=this.getEnumString();break;case this.DropdownType.dynamic:this.clearEnum(),this.initializeDynamicValueDropdowns();break;case this.DropdownType.disabled:default:this.clearDynamicValues(),this.clearEnum()}},e.prototype.updateEnum=function(){l.isNullOrWhitespace(this.enumString)?this.clearEnum():this.setEnum(this.splitEnumStringOnCommas(this.enumString))},e.prototype.onDynamicValueOperationChanged=function(){var e=this;if(this.dynamicValueOperation){var t=a.getParametersWithResolvedReferences(this.dynamicValueOperation.parameters,this.swaggerEditorDataService.swagger);this.dynamicValueParameters=t.filter(function(e){return e.in!==n.ParameterLocations.body}).map(function(e){return e}).filter(function(e){return e.required}).map(function(t){return{parameter:t,customValue:l.isNullOrUndefined(t.default)?"":t.default,useCustomValue:e.currentOperationParameterNames.length<=1,referencedParameterName:void 0}});var i=this.dynamicValueOperation.responses.filter(function(e){return"200"===e.name})[0]||this.dynamicValueOperation.responses.filter(function(e){return"default"===e.name})[0];if(i&&i.item){var r;r=a.isReference(i.item)?a.getJsonReference(this.swaggerEditorDataService.swagger,i.item.$ref):i;var o=s.resolveSchema(this.swaggerEditorDataService.swagger,r.item.schema),c=s.getLeafSchemaProperties(o.schema);this.valuePathOptions=c.filter(function(e){return e.isInsideArray}),this.valuePathIndex=-1,this.valueTitleIndex=-1}}},e.prototype.populateValueTitleOptions=function(){var e=this;this.valueTitleOptions=this.valuePathOutputParameter?this.valuePathOptions.filter(function(t){return t.parentArray===e.valuePathOutputParameter.parentArray}):[],this.valueTitleIndex=-1},e.prototype.initializeDynamicValueDropdowns=function(){var e=this;if(this.updateParameterNamesForCurrentOperations(),this.dynamicValueParameters=[],this.dynamicValueOperationIndex=-1,this.valuePathIndex=-1,this.valueTitleIndex=-1,this.dynamicValues&&this.dynamicValues[o.DynamicValueFields.valuePath]&&this.dynamicValues.operationId&&(this.dynamicValueOperationIndex=this.dynamicValueOperationOptions.map(function(e){return e.operationId}).indexOf(this.dynamicValues.operationId),!(this.dynamicValueOperationIndex<0)&&(this.onDynamicValueOperationChanged(),this.valuePathIndex=this.valuePathOptions.filter(function(t){return(t.parentArray?t.parentArray.replace(".","/"):t.parentArray)===e.dynamicValues[o.DynamicValueFields.valueCollection]}).map(function(e){return e.name.replace(".","/")}).indexOf(this.dynamicValues[o.DynamicValueFields.valuePath]),this.populateValueTitleOptions(),this.dynamicValues[o.DynamicValueFields.valueTitle]&&(this.valueTitleIndex=this.valueTitleOptions.map(function(e){return e.name.replace(".","/")}).indexOf(this.dynamicValues[o.DynamicValueFields.valueTitle])),this.dynamicValues.parameters))){var t=this;for(var i in this.dynamicValues.parameters){if("break"===function(e){var i=t.dynamicValueParameters.filter(function(t){return t.parameter.name===e})[0];if(!i)return"break";"string"==typeof t.dynamicValues.parameters[e]?(i.useCustomValue=!0,i.customValue=t.dynamicValues.parameters[e]):t.currentOperationParameterNames.length>1?(i.useCustomValue=!1,i.referencedParameterName=t.dynamicValues.parameters[e].parameter):(i.useCustomValue=!0,i.customValue="")}(i))break}}},e.prototype.updateParameterNamesForCurrentOperations=function(){var e=this;this.currentOperationParameterNames=[];var t;this.operationItems.forEach(function(i){var r=e.getParameterNamesInOperation(i);t=r.filter(function(e){return l.isNullOrUndefined(t)||-1!==t.indexOf(e)})}),t.forEach(function(t){return e.currentOperationParameterNames.push(t)}),this.currentOperationParameterNames.push(this.useCustomValueDropdownOption)},e.prototype.getParameterNamesInOperation=function(e){var t=a.getParametersWithResolvedReferences(e.operation.parameters,this.swaggerEditorDataService.swagger);if(!Array.isArray(t))return[];var i=t.filter(function(e){return e.in!==n.ParameterLocations.body}).map(function(e){return e.name}),r=t.filter(function(e){return e.in===n.ParameterLocations.body})[0];if(r){var o=s.resolveSchema(this.swaggerEditorDataService.swagger,r.schema),c=s.getLeafSchemaProperties(o.schema).map(function(e){return e.name});i=i.concat(c)}return l.getArrayWithNoDuplicates(i)},e.prototype.saveDynamicValues=function(){var e=this;if(this.dynamicValueOperation){var t={};if(Array.isArray(this.dynamicValueParameters)&&this.dynamicValueParameters.forEach(function(i){if(i.referencedParameterName===e.useCustomValueDropdownOption&&(i.useCustomValue=!0,i.referencedParameterName=null),i.useCustomValue){if(l.isNullOrWhitespace(i.customValue))return;t[i.parameter.name]=i.customValue}else{if(l.isNullOrWhitespace(i.referencedParameterName))return;var r={parameter:i.referencedParameterName};t[i.parameter.name]=r}}),this.valuePathOutputParameter){var i={operationId:this.dynamicValueOperation.operationId,"value-path":this.valuePathOutputParameter.name.replace(".","/")},r=this.valuePathOutputParameter.parentArray;r&&(i[o.DynamicValueFields.valueCollection]=r.replace(".","/"));var n=this.valueTitleOutputParameter?this.valueTitleOutputParameter.name.replace(".","/"):null;n&&(i[o.DynamicValueFields.valueTitle]=n),l.isEmpty(t)||(i.parameters=t),this.setDynamicValues(i)}}},e.prototype.splitEnumStringOnCommas=function(e){for(var t=[],i=!1,r=!1,n="",o=0,s=e;o<s.length;o++){var a=s[o];r||"\\"!==a?(r?n+=a:i?'"'===a?(t.push(n.trim()),n="",i=!1):n+=a:","!==a||l.isNullOrWhitespace(n)?'"'===a?i=!0:","!==a&&(n+=a):(t.push(n.trim()),n=""),r=!1):r=!0}return!i&&n.trim().length>0&&t.push(n.trim()),t},e.prototype.surroundWithQuotes=function(e){return'"'+e+'"'},e.prototype.getUniqueOutputParameterName=function(e){return e.parentArray?e.parentArray+"["+e.name+"]":e.name},e.prototype.setEnum=function(e){if(this.isSchemaProperty){var t=[];e.forEach(function(e){t.push({displayName:e,value:e})}),this.schemaProperty.enum=t}else this.parameter.enum=e},e.prototype.getEnumString=function(){var e=this;return this.isSchemaProperty?Array.isArray(this.schemaProperty.enum)?this.schemaProperty.enum.map(function(t){return e.surroundWithQuotes(t.value)}).join(", ").trim():"":Array.isArray(this.parameter.enum)?this.parameter.enum.map(function(t){return e.surroundWithQuotes(t)}).join(", ").trim():""},e.prototype.clearEnum=function(){this.isSchemaProperty?delete this.schemaProperty.enum:delete this.parameter.enum},e.prototype.clearDynamicValues=function(){this.isSchemaProperty?delete this.schemaProperty.dynamicValues:delete this.parameter[o.Swagger.DynamicValues]},e.prototype.setDynamicValues=function(e){this.isSchemaProperty?this.schemaProperty.dynamicValues=e:this.parameter[o.Swagger.DynamicValues]=e},e.$inject=[r.default.services.$scope,r.default.services.clientResources,r.default.services.swaggerEditorData],e}();t.ParameterDropdownEditorCtrl=c},function(e,t){},function(e,t){e.exports='<div class="parameter-dropdown-editor-container"> <div class="pane-field"> <fieldset class="c-radio f-inline"> <legend class="pane-field-label"> {{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DropdownType.Label}} <learn-more resource="\'Manage.CustomApi.Definition.RightPane.DropdownType.Hyperlink\'"/> </legend> <div> <div ng-repeat="dropdownType in parameterDropdownEditorCtrl.dropdownTypes"> <label class="c-label"> <input type="radio" aria-label="{{dropdownType}}" ng-value="dropdownType" ng-model="parameterDropdownEditorCtrl.selectedDropdownType"/> <span>{{dropdownType}}</span> </label> </div> </div> </fieldset> </div> <div ng-if="parameterDropdownEditorCtrl.selectedDropdownType === parameterDropdownEditorCtrl.DropdownType.static"> <div class="pane-field"> <label class="pane-field-label">{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.EnumValues.Label}}</label> <input class="c-text-field" type="text" ng-model="parameterDropdownEditorCtrl.enumString" placeholder="{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.EnumValues.Placeholder}}"/> </div> </div> <div ng-if="parameterDropdownEditorCtrl.selectedDropdownType === parameterDropdownEditorCtrl.DropdownType.dynamic"> <div class="pane-field"> <div class="pane-field"> <label class="pane-field-label">{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.OperationId.Label}}<span class="context-required-text"> *</span></label> <div class="c-select"> <select ng-disabled="!parameterDropdownEditorCtrl.operationDropdownEnabled" ng-model="parameterDropdownEditorCtrl.dynamicValueOperationIndex" ng-options="parameterDropdownEditorCtrl.dynamicValueOperationOptions.indexOf(operation) as operation.operationId for operation in parameterDropdownEditorCtrl.dynamicValueOperationOptions"> <option disabled="disabled" selected="selected" value>{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.OperationId.Placeholder}}</option> </select> </div> </div> <div class="pane-field" ng-repeat="dynamicValueParameter in parameterDropdownEditorCtrl.dynamicValueParameters"> <label class="pane-field-label">{{dynamicValueParameter.parameter.name}}<span class="context-required-text" ng-if="dynamicValueParameter.parameter.required"> *</span></label> <div class="input-with-image-container" ng-if="dynamicValueParameter.useCustomValue"> <input class="c-text-field" type="text" ng-model="dynamicValueParameter.customValue" ng-change="parameterDropdownEditorCtrl.saveDynamicValues()"/> <span ng-if="parameterDropdownEditorCtrl.currentOperationParameterNames.length > 1" ng-click="dynamicValueParameter.useCustomValue = false" class="c-glyph glyph-arrowdown"/> </div> <div class="c-select" ng-if="!dynamicValueParameter.useCustomValue"> <select ng-disabled="!parameterDropdownEditorCtrl.dynamicValueOperation" ng-model="dynamicValueParameter.referencedParameterName" ng-change="parameterDropdownEditorCtrl.saveDynamicValues()" ng-options="parameterName for parameterName in parameterDropdownEditorCtrl.currentOperationParameterNames"> <option disabled="disabled" selected="selected" value>{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValueParameter.Placeholder}}</option> </select> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValue.Label}}<span class="context-required-text"> *</span></label> <div class="c-select"> <select ng-disabled="!parameterDropdownEditorCtrl.dynamicValueOperation" ng-model="parameterDropdownEditorCtrl.valuePathIndex" ng-options="parameterDropdownEditorCtrl.valuePathOptions.indexOf(outputParameter) as parameterDropdownEditorCtrl.getUniqueOutputParameterName(outputParameter) for outputParameter in parameterDropdownEditorCtrl.valuePathOptions"> <option disabled="disabled" selected="selected" value>{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValue.Placeholder}}</option> </select> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValueDisplayName.Label}}</label> <div class="c-select"> <select ng-disabled="!parameterDropdownEditorCtrl.valuePathOutputParameter" ng-model="parameterDropdownEditorCtrl.valueTitleIndex" ng-options="parameterDropdownEditorCtrl.valueTitleOptions.indexOf(outputParameter) as parameterDropdownEditorCtrl.getUniqueOutputParameterName(outputParameter) for outputParameter in parameterDropdownEditorCtrl.valueTitleOptions"> <option disabled="disabled" selected="selected" value>{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValueDisplayName.Placeholder}}</option> </select> </div> </div> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1098);i(1099);var o=function(){function e(){this.template=i(1100),this.controller=n.SecuritySwaggerEditorTabCtrl,this.controllerAs="securitySwaggerEditorTabCtrl"}return e}();t.SecuritySwaggerEditorTab=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.securityTab,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(8),s=i(31),a=i(117),l=i(35),c=i(29),u=i(1),p=i(3),d=i(24),g=i(6),m=i(10),f=function(){function e(e,t,i,r,o,s,a,l,c){this.$scope=e,this.appSettings=t,this.clientResources=i,this.connectionFormService=r,this.customApiHelper=o,this.loggingService=s,this.navigationService=a,this.swaggerEditorDataService=l,this.telemetryService=c,this.copyToClipboardImage=n.default.copyClipboard,this.ApiAuthenticationType={Basic:"basic",Oauth2:"oauth2",ApiKey:"apiKey",None:"none"},this.ApiKeyLocationType={Query:"query",Header:"header"},this.apiKeyLocationTypes=[{value:this.ApiKeyLocationType.Query,displayName:this.clientResources.Manage.CustomApi.Security.ApiKey.Location.query},{value:this.ApiKeyLocationType.Header,displayName:this.clientResources.Manage.CustomApi.Security.ApiKey.Location.header}],this.authenticationTypes=[{value:this.ApiAuthenticationType.None,displayName:this.clientResources.Manage.CustomApi.Security.noAuth},{value:this.ApiAuthenticationType.Basic,displayName:this.clientResources.Manage.CustomApi.Security.basic},{value:this.ApiAuthenticationType.ApiKey,displayName:this.clientResources.Manage.CustomApi.Security.apiKey},{value:this.ApiAuthenticationType.Oauth2,displayName:this.clientResources.Manage.CustomApi.Security.oauth2}],this.swaggerEditorData=l.SwaggerEditorData,this.telemetryService.tagEvent(g.TelemetryEventNames.CustomApiSecurityTabVisited),this.initializeSecurityTab()}return e.prototype.initializeSecurityTab=function(){var e=this;this.swaggerEditorData.securityTabDetails.selectedAuthenticationType=d.getAuthenticationTypeFromSwagger(this.swaggerEditorData.swagger),this.isValidAuthenticationType(this.swaggerEditorData.securityTabDetails.selectedAuthenticationType)||(this.loggingService.logWarning("CustomApi.isValidAuthenticationType",this.clientResources.Manage.CustomApi.Security.invalidAuthType),this.swaggerEditorData.securityTabDetails.selectedAuthenticationType=this.ApiAuthenticationType.None),this.$scope.$watch(function(){return e.swaggerEditorData.securityTabDetails.selectedAuthenticationType},function(){return e.authenticationTypeChanged()}),this.$scope.$watch(function(){return e.swaggerEditorData.securityTabDetails.selectedIdentityProviderId},function(t,i){u.isNullOrUndefined(t)||(t!==i?e.identityProviderChanged():e.swaggerEditorData.securityTabDetails.selectedAuthenticationType===e.ApiAuthenticationType.Oauth2&&(e.swaggerEditorData.spinner.show=!1))})},e.prototype.isValidAuthenticationType=function(e){return o.equalsIgnoreCase(e,this.ApiAuthenticationType.None)||o.equalsIgnoreCase(e,this.ApiAuthenticationType.Basic)||o.equalsIgnoreCase(e,this.ApiAuthenticationType.Oauth2)||o.equalsIgnoreCase(e,this.ApiAuthenticationType.ApiKey)},e.prototype.authenticationTypeChanged=function(){o.equalsIgnoreCase(this.swaggerEditorData.securityTabDetails.selectedAuthenticationType,this.ApiAuthenticationType.None)?this.showNoAuthenticationForm():o.equalsIgnoreCase(this.swaggerEditorData.securityTabDetails.selectedAuthenticationType,this.ApiAuthenticationType.Basic)?this.populateBasicAuthenticationForm():o.equalsIgnoreCase(this.swaggerEditorData.securityTabDetails.selectedAuthenticationType,this.ApiAuthenticationType.Oauth2)?this.populateOAuthForm():o.equalsIgnoreCase(this.swaggerEditorData.securityTabDetails.selectedAuthenticationType,this.ApiAuthenticationType.ApiKey)&&this.populateApiKeyForm()},e.prototype.showNoAuthenticationForm=function(){this.swaggerEditorData.swagger.securityDefinitions={},this.swaggerEditorData.securityTabDetails.authenticationFormItems={},this.swaggerEditorData.securityTabDetails.selectedIdentityProviderId=null},e.prototype.populateBasicAuthenticationForm=function(){o.equalsIgnoreCase(d.getAuthenticationTypeFromSwagger(this.swaggerEditorData.swagger),this.ApiAuthenticationType.Basic)||(this.swaggerEditorData.swagger.securityDefinitions={basic_auth:{type:"basic"}}),this.swaggerEditorData.securityTabDetails.authenticationFormItems=this.connectionFormService.createFormItemsFromProviderParameters(a.FormType.Create,this.getBasicAuthParameters(),this.getBasicAuthValues(this.swaggerEditorData.securityTabDetails.initialConnectionParameters)),this.swaggerEditorData.securityTabDetails.selectedIdentityProviderId=null,this.swaggerEditorData.securityTabDetails.initialConnectionParameters=null},e.prototype.populateOAuthForm=function(){var e=this;this.swaggerEditorData.spinner.show=!0,o.equalsIgnoreCase(d.getAuthenticationTypeFromSwagger(this.swaggerEditorData.swagger),this.ApiAuthenticationType.Oauth2)||this.setDefaultSecurityDefinitions(),this.swaggerEditorDataService.convertSwaggerToOAuthSecurityDetails(),this.setIdentityProvider(this.swaggerEditorData.securityTabDetails.selectedIdentityProviderId).finally(function(){return e.swaggerEditorData.spinner.show=!1})},e.prototype.populateApiKeyForm=function(){if(o.equalsIgnoreCase(d.getAuthenticationTypeFromSwagger(this.swaggerEditorData.swagger),this.ApiAuthenticationType.ApiKey)||(this.swaggerEditorData.swagger.securityDefinitions={api_key:{type:"apiKey",in:"header",name:""}}),this.swaggerEditorDataService.convertSwaggerToApiKeySecurityDetails(),!u.isEmpty(this.swaggerEditorData.securityTabDetails.initialConnectionParameters)){var e=Object.keys(this.swaggerEditorData.swagger.securityDefinitions)[0];this.swaggerEditorData.securityTabDetails.apiKeyLabel=this.swaggerEditorData.securityTabDetails.initialConnectionParameters[e]?this.swaggerEditorData.securityTabDetails.initialConnectionParameters[e].uiDefinition.displayName:""}this.swaggerEditorData.securityTabDetails.authenticationFormItems={},this.swaggerEditorData.securityTabDetails.selectedIdentityProviderId=null},e.prototype.setIdentityProvider=function(e){var t=this,i=this.loggingService.profileStart(c.ProfilingEventNames.myCustomApiGetIdentityProvidersStart);return this.customApiHelper.getIdentityProviders().then(function(e){t.identityProviders=e.filter(function(e){return o.equalsIgnoreCase(e.AuthenticationType,t.ApiAuthenticationType.Oauth2)}).filter(function(e){return!u.isEmpty(e.AuthorizationEndPoints)||o.equalsIgnoreCase(e.Id,t.ApiAuthenticationType.Oauth2)}).sort(function(e,t){return e.DisplayName>t.DisplayName?1:-1})}).then(function(){return e?t.customApiHelper.getMatchingIdentityProviderById(t.identityProviders,e):t.customApiHelper.getMatchingIdentityProvider(t.identityProviders,l.parseUri(t.swaggerEditorData.securityTabDetails.authorizationUrl).host)}).then(function(e){t.loggingService.profileEnd(i,c.ProfilingEventNames.myCustomApiGetIdentityProvidersEnd,{status:p.Status.Success}),o.equalsIgnoreCase(t.swaggerEditorData.securityTabDetails.selectedIdentityProviderId,e.Id)||(t.swaggerEditorData.securityTabDetails.selectedIdentityProviderId=e.Id),o.equalsIgnoreCase(e.Id,t.ApiAuthenticationType.Oauth2)||(t.swaggerEditorData.securityTabDetails.authorizationUrl=e.AuthorizationEndPoints[0])}).catch(function(e){t.swaggerEditorDataService.SwaggerEditorData.statusAlert.options.show(m.AlertType.Error,t.clientResources.Manage.CustomApi.Security.LoadProviders.Error),t.loggingService.profileEnd(i,c.ProfilingEventNames.myCustomApiGetIdentityProvidersEnd,{status:p.inferErrorStatus(e),error:p.parseErrorMessage(e)}),t.loggingService.logError("CustomApi.findMatchingIdentityProvider",e)})},e.prototype.identityProviderChanged=function(){var e=this;this.swaggerEditorData.spinner.show=!0;var t=this.swaggerEditorData.securityTabDetails.selectedIdentityProviderId;t&&(this.swaggerEditorData.securityTabDetails.authenticationFormItems={},this.customApiHelper.getIdentityProviderParameters(t).then(function(i){return e.swaggerEditorData.securityTabDetails.authenticationFormItems=e.connectionFormService.createFormItemsFromProviderParameters(a.FormType.Create,i,e.getOAuthParamValues(e.swaggerEditorData.securityTabDetails.initialConnectionParameters)),e.swaggerEditorData.securityTabDetails.initialConnectionParameters=null,e.setIdentityProvider(t)}).finally(function(){e.swaggerEditorData.spinner.show=!1}))},e.prototype.setDefaultSecurityDefinitions=function(){this.swaggerEditorData.swagger.securityDefinitions={oauth2_auth:{type:"oauth2",flow:"accessCode",authorizationUrl:"",tokenUrl:"https://login.windows.net/common/oauth2/authorize"}}},e.prototype.getBasicAuthParameters=function(){return[{Name:"username",Type:"string",DisplayName:this.clientResources.Manage.CustomApi.Security.Basic.username},{Name:"password",Type:"string",DisplayName:this.clientResources.Manage.CustomApi.Security.Basic.password}]},e.prototype.getBasicAuthValues=function(e){var t={};if(u.isEmpty(e)){var i=this.swaggerEditorData.securityTabDetails.authenticationFormItems;i&&!u.isEmpty(i.username)&&(t.username=i.username.value),i&&!u.isEmpty(i.password)&&(t.password=i.password.value)}else u.isEmpty(e.username)||(t.username=e.username.uiDefinition.displayName),u.isEmpty(e.password)||(t.password=e.password.uiDefinition.displayName);return t},e.prototype.getOAuthParamValues=function(e){if(u.isNullOrUndefined(e))return{};var t={},i=e.token;return!e||u.isEmpty(i)||u.isEmpty(i.oAuthSettings)||(t.clientId=i.oAuthSettings.clientId,i.oAuthSettings.customParameters&&Object.keys(i.oAuthSettings.customParameters).forEach(function(e){t[e]=i.oAuthSettings.customParameters[e].value})),t},e.prototype.copyRedirectUrlToClipboard=function(e){var t=window.document.getSelection();t.removeAllRanges(),window.document.getElementById(e).select(),window.document.execCommand("copy"),t.removeAllRanges()},e.prototype.continue=function(){var e=this.swaggerEditorData.editMode?s.getEditCustomConnectorDefinitionUrl(this.swaggerEditorData.apiName):s.getNewCustomConnectorDefinitionUrl();this.navigationService.navigate(e)},e.$inject=[r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.connectionForm,r.default.services.customApiHelper,r.default.services.logging,r.default.services.navigation,r.default.services.swaggerEditorData,r.default.services.telemetry],e}();t.SecuritySwaggerEditorTabCtrl=f},function(e,t){},function(e,t){e.exports='<div class="section-custom-api-security-tab"> <section class="row section-custom-api-component-section"> <div class="column medium-3 left-pane minimal-content"> <div class="title">{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.LeftPane.Security.Heading}}</div> <p> {{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.LeftPane.Security.Description}} <learn-more resource="\'Manage.CustomApi.Security.LeftPane.Hyperlink\'"/> </p> </div> <div class="column medium-8 medium-offset-1 right-pane"> <div class="pane-title"> <span>{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.AuthenticationType.Heading}}</span> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label">{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.AuthenticationType.Type.Label}} <span class="context-required-text">*</span> </label> <div class="c-select"> <select ng-disabled="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" ng-model="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.selectedAuthenticationType"> <option ng-repeat="authenticationType in securitySwaggerEditorTabCtrl.authenticationTypes" value="{{authenticationType.value}}"> {{authenticationType.displayName}} </option> </select> </div> </div> </div> </div> </section> <div ng-if="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.selectedAuthenticationType == securitySwaggerEditorTabCtrl.ApiAuthenticationType.Basic"> <section class="row section-custom-api-component-section"> <div class="column medium-3 left-pane minimal-content"> </div> <div class="column medium-8 medium-offset-1 right-pane"> <div class="pane-title"> <span>{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Basic.Heading}}</span> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label">{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Label}}</label> <div class="pane-table"> <div class="row pane-table-header"> <div class="column medium-6"> <label>{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Table.Label.Heading}}</label> </div> <div class="column medium-5 medium-offset-1"> <label>{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Table.Key.Heading}}</label> </div> <hr/> </div> <hr/> <div ng-repeat="(key, formItem) in securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.authenticationFormItems"> <div class="row pane-table-body"> <ng-form name="apiAuthForm"> <div class="column medium-6"> <div class="pane-row-input" ng-switch="formItem.type"> <span ng-switch-when="string"> <input ng-disabled="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" placeholder="{{formItem.displayName}}" type="text" class="c-text-field" ng-model="formItem.value" ng-required="formItem.required"/> </span> </div> </div> <div class="column medium-5 medium-offset-1"> <label class="pane-row-label">{{formItem.displayName}}</label> </div> </ng-form> </div> <hr/> </div> </div> </div> </div> </div> </section> </div> <div ng-if="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.selectedAuthenticationType == securitySwaggerEditorTabCtrl.ApiAuthenticationType.Oauth2"> <section class="row section-custom-api-component-section"> <div class="column medium-3 left-pane minimal-content"> </div> <div class="column medium-8 medium-offset-1 right-pane"> <div class="pane-title"> <span>{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.OAuth2.Heading}}</span> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label">{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.IdentityProvider.Label}}</label> <div class="c-select"> <select ng-disabled="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" ng-model="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.selectedIdentityProviderId"> <option ng-repeat="identityProvider in securitySwaggerEditorTabCtrl.identityProviders" value="{{identityProvider.Id}}"> {{identityProvider.DisplayName}} </option> </select> </div> </div> <ng-form name="apiAuthForm"> <div class="pane-field" ng-repeat="(key, formItem) in securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.authenticationFormItems"> <label class="pane-field-label">{{formItem.displayName}} <span class="context-required-text" ng-if="formItem.required">*</span> </label> <div ng-switch="formItem.type"> <span ng-switch-when="string"> <input ng-disabled="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" placeholder="{{formItem.displayName}}" type="text" class="c-text-field" ng-model="formItem.value" ng-required="formItem.required"/> </span> <span ng-switch-when="securestring"> <input ng-readonly="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" ng-disabled="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" type="password" class="c-text-field" ng-model="formItem.value" placeholder="********"/> </span> </div> </div> <div class="pane-field"> <label class="pane-field-label">{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.Scope.Label}}</label> <input ng-disabled="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" type="text" class="c-text-field" ng-model="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.scopeInput" placeholder="{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.Scope.Label}}"> </div> <div class="pane-field"> <label class="pane-field-label">{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.RedirectUrl.Label}}</label> <div class="pane-field-with-copy-button"> <input id="customapi-redirecturl" type="text" class="c-text-field" readonly="readonly" ng-model="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.redirectUrl" placeholder="{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.RedirectUrl.PlaceHolder}}"> <button class="btn-copy" ng-click="securitySwaggerEditorTabCtrl.copyRedirectUrlToClipboard(\'customapi-redirecturl\')" ng-hide="!securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.redirectUrl" ng-attr-title="{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopyToClipboard.Title}}"> <img cdn-src="{{securitySwaggerEditorTabCtrl.copyToClipboardImage}}" alt="{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopyToClipboard.Image.Alt}}" ng-attr-title="{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopyToClipboard.Title}}"/> </button> </div> </div> </ng-form> </div> </div> </section> </div> <div ng-if="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.selectedAuthenticationType == securitySwaggerEditorTabCtrl.ApiAuthenticationType.ApiKey"> <section class="row section-custom-api-component-section"> <div class="column medium-3 left-pane minimal-content"> </div> <div class="column medium-8 medium-offset-1 right-pane"> <div class="pane-title"> <span>{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.ApiKey.Heading.Label}}</span> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label">{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.ApiKey.Label}}</label> <div class="pane-table"> <div class="row pane-table-header"> <div class="column medium-3"> <label>{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Table.Label.Heading}}</label> </div> <div class="column medium-4"> <label>{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Table.Key.Heading}}</label> </div> <div class="column medium-5"> <label>{{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.ApiKey.Location.Heading}}</label> </div> </div> <hr/> <div class="row pane-table-body"> <div class="column medium-3"> <input ng-disabled="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" type="text" class="c-text-field" ng-model="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.apiKeyLabel"/> </div> <div class="column medium-4"> <input ng-disabled="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" type="text" class="c-text-field" ng-model="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.apiKeyName"/> </div> <div class="column medium-5"> <div class="c-select"> <select ng-disabled="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" ng-model="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.selectedApiKeyLocation"> <option ng-repeat="apiKeyLocationType in securitySwaggerEditorTabCtrl.apiKeyLocationTypes" value="{{apiKeyLocationType.value}}"> {{apiKeyLocationType.displayName}} </option> </select> </div> </div> </div> </div> <hr/> </div> </div> </div> </section> </div> <section class="row section-custom-api-component-section"> <div class="column medium-3 left-pane minimal-content"> </div> <div class="column medium-7 medium-offset-1"> <button type="submit" class="c-button" ng-disabled="!securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked" ng-click="securitySwaggerEditorTabCtrl.swaggerEditorData.securityTabDetails.isLocked = false"> {{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Security.Edit}} </button> <button type="submit" class="c-button" ng-click="securitySwaggerEditorTabCtrl.continue()"> {{securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.General.Continue}} </button> </div> </section> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1102);i(1104);var o=function(){function e(){this.template=i(1105),this.controller=n.CustomApiShareTabCtrl,this.bindings={model:"="},this.controllerAs="customApiShareTabCtrl"}return e}();t.CustomApiShareTab=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.shareTab,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(97),s=i(96),a=i(1),l=i(8),c=i(1103),u=i(6),p=i(20),d=i(3),g=i(10),m=i(29),f=function(){function e(e,t,i,r,s,a,l,c,f,h,v){var y=this;this.$q=e,this.$routeParams=t,this.$scope=i,this.appSettings=r,this.clientResources=s,this.environmentService=a,this.graphService=l,this.loggingService=c,this.permissionsClient=f,this.sessionService=h,this.telemetryService=v,this.users=[],this.groupIcon=n.default.group,this.defaultPlaceholderImage=n.default.userPlaceholder,this.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiShareTabVisited),this.disableActionButtons=!0,this.memberDetailsIndexable={},this.deletedPermissionsIndexable={},this.domainsRegularExpressions=[],this.currentUserTenantId=this.sessionService.getUserSession().userInfo.tenantId;var w=t.apiName;this.queryParameters=p.extendQueryParamsWithEnvironment({apiName:w},!0,this.environmentService.getCurrentEnvironmentName()),this.model.spinner.show=!0,this.model.permissions.$watch(this.$scope,function(){var e=o.getOidsFromPermissions(y.model.permissions),t=y.graphService.getCachedThumbnailPhotos(e),i=y.sessionService.getUserSession().userInfo.uniqueId,r=y.loggingService.profileStart(m.ProfilingEventNames.myCustomApiGetCurrentUserPermissionStart);y.getCurrentUserPermission(i).then(function(n){return y.loggingService.profileEnd(r,m.ProfilingEventNames.myCustomApiGetCurrentUserPermissionEnd,{status:d.Status.Success}),y.currentUserPermission=n,y.currentUserPermission||y.loggingService.logWarning("CustomApiShareTabCtrl.GetCurrentUserPermission","Resource does not have permission for user "+i),y.isCurrentUserReader=!!y.currentUserPermission&&o.isUserReader(y.currentUserPermission),y.isCurrentUserViewWithShare=!!y.currentUserPermission&&o.isUserViewWithShare(y.currentUserPermission),y.canCurrentUserShare=!!y.currentUserPermission&&o.canUserShare(y.currentUserPermission),y.roles=o.getRoles(y.clientResources),y.users=y.populateAndGetUserPermissions(y.model.permissions,t),y.updateActionButtons(),y.model.spinner.show=!1,y.canCurrentUserShare||y.model.statusAlert.options.show(g.AlertType.Info,y.clientResources.Manage.CustomApi.Share.ViewPermissionsInfo),y.graphService.getThumbnailPhotos(e)}).then(function(e){return y.populateUserThumbnails(y.users,e)}).catch(function(e){y.loggingService.profileEnd(r,m.ProfilingEventNames.myCustomApiGetCurrentUserPermissionEnd,{status:d.inferErrorStatus(e),error:d.parseErrorMessage(e)}),y.model.statusAlert.options.show(g.AlertType.Error,y.clientResources.Manage.CustomApi.Share.GetCurrentUserPermission.Error)})});var C=this.loggingService.profileStart(m.ProfilingEventNames.myCustomApiGetTenantDetailsStart);this.graphService.queryTenantDetails().then(function(e){y.loggingService.profileEnd(C,m.ProfilingEventNames.myCustomApiGetTenantDetailsEnd,{status:d.Status.Success}),y.currentUserTenantDisplayName=e[0].displayName,y.updateTenantDisplayName()}).catch(function(e){y.loggingService.profileEnd(C,m.ProfilingEventNames.myCustomApiGetTenantDetailsEnd,{status:d.inferErrorStatus(e),error:d.parseErrorMessage(e)})})}return e.prototype.getTitle=function(e){return this.userHasPermissionRole(e)?e.userPermission.role.displayName:""},e.prototype.getCommandsInDropdown=function(e){return e.commandsInDropDown},e.prototype.isCustomApiSharedWithTenant=function(){return!!this.users.some(function(e){return o.isTenantPermissionType(e.userPermission.principalType)&&!!e.userPermission.role})},e.prototype.populateAndGetUserPermissions=function(e,t){var i=this,r=[];return e.forEach(function(e){var n=e.properties.principal,s=t[n.id]||i.defaultPlaceholderImage,a=o.isPermissionForTenant(e);if(i.isNewUser(n.id)||a){var u={objectId:a?n.tenantId:n.id,displayName:a?i.clientResources.Manage.CustomApi.Share.ToggleTenantText:n.displayName,email:a?i.currentUserTenantDisplayName:n.email,principalType:n.type,thumbnailPhoto:a?i.groupIcon:s},p=new c.UserPermission(e,u,i.canCurrentUserShare,n.type,i.clientResources),d={id:u.objectId,iconUrl:u.thumbnailPhoto,click:function(){for(var e=0;e<i.users.length&&!l.equalsIgnoreCase(i.users[e].id,u.objectId);e++);i.removePermission(e,i.isUserPermissionRemovable(p))},title:u.displayName,subTitle:u.email,userPermission:p};i.createCommandForUserCard(d),r.push(d)}else for(var g=0,m=i.users;g<m.length;g++){var f=m[g];if(l.equalsIgnoreCase(f.id,n.id)){f.iconUrl=s,r.push(f);break}}}),r.sort(function(e,t){return i.userHasPermissionRole(e)&&(o.isPermissionForTenant(e.userPermission.permission)?-1:o.isUserOwner(e.userPermission.permission)&&!o.isPermissionForTenant(t.userPermission.permission)?-1:1)})},e.prototype.saveChanges=function(){var e=this;this.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiShareTabSaveChangesClicked),this.model.statusAlert.options.show(g.AlertType.Progress,this.clientResources.Manage.CustomApi.Share.SavingPermissions),this.disableActionButtons=!0,this.isSaveInProgress=!0;var t=this.loggingService.profileStart(m.ProfilingEventNames.myCustomApiModifyPermissionsStart);this.modifyPermissions(this.users).then(function(i){e.loggingService.profileEnd(t,m.ProfilingEventNames.myCustomApiModifyPermissionsEnd,{status:d.Status.Success}),e.deletedPermissionsIndexable={},e.updateActionButtons(),e.displayShareResults(i)}).catch(function(i){var r=d.parseErrorMessage(i);e.loggingService.profileEnd(t,m.ProfilingEventNames.myCustomApiModifyPermissionsEnd,{status:d.inferErrorStatus(i),error:r}),e.model.statusAlert.options.show(g.AlertType.Error,r)}).finally(function(){e.isSaveInProgress=!1})},e.prototype.displayShareResults=function(e){var t=e.filter(function(e){return e.alertType===g.AlertType.Error})[0]||e.filter(function(e){return e.alertType===g.AlertType.Warning})[0]||e.filter(function(e){return e.alertType===g.AlertType.Info})[0]||e.filter(function(e){return e.alertType===g.AlertType.Progress})[0]||e.filter(function(e){return e.alertType===g.AlertType.Success})[0]||e.filter(function(e){return e.alertType===g.AlertType.None})[0];this.model.statusAlert.options.show(t.alertType,t.message)},e.prototype.populateUserThumbnails=function(e,t){e.forEach(function(e){var i=t[e.id];i&&(e.iconUrl=i)})},e.prototype.discardChanges=function(){this.telemetryService.tagEvent(u.TelemetryEventNames.CustomApiShareTabDiscardChangesClicked),this.disableActionButtons=!0,this.model.statusAlert.options.hide();for(var e=this.users.length-1;e>=0;e--){var t=this.users[e].userPermission;t.allowRoleToChange&&(!t.role&&t.permission?this.restoreDeletedUnsavedUser(t):t.role&&t.permission?this.users[e].userPermission.setRole(o.getRole(t.permission.properties.roleName,this.clientResources)):(this.deletedPermissionsIndexable[t.email]&&delete this.deletedPermissionsIndexable[t.email],delete this.memberDetailsIndexable[t.email],this.users.splice(e,1)))}},e.prototype.removePermission=function(e,t){if(!this.isSaveInProgress&&t&&this.users.length>0&&this.users[e]){var i=this.users[e].userPermission;delete this.memberDetailsIndexable[i.email],i.permission?(i.setRole(null),this.deletedPermissionsIndexable[i.email]=i.email):this.users.splice(e,1),this.updateActionButtons()}},e.prototype.addTenantPermission=function(){if(!this.isCustomApiSharedWithTenant()){var e={objectId:this.currentUserTenantId,displayName:this.clientResources.Manage.CustomApi.Share.ToggleTenantText,email:this.currentUserTenantDisplayName,thumbnailPhoto:this.groupIcon,principalType:s.PrincipalType.Tenant};this.addPermission(e)}},e.prototype.updateActionButtons=function(){this.users.filter(function(e){return e.userPermission.allowRoleToChange}).filter(function(e){var t=e.userPermission;return!(t.role&&t.permission&&t.allowRoleToChange&&t.permission.properties.roleName===t.getRoleName())}).length>0&&!this.isSaveInProgress?this.disableActionButtons=!1:this.disableActionButtons=!0},e.prototype.isUserVisible=function(e){return!!this.userHasPermissionRole(e)},e.prototype.canUserRoleBeChanged=function(e){return!(!(this.canCurrentUserShare&&this.userHasPermissionRole(e)&&e.userPermission.allowRoleToChange)||e.userPermission.isTenantPermission)&&(!(this.isCurrentUserReader&&l.equalsIgnoreCase(e.userPermission.role.name,s.RoleName.CanEdit))&&this.userHasPermissionRole(e)&&!this.isCurrentUserPermission(e.userPermission.permission))},e.prototype.canUserInfoCardBeRemoved=function(e){return this.userHasPermissionRole(e)&&this.isUserPermissionRemovable(e.userPermission)},e.prototype.onGraphAutocompleteSelect=function(e,t){var i=this.users.filter(function(t){return l.equalsIgnoreCase(t.id,e.model.objectId)});if(i.length>0){var r=i[0].userPermission;return void(this.deletedPermissionsIndexable[e.model.mail]&&a.isNullOrUndefined(r.role)&&(this.restoreDeletedUnsavedUser(r),this.updateActionButtons()))}var n={objectId:e.model.objectId,displayName:e.displayName,email:e.mail,principalType:e.type,thumbnailPhoto:this.defaultPlaceholderImage};this.addPermission(n)},e.prototype.getCurrentUserPermission=function(e){var t=this,i=o.getPermissionForObjectId(this.model.permissions,e);if(o.isUserOwner(i))return this.$q.resolve(i);var r=this.model.api.properties&&o.getHighestPermission(this.model.api.properties.permissions,this.clientResources);return r?this.$q.resolve(r):o.hasGroupPermission(this.model.permissions)?this.graphService.getMemberGroups(e,this.currentUserTenantId).then(function(e){var r=t.model.permissions.filter(function(e){return e.properties.principal.type===s.PrincipalType.Group}).filter(function(t){var i=t.properties.principal.id;return-1!==e.indexOf(i)});return t.$q.resolve(o.getHighestPermission(r.concat(i),t.clientResources))}):this.$q.resolve(i)},e.prototype.isUserPermissionRemovable=function(e){return e.isTenantPermission?this.currentUserPermission&&!this.isCurrentUserReader||this.isCurrentUserViewWithShare:e.allowRoleToChange&&!this.isCurrentUserReader&&!this.isCurrentUserPermission(e.permission)},e.prototype.isNewUser=function(e){var t=this,i=this.users.filter(function(i){return l.equalsIgnoreCase(i.id,e)&&t.userPermissionInitialized(i)});return!i||0===i.length},e.prototype.isCurrentUserPermission=function(e){return e&&l.equalsIgnoreCase(this.currentUserPermission.id,e.id)},e.prototype.userHasPermissionRole=function(e){return!a.isNullOrUndefined(e)&&!a.isNullOrUndefined(e.userPermission)&&!a.isNullOrUndefined(e.userPermission.role)},e.prototype.userPermissionInitialized=function(e){return!a.isNullOrUndefined(e)&&!a.isNullOrUndefined(e.userPermission)&&!a.isNullOrUndefined(e.userPermission.permission)},e.prototype.createCommandForUserCard=function(e){var t=this,i=[{text:this.clientResources.Manage.CustomApi.Share.ChoosePermission,iconUrl:"",disabled:!0,click:function(){return!0}},{text:this.clientResources.Manage.CustomApi.Share.RoleView,iconUrl:"",click:function(){var i=o.getRole(s.RoleName.CanView,t.clientResources);e.userPermission.setRole(i),t.updateActionButtons()}},{text:this.clientResources.Manage.CustomApi.Share.RoleViewWithShare,iconUrl:"",click:function(){var i=o.getRole(s.RoleName.CanViewWithShare,t.clientResources);e.userPermission.setRole(i),t.updateActionButtons()}}];this.canCurrentUserShare&&!l.equalsIgnoreCase(this.currentUserPermission.properties.roleName,s.RoleName.CanViewWithShare)&&i.push({text:this.clientResources.Manage.CustomApi.Share.RoleEdit,iconUrl:"",click:function(){var i=o.getRole(s.RoleName.CanEdit,t.clientResources);e.userPermission.setRole(i),t.updateActionButtons()}}),e.commandsInDropDown=i},e.prototype.updateTenantDisplayName=function(){var e=this,t=this.users.filter(function(t){return e.userHasPermissionRole(t)&&t.userPermission.isTenantPermission});t.length>0&&(this.users[this.users.indexOf(t[0])].subTitle=this.currentUserTenantDisplayName)},e.prototype.addMemberDetails=function(e,t,i){this.memberDetailsIndexable[e.email]={displayName:e.displayName,email:e.email,objectId:t,thumbnailPhoto:e.thumbnailPhoto,principalType:e.principalType}},e.prototype.addPermission=function(e){var t=this;if(e){var i,r=e;if(this.memberDetailsIndexable[r.email]||this.deletedPermissionsIndexable[r.email]){var s=this.users.filter(function(e){return e.userPermission.email===r.email});s.length>0&&s[0].userPermission.setRole(o.getRole(s[0].userPermission.role?s[0].userPermission.role.name:o.getDefaultRoleForResource(this.clientResources).name,this.clientResources)),this.deletedPermissionsIndexable[r.email]&&delete this.deletedPermissionsIndexable[r.email]}else{i=new c.UserPermission(null,r,this.canCurrentUserShare,r.principalType,this.clientResources);var a=o.getDefaultRoleForResource(this.clientResources);i.setRole(a);var u={id:e.objectId,iconUrl:l.equalsIgnoreCase(e.objectId,this.currentUserTenantId)?n.default.group:this.defaultPlaceholderImage,click:function(){for(var r=0;r<t.users.length&&!l.equalsIgnoreCase(t.users[r].id,e.objectId);r++);t.removePermission(r,t.isUserPermissionRemovable(i))},title:e.displayName,subTitle:e.email,userPermission:i};this.createCommandForUserCard(u),this.users.unshift(u)}this.memberDetailsIndexable[r.email]=r,this.updateActionButtons()}},e.prototype.modifyPermissions=function(e){var t=this,i=e.filter(function(e){return e.userPermission.isRevoked()}).map(function(e){return{id:e.userPermission.permission.id}}),r=e.filter(function(e){return e.userPermission.isUpdated()||e.userPermission.isNew()}).map(function(e){var t=e.userPermission;return{properties:{roleName:t.getRoleName(),principal:{email:t.email,id:t.objectId,type:t.principalType,tenantId:t.isTenantPermission?t.objectId:null}}}}),n=i.length?{delete:i}:null,o=r.length?{put:r}:null,s=[];return this.callModifyPermissions(n).then(function(e){return a.isNullOrUndefined(e)||s.push(e),t.callModifyPermissions(o)}).then(function(e){a.isNullOrUndefined(e)||s.push(e)}).then(function(){return s.length?s:(t.disableActionButtons=!1,[{message:t.clientResources.Manage.CustomApi.Share.NothingToSave,alertType:g.AlertType.Info}])})},e.prototype.callModifyPermissions=function(e){var t=this;return a.isNullOrUndefined(e)?this.$q.resolve(null):this.permissionsClient.modify(this.queryParameters,e).then(function(e){var i=e.data.remove&&e.data.remove.filter(function(e){return!!e.error}),r=e.data.add&&e.data.add.filter(function(e){return!!e.error}),n=i||r;return t.model.permissions.$refresh(),n?{message:d.parseErrorMessage(n,t.clientResources.Manage.CustomApi.Share.SaveActionFailed),alertType:g.AlertType.Error}:{message:t.clientResources.Manage.CustomApi.Share.Success,alertType:g.AlertType.Success}})},e.prototype.restoreDeletedUnsavedUser=function(e){this.addMemberDetails(e,e.objectId,e.principalType),delete this.deletedPermissionsIndexable[e.email],e.setRole(o.getRole(e.permission.properties.roleName,this.clientResources))},e.$inject=[r.default.services.$q,r.default.services.$routeParams,r.default.services.$scope,r.default.services.appSettings,r.default.services.clientResources,r.default.services.environment,r.default.services.graph,r.default.services.logging,r.default.services.permissionsClient,r.default.services.session,r.default.services.telemetry],e}();t.CustomApiShareTabCtrl=f},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(97),n=i(8),o=i(1),s=function(){function e(e,t,i,n,o){this.email=t.email,this.principalType=n,this.isTenantPermission=r.isTenantPermissionType(this.principalType),this.displayName=t.displayName,this.objectId=t.objectId,this.thumbnailPhoto=t.thumbnailPhoto,this.allowRoleToChange=i,e&&e.properties&&e.properties.roleName&&(this.permission=e,this.allowRoleToChange=this.allowRoleToChange&&!r.isUserOwner(e),this.setRole(r.getRole(this.permission.properties.roleName,o)))}return e.prototype.isRevoked=function(){return!this.role&&!!this.permission},e.prototype.isUpdated=function(){return!(!this.role||!this.permission||o.isEmpty(this.permission))&&!n.equalsIgnoreCase(this.role.name,this.permission.properties.roleName)},e.prototype.isNew=function(){return!this.permission},e.prototype.setRole=function(e){this.role=e},e.prototype.getRoleName=function(){return this.role&&this.role.name},e.prototype.getRoleDisplayName=function(){return this.role&&this.role.displayName},e}();t.UserPermission=s},function(e,t){},function(e,t){e.exports='<section class="row section-share" ng-hide="customApiShareTabCtrl.spinner.show"> <div class="column medium-3 left-pane"> <h1>{{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.LeftPane.Header}}</h1> <p>{{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.LeftPane.Description}}</p> </div> <div class="column medium-8 medium-offset-1 right-pane"> <h6>{{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.RightPane.AddPeople}}</h6> <graph-autocomplete on-select="customApiShareTabCtrl.onGraphAutocompleteSelect(value, event)" class="autocomplete-container" is-disabled="!customApiShareTabCtrl.canCurrentUserShare"></graph-autocomplete> <div class="tenant-share" ng-if="customApiShareTabCtrl.canCurrentUserShare && !customApiShareTabCtrl.isCustomApiSharedWithTenant() && customApiShareTabCtrl.currentUserTenantDisplayName "> <img src="{{customApiShareTabCtrl.groupIcon}}"/> <span class="display-name">{{customApiShareTabCtrl.currentUserTenantDisplayName}}</span> <a class="toggle" ng-click="customApiShareTabCtrl.addTenantPermission()"> {{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.ToggleTenantText}} </a> </div> <h6>{{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.RightPane.CurrentlySharedWith}}</h6> <ul> <li class="ps-list-item" ng-repeat="item in customApiShareTabCtrl.users track by $index" ng-show="customApiShareTabCtrl.isUserVisible(item)"> <info-card model="item"> <info-card-icon-template> <avatar mail="item.subTitle" display-name="item.title" image-src="item.iconUrl"></avatar> </info-card-icon-template> <info-card-picker-template> <list-commands model="customApiShareTabCtrl.getCommandsInDropdown(item)" title="customApiShareTabCtrl.getTitle(item)" disabled="!customApiShareTabCtrl.canUserRoleBeChanged(item)" show-text-dropdown="true"></list-commands> </info-card-picker-template> <info-card-option-template> <div class="c-glyph glyph-delete option-block" ng-class="{\'disabled\': !customApiShareTabCtrl.canUserInfoCardBeRemoved(item)}"></div> </info-card-option-template> </info-card> </li> </ul> <hr> <div class="action-buttons"> <button type="submit" ng-click="customApiShareTabCtrl.saveChanges()" class="c-button" ng-disabled="!customApiShareTabCtrl.canCurrentUserShare || customApiShareTabCtrl.disableActionButtons || customApiShareTabCtrl.isSaveInProgress">{{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.Save}}</button> <button ng-click="customApiShareTabCtrl.discardChanges()" class="c-button btn-secondary" ng-disabled="!customApiShareTabCtrl.canCurrentUserShare || customApiShareTabCtrl.disableActionButtons">{{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.Discard}}</button> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1107);i(1108);var o=function(){function e(){this.template=i(1109),this.controller=n.CustomApiTestTabCtrl,this.controllerAs="customApiTestTabCtrl"}return e}();t.CustomApiTestTab=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.customApi.customApiTestTab,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(1),s=i(62),a=i(27),l=i(33),c=i(8),u=i(24),p=i(34),d=i(16),g=i(7),m=i(29),f=i(3),h=i(6),v=i(133),y=i(131),w=i(28),C=i(38),S=i(50),b=i(23),P=i(10),R=i(1),T=i(35),E=function(){function e(e,t,i,r,s,a,c,u,p,d,R,T,E,A,D,F,N,I){var O=this;this.$element=e,this.$http=t,this.$location=i,this.$q=r,this.$scope=s,this.$window=a,this.appSettings=c,this.clientResources=u,this.connectionHelper=p,this.connectionsClient=d,this.customApiHelperService=R,this.environmentService=T,this.loggingService=E,this.promiseHelperService=A,this.sessionService=D,this.swaggerEditorDataService=F,this.telemetryService=N,this.urlService=I,this.TriggerStateName="triggerState",this.warningImage=n.default.statusWarning,this.hostCommunicationService=S.HostCommunicationService.instance,this.connectionsSpinner={size:g.SpinnerSize.Small,local:g.SpinnerPosition.LocalHorizontal},this.onOperationClicked=function(e,t){O.testData.selectedOperationIndex=e,O.testData.currentOperation=O.testData.testOperations.filter(function(e){return e.operation.operationId===t.operation.operationId})[0]},this.openAddConnection=function(){var e=O.testData.apiInfo.api;if(O.appSettings.isWidgetPage)return void O.hostCommunicationService.triggerHostEvent(b.WidgetHostAction.ONADDCONNECTIONCLICKED,{apiName:e.name});O.telemetryService.tagEvent(h.TelemetryEventNames.CreateConnectionFromTestPage,null,{api:e.name});var t=O.loggingService.profilePageStart(m.ProfilingEventNames.myCustomApiTestCreateConnectionStart,{api:e.name}),i=O.appSettings.featureFlags.showManageGateways&&w.isApiGatewayCompatible(e);if(w.isApiConfigurable(e)||i)O.$window.open("/manage/environments/"+O.environmentService.getCurrentEnvironmentName()+"/connections/available/"+e.name+"/new?closeOnCreate=true");else{O.connectionsSpinner.show=!0;var r=C.uuid(),n=l.getConnectionId(e.name,r);O.connectionHelper.addConnection(e,n).then(function(){O.loggingService.profilePageEnd(t,m.ProfilingEventNames.myCustomApiTestCreateConnectionEnd,{status:f.Status.Success,api:e.name})}).catch(function(i){O.loggingService.profilePageEnd(t,m.ProfilingEventNames.myCustomApiTestCreateConnectionEnd,{status:f.inferErrorStatus(i),error:f.parseErrorMessage(i),api:e.name}),O.loggingService.logError("CustomApisTestTabCtrl.openAddConnection",i),O.connectionsSpinner.show=!1})}},this.telemetryService.tagEvent(h.TelemetryEventNames.TestTabVisited),this.connectionsSpinner.show=!0,this.testData.apimSubscriptionKey=this.$location.search()["apim-key"],o.isNullOrUndefined(this.$element)||y.lazyInitializeUI(this.$element.find(".c-pivot"),v.default),this.$scope.$watch(function(){return O.swaggerEditorDataService.SwaggerEditorData.api},function(){o.isNullOrUndefined(O.swaggerEditorDataService.SwaggerEditorData.api)||o.isNullOrUndefined(O.swaggerEditorDataService.SwaggerEditorData.api.properties)||(O.updateApiInfo(O.swaggerEditorDataService.SwaggerEditorData.api),O.swaggerEditorDataService.hasSwaggerBeenModified&&O.swaggerEditorDataService.SwaggerEditorData.statusAlert.options.show(P.AlertType.Warning,O.clientResources.Manage.CustomApi.Test.Warning.ConnectorDefinitionModifiedLocally))}),this.allConnections=this.connectionsClient.query(this.$scope),this.allConnections.$watch(this.$scope,function(){O.connectionsSpinner.show=!0,O.updateConnections()}),this.appSettings.isWidgetPage&&this.hostCommunicationService.onCustomApiRefreshConnections(function(){O.connectionHelper.refreshConnectionClient()})}return Object.defineProperty(e.prototype,"testData",{get:function(){return this.swaggerEditorDataService.CustomApiTestData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentConnection",{get:function(){var e=this;return this.testData.connections.filter(function(t){return t.name===e.testData.selectedConnectionName})[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentOperationHasParameters",{get:function(){return!o.isEmpty(this.testData.currentOperation.nonBodyParameters)||!o.isNullOrUndefined(this.testData.currentOperation.bodyParameter)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rawBodyToggleLabel",{get:function(){return this.testData.currentOperation.useRawBody?this.clientResources.Manage.CustomApi.Test.RawBodyToggle.On:this.clientResources.Manage.CustomApi.Test.RawBodyToggle.Off},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatedRequestHeaders",{get:function(){return o.isNullOrUndefined(this.testData.currentOperation)||o.isNullOrUndefined(this.testData.currentOperation.lastSentRequest)?"":this.getFormatedJsonObject(this.testData.currentOperation.lastSentRequest.headers)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatedRequestData",{get:function(){return o.isNullOrUndefined(this.testData.currentOperation)||o.isNullOrUndefined(this.testData.currentOperation.lastSentRequest)?"":"object"!=typeof this.testData.currentOperation.lastSentRequest.data?this.testData.currentOperation.lastSentRequest.data:this.getFormatedJsonObject(this.testData.currentOperation.lastSentRequest.data)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatedResponseData",{get:function(){if(o.isNullOrUndefined(this.testData.currentOperation)||o.isEmpty(this.testData.currentOperation.lastReceivedResponse))return"";try{return JSON.stringify(JSON.parse(this.testData.currentOperation.lastReceivedResponse.body),null,2)}catch(e){return this.testData.currentOperation.lastReceivedResponse.body}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schemaValidationErrors",{get:function(){if(o.isNullOrUndefined(this.testData.currentOperation)||o.isEmpty(this.testData.currentOperation.lastReceivedResponse))return[];try{var e=p.generateSchemaFromJson(this.testData.currentOperation.lastReceivedResponse.body,{allowNullType:!0}),t=this.getExpectedResponseSchema(),i=p.getSchemaComparisonResults(t,e);return this.getSchemaComparisonErrors(i)}catch(e){return[]}},enumerable:!0,configurable:!0}),e.prototype.getExpectedResponseSchema=function(){var e=this.testData.currentOperation.operation.responses;if(Array.isArray(e)){var t=this.testData.currentOperation.lastReceivedResponse.statusCode,i=this.getExpectedOperationResponse(e,t),r=i.schema;return p.resolveSchema(this.swaggerEditorDataService.swagger,r).schema}return{type:a.Types.string}},e.prototype.getExpectedOperationResponse=function(e,t){return(e.filter(function(e){return e.name===t.toString()})[0]||e.filter(function(e){return t>=200&&t<300&&"200"===e.name})[0]||e.filter(function(e){return"default"===e.name})[0]||e[0]).item},e.prototype.getSchemaComparisonErrors=function(e){var t=this;return e.map(function(e){return e.propertyPresent?o.format(t.clientResources.Manage.CustomApi.Test.SchemaValidation.PropertyMismatch,e.propertyName,e.expectedType,e.actualType):o.format(t.clientResources.Manage.CustomApi.Test.SchemaValidation.PropertyMissing,e.propertyName)})},Object.defineProperty(e.prototype,"isSubscriptionKeyEntered",{get:function(){return!o.isNullOrWhitespace(this.testData.apimSubscriptionKey)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentOperationHasResults",{get:function(){return!o.isNullOrUndefined(this.testData.currentOperation)&&!o.isNullOrUndefined(this.testData.currentOperation.lastReceivedResponse)&&!o.isNullOrWhitespace(this.testData.currentOperation.lastReceivedResponse.status)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldDisplayResults",{get:function(){return!(o.isNullOrUndefined(this.testData.currentOperation)||o.isNullOrUndefined(this.testData.currentOperation.progressSpinner)||this.testData.currentOperation.progressSpinner.show||o.isNullOrUndefined(this.testData.currentOperation.lastSentRequest)||o.isNullOrUndefined(this.testData.currentOperation.lastSentRequest.url))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTestOperationButtonDisabled",{get:function(){return o.isNullOrUndefined(this.testData.currentOperation)||!this.testData.currentOperation.operation||this.testData.currentOperation.progressSpinner.show||!this.currentConnection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canAddTriggerParameters",{get:function(){return this.appSettings.featureFlags.enableAdvancedTestApiMode&&!o.isNullOrUndefined(this.testData.currentOperation.operation[d.Swagger.Trigger])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canCurrentOperationHaveRequestBody",{get:function(){var e=this.testData.currentOperation;if(!e)return!1;var t=o.isNullOrUndefined(e.lastSentRequest)?"":e.lastSentRequest.method;return this.canMethodHaveRequestBody(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"testingInProgress",{get:function(){return this.testData.testOperations.some(function(e){return e.progressSpinner.show})},enumerable:!0,configurable:!0}),e.prototype.triggerConnectionsRefresh=function(){this.connectionsSpinner.show||this.allConnections.$refresh()},e.prototype.isNonBodyParameterReadOnlyInTestUI=function(e){return!e[d.Swagger.NotificationUrl]&&(e[d.Swagger.Visibility]===d.Visibility.internal||e[d.Swagger.Permission]===d.Permission.readOnly)},e.prototype.isInputParameterReadOnlyInTestUI=function(e){return!e.isNotificationUrl&&(e.readOnly||e.visibility===d.Visibility.internal)},e.prototype.getNonBodyParameterTooltip=function(e){return this.isNonBodyParameterReadOnlyInTestUI(e)?e[d.Swagger.Permission]===d.Permission.readOnly?this.clientResources.Manage.CustomApi.Test.ToolTip.ReadonlyParameter:e[d.Swagger.Visibility]===d.Visibility.internal?this.clientResources.Manage.CustomApi.Test.ToolTip.InternalParameter:"":""},e.prototype.getInputParameterTooltip=function(e){return this.isInputParameterReadOnlyInTestUI(e)?e.readOnly?this.clientResources.Manage.CustomApi.Test.ToolTip.ReadonlyParameter:e.visibility===d.Visibility.internal?this.clientResources.Manage.CustomApi.Test.ToolTip.InternalParameter:"":""},e.prototype.updateApiInfo=function(e){var t=this;if(o.isNullOrUndefined(this.testData.apiInfo.api)||o.isNullOrUndefined(this.testData.apiInfo.api.properties)||o.isNullOrUndefined(this.testData.apiInfo.api.properties.swagger)||JSON.stringify(this.testData.apiInfo.api.properties.swagger)!==JSON.stringify(e.properties.swagger)){this.testData.apiInfo.api=angular.copy(e),this.testData.apiInfo.apimSwagger=s.deserialize(this.testData.apiInfo.api.properties.swagger);var i=[];this.testData.apiInfo.apimSwagger.actions.forEach(function(e){return i.push(e.operation)}),this.testData.apiInfo.apimSwagger.triggers.forEach(function(e){return i.push(e.operation)}),this.testData.testOperations=i.map(function(e){var i={operation:e,nonBodyParameters:[],userDefinedQueryParameters:[],bodyParameter:void 0,bodyParameterFields:[],unableToResolveBodyParameterRefs:!1,usesDynamicSchema:!1,rawBody:"",useRawBody:!1,lastSentRequest:{},lastReceivedResponse:{statusCode:void 0,status:"",headers:"",body:""},traceLocation:"",progressSpinner:{size:g.SpinnerSize.Large,show:!1,local:g.SpinnerPosition.LocalHorizontal},alert:{show:!1,message:""}};return t.updateOperationParameters(i),i})}if(this.updateConnections(),this.testData.testOperations.length>0){var r=o.isNullOrUndefined(this.testData.selectedOperationIndex)?0:this.testData.selectedOperationIndex%this.testData.testOperations.length;this.onOperationClicked(r,this.testData.testOperations[r])}},e.prototype.updateConnections=function(){var e=this;o.isNullOrUndefined(this.allConnections)||!this.allConnections.$resolved||o.isNullOrUndefined(this.testData.apiInfo.api)||(this.testData.connections=this.allConnections.filter(function(t){return c.equalsIgnoreCase(t.properties.apiId,e.testData.apiInfo.api.id)&&t.properties.statuses.filter(function(e){return l.isConnectedStatus(e.status)}).length>0}).sort(function(e,t){return new Date(e.properties.createdTime).valueOf()>new Date(t.properties.createdTime).valueOf()?-1:1}),this.testData.connections.length>0&&this.testData.connections.filter(function(t){return t.name===e.testData.selectedConnectionName}).length<1&&(this.testData.selectedConnectionName=this.testData.connections[0].name),this.connectionsSpinner.show=!1)},e.prototype.updateOperationParameters=function(e){var t=this,i=angular.copy(u.getParametersWithFullyResolvedReferences(e.operation.parameters,this.testData.apiInfo.apimSwagger));i=i.filter(function(e){return"connectionId"!==e.name}),e.nonBodyParameters=i.filter(function(e){return e.in!==a.ParameterLocations.body}).map(function(e){return t.setNonBodyParameterDefaultToTestValue(e)}),e.bodyParameter=i.filter(function(e){return e.in===a.ParameterLocations.body})[0],e.unableToResolveBodyParameterRefs=R.hasOwnNestedProperty(e.bodyParameter,"$ref"),e.bodyParameterFields=e.unableToResolveBodyParameterRefs?[]:u.convertBodyParameterToInputParameters(e.bodyParameter),e.usesDynamicSchema=e.bodyParameter&&e.bodyParameter.schema&&p.isDynamicSchema(e.bodyParameter.schema),e.usesDynamicSchema||e.unableToResolveBodyParameterRefs?(e.useRawBody=!0,this.setRawBodyToDefaultOrTestValue(e)):e.bodyParameterFields.length>0&&p.setBodyParameterDefaultsFromJson(e.bodyParameterFields,e.bodyParameter.schema[d.Swagger.TestValue],!0)},e.prototype.setNonBodyParameterDefaultToTestValue=function(e){return o.isNullOrWhitespace(e.default)&&(e.default=e[d.Swagger.TestValue]),e},e.prototype.setRawBodyToDefaultOrTestValue=function(e){o.isNullOrUndefined(e)||o.isNullOrUndefined(e.bodyParameter)||o.isNullOrUndefined(e.bodyParameter.schema)||(e.bodyParameter.schema.default?e.rawBody=JSON.stringify(e.bodyParameter.schema.default,null,2):e.bodyParameter.schema[d.Swagger.TestValue]&&(e.rawBody=JSON.stringify(e.bodyParameter.schema[d.Swagger.TestValue],null,2)))},e.prototype.onAddNewUserDefinedQueryParameter=function(){this.testData.currentOperation.userDefinedQueryParameters.push({name:"",value:""})},e.prototype.onRemoveUserDefinedQueryParameter=function(e){this.testData.currentOperation.userDefinedQueryParameters.splice(e,1)},e.prototype.onRawBodyToggled=function(){this.telemetryService.tagEvent(h.TelemetryEventNames.ToggleRawBodyClicked,{toggleOn:!this.testData.currentOperation.useRawBody,api:this.testData.apiInfo.api.name}),this.testData.currentOperation.useRawBody=!this.testData.currentOperation.useRawBody,this.toggleRawBody(this.testData.currentOperation.useRawBody)},e.prototype.toggleRawBody=function(e){if(e){var t=p.convertBodyParametersToSingleObject(this.testData.currentOperation.bodyParameterFields);this.testData.currentOperation.rawBody=JSON.stringify(t,null,2)}else{var i=null;try{i=JSON.parse(this.testData.currentOperation.rawBody)}catch(e){return}p.setBodyParameterDefaultsFromJson(this.testData.currentOperation.bodyParameterFields,i,!0)}},e.prototype.getParameterDisplayName=function(e){return e.name?e.name:e.parentArray?e.parentArray.replace("$.",""):""},e.prototype.testAll=function(){var e=this;this.testData.testOperations.forEach(function(t,i){if(!t.operation[d.Swagger.NoGenericTest]){var r=!0;t.nonBodyParameters.forEach(function(e){if(e.required&&o.isNullOrWhitespace(e.default))return void(r=!1)}),r&&(e.onOperationClicked(i,t),e.toggleRawBody(!1),t.bodyParameterFields.forEach(function(e){if(e.required&&o.isNullOrWhitespace(e.default))return void(r=!1)}),r&&e.testCurrentOperationWithApimTrace())}})},e.prototype.testCurrentOperationWithApimTrace=function(){var e=this;this.testData.currentOperation.progressSpinner.show=!0;var t=this.testData.currentOperation,i={api:this.testData.apiInfo.api.name,isTrigger:!o.isNullOrUndefined(t.operation[d.Swagger.Trigger])},r=this.loggingService.profilePageStart(m.ProfilingEventNames.myCustomApiTestOperationStart,i);this.telemetryService.tagEvent(h.TelemetryEventNames.TestCurrentOperationClicked,i),t.alert.show=!1,this.clearResponseAndTrace();var n=this.isSubscriptionKeyEntered;this.testOperation(t,n).then(function(t){return e.$q.resolve(t)}).catch(function(i){return e.isFailedAttemptToGetApimTrace(i)?e.testOperation(t,!1):e.$q.reject(i)}).then(function(i){return e.updateResponseAndTraceLocation(t,i)}).catch(function(i){return e.updateResponseAndTraceLocation(t,i)}).finally(function(){e.loggingService.profilePageEnd(r,m.ProfilingEventNames.myCustomApiTestOperationEnd),t.progressSpinner.show=!1})},e.prototype.testOperation=function(e,t){var i=this;return void 0===t&&(t=!0),this.getRequestConfig(e,t).then(function(t){return e.lastSentRequest=t,i.$http(e.lastSentRequest)})},e.prototype.getRequestConfig=function(e,t){var i=this,r=this.getOperationById(this.testData.apiInfo.apimSwagger,e.operation.operationId),n=this.getUrl(this.testData.apiInfo.apimSwagger,r,e,this.currentConnection),o=r.method;return this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(r){var s={method:o,url:n,headers:{Authorization:"Bearer "+r.userInfo.accessToken},transformResponse:function(e,t){return e}};return i.canMethodHaveRequestBody(o)&&i.addBodyContent(e,s),t&&i.addOcpApimTraceHeaders(i.testData.apimSubscriptionKey,s),i.addAdditionalHeaders(e.nonBodyParameters,s),s})},e.prototype.getFormatedJsonObject=function(e){return o.isNullOrUndefined(e)?"":JSON.stringify(e,null,2)},e.prototype.canMethodHaveRequestBody=function(e){return[a.Methods.post,a.Methods.put,a.Methods.patch,a.Methods.delete,a.Methods.options].indexOf(e)>-1},e.prototype.getOperationById=function(e,t){return e.actions.concat(e.triggers).filter(function(e){return c.equalsIgnoreCase(e.operation.operationId,t)})[0]},e.prototype.getUrl=function(e,t,i,r){var n=e.schemes[0]+"://"+e.host+e.basePath+t.path;"/"!==n.charAt(n.length-1)&&(n+="/");var o=n.replace("{connectionId}",r.name);return this.addParametersToBaseUrl(o,i)},e.prototype.addParametersToBaseUrl=function(e,t){var i={},r=e,n=t.nonBodyParameters.filter(function(e){return c.equalsIgnoreCase(e.in,a.ParameterLocations.path)});return t.nonBodyParameters.filter(function(e){return c.equalsIgnoreCase(e.in,a.ParameterLocations.query)&&!o.isNullOrWhitespace(e.default)}).forEach(function(e){return i[e.name]=e.default}),t.userDefinedQueryParameters.length>0&&t.userDefinedQueryParameters.filter(function(e){return!o.isNullOrWhitespace(e.name)&&!o.isNullOrWhitespace(e.value)}).forEach(function(e){return i[e.name.trim()]=e.value.trim()}),n.forEach(function(e){return r=r.replace("{"+e.name+"}",encodeURIComponent(e.default))}),r=T.stripTrailingSlashes(r),Object.keys(i).length>0&&(r=r+"?"+T.createQueryString(i)),r},e.prototype.addOcpApimTraceHeaders=function(e,t){this.appSettings.featureFlags.enableAdvancedTestApiMode&&(t.headers[d.OcpApimHeaderNames.Trace]="true",t.headers[d.OcpApimHeaderNames.TraceLocation]="",t.headers[d.OcpApimHeaderNames.SubscriptionKey]=e)},e.prototype.addAdditionalHeaders=function(e,t){e.filter(function(e){return c.equalsIgnoreCase(e.in,a.ParameterLocations.header)}).map(function(e){return e}).forEach(function(e){o.isNullOrWhitespace(e.default)||(t.headers[e.name]=e.default)})},e.prototype.addBodyContent=function(e,t){e.useRawBody?(this.telemetryService.tagEvent(h.TelemetryEventNames.TestingOperationUsingRawBody,{api:this.testData.apiInfo.api.name}),t.data=e.rawBody):(this.telemetryService.tagEvent(h.TelemetryEventNames.TestingOperationUsingParsedBody,{api:this.testData.apiInfo.api.name}),t.data=p.convertBodyParametersToSingleObject(e.bodyParameterFields.filter(function(e){return e.required||!o.isNullOrWhitespace(e.default)})))},e.prototype.isFailedAttemptToGetApimTrace=function(e){return this.isSubscriptionKeyEntered&&o.isNullOrUndefined(e.headers()[d.OcpApimHeaderNames.TraceLocation])},e.prototype.clearResponseAndTrace=function(){this.testData.currentOperation.lastReceivedResponse={statusCode:void 0,status:"",headers:"",body:""},this.testData.currentOperation.traceLocation=""},e.prototype.updateResponseAndTraceLocation=function(e,t){this.updateTestOperationAlert(e,t),e.lastReceivedResponse.statusCode=t.status,-1===e.lastReceivedResponse.statusCode?(e.lastReceivedResponse.status=this.clientResources.Manage.CustomApi.Test.Unknown,e.lastReceivedResponse.headers=this.clientResources.Manage.CustomApi.Test.Unknown,e.lastReceivedResponse.body=this.clientResources.Manage.CustomApi.Test.Unknown):(e.lastReceivedResponse.status=o.isNullOrUndefined(t.status)?"":t.statusText+o.format(" ({0})",t.status),e.lastReceivedResponse.headers=o.isNullOrUndefined(t.headers)?"":JSON.stringify(t.headers(),null,2),e.lastReceivedResponse.body=o.isNullOrUndefined(t.data)?"":t.data),e.traceLocation=o.isNullOrUndefined(t.headers)?"":t.headers()[d.OcpApimHeaderNames.TraceLocation],!o.isNullOrWhitespace(e.traceLocation)&&(e.lastReceivedResponse.statusCode<200||e.lastReceivedResponse.statusCode>299)&&this.$window.open(e.traceLocation)},e.prototype.updateTestOperationAlert=function(e,t){o.isNullOrUndefined(t)||o.isNullOrUndefined(t.status)||o.isNullOrUndefined(t.data)||o.isNullOrUndefined(t.headers)?(e.alert.show=!0,e.alert.message=this.clientResources.Manage.CustomApi.Test.Alert.InvalidResponse):this.isFailedAttemptToGetApimTrace(t)?(e.alert.show=!0,e.alert.message=this.clientResources.Manage.CustomApi.Test.Alert.OperationFailedInvalidKey):t.status<200||t.status>=300?(e.alert.show=!0,e.alert.message=o.format(this.clientResources.Manage.CustomApi.Test.Alert.OperationFailed,t.status)):e.alert.show=!1},e.prototype.getOperationText=function(e){return e.operation.operationId},e.prototype.getOperationStatus=function(e,t){return e?e.progressSpinner.show?P.AlertType.Progress:e.lastReceivedResponse&&e.lastReceivedResponse.statusCode?e.lastReceivedResponse.statusCode>=200&&e.lastReceivedResponse.statusCode<300?P.AlertType.Success:P.AlertType.Error:P.AlertType.None:P.AlertType.None},e.prototype.getConnectionText=function(e){return o.format(this.clientResources.Manage.CustomApi.Test.Connection.DisplayName,e.properties.displayName,e.properties.createdTime)},e.$inject=[r.default.services.$element,r.default.services.$http,r.default.services.$location,r.default.services.$q,r.default.services.$scope,r.default.services.$window,r.default.services.appSettings,r.default.services.clientResources,r.default.services.connectionHelper,r.default.services.connectionsClient,r.default.services.customApiHelper,r.default.services.environment,r.default.services.logging,r.default.services.promiseHelperService,r.default.services.session,r.default.services.swaggerEditorData,r.default.services.telemetry,r.default.services.url],e}();t.CustomApiTestTabCtrl=E},function(e,t){},function(e,t){e.exports='<div class="custom-api-test-tab"> <div ng-show="customApiTestTabCtrl.testData.apiInfo.api"> <section class="row section-custom-api-component-section"> <div class="column medium-3 left-pane"> <div> <div> <div class="column-title">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Operation.Heading}}</div> <p>{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Operation.Description}}</p> </div> </div> </div> <div class="column medium-8 medium-offset-1 right-pane"> <div> <section> <div class="pane-title"> <span class="pane-header">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Connections.Heading}}</span> <a title="{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RefreshConnectionsButton.Title}}" ng-click="customApiTestTabCtrl.triggerConnectionsRefresh()" role="button" class="c-glyph" ng-class="customApiTestTabCtrl.connectionsSpinner.show ? \'glyph-inprogress disabled\' : \'glyph-refresh\'"/> </div> <div class="pane-content"> <div class="pane-field"> <label class="pane-field-label"><span class="context-required-text">*</span>{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Connections.Selected.Label}}</label> <div class="c-select"> <select type="text" class="select-option c-select" ng-disabled="customApiTestTabCtrl.testData.connections.length <= 0 || customApiTestTabCtrl.connectionsSpinner.show" ng-model="customApiTestTabCtrl.testData.selectedConnectionName" ng-options="connection.name as customApiTestTabCtrl.getConnectionText(connection) for connection in customApiTestTabCtrl.testData.connections"> <option ng-if="customApiTestTabCtrl.testData.connections.length <= 0" disabled="disabled" value="">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.MustCreateConnection.Message}}</option> </select> </div> </div> <div class="pane-field"> <button class="c-button f-lightweight c-glyph glyph-create" type="submit" ng-click="customApiTestTabCtrl.openAddConnection()" ng-disabled="customApiTestTabCtrl.connectionsSpinner.show"> {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Connections.AddNew}} </button> <spinner model="customApiTestTabCtrl.connectionsSpinner"></spinner> </div> </div> </section> </div> </div> </section> <hr/> <section class="row section-custom-api-component-section"> <div class="column medium-3 left-pane"> <div> <folding-list title="customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.LeftPane.Operations.Heading" description="customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.LeftPane.Operations.Description" learn-more-hyperlink="" add-new-text="" filter-text="customApiTestTabCtrl.filterText" items="customApiTestTabCtrl.testData.testOperations" get-item-text="customApiTestTabCtrl.getOperationText" on-item-click="customApiTestTabCtrl.onOperationClicked" selected-item-index="customApiTestTabCtrl.testData.selectedOperationIndex" get-item-status="customApiTestTabCtrl.getOperationStatus" is-collapsed="customApiTestTabCtrl.swaggerEditorDataService.swaggerEditorUIData.foldingListCollapseState.test"/> <button class="c-button" type="submit" ng-if="customApiTestTabCtrl.appSettings.featureFlags.enableAdvancedTestApiMode" ng-click="customApiTestTabCtrl.testAll()" ng-disabled="customApiTestTabCtrl.testingInProgress"> {{customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Label.TestAll}} </button> </div> </div> <div class="column medium-8 medium-offset-1 right-pane" ng-show="customApiTestTabCtrl.testData.currentOperation.operation"> <div> <section class="margin-bottom"> <div class="pane-title"> <header class="pane-header">{{customApiTestTabCtrl.testData.currentOperation.operation.operationId}}</header> </div> <div class="pane-content"> <div class="pane-field" ng-repeat="param in customApiTestTabCtrl.testData.currentOperation.nonBodyParameters"> <label class="pane-field-label"><span ng-if="param.required" class="context-required-text">*</span> {{param.name}}</label> <input class="c-text-field" type="text" title="{{customApiTestTabCtrl.getNonBodyParameterTooltip(param)}}" ng-model="param.default" ng-readonly="customApiTestTabCtrl.isNonBodyParameterReadOnlyInTestUI(param)"/> </div> <div ng-if="customApiTestTabCtrl.testData.currentOperation.bodyParameter"> <hr ng-if="customApiTestTabCtrl.testData.currentOperation.nonBodyParameters.length > 0"/> <div class="c-toggle pane-field"> <label class="pane-field-label" for="raw-body-toggle">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RawBodyToggle.Label}}</label> <button role="checkbox" ng-click="customApiTestTabCtrl.onRawBodyToggled()" ng-disabled="customApiTestTabCtrl.testData.currentOperation.usesDynamicSchema || customApiTestTabCtrl.testData.currentOperation.unableToResolveBodyParameterRefs" aria-checked="{{customApiTestTabCtrl.testData.currentOperation.useRawBody}}" aria-labelledby="c-label-1 c-state-label-1"/> <span>{{customApiTestTabCtrl.rawBodyToggleLabel}}</span> </div> <div class="pane-field" ng-if="!customApiTestTabCtrl.testData.currentOperation.useRawBody" ng-repeat="param in customApiTestTabCtrl.testData.currentOperation.bodyParameterFields"> <label class="pane-field-label"> <span class="context-required-text" ng-if="param.required === true">*</span>{{customApiTestTabCtrl.getParameterDisplayName(param)}} </label> <input class="c-text-field" type="text" title="{{customApiTestTabCtrl.getInputParameterTooltip(param)}}" ng-model="param.default" ng-readonly="customApiTestTabCtrl.isInputParameterReadOnlyInTestUI(param)"/> </div> <div class="pane-field" ng-if="customApiTestTabCtrl.testData.currentOperation.useRawBody"> <label class="pane-field-label error-message" ng-if="customApiTestTabCtrl.testData.currentOperation.unableToResolveBodyParameterRefs"> {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ReasonForDisablingRawBodyToggle.UnresolvedReferences}}</label> <label class="pane-field-label" ng-if="customApiTestTabCtrl.testData.currentOperation.usesDynamicSchema"> {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ReasonForDisablingRawBodyToggle.DynamicSchema}}</label> <textarea class="c-text-field" type="text" ng-model="customApiTestTabCtrl.testData.currentOperation.rawBody"/>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <div class="pane-field" ng-if="customApiTestTabCtrl.appSettings.featureFlags.enableAdvancedTestApiMode">\r\n                                <hr ng-if="customApiTestTabCtrl.testData.currentOperation.bodyParameter || customApiTestTabCtrl.testData.currentOperation.nonBodyParameters.length > 0"/>\r\n                                <label class="pane-field-label">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.TiggerParameters.Label}}</label>\r\n                                <div class="row pane-table-body" ng-repeat="queryParameter in customApiTestTabCtrl.testData.currentOperation.userDefinedQueryParameters">\r\n                                    <div class="column medium-3">\r\n                                        <input class="c-text-field" type="text" ng-model="queryParameter.name" placeholder="{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.TiggerParameters.NamePlaceholder}}"/>\r\n                                    </div>\r\n                                    <div class="column medium-7">\r\n                                        <input class="c-text-field" type="text" ng-model="queryParameter.value" placeholder="{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.TiggerParameters.ValuePlaceholder}}"/>\r\n                                    </div>\r\n                                    <div class="column medium-2">\r\n                                        <a class="add-element c-glyph glyph-delete" ng-click="customApiTestTabCtrl.onRemoveUserDefinedQueryParameter($index)">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.TiggerParameters.Remove}}</a>\r\n                                    </div>\r\n                                </div>\r\n                                <a class="add-element c-glyph glyph-create" ng-click="customApiTestTabCtrl.onAddNewUserDefinedQueryParameter()">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.TiggerParameters.Add}}</a>\r\n                            </div>\r\n                            <div class="pane-field">\r\n                                <button class="c-button right" type="submit" ng-click="customApiTestTabCtrl.testCurrentOperationWithApimTrace()" ng-disabled="customApiTestTabCtrl.isTestOperationButtonDisabled">\r\n                                    {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Button.Text}}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </section>\r\n                    \r\n                    <div class="margin-top" ng-if="customApiTestTabCtrl.testData.currentOperation.progressSpinner.show">\r\n                        <spinner model="customApiTestTabCtrl.testData.currentOperation.progressSpinner"></spinner>\r\n                    </div>\r\n                    \r\n                    <section class="c-pivot margin-bottom" id="results-section-pivot" ng-show="customApiTestTabCtrl.shouldDisplayResults">\r\n                        \r\n                        <div class="m-alert f-warning" role="alert" ng-if="customApiTestTabCtrl.testData.currentOperation.alert.show">\r\n                            <button class="c-action-trigger c-glyph glyph-cancel" aria-label="{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.AriaLabel.CloseAlert}}" ng-click="customApiTestTabCtrl.testData.currentOperation.alert.show = false"></button>\r\n                            <div class="pane-alert">\r\n                                <div class="c-glyph glyph-warning" aria-label="{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.AriaLabel.WarningMessage}}"></div>\r\n                                <p class="c-paragraph">{{customApiTestTabCtrl.testData.currentOperation.alert.message}}</p>\r\n                            </div>\r\n                        </div>\r\n                        <header role="tablist" class="pane-title pane-tabs">\r\n                            <a class="pane-header" role="tab" tabindex="0" aria-controls="request-section" ng-click="">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Request.Label}}</a>\r\n                            <a class="f-active pane-header" role="tab" aria-controls="result-section">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Response.Label}}</a>\r\n                            <a class="pane-header" role="tab" ng-if="customApiTestTabCtrl.appSettings.featureFlags.enableAdvancedTestApiMode" aria-controls="apim-trace-section">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ApimTraceTitle.Label}}</a>\r\n                        </header>\r\n                        \r\n                        <section id="request-section" role="tabpanel" aria-hidden="false">\r\n                            <div class="pane-content">\r\n                                <div class="pane-field">\r\n                                    <label class="pane-field-label">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RequestUrl.Label}}</label>\r\n                                    <input class="c-text-field" type="text" ng-value="customApiTestTabCtrl.testData.currentOperation.lastSentRequest.url" readonly="readonly"/>\r\n                                </div>\r\n                                <div class="pane-field">\r\n                                    <label class="pane-field-label">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RequestMethod.Label}}</label>\r\n                                    <div class="raw-output">{{customApiTestTabCtrl.testData.currentOperation.lastSentRequest.method}}</div>\r\n                                </div>\r\n                                <div class="pane-field">\r\n                                    <label class="pane-field-label">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RequestHeaders.Label}}</label>\r\n                                    <textarea class="raw-output small" readonly="readonly">{{customApiTestTabCtrl.formatedRequestHeaders}}</textarea>\r\n                                </div>\r\n                                <div class="pane-field" ng-if="customApiTestTabCtrl.canCurrentOperationHaveRequestBody">\r\n                                    <label class="pane-field-label">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RequestBody.Label}}</label>\r\n                                    <textarea class="raw-output" readonly="readonly">{{customApiTestTabCtrl.formatedRequestData}}</textarea>\r\n                                </div>\r\n                            </div>\r\n                        </section>\r\n                        \r\n                        <section id="result-section" role="tabpanel" aria-hidden="true">\r\n                            <div class="pane-content">\r\n                                <div class="pane-field">\r\n                                    <label class="pane-field-label">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ResponseStatus.Label}}</label>\r\n                                    <div class="raw-output">{{customApiTestTabCtrl.testData.currentOperation.lastReceivedResponse.status}}</div>\r\n                                </div>\r\n                                <div class="pane-field">\r\n                                    <label class="pane-field-label">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ResponseHeaders.Label}}</label>\r\n                                    <textarea class="raw-output small" readonly="readonly">{{customApiTestTabCtrl.testData.currentOperation.lastReceivedResponse.headers}}</textarea>\r\n                                </div>\r\n                                <div class="pane-field">\r\n                                    <label class="pane-field-label">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ResponseBody.Label}}</label>\r\n                                    <textarea class="raw-output" readonly="readonly">{{customApiTestTabCtrl.formatedResponseData}}</textarea>\r\n                                </div>\r\n                            </div>\r\n                        </section>\r\n                        \r\n                        <section id="apim-trace-section" ng-if="customApiTestTabCtrl.appSettings.featureFlags.enableAdvancedTestApiMode" role="tabpanel" aria-hidden="true">\r\n                            <div class="pane-content">\r\n                                <div class="pane-field">\r\n                                    <label class="pane-field-label"><span class="context-required-text">*</span> {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.OcpSubscriptionKey.Label}}</label>\r\n                                    <input class="c-text-field" type="text" ng-model="customApiTestTabCtrl.testData.apimSubscriptionKey"/>\r\n                                </div>\r\n                                <div class="pane-field" ng-if="customApiTestTabCtrl.testData.currentOperation.traceLocation">\r\n                                    <label class="pane-field-label">\r\n                                        <a class="c-hyperlink" target="_blank" href="{{customApiTestTabCtrl.testData.currentOperation.traceLocation}}">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ApimTraceUrl.Label}}</a>\r\n                                    </label>\r\n                                </div>\r\n                                <div class="pane-field" ng-if="!customApiTestTabCtrl.testData.currentOperation.traceLocation">\r\n                                    <label class="subtitle">\r\n                                        {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.MissingApimTraceLocation}}\r\n                                    </label>\r\n                                </div>\r\n                            </div>\r\n                        </section>\r\n                    </section>\r\n                    \r\n                    <section ng-if="customApiTestTabCtrl.shouldDisplayResults">\r\n                        <div class="pane-title">\r\n                            <header class="pane-header">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.SchemaValidation.Label}}</header>\r\n                        </div>\r\n                        <div class="pane-content">\r\n                            <div class="pane-field">\r\n                                <div class="validation-errors" ng-repeat="error in customApiTestTabCtrl.schemaValidationErrors">\r\n                                    <img src="{{customApiTestTabCtrl.warningImage}}">\r\n                                    <label class="subtitle">{{error}}</label>\r\n                                </div>\r\n                                <div class="pane-field" ng-show="customApiTestTabCtrl.schemaValidationErrors.length === 0">\r\n                                    <span>{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.SchemaValidation.Success}}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </section>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    </div>\r\n</div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1111);i(1112);var o=function(){function e(){this.template=i(1113),this.bindings={inputModel:"=",inputPlaceholder:"<?",inputMaxlength:"@?",validationResultCollection:"<",isReadOnly:"<?",isRequired:"<?"},this.controller=n.ValidatedInputCtrl,this.controllerAs="validatedInputCtrl"}return e}();t.ValidatedInput=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.validatedInput,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e}();t.ValidatedInputCtrl=r},function(e,t){},function(e,t){e.exports='<div class="validated-input-container"> <input ng-class="{\'input-with-img\': !validatedInputCtrl.validationResultCollection.isEmpty}" class="c-text-field" type="text" ng-model="validatedInputCtrl.inputModel" ng-readonly="validatedInputCtrl.isReadOnly" placeholder="{{validatedInputCtrl.inputPlaceholder}}" ng-attr-maxlength="{{::validatedInputCtrl.inputMaxlength}}" aria-required="{{::!!validatedInputCtrl.isRequired}}"> <validation-result-tooltip validation-result-collection="validatedInputCtrl.validationResultCollection"/> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1115);i(1117);var o=function(){function e(){this.template=i(1118),this.bindings={headingAbovePane:"<",subHeadingAbovePane:"<",baseViolator:"<",includeReferencedResults:"&?"},this.controller=n.ValidationResultsCtrl,this.controllerAs="validationResultsCtrl"}return e}();t.ValidationResults=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.validationResults,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(17),o=i(11),s=i(1116),a=i(5),l=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.clientResources=t,this.swaggerEditorDataService=i,this.swaggerValidationService=r,this.validationResultsForBaseViolator=new o.ValidationResultCollection,this.$scope.$watch(function(){return n.swaggerValidationService.resultCollection.results},function(){n.processValidationResults()})}return Object.defineProperty(e.prototype,"iconUrl",{get:function(){return!this.validationResultsForBaseViolator||this.validationResultsForBaseViolator.isEmpty?a.default.statusSuccess:this.validationResultsForBaseViolator.mostSevereResultTypeImage},enumerable:!0,configurable:!0}),e.prototype.processValidationResults=function(){var e=this;this.validationResultsForBaseViolator=this.swaggerValidationService.resultCollection.filterOnViolator(this.baseViolator);var t;if(this.includeReferencedResults){var i=this.baseViolator.actionIndex;t=i>=0?this.swaggerEditorDataService.swagger.actions[i]:t;var r=this.baseViolator.triggerIndex;t=r>=0?this.swaggerEditorDataService.swagger.triggers[r]:t}t&&this.validationResultsForBaseViolator.add(n.getOperationReferencedResults(t,this.swaggerEditorDataService.swagger,this.swaggerValidationService.resultCollection)),this.validationResultHierarchy=new s.ResultHierarchyEntity,this.validationResultsForBaseViolator.results.forEach(function(t){return e.insertResultInHierarchy(t)})},e.prototype.insertResultInHierarchy=function(e){e&&(e.violator?e.violator.swaggerItem&&e.violator.schemaPropertyItem&&e.violator.schemaPropertyItem.schemaProperty&&e.violator.schemaPropertyItem.subPath?this.validationResultHierarchy.addChild(e.violator.getSwaggerPathDisplayName(this.baseViolator),e.violator).addChild(e.violator.getSchemaPropertyKeyDisplayName(this.baseViolator),e.violator).addChild(e.violator.schemaPropertySubPathDisplayName,e.violator).addResult(e):e.violator.swaggerItem&&e.violator.schemaPropertyItem&&e.violator.schemaPropertyItem.schemaProperty?this.validationResultHierarchy.addChild(e.violator.getSwaggerPathDisplayName(this.baseViolator),e.violator).addChild(e.violator.getSchemaPropertyKeyDisplayName(this.baseViolator),e.violator).addResult(e):e.violator.swaggerItem?this.validationResultHierarchy.addChild(e.violator.getSwaggerPathDisplayName(this.baseViolator),e.violator).addResult(e):this.validationResultHierarchy.addResult(e):this.validationResultHierarchy.addResult(e))},e.$inject=[r.default.services.$scope,r.default.services.clientResources,r.default.services.swaggerEditorData,r.default.services.swaggerValidationService],e}();t.ValidationResultsCtrl=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.children={},this.results=[]}return e.prototype.addChild=function(t,i){return this.children[t]||(this.children[t]=new e),this.children[t]},e.prototype.addResult=function(e){return this.results.push(e),this},e}();t.ResultHierarchyEntity=r},function(e,t){},function(e,t){e.exports='<div class="validation-results-container"> <h5 class="c-heading-5" ng-if="validationResultsCtrl.headingAbovePane">{{validationResultsCtrl.headingAbovePane}}</h5> <p class="c-subheading-5" ng-if="validationResultsCtrl.subHeadingAbovePane">{{validationResultsCtrl.subHeadingAbovePane}}</p> <div class="validation-pane"> <div class="pane-title"> <span>{{validationResultsCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading}}</span> <img class="validation-icon" src="{{validationResultsCtrl.iconUrl}}"> </div> <div class="pane-content"> <div class="pane-field" ng-if="validationResultsCtrl.validationResultsForBaseViolator.isEmpty"> <span>{{validationResultsCtrl.clientResources.Manage.CustomApi.ValidationResults.Success}}</span> </div> <div> <div class="result-messages" ng-repeat="result in validationResultsCtrl.validationResultHierarchy.results"> <img src="{{result.resultTypeImage}}"> <label class="subtitle">{{result.message}}</label> </div> <div class="pane-field entity-result" ng-repeat="(swaggerPathKey, swaggerPathValue) in validationResultsCtrl.validationResultHierarchy.children"> <label class="pane-field-label">{{swaggerPathKey}}</label> <div class="result-messages indent" ng-repeat="result in swaggerPathValue.results"> <img src="{{result.resultTypeImage}}"> <label class="subtitle">{{result.message}}</label> </div> <div class="pane-field entity-result indent" ng-repeat="(schemaPropertyKey, schemaPropertyValue) in swaggerPathValue.children"> <label class="pane-field-label">{{schemaPropertyKey}}</label> <div class="result-messages indent" ng-repeat="result in schemaPropertyValue.results"> <img src="{{result.resultTypeImage}}"> <label class="subtitle">{{result.message}}</label> </div> <div class="pane-field entity-result indent" ng-repeat="(schemaPropertySubPathKey, schemaPropertySubPathValue) in schemaPropertyValue.children"> <label class="pane-field-label">{{schemaPropertySubPathKey}}</label> <div class="result-messages indent" ng-repeat="result in schemaPropertySubPathValue.results"> <img src="{{result.resultTypeImage}}"> <label class="subtitle">{{result.message}}</label> </div> </div> </div> </div> </div> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1120);i(1121);var o=function(){function e(){this.template=i(1122),this.bindings={validationResultCollection:"<"},this.controller=n.ValidationResultTooltipCtrl,this.controllerAs="validationResultTooltipCtrl"}return e}();t.ValidationResultTooltip=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.validationResultTooltip,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e}();t.ValidationResultTooltipCtrl=r},function(e,t){},function(e,t){e.exports='<div class="validation-result-tooltip-container" ng-if="validationResultTooltipCtrl.validationResultCollection.mostSevereResultTypeImage"> <img src="{{validationResultTooltipCtrl.validationResultCollection.mostSevereResultTypeImage}}"> <div class="tooltip-text tooltip-bottom"> <div class="validation-results" ng-repeat="result in validationResultTooltipCtrl.validationResultCollection.results"> <img src="{{result.resultTypeImage}}"> <span>{{result.message}}</span> <hr ng-if="!$last"/> </div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1124)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(5),o=i(15),s=i(1),a=i(8),l=i(1),c=i(24),u=i(7),p=i(10),d=i(24),g=i(223),m=function(){function e(e,t,i,r,o,s,a){this.$q=e,this.$timeout=t,this.apisClient=i,this.apisClientLA=r,this.appSettings=o,this.clientResources=s,this.connectionFormService=a,this.validationRegExp={startsWithScheme:/^(http|https|ws|wss):\/\//,startsWithForwardSlash:/^\//,hasForwardSlash:/[\/]/,hasPathTemplate:/[{}]/,hasQuestionMark:/[?]/},this.defaultIconFile=n.default.defaultSwaggerIcon,this.autoHideNotificationInterval=3e3,this.maxPostFix=20,this.initializeData()}return Object.defineProperty(e.prototype,"SwaggerEditorData",{get:function(){return this.swaggerEditorData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"swaggerEditorUIData",{get:function(){return this.swaggerEditorData.uiDetails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"swagger",{get:function(){return this.swaggerEditorData.swagger},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasSwaggerBeenModified",{get:function(){return!angular.equals(this.swagger,this.swaggerEditorData.deployedSwagger)},enumerable:!0,configurable:!0}),e.prototype.isDeployedSwaggerAction=function(e){var t=this;return this.swaggerEditorData.deployedSwagger.actions.some(function(i){return t.areSameOperationItem(i,e)})},e.prototype.isDeployedSwaggerTrigger=function(e){var t=this;return this.swaggerEditorData.deployedSwagger.triggers.some(function(i){return t.areSameOperationItem(i,e)})},e.prototype.areSameOperationItem=function(e,t){return e&&t&&e.path&&t.path&&e.method&&t.method&&e.operation&&t.operation&&s.equals(e.path,t.path,!0)&&s.equals(e.method,t.method,!1)&&s.equals(e.operation.operationId,t.operation.operationId,!0)},Object.defineProperty(e.prototype,"CustomApiTestData",{get:function(){return this.customApiTestData},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.initializeData()},e.prototype.updateDisplayName=function(){this.swaggerEditorData.displayName=this.swaggerEditorData.swagger&&this.swaggerEditorData.swagger.info&&!l.isNullOrUndefined(this.swaggerEditorData.swagger.info.title)?l.getSlug(this.swaggerEditorData.swagger.info.title.substring(0,this.appSettings.customApiNameMaxLength),!0).replace(/-+/g," "):l.getSlug(this.swaggerEditorData.swaggerFileName.substring(0,this.appSettings.customApiNameMaxLength),!0)},e.prototype.setUniqueDisplayName=function(e){for(var t=this.swaggerEditorData.displayName,i=!e.some(function(e){return s.equals(e.properties.displayName,t)}),r="",n=1;!i&&n<this.maxPostFix;n++)r=" - "+n,t=""+this.swaggerEditorData.displayName.slice(0,this.appSettings.customApiNameMaxLength-r.length)+r,i=!e.some(function(e){return s.equals(e.properties.displayName,t)});this.swaggerEditorData.displayName=t},e.prototype.setIconDisplay=function(){this.swaggerEditorData.swaggerIconDisplay={"background-image":'url("'+this.swaggerEditorData.swaggerIconFileContentUrl+'")',"background-color":this.swaggerEditorData.swaggerIconBrandColor}},e.prototype.setIconDisplayNotFound=function(){this.swaggerEditorData.swaggerIconDisplay={"background-image":'url("'+n.default.alert+'")',"background-size":"16px","background-position":"center","background-color":this.swaggerEditorData.swaggerIconBrandColor}},e.prototype.constructInitialConnectionParametersFromSwagger=function(){var e={};switch(c.getAuthenticationTypeFromSwagger(this.swaggerEditorData.swagger)){case c.ApiAuthenticationType.None:break;case c.ApiAuthenticationType.Basic:e.username={type:"string",uiDefinition:{displayName:this.clientResources.Manage.CustomApi.Security.Basic.username}},e.password={type:"securestring",uiDefinition:{displayName:this.clientResources.Manage.CustomApi.Security.Basic.password}};break;case c.ApiAuthenticationType.ApiKey:e.api_key={type:"securestring",uiDefinition:{displayName:this.clientResources.Manage.CustomApi.Security.apiKey}};break;case c.ApiAuthenticationType.Oauth2:var t=Object.keys(this.SwaggerEditorData.swagger.securityDefinitions)[0],i=this.swaggerEditorData.swagger.securityDefinitions[t],r={type:"oauthSetting",oAuthSettings:{customParameters:{}}};r.oAuthSettings.customParameters.authorizationUrl={value:i.authorizationUrl},r.oAuthSettings.customParameters.tokenUrl={value:i.tokenUrl},r.oAuthSettings.scopes=l.isNullOrUndefined(i.scopes)?[]:Object.keys(i.scopes).map(function(e){return e}),e.token=r}return e},e.prototype.convertSwaggerToOAuthSecurityDetails=function(){var e=this.SwaggerEditorData.swagger.securityDefinitions;if(e&&Object.keys(e).length>0){var t=Object.keys(e)[0],i=e[t];this.SwaggerEditorData.securityTabDetails.authorizationUrl=i.authorizationUrl,this.SwaggerEditorData.securityTabDetails.tokenUrl=i.tokenUrl,i.scopes instanceof Object?this.SwaggerEditorData.securityTabDetails.scopes=Object.keys(i.scopes):Array.isArray(i.scopes)&&(this.SwaggerEditorData.securityTabDetails.scopes=i.scopes)}this.SwaggerEditorData.securityTabDetails.scopeInput=this.SwaggerEditorData.securityTabDetails.scopes&&this.SwaggerEditorData.securityTabDetails.scopes.length>0?this.SwaggerEditorData.securityTabDetails.scopes.join(", "):""},e.prototype.convertOAuthSecurityDetailsToSwagger=function(e){if(this.SwaggerEditorData.securityTabDetails.scopeInput&&(this.SwaggerEditorData.securityTabDetails.scopes=this.SwaggerEditorData.securityTabDetails.scopeInput.split(",").map(function(e){return e.trim()})),this.SwaggerEditorData.swagger.securityDefinitions&&Object.keys(this.SwaggerEditorData.swagger.securityDefinitions).length>0){var t=Object.keys(this.SwaggerEditorData.swagger.securityDefinitions)[0],i={};if(s.isEmpty(this.SwaggerEditorData.securityTabDetails.scopes)||(this.SwaggerEditorData.swagger.securityDefinitions[t].scopes=this.SwaggerEditorData.securityTabDetails.scopes.reduce(function(e,t){return e[t]=t,e},i)),a.equalsIgnoreCase(this.SwaggerEditorData.securityTabDetails.selectedIdentityProviderId,"oauth2")?(this.SwaggerEditorData.swagger.securityDefinitions[t].authorizationUrl=e.AuthorizationUrl,this.SwaggerEditorData.swagger.securityDefinitions[t].tokenUrl=e.TokenUrl):this.SwaggerEditorData.swagger.securityDefinitions[t].authorizationUrl=this.SwaggerEditorData.securityTabDetails.authorizationUrl,this.SwaggerEditorData.swagger.security&&this.SwaggerEditorData.swagger.security.hasOwnProperty(t))this.SwaggerEditorData.swagger.security[t]=this.SwaggerEditorData.securityTabDetails.scopes;else{var r={};r[t]=this.SwaggerEditorData.securityTabDetails.scopes,this.SwaggerEditorData.swagger.security=[r]}}},e.prototype.convertSwaggerToApiKeySecurityDetails=function(){var e=this.SwaggerEditorData.swagger.securityDefinitions;if(e&&Object.keys(e).length>0){var t=Object.keys(e)[0],i=e[t];this.SwaggerEditorData.securityTabDetails.selectedApiKeyLocation=i.in,s.isEmpty(this.SwaggerEditorData.securityTabDetails.apiKeyName)&&(this.SwaggerEditorData.securityTabDetails.apiKeyName=i.name)}},e.prototype.convertApiKeySecurityDetailsToSwagger=function(){if(this.SwaggerEditorData.swagger.securityDefinitions&&Object.keys(this.SwaggerEditorData.swagger.securityDefinitions).length>0){var e=Object.keys(this.SwaggerEditorData.swagger.securityDefinitions)[0],t=this.SwaggerEditorData.swagger.securityDefinitions[e];t.in=this.SwaggerEditorData.securityTabDetails.selectedApiKeyLocation,t.name=this.SwaggerEditorData.securityTabDetails.apiKeyName}},e.prototype.validateFormDetailsLogicApps=function(e){var t=this;return this.$q.resolve().then(function(){return t.SwaggerEditorData.validatationError=t.validateGeneralTabDetails(),t.SwaggerEditorData.validatationError?t.$q.reject(t.SwaggerEditorData.validatationError):!t.swaggerEditorData.securityTabDetails.isLocked&&(t.SwaggerEditorData.validatationError=t.validateSecurityTabDetails(),t.SwaggerEditorData.validatationError)?t.$q.reject(t.SwaggerEditorData.validatationError):t.$q.resolve()}).catch(function(e){return t.SwaggerEditorData.validatationError=e,t.$q.reject(t.SwaggerEditorData.validatationError)})},e.prototype.validateFormDetails=function(e){var t=this,i=this.apisClient.query(e);return i.$promise.then(function(){return t.swaggerEditorData.editMode||t.setUniqueDisplayName(i),t.swaggerEditorData.validatationError=t.validateDisplayName(i),t.SwaggerEditorData.validatationError?t.$q.reject(t.SwaggerEditorData.validatationError):(t.SwaggerEditorData.validatationError=t.validateGeneralTabDetails(),t.SwaggerEditorData.validatationError?t.$q.reject(t.SwaggerEditorData.validatationError):!t.swaggerEditorData.securityTabDetails.isLocked&&(t.SwaggerEditorData.validatationError=t.validateSecurityTabDetails(),t.SwaggerEditorData.validatationError)?t.$q.reject(t.SwaggerEditorData.validatationError):t.$q.resolve())}).catch(function(e){return t.SwaggerEditorData.validatationError=e,t.$q.reject(t.SwaggerEditorData.validatationError)})},e.prototype.validateDisplayName=function(e){var t=this;if(!this.SwaggerEditorData.editMode){var i=g.validateDisplayName(this.swaggerEditorData.displayName);if(i)return i;return e.some(function(e){return s.equals(e.properties.displayName,t.swaggerEditorData.displayName)})?new o.ClientError(o.ErrorCodes.customApiExist,this.clientResources.Manage.CustomConnection.Create.Api.Name.alreadyExists,null):void 0}},e.prototype.validateGeneralTabDetails=function(){return this.appSettings.featureFlags.enableBlankConnector||!s.isEmpty(this.swagger)&&!angular.equals(this.swagger,d.DeserializedBaseSwagger)?this.validateSwaggerIconBrandColor()||this.validateSwaggerHost()||this.validateSwaggerBasePath():new o.ClientError(o.ErrorCodes.customApiValidationError,this.clientResources.Manage.CustomApi.General.MissingSwaggerError,null)},e.prototype.validateSwaggerIconBrandColor=function(){return s.isEmpty(this.SwaggerEditorData.swaggerIconBrandColor)||/^#[0-9a-fA-F]{6}$/.test(this.SwaggerEditorData.swaggerIconBrandColor)?null:new o.ClientError(o.ErrorCodes.customApiInvalidIconBrandColor,this.clientResources.Manage.CustomConnection.Create.Api.IconBrandColor.invalidFormat,null)},e.prototype.validateSwaggerHost=function(){return s.isNullOrWhitespace(this.swagger.host)?new o.ClientError(o.ErrorCodes.customApiInvalidBasePath,this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.missing,null):this.validationRegExp.startsWithScheme.test(this.swagger.host)?new o.ClientError(o.ErrorCodes.customApiInvalidBasePath,this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.scheme,null):this.validationRegExp.hasForwardSlash.test(this.swagger.host)?new o.ClientError(o.ErrorCodes.customApiInvalidHost,this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.subPaths,null):this.validationRegExp.hasPathTemplate.test(this.swagger.host)?new o.ClientError(o.ErrorCodes.customApiInvalidHost,this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.pathTemplating,null):this.validationRegExp.hasQuestionMark.test(this.swagger.host)?new o.ClientError(o.ErrorCodes.customApiInvalidHost,this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.queryParameter,null):null},e.prototype.validateSwaggerBasePath=function(){return s.isEmpty(this.swagger.basePath)?null:this.validationRegExp.startsWithForwardSlash.test(this.swagger.basePath)?this.validationRegExp.hasPathTemplate.test(this.swagger.basePath)?new o.ClientError(o.ErrorCodes.customApiInvalidBasePath,this.clientResources.Manage.CustomConnection.Create.Api.BasePath.Invalid.pathTemplating,null):this.validationRegExp.hasQuestionMark.test(this.swagger.basePath)?new o.ClientError(o.ErrorCodes.customApiInvalidBasePath,this.clientResources.Manage.CustomConnection.Create.Api.BasePath.Invalid.queryParameter,null):null:new o.ClientError(o.ErrorCodes.customApiInvalidBasePath,this.clientResources.Manage.CustomConnection.Create.Api.BasePath.Invalid.noLeadingSlash,null)},e.prototype.constructConnectionParameters=function(){var e={};return a.equalsIgnoreCase(this.swaggerEditorData.securityTabDetails.selectedAuthenticationType,"basic")?e=this.constructBasicAuthConnectionParameters():a.equalsIgnoreCase(this.swaggerEditorData.securityTabDetails.selectedAuthenticationType,"oauth2")?e=this.constructOAuth2ConnectionParameters():a.equalsIgnoreCase(this.swaggerEditorData.securityTabDetails.selectedAuthenticationType,"apiKey")&&(e=this.constructApiKeyAuthConnectionParameters()),e},e.prototype.constructBasicAuthConnectionParameters=function(){var e=this.connectionFormService.convertFormItemsToParameterValues(this.swaggerEditorData.securityTabDetails.authenticationFormItems),t="Username",i="Password";if(e)for(var r in e){var n=e[r];switch(r.toUpperCase()){case"USERNAME":t=n;break;case"PASSWORD":i=n}}return{username:{type:"string",uiDefinition:{displayName:t,description:s.format(this.clientResources.Manage.CustomApi.Security.Basic.descriptionMessage,t),tooltip:s.format(this.clientResources.Manage.CustomApi.Security.Basic.tooltipMessage,t),constraints:{required:"true"}}},password:{type:"securestring",uiDefinition:{displayName:i,description:s.format(this.clientResources.Manage.CustomApi.Security.Basic.descriptionMessage,i),tooltip:s.format(this.clientResources.Manage.CustomApi.Security.Basic.tooltipMessage,i),constraints:{required:"true"}}}}},e.prototype.constructOAuth2ConnectionParameters=function(){var e={},t=this.connectionFormService.convertFormItemsToParameterValues(this.swaggerEditorData.securityTabDetails.authenticationFormItems);if(this.convertOAuthSecurityDetailsToSwagger(t),e={token:{type:"oAuthSetting",oAuthSettings:{identityProvider:this.swaggerEditorData.securityTabDetails.selectedIdentityProviderId,scopes:this.swaggerEditorData.securityTabDetails.scopes,customParameters:{}},uiDefinition:null}},t)for(var i in t){var r=t[i];switch(i.toUpperCase()){case"CLIENTID":e.token.oAuthSettings.clientId=r;break;case"CLIENTSECRET":e.token.oAuthSettings.clientSecret=r;break;default:e.token.oAuthSettings.customParameters[i]={value:r}}}return e},e.prototype.constructApiKeyAuthConnectionParameters=function(){var e={};return this.convertApiKeySecurityDetailsToSwagger(),e.api_key={type:"securestring",uiDefinition:{displayName:this.swaggerEditorData.securityTabDetails.apiKeyLabel,description:s.format(this.clientResources.Manage.CustomApi.Security.ApiKey.descriptionMessage,this.swaggerEditorData.securityTabDetails.apiKeyLabel),tooltip:s.format(this.clientResources.Manage.CustomApi.Security.ApiKey.tooltipMessage,this.swaggerEditorData.securityTabDetails.apiKeyLabel),constraints:{required:"true"}}},e},e.prototype.validateSecurityTabDetails=function(){var e=this,t=null;if(a.equalsIgnoreCase(this.SwaggerEditorData.securityTabDetails.selectedAuthenticationType,"basic")||a.equalsIgnoreCase(this.SwaggerEditorData.securityTabDetails.selectedAuthenticationType,"oauth2")){var i=this.SwaggerEditorData.securityTabDetails.authenticationFormItems;Object.keys(i).forEach(function(r){var n=i[r],a=s.format(e.clientResources.Manage.CustomApi.Security.InvalidCharactersForField,n.displayName);n.required&&s.isEmpty(n.value)&&(t=new o.ClientError(o.ErrorCodes.customApiValidationError,a,null))})}else if(a.equalsIgnoreCase(this.SwaggerEditorData.securityTabDetails.selectedAuthenticationType,"apiKey")){var r=this.SwaggerEditorData.securityTabDetails.apiKeyLabel,n=this.SwaggerEditorData.securityTabDetails.apiKeyName;(s.isNullOrWhitespace(r)||s.isNullOrWhitespace(n))&&(t=new o.ClientError(o.ErrorCodes.customApiValidationError,this.clientResources.Manage.CustomApi.Security.InvalidCharactersForApiKey,null))}return t},e.prototype.initializeData=function(){var e=this;this.swaggerEditorData={apiName:null,displayName:null,editMode:!1,securityTabDetails:{},spinner:{size:u.SpinnerSize.Large,local:u.SpinnerPosition.Local},statusAlert:{message:"",type:p.AlertType.None,options:{title:null,show:function(t,i){e.swaggerEditorData.statusAlert.type=t,e.swaggerEditorData.statusAlert.message=i,-1===[p.AlertType.Success,p.AlertType.Info].indexOf(t)||e.hideAlertInProgress||(e.hideAlertInProgress=!0,e.$timeout(function(){e.swaggerEditorData.statusAlert.options.hide(),e.hideAlertInProgress=!1},e.autoHideNotificationInterval))},hide:function(){return e.swaggerEditorData.statusAlert.options.show(p.AlertType.None,"")},control:{action:function(){return e.swaggerEditorData.validatationError=null}}}},swagger:angular.copy(d.DeserializedBaseSwagger),deployedSwagger:d.DeserializedBaseSwagger,swaggerFileName:null,swaggerIconFile:null,swaggerIconFileContentUrl:this.defaultIconFile,swaggerIconBrandColor:null,swaggerIconDisplay:{"background-image":null,"background-color":null},validatationError:null,uiDetails:{leftColumnScrollPosition:0,foldingListCollapseState:{actions:!1,triggers:!1,references:!1,test:!1}}},this.customApiTestData={connections:[],apiInfo:{api:void 0,apimSwagger:void 0},currentOperation:void 0,testOperations:[],selectedOperationIndex:null,selectedConnectionName:null}},e}();t.SwaggerEditorDataService=m,angular.module(r.default.modules.processSimpleServices).factory(r.default.services.swaggerEditorData,[r.default.services.$q,r.default.services.$timeout,r.default.services.apisClient,r.default.services.apisClientLA,r.default.services.appSettings,r.default.services.clientResources,r.default.services.connectionForm,function(e,t,i,r,n,o,s){return new m(e,t,i,r,n,o,s)}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(27),i(72)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(62),i(206),i(1127)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(27),o=i(11),s=i(1),a=i(29),l=i(34),c=i(24),u=i(17),p=i(11),d=i(1128),g=function(){function e(e,t,i){this.appSettings=e,this.clientResources=t,this.loggingService=i,this.refPropertyKey="$ref",this.rules=[new d.AllPathsHaveCorrectFormatRule,new d.InternalRequiredFieldsHaveDefaultsRule,new d.ObjectAndArraySchemaHaveCorrectTypeRule,new d.OperationIdsShouldBeProperlyNamedRule,new d.OperationIdsShouldBeUniqueRule,new d.ParameterDefaultValueTypeRule,new d.PathAndMethodAreUniqueRule,new d.PathInSyncWithParametersRule,new d.PathParameterMarkedAsRequiredRule,new d.ReadOnlyRequiredParametersNotAllowedRule,new d.ReferenceNameUniqueRule,new d.ReferencesFullyResolvedRule,new d.ReferencesExistRule,new d.RequiredFieldsExistRule,new d.ResponseNameValidRule],this.appSettings.featureFlags.enableAdvancedSwaggerValidation&&(this.rules.push(new d.AllDescriptionsAreSentencesRule),this.rules.push(new d.DescriptionsDifferentFromNameRule),this.rules.push(new d.OperationVisibilityCorrectlyMarkedRule),this.rules.push(new d.SummariesShouldBeProperlyNamedRule)),this.resultCollection=new o.ValidationResultCollection}return e.prototype.validateIfSwaggerChanged=function(e){angular.equals(this.lastSwaggerValidated,e)||this.validate(e)},e.prototype.validate=function(e){var t=this;if(this.resultCollection.clear(),!s.isEmpty(e))try{this.swagger=e,this.lastSwaggerValidated=angular.copy(e),this.rules.forEach(function(t){t.setSwaggerUsedForValidation(e)}),Array.isArray(e.actions)&&e.actions.forEach(function(e,i){var r={itemPath:o.Paths.Actions+"["+i+"]",itemDisplayName:u.getOperationDisplayName(e)};t.resultCollection.add(t.validateOperation(e,r))}),Array.isArray(e.triggers)&&e.triggers.forEach(function(e,i){var r={itemPath:o.Paths.Triggers+"["+i+"]",itemDisplayName:u.getOperationDisplayName(e)};t.resultCollection.add(t.validateOperation(e,r))}),Array.isArray(e.definitions)&&e.definitions.forEach(function(i,r){if(i&&i.item){var n={itemPath:o.Paths.Definitions+"["+r+"]",itemDisplayName:o.PathDisplayNames.Definition};t.resultCollection.add(t.rules.map(function(e){return e.validateDefinitionItem(i,n)})),n.itemPath+=o.Paths.Item,n.itemDisplayName=o.PathDisplayNames.Body,t.resultCollection.add(t.rules.map(function(e){return e.validateUnresolvedSchema(i.item,n)}));var s;try{var a=l.resolveSchema(e,i.item);t.resultCollection.add(t.rules.map(function(e){return e.validateResolvedSchema(a,n)})),s=l.getLeafSchemaProperties(a.schema)}catch(e){return void t.resultCollection.add(t.getSchemaResolutionViolation(n))}s.forEach(function(e){t.resultCollection.add(t.rules.map(function(t){return t.validateSchemaProperty(e,n)}))})}}),Array.isArray(e.parameters)&&e.parameters.forEach(function(e,i){if(e&&e.item){var r={itemPath:o.Paths.Parameters+"["+i+"]",itemDisplayName:o.PathDisplayNames.ParameterDefinition};t.resultCollection.add(t.rules.map(function(t){return t.validateParameterDefinitionItem(e,r)})),r.itemPath+=o.Paths.Item,r.itemDisplayName=u.getParameterDisplayName(e.item,t.swagger),t.resultCollection.add(t.validateParameter(e.item,r))}}),Array.isArray(e.responses)&&e.responses.forEach(function(e,i){if(e&&e.item){var r={itemPath:o.Paths.Responses+"["+i+"]",itemDisplayName:o.PathDisplayNames.ResponseDefinition};t.resultCollection.add(t.rules.map(function(t){return t.validateResponseDefinitionItem(e,r)})),r.itemPath+=o.Paths.Item,r.itemDisplayName=u.getResponseDisplayName(e),t.resultCollection.add(t.validateResponse(e.item,r))}})}catch(e){this.loggingService.logError(a.ProfilingEventNames.swaggerValidationException,e)}},e.prototype.validateOperation=function(e,t){var i=new o.ValidationResultCollection;if(!e||s.isNullOrUndefined(t)||!this.swagger)return i;i.add(this.rules.map(function(i){return i.validateOperation(e,t)}));var r={itemPath:""+t.itemPath+o.Paths.Operation,itemDisplayName:t.itemDisplayName};return i.add(this.validateInlineParameters(e.operation,r)),i.add(this.validateInlineResponses(e.operation,r)),i},e.prototype.validateInlineParameters=function(e,t){var i=this,r=new o.ValidationResultCollection;return e&&Array.isArray(e.parameters)?(e.parameters.forEach(function(e,n){var s={itemPath:""+t.itemPath+o.Paths.Parameters+"["+n+"]",itemDisplayName:u.getParameterDisplayName(e,i.swagger)};c.isReference(e)?r.add(i.rules.map(function(t){return t.validateJsonReference(e,s)})):r.add(i.validateParameter(e,s))}),r):r},e.prototype.validateInlineResponses=function(e,t){var i=this,r=new o.ValidationResultCollection;return e&&Array.isArray(e.responses)?(e.responses.forEach(function(e,n){if(e.item){var s={itemPath:""+t.itemPath+o.Paths.Responses+"["+n+"]",itemDisplayName:u.getResponseDisplayName(e)};r.add(i.rules.map(function(t){return t.validateInlineResponseDefinitionItem(e,s)}));var a={itemPath:""+s.itemPath+o.Paths.Item,itemDisplayName:s.itemDisplayName};if(c.isReference(e.item))return void r.add(i.rules.map(function(t){return t.validateJsonReference(e.item,a)}));r.add(i.validateResponse(e.item,a))}}),r):r},e.prototype.validateParameter=function(e,t){var i=this,r=new o.ValidationResultCollection;if(!e||!e.in||s.isNullOrUndefined(t)||!this.swagger)return r;var a={itemPath:t.itemPath,itemDisplayName:t.itemDisplayName};if(e.in===n.ParameterLocations.body){a.propertyPath=o.Paths.Schema,a.propertyDisplayName=o.PathDisplayNames.Body,r.add(this.rules.map(function(t){return t.validateUnresolvedSchema(e.schema,a)}));var c=void 0;try{var u=l.resolveSchema(this.swagger,e.schema);r.add(this.rules.map(function(e){return e.validateResolvedSchema(u,a)})),c=l.getLeafSchemaProperties(u.schema)}catch(e){return r.add(this.getSchemaResolutionViolation(a)),r}c.forEach(function(e){r.add(i.rules.map(function(t){return t.validateSchemaProperty(e,a)}))})}else r.add(this.rules.map(function(t){return t.validateNonBodyParameter(e,a)}));return r},e.prototype.validateResponse=function(e,t){var i=this,r=new o.ValidationResultCollection;if(!e||!e.schema||e.schema.type===n.Types.file||!this.swagger)return r;var s={itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Schema,propertyDisplayName:o.PathDisplayNames.Body};r.add(this.rules.map(function(t){return t.validateUnresolvedSchema(e.schema,s)}));var a;try{var c=l.resolveSchema(this.swagger,e.schema);r.add(this.rules.map(function(e){return e.validateResolvedSchema(c,s)})),a=l.getLeafSchemaProperties(c.schema)}catch(e){return r.add(this.getSchemaResolutionViolation(s)),r}return a.forEach(function(e){r.add(i.rules.map(function(t){return t.validateSchemaProperty(e,s)}))}),r},e.prototype.getSchemaResolutionViolation=function(e){return new o.ValidationResult("SwaggerValidationService",p.ResultType.Warning,this.clientResources.Validate.CustomApi.Results.UnableToResolveSchema,new o.Violator(e))},e}();t.SwaggerValidationService=g,angular.module(r.default.modules.processSimpleServices).factory(r.default.services.swaggerValidationService,[r.default.services.appSettings,r.default.services.clientResources,r.default.services.logging,function(e,t,i){return new g(e,t,i)}])},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(1129);t.AllDescriptionsAreSentencesRule=r.AllDescriptionsAreSentencesRule;var n=i(1130);t.AllPathsHaveCorrectFormatRule=n.AllPathsHaveCorrectFormatRule;var o=i(1131);t.DescriptionsDifferentFromNameRule=o.DescriptionsDifferentFromNameRule;var s=i(1132);t.InternalRequiredFieldsHaveDefaultsRule=s.InternalRequiredFieldsHaveDefaultsRule;var a=i(1133);t.ObjectAndArraySchemaHaveCorrectTypeRule=a.ObjectAndArraySchemaHaveCorrectTypeRule;var l=i(1134);t.OperationIdsShouldBeProperlyNamedRule=l.OperationIdsShouldBeProperlyNamedRule;var c=i(1135);t.OperationIdsShouldBeUniqueRule=c.OperationIdsShouldBeUniqueRule;var u=i(1136);t.OperationVisibilityCorrectlyMarkedRule=u.OperationVisibilityCorrectlyMarkedRule;var p=i(1137);t.ParameterDefaultValueTypeRule=p.ParameterDefaultValueTypeRule;var d=i(1138);t.PathAndMethodAreUniqueRule=d.PathAndMethodAreUniqueRule;var g=i(1139);t.PathInSyncWithParametersRule=g.PathInSyncWithParametersRule;var m=i(1140);t.PathParameterMarkedAsRequiredRule=m.PathParameterMarkedAsRequiredRule;var f=i(1141);t.ReadOnlyRequiredParametersNotAllowedRule=f.ReadOnlyRequiredParametersNotAllowedRule;var h=i(1142);t.ReferenceNameUniqueRule=h.ReferenceNameUniqueRule;var v=i(1143);t.ReferencesFullyResolvedRule=v.ReferencesFullyResolvedRule;var y=i(1144);t.ReferencesExistRule=y.ReferencesExistRule;var w=i(1145);t.RequiredFieldsExistRule=w.RequiredFieldsExistRule;var C=i(1146);t.ResponseNameValidRule=C.ResponseNameValidRule;var S=i(1147);t.SummariesShouldBeProperlyNamedRule=S.SummariesShouldBeProperlyNamedRule},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.AllDescriptionsAreSentencesRule,t}return r.__extends(t,e),t.prototype.validateNonBodyParameter=function(e,t){if(n.isNullOrUndefined(e))return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Description,propertyDisplayName:o.PathDisplayNames.Description});return this.validateDescription(e.description,i)},t.prototype.validateOperation=function(e,t){if(n.isNullOrUndefined(e)||n.isNullOrUndefined(e.operation))return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.OperationDescription,propertyDisplayName:o.PathDisplayNames.Description});return this.validateDescription(e.operation.description,i)},t.prototype.validateSchemaProperty=function(e,t){if(n.isNullOrUndefined(e))return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:o.Paths.Description,subPathDisplayName:o.PathDisplayNames.Description});return this.validateDescription(e.description,i)},t.prototype.validateDescription=function(e,t){var i=[];if(n.isNullOrWhitespace(e))return i;this.hasMultipleWords(e)||i.push(s.constructInfo(this,this.clientResources.Validate.CustomApi.Results.AllDescriptionsAreSentencesRule.OneWord,t)),"."!==e.trim().charAt(e.length-1)&&i.push(s.constructInfo(this,this.clientResources.Validate.CustomApi.Results.AllDescriptionsAreSentencesRule.Period,t));var r=e.trim().charAt(0);return r!==r.toUpperCase()&&i.push(s.constructInfo(this,this.clientResources.Validate.CustomApi.Results.AllDescriptionsAreSentencesRule.DoesNotStartWithUpper,t)),i},t.prototype.hasMultipleWords=function(e){return e.trim().indexOf(" ")>0},t}(a.BaseRule);t.AllDescriptionsAreSentencesRule=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=function(e){function t(){var t=e.call(this)||this;return t.basePathEndsWithForwardSlash=!1,t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.AllPathsHaveCorrectFormatRule,t}return r.__extends(t,e),t.prototype.setSwaggerUsedForValidation=function(t){e.prototype.setSwaggerUsedForValidation.call(this,t),this.basePathEndsWithForwardSlash=!n.isNullOrWhitespace(t.basePath)&&"/"===t.basePath.substr(-1)},t.prototype.validateOperation=function(e,t){var i=[],r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Path,propertyDisplayName:o.PathDisplayNames.URL});if(n.isNullOrUndefined(e)||n.isNullOrWhitespace(e.path))return i;var a=e.path.trim();return this.basePathEndsWithForwardSlash||"/"===a.charAt(0)||i.push(s.constructError(this,this.clientResources.Validate.CustomApi.Results.AllPathsHaveCorrectFormatRule.DoesNotStartWithSlash,r)),a.indexOf("?")>=0&&i.push(s.constructError(this,this.clientResources.Validate.CustomApi.Results.AllPathsHaveCorrectFormatRule.ContainsQuestionMark,r)),"/"===a.substr(-1)&&i.push(s.constructWarning(this,this.clientResources.Validate.CustomApi.Results.AllPathsHaveCorrectFormatRule.EndsWithForwardSlash,r)),i},t}(a.BaseRule);t.AllPathsHaveCorrectFormatRule=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=i(16),c=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.DescriptionsDifferentFromNameRule,t}return r.__extends(t,e),t.prototype.validateNonBodyParameter=function(e,t){if(n.isNullOrUndefined(e))return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Description,propertyDisplayName:o.PathDisplayNames.Description});return this.validateDescription(e.description,e.name,e[l.Swagger.Summary],null,i)},t.prototype.validateOperation=function(e,t){if(n.isNullOrUndefined(e)||n.isNullOrUndefined(e.operation))return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.OperationDescription,propertyDisplayName:o.PathDisplayNames.Description});return this.validateDescription(e.operation.description,null,e.operation.summary,null,i)},t.prototype.validateSchemaProperty=function(e,t){if(n.isNullOrUndefined(e))return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:o.Paths.Description,subPathDisplayName:o.PathDisplayNames.Description});return this.validateDescription(e.description,e.name,null,e.leafTitle,i)},t.prototype.validateDescription=function(e,t,i,r,o){var a=[];return n.isNullOrWhitespace(e)?a:(e===t&&a.push(s.constructInfo(this,this.clientResources.Validate.CustomApi.Results.DescriptionsDifferentFromNameRule.SameAsName,o)),e===i&&a.push(s.constructInfo(this,this.clientResources.Validate.CustomApi.Results.DescriptionsDifferentFromNameRule.SameAsSummary,o)),e===r&&a.push(s.constructInfo(this,this.clientResources.Validate.CustomApi.Results.DescriptionsDifferentFromNameRule.SameAsTitle,o)),a)},t}(a.BaseRule);t.DescriptionsDifferentFromNameRule=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=i(16),c=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.InternalRequiredFieldsHaveDefaultsRule,t}return r.__extends(t,e),t.prototype.validateNonBodyParameter=function(e,t){var i=[];if(n.isNullOrUndefined(e))return i;if(e.required&&e[l.Swagger.Visibility]===l.Visibility.internal&&n.isNullOrWhitespace(e.default)){var r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Default,propertyDisplayName:o.PathDisplayNames.Default});i.push(s.constructError(this,this.clientResources.Validate.CustomApi.Results.InternalRequiredFieldsHaveDefaultsRule.RequiredInternalNoDefault,r))}return i},t.prototype.validateSchemaProperty=function(e,t){var i=[];if(n.isNullOrUndefined(e))return i;if(e.required&&e.visibility===l.Visibility.internal&&n.isNullOrWhitespace(e.default)){var r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:o.Paths.Default,subPathDisplayName:o.PathDisplayNames.Default});i.push(s.constructError(this,this.clientResources.Validate.CustomApi.Results.InternalRequiredFieldsHaveDefaultsRule.RequiredInternalNoDefault,r))}return i},t}(a.BaseRule);t.InternalRequiredFieldsHaveDefaultsRule=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=i(27),c=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ObjectAndArraySchemaHaveCorrectTypeRule,t}return r.__extends(t,e),t.prototype.validateUnresolvedSchema=function(e,t){var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName});return this.validateUnresolvedSchemaInternal(e,i)},t.prototype.validateUnresolvedSchemaInternal=function(e,t){var i=this,r=[];return n.isNullOrUndefined(e)||!n.isNullOrUndefined(e.$ref)?r:(n.isNullOrUndefined(e.properties)?n.isNullOrUndefined(e.items)||(e.type!==l.Types.array&&r.push(s.constructWarning(this,this.clientResources.Validate.CustomApi.Results.ObjectAndArraySchemaHaveCorrectTypeRule.ArrayTypeMissing,t)),r=r.concat(this.validateUnresolvedSchemaInternal(e.items,t))):(e.type!==l.Types.object&&r.push(s.constructWarning(this,this.clientResources.Validate.CustomApi.Results.ObjectAndArraySchemaHaveCorrectTypeRule.ObjectTypeMissing,t)),Object.keys(e.properties).forEach(function(n){return r=r.concat(i.validateUnresolvedSchemaInternal(e.properties[n],t))})),r)},t}(a.BaseRule);t.ObjectAndArraySchemaHaveCorrectTypeRule=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.OperationIdsShouldBeProperlyNamedRule,t}return r.__extends(t,e),t.prototype.validateOperation=function(e,t){var i=[],r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.OperationId,propertyDisplayName:o.PathDisplayNames.OperationID});return n.isNullOrUndefined(e)||n.isNullOrUndefined(e.operation)||n.isNullOrWhitespace(e.operation.operationId)?i:(!1===/^[a-zA-Z0-9-_. ]*$/.test(e.operation.operationId)&&i.push(s.constructError(this,this.clientResources.Validate.CustomApi.Results.OperationIdsShouldBeProperlyNamedRule.NoSpecialCharacters,r)),-1!==e.operation.operationId.indexOf(" ")&&i.push(s.constructWarning(this,this.clientResources.Validate.CustomApi.Results.OperationIdsShouldBeProperlyNamedRule.NoSpaces,r)),e.operation.operationId.charAt(0)!==e.operation.operationId.charAt(0).toUpperCase()&&i.push(s.constructInfo(this,this.clientResources.Validate.CustomApi.Results.OperationIdsShouldBeProperlyNamedRule.StartWithUpper,r)),i)},t}(a.BaseRule);t.OperationIdsShouldBeProperlyNamedRule=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.OperationIdsShouldBeUniqueRule,t}return r.__extends(t,e),t.prototype.setSwaggerUsedForValidation=function(t){e.prototype.setSwaggerUsedForValidation.call(this,t),this.operationIdOccurences=this.getOperationIdOccurences()},t.prototype.validateOperation=function(e,t){var i=[],r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.OperationId,propertyDisplayName:o.PathDisplayNames.OperationID});return n.isNullOrUndefined(e)||n.isNullOrUndefined(e.operation)||n.isNullOrWhitespace(e.operation.operationId)?i:(this.operationIdOccurences[e.operation.operationId]>1&&i.push(s.constructError(this,this.clientResources.Validate.CustomApi.Results.OperationIdsShouldBeUniqueRule.NotUnique,r)),i)},t.prototype.getOperationIdOccurences=function(){var e=this.swagger.actions.concat(this.swagger.triggers),t={};return e.forEach(function(e){n.isNullOrUndefined(e.operation)||n.isNullOrUndefined(e.operation.operationId)||(t[e.operation.operationId]=t[e.operation.operationId]?t[e.operation.operationId]+1:1)}),t},t}(a.BaseRule);t.OperationIdsShouldBeUniqueRule=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=i(16),c=function(e){function t(){var t=e.call(this)||this;return t.actionsMarkedAsImportant={},t.triggersMarkedAsImportant={},t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.OperationVisibilityCorrectlyMarkedRule,t}return r.__extends(t,e),t.prototype.setSwaggerUsedForValidation=function(t){e.prototype.setSwaggerUsedForValidation.call(this,t),this.updateOperationVisibilityCounts()},t.prototype.validateOperation=function(e,t){var i=[];if(!e||!e.operation)return i;var r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:""+o.Paths.Operation+o.Paths.XMsVisibility,propertyDisplayName:o.PathDisplayNames.Visibility}),a=this.getUniqueOperationKey(e);return Object.keys(this.actionsMarkedAsImportant).length>1&&this.actionsMarkedAsImportant[a]?i.push(s.constructInfo(this,n.format(this.clientResources.Validate.CustomApi.Results.OperationVisibilityCorrectlyMarkedRule.TooManyImportantActions,Object.keys(this.actionsMarkedAsImportant).length,this.getCommaSeparatedStringOfValues(this.actionsMarkedAsImportant,e.operation.operationId)),r)):Object.keys(this.triggersMarkedAsImportant).length>1&&this.triggersMarkedAsImportant[a]&&i.push(s.constructInfo(this,n.format(this.clientResources.Validate.CustomApi.Results.OperationVisibilityCorrectlyMarkedRule.TooManyImportantTriggers,Object.keys(this.triggersMarkedAsImportant).length,this.getCommaSeparatedStringOfValues(this.triggersMarkedAsImportant,e.operation.operationId)),r)),i},t.prototype.updateOperationVisibilityCounts=function(){var e=this;this.actionsMarkedAsImportant={},this.triggersMarkedAsImportant={},Array.isArray(this.swagger.actions)&&this.swagger.actions.forEach(function(t){t.operation&&t.operation[l.Swagger.Visibility]===l.Visibility.important&&(e.actionsMarkedAsImportant[e.getUniqueOperationKey(t)]=t.operation.operationId)}),Array.isArray(this.swagger.triggers)&&this.swagger.triggers.forEach(function(t){t.operation&&t.operation[l.Swagger.Visibility]===l.Visibility.important&&(e.triggersMarkedAsImportant[e.getUniqueOperationKey(t)]=t.operation.operationId)})},t.prototype.getUniqueOperationKey=function(e){return""+e.method+e.path},t.prototype.getCommaSeparatedStringOfValues=function(e,t){return Object.keys(e).map(function(t){return e[t]}).filter(function(e){return e!==t}).join(", ").trim()},t}(a.BaseRule);t.OperationVisibilityCorrectlyMarkedRule=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(11),o=i(17),s=i(26),a=i(1),l=i(61),c=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ParameterDefaultValueTypeRule,t}return r.__extends(t,e),t.prototype.validateNonBodyParameter=function(e,t){var i=new n.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.Paths.Default,propertyDisplayName:n.PathDisplayNames.Default});return this.validateDefaultValueType(e,i)},t.prototype.validateSchemaProperty=function(e,t){var i=new n.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:n.Paths.Default,subPathDisplayName:n.PathDisplayNames.Default});return this.validateDefaultValueType(e,i)},t.prototype.validateDefaultValueType=function(e,t){if(a.isNullOrUndefined(e)||a.isEmpty(e.default))return[];var i=""+e.default;return"string"===e.type||"file"===e.type||"object"===e.type||e.type===l.getTypeFromStringValue(i)?[]:[o.constructError(this,a.format(this.clientResources.Validate.CustomApi.Results.ParameterDefaultValueTypeRule.ValueDoesNotMatchType,e.type),t)]},t}(s.BaseRule);t.ParameterDefaultValueTypeRule=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.PathAndMethodAreUniqueRule,t}return r.__extends(t,e),t.prototype.setSwaggerUsedForValidation=function(t){e.prototype.setSwaggerUsedForValidation.call(this,t),this.operationPathMap=this.getOperationPathMap()},t.prototype.validateOperation=function(e,t){var i=[];if(n.isNullOrUndefined(e)||n.isNullOrUndefined(e.operation))return i;var r=""+e.path+e.method;if(this.operationPathMap[r].length<2)return i;var a=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Path,propertyDisplayName:o.PathDisplayNames.URL});return i.push(s.constructError(this,n.format(this.clientResources.Validate.CustomApi.Results.PathAndMethodAreUniqueRule.PathAndMethodNotUnique,this.operationPathMap[r].length,this.operationPathMap[r].join(", ").trim()),a)),i},t.prototype.getOperationPathMap=function(){var e=this.swagger.actions.concat(this.swagger.triggers),t={};return e.forEach(function(e){if(!n.isNullOrUndefined(e.operation)){var i=""+e.path+e.method;t[i]||(t[i]=[]),t[i].push(e.operation.operationId)}}),t},t}(a.BaseRule);t.PathAndMethodAreUniqueRule=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(24),s=i(61),a=i(11),l=i(17),c=i(26),u=i(27),p=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.PathInSyncWithParametersRule,t}return r.__extends(t,e),t.prototype.validateOperation=function(e,t){var i=this,r=[];if(n.isNullOrUndefined(e)||n.isNullOrUndefined(e.operation))return r;var c=s.getPathParametersInsideBrackets(e.path),u=this.getAllPathParameterNameIndexPairs(e.operation.parameters);return c.forEach(function(e){if(n.isNullOrUndefined(u[e])){var o=new a.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:a.Paths.Path,propertyDisplayName:a.PathDisplayNames.URL});r.push(l.constructError(i,n.format(i.clientResources.Validate.CustomApi.Results.PathInSyncWithParametersRule.ReferenceNotFound,e),o))}}),Object.keys(u).forEach(function(s){if(c.indexOf(s)<0){var p=u[s],d=e.operation.parameters[p],g=new a.Violator({itemPath:""+t.itemPath+a.Paths.OperationParameters+"["+p+"]"+a.Paths.Item,itemDisplayName:l.getParameterDisplayName(d,i.swagger),propertyPath:a.Paths.Path,propertyDisplayName:a.PathDisplayNames.URL});if(o.isReference(d)){var m=d.$ref.split("/"),f=i.swagger.parameters.map(function(e){return e.name}).indexOf(m[m.length-1]);g.swaggerItem.itemPath=a.Paths.Parameters+"["+f+"]"+a.Paths.Item,r.push(l.constructError(i,n.format(i.clientResources.Validate.CustomApi.Results.PathInSyncWithParametersRule.ReferenceParameterNotUsedInPath,e.operation.operationId),g))}else r.push(l.constructError(i,n.format(i.clientResources.Validate.CustomApi.Results.PathInSyncWithParametersRule.InlineParameterNotUsedInPath,s),g))}}),r},t.prototype.getAllPathParameterNameIndexPairs=function(e){var t={};return e?(o.getParametersWithResolvedReferences(e,this.swagger).forEach(function(e,i){e.in===u.ParameterLocations.path&&(t[e.name]=i)}),t):t},t}(c.BaseRule);t.PathInSyncWithParametersRule=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.PathParameterMarkedAsRequiredRule,t}return r.__extends(t,e),t.prototype.validateNonBodyParameter=function(e,t){if(n.isNullOrUndefined(e)||"path"!==e.in||e.required)return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Required,propertyDisplayName:o.PathDisplayNames.Required});return[s.constructError(this,this.clientResources.Validate.CustomApi.Results.PathParameterMarkedAsRequiredRule.NotMarkedAsRequired,i)]},t}(a.BaseRule);t.PathParameterMarkedAsRequiredRule=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=i(16),c=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ReadOnlyRequiredParametersNotAllowedRule,t}return r.__extends(t,e),t.prototype.validateNonBodyParameter=function(e,t){if(n.isNullOrUndefined(e)||!e.required||e[l.Swagger.Permission]!==l.Permission.readOnly)return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Required,propertyDisplayName:o.PathDisplayNames.Required});return[s.constructWarning(this,this.clientResources.Validate.CustomApi.Results.ReadOnlyRequiredParametersNotAllowedRule.RequiredAndReadOnly,i)]},t.prototype.validateSchemaProperty=function(e,t){if(n.isNullOrUndefined(e)||!e.required||!e.readOnly)return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:o.Paths.Required,subPathDisplayName:o.PathDisplayNames.Required});return[s.constructWarning(this,this.clientResources.Validate.CustomApi.Results.ReadOnlyRequiredParametersNotAllowedRule.RequiredAndReadOnly,i)]},t}(a.BaseRule);t.ReadOnlyRequiredParametersNotAllowedRule=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ReferenceNameUniqueRule,t}return r.__extends(t,e),t.prototype.setSwaggerUsedForValidation=function(t){e.prototype.setSwaggerUsedForValidation.call(this,t),this.referenceCount=this.getReferencesCount()},t.prototype.validateDefinitionItem=function(e,t){if(n.isNullOrUndefined(e))return[];var i="#/definitions/"+e.name;return this.validateReference(i,e.name,this.clientResources.Validate.CustomApi.Results.ReferenceNameUniqueRule.DefinitionNameNotUnique,t)},t.prototype.validateResponseDefinitionItem=function(e,t){if(n.isNullOrUndefined(e))return[];var i="#/responses/"+e.name;return this.validateReference(i,e.name,this.clientResources.Validate.CustomApi.Results.ReferenceNameUniqueRule.ResponseDefinitionNameNotUnique,t)},t.prototype.validateParameterDefinitionItem=function(e,t){if(n.isNullOrUndefined(e))return[];var i="#/parameters/"+e.name;return this.validateReference(i,e.name,this.clientResources.Validate.CustomApi.Results.ReferenceNameUniqueRule.ParameterDefinitionNameNotUnique,t)},t.prototype.validateReference=function(e,t,i,r){var a=[];if(1===this.referenceCount[e])return a;var l=new o.Violator({itemPath:r.itemPath,itemDisplayName:r.itemDisplayName,propertyPath:o.Paths.Name,propertyDisplayName:o.PathDisplayNames.Name});return a.push(s.constructError(this,n.format(i,t,this.referenceCount[e]),l)),a},t.prototype.getReferencesCount=function(){var e={};return Array.isArray(this.swagger.definitions)&&this.swagger.definitions.forEach(function(t){var i="#/definitions/"+t.name;e[i]=n.isNullOrUndefined(e[i])?1:e[i]+1}),Array.isArray(this.swagger.responses)&&this.swagger.responses.forEach(function(t){var i="#/responses/"+t.name;e[i]=n.isNullOrUndefined(e[i])?1:e[i]+1}),Array.isArray(this.swagger.parameters)&&this.swagger.parameters.forEach(function(t){var i="#/parameters/"+t.name;e[i]=n.isNullOrUndefined(e[i])?1:e[i]+1}),e},t}(a.BaseRule);t.ReferenceNameUniqueRule=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ReferencesFullyResolvedRule,t}return r.__extends(t,e),t.prototype.validateResolvedSchema=function(e,t){return this.isSchemaUnresolved(e)?[s.constructWarning(this,this.clientResources.Validate.CustomApi.Results.UnableToResolveSchema,new o.Violator(t))]:[]},t.prototype.isSchemaUnresolved=function(e){return!e||n.hasOwnNestedProperty(e,"$ref")},t}(a.BaseRule);t.ReferencesFullyResolvedRule=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(94),s=i(11),a=i(17),l=i(26),c=function(e){function t(){var t=e.call(this)||this;return t.validReferences=[],t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ReferencesExistRule,t}return r.__extends(t,e),t.prototype.setSwaggerUsedForValidation=function(t){e.prototype.setSwaggerUsedForValidation.call(this,t),this.setValidReferences()},t.prototype.validateJsonReference=function(e,t){return this.checkIfReferencesAreValid(e,t)},t.prototype.validateUnresolvedSchema=function(e,t){return this.checkIfReferencesAreValid(e,t)},t.prototype.checkIfReferencesAreValid=function(e,t){var i=this,r=[];return e?(Object.keys(o.getAllReferences(e)).forEach(function(e){if(i.validReferences.indexOf(e)<0){var o=new s.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName});r.push(a.constructError(i,n.format(i.clientResources.Validate.CustomApi.Results.ReferencesExistRule.ReferenceNotFound,e),o))}}),r):r},t.prototype.setValidReferences=function(){var e=this;this.validReferences=[],this.swagger&&(Array.isArray(this.swagger.definitions)&&this.swagger.definitions.forEach(function(t){e.validReferences.push("#/definitions/"+t.name)}),Array.isArray(this.swagger.parameters)&&this.swagger.parameters.forEach(function(t){e.validReferences.push("#/parameters/"+t.name)}),Array.isArray(this.swagger.responses)&&this.swagger.responses.forEach(function(t){e.validReferences.push("#/responses/"+t.name)}))},t}(l.BaseRule);t.ReferencesExistRule=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=i(27),c=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.RequiredFieldsExistRule,t}return r.__extends(t,e),t.prototype.validateNonBodyParameter=function(e,t){var i=[];if(n.isNullOrUndefined(e))return i;if(n.isNullOrWhitespace(e.name)){var r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Name,propertyDisplayName:o.PathDisplayNames.Name});i.push(s.constructError(this,this.constructValidationMessage(o.PathDisplayNames.Name),r))}if(n.isNullOrWhitespace(e.type)){var r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Type,propertyDisplayName:o.PathDisplayNames.Type});i.push(s.constructError(this,this.constructValidationMessage(o.PathDisplayNames.Type),r))}return i},t.prototype.validateOperation=function(e,t){var i=[];if(n.isNullOrUndefined(e))return i;if(n.isNullOrWhitespace(e.operation.operationId)){var r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.OperationId,propertyDisplayName:o.PathDisplayNames.OperationID});i.push(s.constructError(this,this.constructValidationMessage(o.PathDisplayNames.OperationID),r))}if(n.isNullOrWhitespace(e.path)){var r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Path,propertyDisplayName:o.PathDisplayNames.URL});i.push(s.constructError(this,this.constructValidationMessage(o.PathDisplayNames.Path),r))}if(n.isNullOrWhitespace(e.operation.summary)){var r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.OperationSummary,propertyDisplayName:o.PathDisplayNames.Summary});i.push(s.constructWarning(this,this.constructValidationMessage(o.PathDisplayNames.Summary),r))}if(n.isNullOrWhitespace(e.operation.description)){var r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.OperationDescription,propertyDisplayName:o.PathDisplayNames.Description});i.push(s.constructInfo(this,this.constructValidationMessage(o.PathDisplayNames.Description),r))}return i},t.prototype.validateSchemaProperty=function(e,t){var i=[];if(n.isNullOrUndefined(e))return i;if(e.type===l.Types.any){var r=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:o.Paths.Type,subPathDisplayName:o.PathDisplayNames.Type});i.push(s.constructWarning(this,this.constructValidationMessage(o.PathDisplayNames.Type),r))}return i},t.prototype.validateDefinitionItem=function(e,t){return this.validateDefinitionItemName(e,t)},t.prototype.validateResponseDefinitionItem=function(e,t){return this.validateDefinitionItemName(e,t)},t.prototype.validateParameterDefinitionItem=function(e,t){return this.validateDefinitionItemName(e,t)},t.prototype.validateDefinitionItemName=function(e,t){if(n.isNullOrUndefined(e)||!n.isNullOrWhitespace(e.name))return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Name,propertyDisplayName:o.PathDisplayNames.Name});return[s.constructError(this,this.constructValidationMessage(o.PathDisplayNames.Name),i)]},t.prototype.constructValidationMessage=function(e){return n.format(this.clientResources.Validate.CustomApi.Results.RequiredFieldsExistRule.NotDefined,e)},t}(a.BaseRule);t.RequiredFieldsExistRule=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ResponseNameValidRule,t}return r.__extends(t,e),t.prototype.validateResponseDefinitionItem=function(e,t){return this.validateResponseName(e,t)},t.prototype.validateInlineResponseDefinitionItem=function(e,t){return this.validateResponseName(e,t)},t.prototype.validateResponseName=function(e,t){if(n.isNullOrUndefined(e)||n.isNullOrUndefined(e.name)||"default"===e.name||Number(e.name)>=100&&Number(e.name)<600)return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.Name,propertyDisplayName:o.PathDisplayNames.Name});return[s.constructError(this,n.format(this.clientResources.Validate.CustomApi.Results.ResponseNameValidRule.ResponseNameInvalid,e.name),i)]},t}(a.BaseRule);t.ResponseNameValidRule=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),n=i(1),o=i(11),s=i(17),a=i(26),l=i(16),c=function(e){function t(){var t=e.call(this)||this;return t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.SummariesShouldBeProperlyNamedRule,t}return r.__extends(t,e),t.prototype.validateNonBodyParameter=function(e,t){if(n.isNullOrUndefined(e))return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.XMsSummary,propertyDisplayName:o.PathDisplayNames.Summary});return this.validateSummary(e[l.Swagger.Summary],i,o.PathDisplayNames.Summary)},t.prototype.validateOperation=function(e,t){if(n.isNullOrUndefined(e)||n.isNullOrUndefined(e.operation))return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:o.Paths.OperationSummary,propertyDisplayName:o.PathDisplayNames.Summary});return this.validateSummary(e.operation.summary,i,o.PathDisplayNames.Summary)},t.prototype.validateSchemaProperty=function(e,t){if(n.isNullOrUndefined(e))return[];var i=new o.Violator({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:o.Paths.Title,subPathDisplayName:o.PathDisplayNames.Title});return this.validateSummary(e.leafTitle,i,o.PathDisplayNames.Title)},t.prototype.validateSummary=function(e,t,i){var r=[];if(n.isNullOrWhitespace(e))return r;n.endsWith(e.trim(),".")&&r.push(s.constructInfo(this,n.format(this.clientResources.Validate.CustomApi.Results.SummariesShouldBeProperlyNamedRule.Period,i),t));var o=e.trim().charAt(0);return o!==o.toUpperCase()&&r.push(s.constructInfo(this,n.format(this.clientResources.Validate.CustomApi.Results.SummariesShouldBeProperlyNamedRule.DoesNotStartUpper,i),t)),r},t}(a.BaseRule);t.SummariesShouldBeProperlyNamedRule=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1149)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1150),i(1154)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1151);i(1152);var o=function(){function e(){this.controller=n.ContactSupportCtrl,this.template=i(1153),this.controllerAs="contactSupportCtrl"}return e}();t.ContactSupport=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.contactSupport,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(68),o=function(){function e(e,t,i,r,o,s,a){this.$element=e,this.$scope=t,this.$window=i,this.clientResources=r,this.planService=o,this.policiesService=s,this.sessionService=a,this.contactSupportButtonOnClick=null,this.closeDialogOnClick=null,this.contactSupportButtonClass=".contact-support",this.closeDialogButtonClass=".contact-support-close",this.dialogTypeClass="",this.showDialog=!1,this.$contactSupportButtons=angular.element(this.contactSupportButtonClass),this.$contactSupportButtons&&this.$contactSupportButtons.length>0&&this.registerComponents(),this.model={sections:[{name:"Community",linkUrl:"http://go.microsoft.com/fwlink/?LinkID=787467&clcid=0x409"},{name:"Admin",linkUrl:"https://go.microsoft.com/fwlink/?linkid=830394&clcid=0x409"}]};var l=this.planService.isPlanFree();this.dialogTypeClass=l?"standard-support":"premium-support",l||this.model.sections.splice(1,0,{name:"Assisted",linkUrl:"http://go.microsoft.com/fwlink/?LinkID=787475&clcid=0x409"});var c=n.parseQueryString(window.location.search);this.showDialog="1"===c.popup}return e.prototype.registerComponents=function(){var e=this;this.contactSupportButtonOnClick=function(t){t.preventDefault(),e.$scope.$apply(function(){e.showDialog=!0})},this.$contactSupportButtons.on("click",this.contactSupportButtonOnClick),this.closeDialogOnClick=function(){e.$scope.$apply(function(){e.showDialog=!1})},$("body").on("click",this.closeDialogButtonClass,this.closeDialogOnClick),this.$scope.$on("$destroy",function(){e.$contactSupportButtons.off("click",e.contactSupportButtonOnClick),e.contactSupportButtonOnClick=null,e.$contactSupportButtons.off("click",e.closeDialogButtonClass,e.closeDialogOnClick),e.closeDialogOnClick=null,e.showDialog=!1})},e.$inject=[r.default.services.$element,r.default.services.$scope,r.default.services.$window,r.default.services.clientResources,r.default.services.plan,r.default.services.policies,r.default.services.session],e}();t.ContactSupportCtrl=o},function(e,t){},function(e,t){e.exports='<section class="context-support-dialog c-dialog f-flow" ng-if="contactSupportCtrl.showDialog" aria-hidden="{{!contactSupportCtrl.showDialog}}"> <div role="presentation" tabindex="-1" class="contact-support-close" aria-label="{{contactSupportCtrl.clientResources.ContactSupport.Dialog.Aria.Close}}"></div> <div role="dialog" tabindex="-1" aria-label="Contact support"> <div class="c-glyph glyph-close contact-support-close" tabindex="0" aria-label="{{contactSupportCtrl.clientResources.ContactSupport.Dialog.Aria.Close}}"></div> <div role="document"> <h1 class="c-heading c-heading-4 text-center popup-heading">{{contactSupportCtrl.clientResources.ContactSupport.Dialog.Title}}</h1> <div class="row"> <div class="column medium-3 contact-card" ng-repeat="section in contactSupportCtrl.model.sections" ng-class="contactSupportCtrl.dialogTypeClass"> <h2 class="c-heading c-heading-3 text-center">{{contactSupportCtrl.clientResources.ContactSupport.Dialog[section.name].Title}}</h2> <div class="c-heading c-heading-5">{{contactSupportCtrl.clientResources.ContactSupport.Dialog[section.name].Subtitle}}</div> <p class="c-paragraph-2">{{contactSupportCtrl.clientResources.ContactSupport.Dialog[section.name].Description}}</p> <div class="link-button"> <a href="{{section.linkUrl}}" class="c-button" data-event-name="{{\'ContactSupport\'+ section.name +\'Clicked\'}}"> {{contactSupportCtrl.clientResources.ContactSupport.Dialog[section.name].Button.Text}} </a> </div> </div> </div> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1156)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1157)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);i(2);var n=i(1158);i(1159);var o=function(){function e(){this.controller=n.TemplateLandingLiteContentCtrl,this.template=i(1160),this.controllerAs="controller"}return e}();t.TemplateLandingLiteContent=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.templateLandingLiteContent,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(6),o=i(98),s=i(7),a=i(10),l=i(3),c=i(1),u=function(){function e(e,t,i,r,n,o,l,u,p){this.$scope=e,this.$window=t,this.clientResources=i,this.telemetryService=r,this.loggingService=n,this.appSettings=o,this.sessionService=l,this.templateCreationHelper=u,this.urlService=p,this.spinner={size:s.SpinnerSize.Large,show:!0,local:s.SpinnerPosition.LocalHorizontal},this.statusAlert={type:a.AlertType.None,message:"",options:{}},this.template=o.cache.template,this.greetingSpeech=c.format(this.clientResources.TemplateLandingLite.Greeting,this.sessionService.getUserInfo().givenName)}return e.prototype.onCreateFlow=function(){var e=this;this.telemetryService.tagEvent(n.TelemetryEventNames.TemplateLandingLiteCreateButtonClicked,null,{templateName:this.template.name}),o.isOneClickTemplate(this.template)||o.isSkipDesignerTemplate(this.template)?(this.isCreating=!0,this.templateCreationHelper.autoCreateFlow(this.$scope,this.template.name).then(function(){e.$window.location.assign(e.urlService.flowsFullPath())}).catch(function(t){e.showAlert(l.parseErrorMessage(e.clientResources.TemplateLandingLite.Alert.Message))}).finally(function(){e.isCreating=!1})):this.$window.location.assign(this.urlService.templateFullPath(this.template.properties.galleryName,this.template.name))},e.prototype.showAlert=function(e){this.statusAlert.type=a.AlertType.Error,this.statusAlert.message=e,this.statusAlert.options.title="",this.statusAlert.options.control=null,this.statusAlert.options.link={url:this.urlService.templateFullPath(this.template.properties.galleryName,this.template.name),text:this.clientResources.TemplateLandingLite.Alert.Link.Text}},e.$inject=[r.default.services.$scope,r.default.services.$window,r.default.services.clientResources,r.default.services.telemetry,r.default.services.logging,r.default.services.appSettings,r.default.services.session,r.default.services.templateCreationHelper,r.default.services.url],e}();t.TemplateLandingLiteContentCtrl=u},function(e,t){},function(e,t){e.exports='<div class="template-landing-lite"> <alert class="sticky-error" model="controller.statusAlert" ng-if="controller.showAlert"></alert> <div class="content"> <img cdn-src="{{controller.template.properties.integrationPageBackgroundImageUri}}" class="background-image"> <h2 class="greeting"> {{controller.greetingSpeech}} </h2> <div class="template-description"> {{controller.template.properties.description}} </div> <spinner model="controller.spinner" ng-if="controller.isCreating"></spinner> <button class="create-flow-button c-button" type="submit" ng-disabled="controller.isCreating" ng-click="controller.onCreateFlow()">{{controller.clientResources.TemplateLandingLite.Button.Create}}</button> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1162)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1163)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1164);i(1165);var o=function(){function e(){this.controller=n.TrialExpiredCtrl,this.template=i(1166),this.controllerAs="trialExpiredCtrl"}return e}();t.TrialExpired=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.trialExpired,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(6),o=i(219),s=i(4),a=i(220),l=i(1),c=i(3),u=function(){function e(e,t,i,r,s,a,c,u,p,d){this.$window=e,this.clientResources=t,this.graphService=i,this.loggingService=r,this.planService=s,this.plansClient=a,this.policiesService=c,this.sessionService=u,this.telemetryService=p,this.urlService=d,this.shouldShowExtendTrialDialog=!1,this.shouldShowTrialExtendedDialog=!1,this.extendingTrial=!1,this.isUserTypeDetermined=!1,this.isAdmin=!1,this.extensionFormData={reasonForExtending:"",phoneNumber:"",additionalComments:""},this.telemetryService.tagEvent(n.TelemetryEventNames.TrialExpiredPageShown,{planSku:this.planService.getPlanLicenseSku()});var g=this.planService.getPlanLicenseSku()===o.planSkus.p2?this.clientResources.Common.FlowPlan.P2:this.clientResources.Common.FlowPlan.P1;this.heading=l.format(t.TrialExpired.Heading.Top,g),this.determineUserType()}return e.prototype.goToPricingPage=function(){this.$window.location.href=this.urlService.pricingRoute()},e.prototype.showExtendTrialDialog=function(){this.shouldShowExtendTrialDialog=!0},e.prototype.hideExtendTrialDialog=function(){this.shouldShowExtendTrialDialog=!1},e.prototype.extendTrial=function(){var e=this;this.telemetryService.tagEvent(n.TelemetryEventNames.TrialExpiredExtendSubmitted,{isAdmin:this.isAdmin},this.extensionFormData),this.extendingTrial=!0;var t=this.loggingService.profileStart(s.ProfilingEventNames.extendTrialStart);this.plansClient.renewPlan({licenseId:this.planService.getPlanName()}).then(function(){e.extendingTrial=!1,e.loggingService.profileEnd(t,s.ProfilingEventNames.extendTrialEnd,{status:c.Status.Success}),e.shouldShowExtendTrialDialog=!1,e.shouldShowTrialExtendedDialog=!0}).catch(function(i){e.extendingTrial=!1,e.loggingService.profileEnd(t,s.ProfilingEventNames.extendTrialEnd,{status:c.Status.Failure,error:i}),e.loggingService.logError("trialExpiredCtrl.ExtendTrialFailed",i)})},Object.defineProperty(e.prototype,"shouldShowPurchaseOption",{get:function(){return this.isAdmin},enumerable:!0,configurable:!0}),e.prototype.redirectBack=function(){this.$window.location.reload()},e.prototype.determineUserType=function(){var e=this;this.sessionService.isOrgId?this.graphService.getUserRoles().then(function(t){e.isAdmin=a.canUserPurchaseForOthers(t),e.isUserTypeDetermined=!0}).catch(function(t){e.isUserTypeDetermined=!0,e.loggingService.logError("trialExpiredCtrl.determineUserType",t)}):this.isUserTypeDetermined=!0},e.$inject=[r.default.services.$window,r.default.services.clientResources,r.default.services.graph,r.default.services.logging,r.default.services.plan,r.default.services.plansClient,r.default.services.policies,r.default.services.session,r.default.services.telemetry,r.default.services.url],e}();t.TrialExpiredCtrl=u},function(e,t){},function(e,t){e.exports='<main class="trial-expired" ng-if="trialExpiredCtrl.isUserTypeDetermined"> <div class="empty-space"></div> <div ng-if="trialExpiredCtrl.shouldShowPurchaseOption"> <section class="heading"> <h1 class="c-heading-3">{{trialExpiredCtrl.heading}}</h1> <p class="c-heading-3">{{trialExpiredCtrl.clientResources.TrialExpired.Heading.Bottom}} <a ng-href="{{trialExpiredCtrl.urlService.pricingRoute()}}" target="_blank" data-event-name="TrialExpiredLearnMoreClicked">{{trialExpiredCtrl.clientResources.Common.LearnMore}}</a> </p> </section> <section class="options"> <div class="row"> <div class="column medium-6"> <section class="option"> <h1 class="c-heading-5">{{trialExpiredCtrl.clientResources.TrialExpired.Options.Buy}}</h1> <button data-event-name="TrialExpiredBuyButtonClicked" class="c-button btn-primary" ng-click="trialExpiredCtrl.goToPricingPage()">{{trialExpiredCtrl.clientResources.TrialExpired.Buttons.Buy}}</button> </section> </div> <div class="column medium-6"> <section class="option"> <h1 class="c-heading-5">{{trialExpiredCtrl.clientResources.TrialExpired.Options.Extend}}</h1> <button data-event-name="TrialExpiredExtendClicked" ng-click="trialExpiredCtrl.showExtendTrialDialog()" class="c-button btn-primary">{{trialExpiredCtrl.clientResources.TrialExpired.Buttons.Extend}}</button> </section> </div> </div> </section> </div> <div ng-if="!trialExpiredCtrl.shouldShowPurchaseOption"> <section class="heading"> <h1 class="c-heading-3">{{trialExpiredCtrl.heading}}</h1> <p class="c-heading-3">{{trialExpiredCtrl.clientResources.TrialExpired.Heading.BottomIndividualPurchaseNotSupported}}</p> </section> <section class="option"> <h1 class="c-heading-5">{{trialExpiredCtrl.clientResources.TrialExpired.Options.Extend}}</h1> <button data-event-name="TrialExpiredExtendClicked" ng-click="trialExpiredCtrl.extendTrial()" class="c-button btn-primary">{{trialExpiredCtrl.clientResources.TrialExpired.Buttons.Extend}}</button> </section> </div> </main> <section class="c-dialog extend-trial-dialog" ng-show="trialExpiredCtrl.shouldShowExtendTrialDialog"> <div role="presentation" tabindex="-1" data-js-dialog-hide></div> <div role="dialog" tabindex="-1" class=""> <div class="heading"> <h1 class="c-heading-3">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Heading.Top}}</h1> <p class="c-paragraph-2">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Heading.Bottom}}</p> </div> <form ng-submit="trialExpiredCtrl.extendTrial()"> <label for="reason" class="c-paragraph-2">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.Heading}}</label> <div class="c-select"> <select name="reason" id="reason" ng-model="trialExpiredCtrl.extensionFormData.reasonForExtending" required> <option disabled="disabled" selected="selected" hidden value="">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.Placeholder}}</option> <option value="Still Evaluating">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.StillEvaluating}}</option> <option value="Problems Purchasing">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.ProblemsPurchasing}}</option> <option value="Someone else is buying">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.SomeoneElse}}</option> <option value="Other">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.Other}}</option> </select> </div> <label for="phone-number" class="c-paragraph-2">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.PhoneNumber.Heading}}</label> <input type="text" placeholder="{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.PhoneNumber.Placeholder}}" id="phone-number" name="phone-number" ng-model="trialExpiredCtrl.extensionFormData.phoneNumber"> <label for="anything-else" class="c-paragraph-2">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.AnythingElse.Heading}}</label> <textarea name="anything-else" id="anything-else" ng-model="trialExpiredCtrl.extensionFormData.additionalComments"></textarea> <div class="buttons"> <button class="c-button" ng-click="trialExpiredCtrl.hideExtendTrialDialog()">{{trialExpiredCtrl.clientResources.Common.Cancel}}</button> <button class="c-button btn-primary" type="submit" ng-disabled="this.trialExpiredCtrl.extendingTrial">{{trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Buttons.Extend}}</button> </div> </form> </div> </section> <section class="c-dialog trial-extended-dialog" ng-show="this.trialExpiredCtrl.shouldShowTrialExtendedDialog"> <div role="presentation" tabindex="-1" data-js-dialog-hide></div> <div role="dialog" tabindex="-1" class=""> <div class="empty-space"></div> <div class="content"> <img svg-src="/content/images/common/ConfirmationCheck.svg" alt=""> <p class="c-heading-3">{{trialExpiredCtrl.clientResources.TrialExpired.TrialExtended.Message}}</p> <button class="c-button btn-primary" ng-disabled="this.trialExpiredCtrl.extendingTrial" ng-click="this.trialExpiredCtrl.redirectBack()">{{trialExpiredCtrl.clientResources.Common.Next}}</button> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1168),i(1179)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1169),i(1174)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1170)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1171);i(1172);var o=function(){function e(){this.controller=n.UserConsentCtrl,this.template=i(1173),this.controllerAs="userConsentCtrl"}return e}();t.UserConsent=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.userConsent,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(1),o=i(6),s=i(5),a=function(){function e(e,t,i,r,a,l){this.$sce=e,this.$window=t,this.appSettings=i,this.clientResources=r,this.telemetryService=a,this.userConsentService=l,this.onboardingImage=s.default.onboarding,this.termsAndConditionsHtml="",this.telemetryService.tagEvent(o.TelemetryEventNames.UserConsentDialogueShown);var c=n.format(this.clientResources.UserConsent.TermsAndConditions.Text,this.clientResources.UserConsent.Button.Accept,this.userConsentService.termsAndConditionsLink);this.termsAndConditionsHtml=this.$sce.trustAsHtml(c)}return e.prototype.consent=function(){var e=this;this.userConsentService.consent().finally(function(){e.$window.location.reload()})},e.prototype.getConsentButtonText=function(){return this.userConsentService.consentInProgress?this.clientResources.Common.Working:this.clientResources.UserConsent.Button.Accept},Object.defineProperty(e.prototype,"disableAcceptButton",{get:function(){return this.userConsentService.consentInProgress||this.userConsentService.disableAcceptButton()},enumerable:!0,configurable:!0}),e.$inject=[r.default.services.$sce,r.default.services.$window,r.default.services.appSettings,r.default.services.clientResources,r.default.services.telemetry,r.default.services.userConsent],e}();t.UserConsentCtrl=a},function(e,t){},function(e,t){e.exports='<section class="c-dialog user-consent-dialog" data-js="userconsent-dialog"> <div role="presentation" tabindex="-1" data-js-dialog-hide></div> <div role="dialog" tabindex="-1" class="x-type-center"> <div class="user-consent-dialog-header"> <div class="user-consent-greeting"> <h1 class="c-heading-3">{{userConsentCtrl.clientResources.UserConsent.Greeting}}</h1> <label class="country-label" for="country-select">{{userConsentCtrl.clientResources.UserConsent.CountryLabel}}</label> <div class="c-select f-border country-select"> <select id="country-select" name="country-select" ng-model="userConsentCtrl.userConsentService.userConsentData.enrollmentUserDetails.countryCode" ng-change="userConsentCtrl.userConsentService.updateUserConsentData()"> <option ng-repeat="country in userConsentCtrl.userConsentService.countryList | orderBy:userConsentCtrl.userConsentService.getCountryDisplayName" value="{{country}}">{{userConsentCtrl.userConsentService.getCountryDisplayName(country)}}</option> </select> </div> <div class="c-checkbox" ng-show="userConsentCtrl.userConsentService.isCheckboxShown"> <label class="c-label email-consent-input"> <input ng-model="userConsentCtrl.userConsentService.isEmailOptedIn" type="checkbox"> <span>{{userConsentCtrl.userConsentService.getPromotionalEmailText()}}</span> </label> </div> </div> <div class="user-consent-image"> <img class="onboarding-image" cdn-src="{{userConsentCtrl.onboardingImage}}" alt=""/> </div> </div> <div class="user-consent-dialog-footer"> <div class="row user-consent-dialog-action"> <button class="c-button" type="submit" data-event-name="UserConsentAcceptClicked" ng-click="userConsentCtrl.consent()" ng-disabled="userConsentCtrl.disableAcceptButton" data-js-dialog-hide data-js="userconsent-accept"> {{userConsentCtrl.getConsentButtonText()}} </button> </div> <div class="user-consent-error" ng-if="userConsentCtrl.userConsentService.errorOccured"> <p class="error-message">{{userConsentCtrl.clientResources.UserConsent.ErrorMessage}}</p> </div> <div class="user-consent-dialog-disclaimer"> <div ng-bind-html="userConsentCtrl.termsAndConditionsHtml"> </div> </div> </div> </div> </section>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1175)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2);var r=i(0),n=i(1176);i(1177);var o=function(){function e(){this.controller=n.InlineUserConsentCtrl,this.template=i(1178),this.controllerAs="inlineUserConsentCtrl"}return e}();t.InlineUserConsent=o,angular.module(r.default.modules.processSimpleComponents).component(r.default.components.inlineUserConsent,new o)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(1),o=i(6),s=i(5),a=function(){function e(e,t,i,r,a,l){var c=this;this.$sce=e,this.appSettings=t,this.clientResources=i,this.telemetryService=r,this.sessionService=a,this.userConsentService=l,this.images=s.default,this.termsAndConditionsHtml="",this.telemetryService.tagEvent(o.TelemetryEventNames.InlineUserConsentDialogueShown);var u=n.format(this.clientResources.InlineUserConsent.TermsAndConditions.Text,this.userConsentService.termsAndConditionsLink);this.termsAndConditionsHtml=this.$sce.trustAsHtml(u),this.hasUserConsented=this.sessionService.hasUserConsented(),this.userConsentService.registerConsentCallback(function(){c.hasUserConsented=!0})}return e.$inject=[r.default.services.$sce,r.default.services.appSettings,r.default.services.clientResources,r.default.services.telemetry,r.default.services.session,r.default.services.userConsent],e}();t.InlineUserConsentCtrl=a},function(e,t){},function(e,t){e.exports='<div class="component-inline-consent" ng-if="!inlineUserConsentCtrl.hasUserConsented"> <div class="inline-block"> <label class="inline-block" for="country-select">{{inlineUserConsentCtrl.clientResources.UserConsent.CountryLabel}}</label> <select id="country-select" ng-model="inlineUserConsentCtrl.userConsentService.userConsentData.enrollmentUserDetails.countryCode" class="country-selector inline-block" ng-change="inlineUserConsentCtrl.userConsentService.updateUserConsentData()"> <option ng-repeat="country in inlineUserConsentCtrl.userConsentService.countryList | orderBy:inlineUserConsentCtrl.userConsentService.getCountryDisplayName" value="{{country}}">{{inlineUserConsentCtrl.userConsentService.getCountryDisplayName(country)}}</option> </select> </div> <div class="c-checkbox promotional-email-checkbox inline-block"> <label class="c-label"> <input type="checkbox" ng-model="inlineUserConsentCtrl.userConsentService.isEmailOptedIn" ng-if="inlineUserConsentCtrl.userConsentService.isCheckboxShown"/> <span>{{inlineUserConsentCtrl.userConsentService.getPromotionalEmailText()}}</span> </label> </div> <div> <div ng-bind-html="inlineUserConsentCtrl.termsAndConditionsHtml"></div> </div> </div>'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(6),o=i(4),s=i(141),a=i(37),l=i(1180),c=i(3),u=function(){function e(e,t,i,r,n,o,s,a,c,u,p){var d=this;this.$http=e,this.$q=t,this.appSettings=i,this.clientResources=r,this.environmentService=n,this.environmentsClient=o,this.loggingService=s,this.promiseHelperService=a,this.sessionService=c,this.telemetryService=u,this.urlService=p,this.consentInProgress=!1,this.errorOccured=!1,this.isEmailOptedIn=!0,this.isCheckboxShown=!1,this.userConsentData={enrollmentUserDetails:{firstName:"",lastName:"",email:"",countryCode:"",locale:"",enrollmentOptions:{MicrosoftFlow:{promotionalEmailOption:"Yes"}}}},this.consentCallbacks=[],this.getCountryDisplayName=function(e){return d.clientResources.CountryName[e]},this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(function(){d.countryList=l.region1.concat(l.region2).concat(l.region3);var e=d.sessionService.getUserInfo();d.userConsentData.enrollmentUserDetails.firstName=e.givenName,d.userConsentData.enrollmentUserDetails.lastName=e.familyName,d.userConsentData.enrollmentUserDetails.email=d.sessionService.getUserSession().userInfo.displayName;var t=d.appSettings.locale,i=t.split("-")[1].toUpperCase();d.userConsentData.enrollmentUserDetails.locale=t,d.countryList.indexOf(i)>-1&&(d.userConsentData.enrollmentUserDetails.countryCode=i),d.updateUserConsentData()})}return e.prototype.consent=function(){var e=this;return this.telemetryService.tagEvent(n.TelemetryEventNames.UserConsentAcceptClicked),this.consentInProgress=!0,this.errorOccured=!1,this.appSettings.featureFlags.enableConsentEmailOptions?this.userConsentData.enrollmentUserDetails.enrollmentOptions.MicrosoftFlow.promotionalEmailOption=this.isEmailOptedIn?"Yes":"No":this.userConsentData.enrollmentUserDetails.enrollmentOptions=null,(this.appSettings.isWidgetPage?this.consentToRP():this.consentToPortal()).then(function(){return e.telemetryService.tagEvent(n.TelemetryEventNames.UserConsentCompleted,{status:n.TelemetryEventStatus.succeeded}),e.sessionService.isConsumerDomain?s.sendMscomCustomEvent(e,a.WedcsTelemetryNames.SignUpConsumerEmail):s.sendMscomCustomEvent(e,a.WedcsTelemetryNames.SignUpAADEmail),e.sessionService.setUserConsent(),e.consentCallbacks.forEach(function(e){e()}),e.setCurrentEnvironmentIfNeeded()}).catch(function(t){e.telemetryService.tagEvent(n.TelemetryEventNames.UserConsentCompleted,{status:n.TelemetryEventStatus.failed},{error:c.scrubErrorObject(t)}),e.loggingService.logError(o.ProfilingEventNames.userConsentFailed,t),e.errorOccured=!0}).finally(function(){e.consentInProgress=!1})},e.prototype.disableAcceptButton=function(){return this.consentInProgress||null===this.userConsentData.enrollmentUserDetails.countryCode},e.prototype.updateUserConsentData=function(){l.region2.indexOf(this.userConsentData.enrollmentUserDetails.countryCode)>-1&&(this.isEmailOptedIn=!1),null!==this.userConsentData.enrollmentUserDetails.countryCode&&-1===l.region3.indexOf(this.userConsentData.enrollmentUserDetails.countryCode)&&(this.isCheckboxShown=!0),this.userConsentData.enrollmentUserDetails.enrollmentOptions.MicrosoftFlow.promotionalEmailOption=this.isEmailOptedIn?"Yes":"No"},e.prototype.getPromotionalEmailText=function(){return this.isCheckboxShown?this.clientResources.UserConsent.PromotionalEmailLabel:""},e.prototype.registerConsentCallback=function(e){this.consentCallbacks.push(e)},Object.defineProperty(e.prototype,"termsAndConditionsLink",{get:function(){var e=this.clientResources.UserConsent.TermsAndConditions.Link;return'<a data-event-name="UserConsentTermsAndConditionsClicked" href="'+this.urlService.termsRoute({locale:this.appSettings.locale})+'" target="_blank">'+e+"</a>"},enumerable:!0,configurable:!0}),e.prototype.consentToPortal=function(){return this.$http.post(this.urlService.portalConsentRoute(),this.userConsentData)},e.prototype.consentToRP=function(){var e=this.appSettings.processSimpleManagementUri+this.urlService.rpConsentRoute()+"?api-version="+this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments;return this.$http.post(e,this.userConsentData)},e.prototype.shouldShowIntegratedConsent=function(){return this.appSettings.isWidgetPage&&!this.sessionService.hasUserConsented()},e.prototype.consentIfNecessary=function(){var e=this.$q.defer();return this.shouldShowIntegratedConsent()?(this.registerConsentCallback(function(){return e.resolve()}),this.consent()):e.resolve(),e.promise},e.prototype.setCurrentEnvironmentIfNeeded=function(){var e=this;if(this.environmentService.getCurrentEnvironment()){var t=this.$q.defer();return t.resolve(),t.promise}return this.environmentsClient.getEnvironments().then(function(t){if(t&&t.data&&t.data.value){var i=t.data.value,r=i.filter(function(e){return e.properties&&e.properties.isDefault});r.length&&e.environmentService.setCurrentEnvironment(r[0])}})},e.$inject=[r.default.services.$http,r.default.services.$q,r.default.services.appSettings,r.default.services.clientResources,r.default.services.environment,r.default.services.environmentsClient,r.default.services.logging,r.default.services.promiseHelperService,r.default.services.session,r.default.services.telemetry,r.default.services.url],e}();t.UserConsentService=u,angular.module(r.default.modules.processSimpleServices).service(r.default.services.userConsent,u)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.region1=["AR","AU","AT","BY","BE","BR","CA","CO","CY","CZ","DK","EE","GR","HU","IS","ID","IL","IT","KZ","KR","KW","LT","LU","MY","MA","NZ","NO","PK","PE","PH","PL","PT","PR","RU","RS","SG","SK","SI","LK","TH","TR","UA","AE","UY","VE"],t.region2=["DE","DZ","BG","CL","CN","CR","HR","EG","FI","FR","GT","HK","IN","IE","JO","JP","LB","LV","MK","MT","MX","NL","NG","PA","RO","ZA","ES","SE","CH","TW","GB","VI"],t.region3=["BH","DO","EC","OM","PY","QA","SA","TT","US","SV","HN","JM","BO"]}],[229]);